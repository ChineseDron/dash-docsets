<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>do-while</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="control-structures.while.html">while</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="control-structures.for.html">for</a></div>
 <div class="up"><a href="language.control-structures.html">Control Structures</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="control-structures.do.while" class="sect1">
 <h2 class="title"><i>do-while</i></h2>
 <p class="verinfo">(PHP 4, PHP5)</p>
 <p class="simpara">
  <i>do-while</i> loops are very similar to
  <i>while</i> loops, except the truth expression is
  checked at the end of each iteration instead of in the beginning.
  The main difference from regular <i>while</i> loops is
  that the first iteration of a <i>do-while</i> loop is
  guaranteed to run (the truth expression is only checked at the end
  of the iteration), whereas it may not necessarily run with a
  regular <i>while</i> loop (the truth expression is
  checked at the beginning of each iteration, if it evaluates to
  <b><tt>FALSE</tt></b> right from the beginning, the loop
  execution would end immediately).
 </p>
 <p class="para">
  There is just one syntax for <i>do-while</i> loops:

  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />do&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">;<br />}&nbsp;while&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
   The above loop would run one time exactly, since after the first
   iteration, when truth expression is checked, it evaluates to
   <b><tt>FALSE</tt></b> (<var class="varname"><var class="varname">$i</var></var> is not bigger than 0) and the loop
   execution ends.
 </p>
 <p class="para">
  Advanced C users may be familiar with a different usage of the
  <i>do-while</i> loop, to allow stopping execution in
  the middle of code blocks, by encapsulating them with
  <i>do-while</i> (0), and using the <a href="control-structures.break.html" class="link"><i>break</i></a>
  statement.  The following code fragment demonstrates this:
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">do&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"i&nbsp;is&nbsp;not&nbsp;big&nbsp;enough"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">*=&nbsp;</span><span style="color: #0000BB">$factor</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$minimum_limit</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"i&nbsp;is&nbsp;ok"</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;process&nbsp;i&nbsp;*/<br /><br /></span><span style="color: #007700">}&nbsp;while&nbsp;(</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
  Don&#039;t worry if you don&#039;t understand this right away or at all.
  You can code scripts and even powerful scripts without using this
  &#039;feature&#039;.
  Since PHP 5.3.0, it is possible to use
  <a href="control-structures.goto.html" class="link"><i>goto</i></a>
  operator instead of this hack.
 </p>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="102985""></a>
  <div class="note">
   <strong class="user">david dot schueler at tel-billig dot de</strong>
   <a href="#102985" class="date">18-Mar-2011 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to use a construct like this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">do {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// some code to run only one more time if expression is true<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$your_expression </span><span class="keyword">== </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
} while (</span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>It will NOT loop as expected, because the continue tries to run the "next" loop, but the expression says just "false" so there is no next loop. The continue exits the while loop.<br />
To get around this you may use an other expression, like this<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">do {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// some code to run only one more time if expression is true<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$your_expression </span><span class="keyword">== </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp; break;<br />
} while (</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>or use the goto statement since PHP 5.3.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102897""></a>
  <div class="note">
   <strong class="user">xiaomao5 at live dot com</strong>
   <a href="#102897" class="date">13-Mar-2011 07:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another hack<br />
If you want $type to only have a value of 0 or 1, you can do this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">do {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Choose a type, 0 or 1: '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">STDIN</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$type </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/* do stuff */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">} elseif (</span><span class="default">$type </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/* do stuff */&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
} while (</span><span class="default">$type </span><span class="keyword">!= </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$type </span><span class="keyword">!= </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99468""></a>
  <div class="note">
   <strong class="user">shaida dot mca at gmail dot com</strong>
   <a href="#99468" class="date">18-Aug-2010 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example of Do while :-<br />
<br />
<span class="default">&lt;?php<br />
$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
echo </span><span class="string">'This code will run at least once because i default value is 0.&lt;br/&gt;'</span><span class="keyword">;<br />
do {<br />
echo </span><span class="string">'i value is ' </span><span class="keyword">. </span><span class="default">$i </span><span class="keyword">. </span><span class="string">', so code block will run. &lt;br/&gt;'</span><span class="keyword">;<br />
++</span><span class="default">$i</span><span class="keyword">;<br />
} while (</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85739""></a>
  <div class="note">
   <strong class="user">andrew at NOSPAM dot devohive dot com</strong>
   <a href="#85739" class="date">15-Sep-2008 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm guilty of writing constructs without curly braces sometimes... writing the do--while seemed a bit odd without the curly braces ({ and }), but just so everyone is aware of how this is written with a do--while...<br />
<br />
a normal while:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">while ( </span><span class="default">$isValid </span><span class="keyword">) </span><span class="default">$isValid </span><span class="keyword">= </span><span class="default">doSomething</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
a do--while:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">do </span><span class="default">$isValid </span><span class="keyword">= </span><span class="default">doSomething</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp; while ( </span><span class="default">$isValid </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Also, a practical example of when to use a do--while when a simple while just won't do (lol)... copying multiple 2nd level nodes from one document to another using the DOM XML extension<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="comment"># open up/create the documents and grab the root element<br />
&nbsp;&nbsp; </span><span class="default">$fileDoc&nbsp; </span><span class="keyword">= </span><span class="default">domxml_open_file</span><span class="keyword">(</span><span class="string">'example.xml'</span><span class="keyword">); </span><span class="comment">// existing xml we want to copy<br />
&nbsp;&nbsp; </span><span class="default">$fileRoot </span><span class="keyword">= </span><span class="default">$fileDoc</span><span class="keyword">-&gt;</span><span class="default">document_element</span><span class="keyword">();<br />
&nbsp;&nbsp; </span><span class="default">$newDoc&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">domxml_new_doc</span><span class="keyword">(</span><span class="string">'1.0'</span><span class="keyword">); </span><span class="comment">// new document we want to copy to<br />
&nbsp;&nbsp; </span><span class="default">$newRoot&nbsp; </span><span class="keyword">= </span><span class="default">$newDoc</span><span class="keyword">-&gt;</span><span class="default">create_element</span><span class="keyword">(</span><span class="string">'rootnode'</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$newRoot&nbsp; </span><span class="keyword">= </span><span class="default">$newDoc</span><span class="keyword">-&gt;</span><span class="default">append_child</span><span class="keyword">(</span><span class="default">$newRoot</span><span class="keyword">); </span><span class="comment">// this is the node we want to copy to<br />
<br />
&nbsp;&nbsp; # loop through nodes and clone (using deep)<br />
&nbsp;&nbsp; </span><span class="default">$child </span><span class="keyword">= </span><span class="default">$fileRoot</span><span class="keyword">-&gt;</span><span class="default">first_child</span><span class="keyword">(); </span><span class="comment">// first_child must be called once and can only be called once<br />
&nbsp;&nbsp; </span><span class="keyword">do </span><span class="default">$newRoot</span><span class="keyword">-&gt;</span><span class="default">append_child</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">clone_node</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)); </span><span class="comment">// do first, so that the result from first_child is appended<br />
&nbsp;&nbsp; </span><span class="keyword">while ( </span><span class="default">$child </span><span class="keyword">= </span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">next_sibling</span><span class="keyword">() ); </span><span class="comment">// we have to use next_sibling for everything after first_child<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82608""></a>
  <div class="note">
   <strong class="user">Ryan</strong>
   <a href="#82608" class="date">17-Apr-2008 10:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found that the most useful thing to use do-while loops for is multiple checks of file existence. The guaranteed iteration means that it will check through at least once, which I had trouble with using a simple "while" loop because it never incremented at the end.<br />
<br />
My code was:<br />
<br />
<span class="default">&lt;?php<br />
$filename </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">, </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">][</span><span class="string">'name'</span><span class="keyword">]); </span><span class="comment">// File being uploaded<br />
</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="comment">// Number of times processed (number to add at the end of the filename)<br />
</span><span class="keyword">do {<br />
&nbsp; </span><span class="comment">/* Since most files being uploaded don't end with a number,<br />
&nbsp;&nbsp; &nbsp;&nbsp; we have to make sure that there is a number at the end<br />
&nbsp;&nbsp; &nbsp;&nbsp; of the filename before we start simply incrementing. I<br />
&nbsp;&nbsp; &nbsp;&nbsp; admit there is probably an easier way to do this, but this<br />
&nbsp;&nbsp; &nbsp;&nbsp; was a quick slap-together job for a friend, and I find it<br />
&nbsp;&nbsp; &nbsp;&nbsp; works just fine. So, the first part "if($i &gt; 0) ..." says that<br />
&nbsp;&nbsp; &nbsp;&nbsp; if the loop has already been run at least once, then there<br />
&nbsp;&nbsp; &nbsp;&nbsp; is now a number at the end of the filename and we can <br />
&nbsp;&nbsp; &nbsp;&nbsp; simply increment that. Otherwise, we have to place a<br />
&nbsp;&nbsp; &nbsp;&nbsp; number at the end of the filename, which is where $i<br />
&nbsp;&nbsp; &nbsp;&nbsp; comes in even handier */<br />
<br />
&nbsp; </span><span class="keyword">if(</span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) </span><span class="default">$filename</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]++;<br />
&nbsp; else </span><span class="default">$filename</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$filename</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">].</span><span class="default">$i</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
} while(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="string">"uploaded/"</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">].</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]));<br />
<br />
</span><span class="comment">/* Now that everything is uploaded, we should move it<br />
&nbsp;&nbsp;&nbsp; somewhere it can be accessed. Hence, the "uploaded"<br />
&nbsp;&nbsp;&nbsp; folder. */<br />
</span><span class="default">move_uploaded_file</span><span class="keyword">(</span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">][</span><span class="string">'tmp_name'</span><span class="keyword">], </span><span class="string">"uploaded/"</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">].</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
</span><span class="default">?&gt;<br />
</span><br />
I'm sure there are plenty of ways of doing this without using the do-while loop, but I managed to toss this one together in no-time flat, and I'm not a great PHP programmer. =) It's simple and effective, and I personally think it works better than any "for" or "while" loop that I've seen that does the same thing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79470""></a>
  <div class="note">
   <strong class="user">jantsch at gmail dot com</strong>
   <a href="#79470" class="date">28-Nov-2007 05:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Useful when you want to continue to read a recordset that was already being read like in:<br />
<br />
&lt;?<br />
$sql = "select * from customers";<br />
$res = mysql_query( $sql );<br />
<br />
// read the first record<br />
if( $rs = mysql_fetch_row( $res ) ){<br />
&nbsp;&nbsp; // do something with this record<br />
<br />
}<br />
<br />
// do another stuff here<br />
<br />
// keep reading till the end<br />
if( mysql_num_rows( $res )&gt;1 ){<br />
&nbsp;&nbsp; do{<br />
&nbsp;&nbsp; &nbsp;&nbsp; // processing the records till the end<br />
<br />
&nbsp;&nbsp; }while( $rs = mysql_fetch_row( $res ));<br />
<br />
}<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74419""></a>
  <div class="note">
   <strong class="user">jayreardon at gmail dot com</strong>
   <a href="#74419" class="date">10-Apr-2007 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is one major difference you should be aware of when using the do--while loop vs. using a simple while loop:&nbsp; And that is when the check condition is made.&nbsp; <br />
<br />
In a do--while loop, the test condition evaluation is at the end of the loop.&nbsp; This means that the code inside of the loop will iterate once through before the condition is ever evaluated.&nbsp; This is ideal for tasks that need to execute once before a test is made to continue, such as test that is dependant upon the results of the loop.&nbsp; <br />
<br />
Conversely, a plain while loop evaluates the test condition at the begining of the loop before any execution in the loop block is ever made. If for some reason your test condition evaluates to false at the very start of the loop, none of the code inside your loop will be executed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="control-structures.while.html">while</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="control-structures.for.html">for</a></div>
 <div class="up"><a href="language.control-structures.html">Control Structures</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
