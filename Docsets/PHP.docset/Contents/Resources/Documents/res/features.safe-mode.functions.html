<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Functions restricted/disabled by safe mode</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ini.sect.safe-mode.html">Security and Safe Mode</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="features.commandline.html">Command line usage</a></div>
 <div class="up"><a href="features.safe-mode.html">Safe Mode</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="features.safe-mode.functions" class="sect1">
   <h2 class="title">Functions restricted/disabled by safe mode</h2>
   <p class="para">
    This is a still probably incomplete and possibly incorrect listing
    of the functions limited by 
    <a href="features.safe-mode.html" class="link">safe mode</a>.
    
    <table class="doctable table">
     <caption><b>Safe mode limited functions</b></caption>
     
      <thead valign="middle">
       <tr valign="middle">
        <th>Function</th>
        <th>Limitations</th>
       </tr>

      </thead>

      <tbody valign="middle" class="tbody">
       <tr valign="middle">
        <td align="left"><span class="function"><b>dbmopen()</b></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.dbase-open.html" class="function">dbase_open()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.filepro.html" class="function">filepro()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.filepro-rowcount.html" class="function">filepro_rowcount()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.filepro-retrieve.html" class="function">filepro_retrieve()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left">ifx_*</td>
        <td align="left">sql_safe_mode restrictions, (!= safe mode)</td>
        
       </tr>

       <tr valign="middle">
        <td align="left">ingres_*</td>
        <td align="left">sql_safe_mode restrictions, (!= safe mode)</td>
        
       </tr>

       <tr valign="middle">
        <td align="left">mysql_*</td>
        <td align="left">sql_safe_mode restrictions, (!= safe mode)</td>
        
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.pg-lo-import.html" class="function">pg_lo_import()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
        
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.posix-mkfifo.html" class="function">posix_mkfifo()</a></span></td>
        <td align="left">Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.putenv.html" class="function">putenv()</a></span></td>
        <td align="left">Obeys the safe_mode_protected_env_vars and 
        safe_mode_allowed_env_vars ini-directives. See also the documentation
        on <span class="function"><a href="function.putenv.html" class="function">putenv()</a></span></td>
        
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.move-uploaded-file.html" class="function">move_uploaded_file()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. </td>
       </tr>


       

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.chdir.html" class="function">chdir()</a></span></td>
        <td align="left">Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.dl.html" class="function">dl()</a></span></td>
        <td align="left">This function is disabled when PHP is running in <a href="features.safe-mode.html" class="link">safe mode</a>.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><a href="language.operators.execution.html" class="link">backtick operator</a></td>
        <td align="left">This function is disabled when PHP is running in <a href="features.safe-mode.html" class="link">safe mode</a>.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.shell-exec.html" class="function">shell_exec()</a></span> (functional equivalent 
        of backticks)</td>
        <td align="left">This function is disabled when PHP is running in <a href="features.safe-mode.html" class="link">safe mode</a>.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.exec.html" class="function">exec()</a></span></td>
        <td align="left">You can only execute executables within the <a href="ini.sect.safe-mode.html#ini.safe-mode-exec-dir" class="link">safe_mode_exec_dir</a>.
        For practical reasons it&#039;s currently not allowed to have
        <i>..</i> components in the path to the executable.
        <span class="function"><a href="function.escapeshellcmd.html" class="function">escapeshellcmd()</a></span> is executed on the argument of this
        function.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.system.html" class="function">system()</a></span></td>
        <td align="left">You can only execute executables within the <a href="ini.sect.safe-mode.html#ini.safe-mode-exec-dir" class="link">safe_mode_exec_dir</a>.
        For practical reasons it&#039;s currently not allowed to have
        <i>..</i> components in the path to the executable.
        <span class="function"><a href="function.escapeshellcmd.html" class="function">escapeshellcmd()</a></span> is executed on the argument of this
        function.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.passthru.html" class="function">passthru()</a></span></td>
        <td align="left">You can only execute executables within the <a href="ini.sect.safe-mode.html#ini.safe-mode-exec-dir" class="link">safe_mode_exec_dir</a>.
        For practical reasons it&#039;s currently not allowed to have
        <i>..</i> components in the path to the executable.
        <span class="function"><a href="function.escapeshellcmd.html" class="function">escapeshellcmd()</a></span> is executed on the argument of this
        function.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.popen.html" class="function">popen()</a></span></td>
        <td align="left">You can only execute executables within the <a href="ini.sect.safe-mode.html#ini.safe-mode-exec-dir" class="link">safe_mode_exec_dir</a>.
        For practical reasons it&#039;s currently not allowed to have
        <i>..</i> components in the path to the executable.
        <span class="function"><a href="function.escapeshellcmd.html" class="function">escapeshellcmd()</a></span> is executed on the argument of this
        function.</td>
        
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.fopen.html" class="function">fopen()</a></span></td>
        <td align="left">Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.mkdir.html" class="function">mkdir()</a></span></td>
        <td align="left">Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.rmdir.html" class="function">rmdir()</a></span></td>
        <td align="left">Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.rename.html" class="function">rename()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.unlink.html" class="function">unlink()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.copy.html" class="function">copy()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed. (on 
        <i><tt class="parameter">source</tt></i> and 
        <i><tt class="parameter">target</tt></i>)</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.chgrp.html" class="function">chgrp()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.chown.html" class="function">chown()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.chmod.html" class="function">chmod()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. In addition, you cannot  
        set the SUID, SGID and sticky bits</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.touch.html" class="function">touch()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.symlink.html" class="function">symlink()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed. (note: only the target is 
        checked)</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.link.html" class="function">link()</a></span></td>
        <td align="left">Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed. (note: only the target is 
        checked)</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.apache-request-headers.html" class="function">apache_request_headers()</a></span></td>
        <td align="left">In safe mode, headers beginning with <i>authorization</i> 
        (case-insensitive) will not be returned.</td>
       </tr>

       <tr valign="middle">
        <td align="left"><span class="function"><a href="function.header.html" class="function">header()</a></span></td>
        <td align="left">In safe mode, the uid of the script is added to the
        <i>realm</i> part of the
        <i>WWW-Authenticate</i> header if you set this
        header (used for HTTP Authentication).</td>
       </tr>

       <tr valign="middle">
        <td align="left"><a href="features.http-auth.html" class="link">PHP_AUTH variables</a></td>
        <td align="left">
         In safe mode, the variables <var class="varname"><var class="varname">PHP_AUTH_USER</var></var>,
         <var class="varname"><var class="varname">PHP_AUTH_PW</var></var>, and <var class="varname"><var class="varname">AUTH_TYPE</var></var>
         are not available in <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER</a></var></var>. Regardless, you
         can still use <var class="varname"><var class="varname">REMOTE_USER</var></var> for the USER.
         (note: only affected since PHP 4.3.0)
        </td>
       </tr>

       <tr valign="middle">
        <td align="left">
         <span class="function"><a href="function.highlight-file.html" class="function">highlight_file()</a></span>,
         <span class="function"><a href="function.show-source.html" class="function">show_source()</a></span>
        </td>
        <td align="left">
         Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed. (note: only affected since PHP 4.2.1)
        </td>
       </tr>

       <tr valign="middle">
        <td align="left">
         <span class="function"><a href="function.parse-ini-file.html" class="function">parse_ini_file()</a></span>
        </td>
        <td align="left">
         Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed. (note: only affected since PHP 4.2.1)
        </td>
       </tr>

       <tr valign="middle">
        <td align="left">
         <span class="function"><a href="function.set-time-limit.html" class="function">set_time_limit()</a></span>
        </td>
        <td align="left">
         Has no effect when PHP is running in <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe mode</a>.
        </td>
       </tr>

       <tr valign="middle">
        <td align="left">
         <a href="info.configuration.html#ini.max-execution-time" class="link">max_execution_time</a>
        </td>
        <td align="left">
         Has no effect when PHP is running in <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe mode</a>.
        </td>
       </tr>

       <tr valign="middle">
        <td align="left">
         <span class="function"><a href="function.mail.html" class="function">mail()</a></span>
        </td>
        <td align="left">
         In safe mode, the fifth parameter is disabled. (note: only affected since PHP 4.2.3)
        </td>
       </tr>

       <tr valign="middle">
        <td align="left">
         <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span>
        </td>
        <td align="left">
         The owner of a script must be the same as owner of a <a href="session.configuration.html#ini.session.save-path" class="link">session.save_path</a> directory if
         the default <i>files</i> <a href="session.configuration.html#ini.session.save-handler" class="link">session.save_handler</a> is
         used.
        </td>
       </tr>

       <tr valign="middle">
        <td align="left">
         All filesystem and stream functions.
        </td>
        <td align="left">
         Checks whether the files or directories being operated
upon have the same UID (owner) as the script that is being executed. Checks whether the directory in which
the script is operating has the same UID (owner) as the script that is being
executed. (see the <a href="ini.sect.safe-mode.html#ini.safe-mode-include-dir" class="link">safe_mode_include_dir</a>
         <var class="filename">php.ini</var> option.
        </td>
       </tr>

      </tbody>
     
    </table>

   </p>
  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="92192""></a>
  <div class="note">
   <strong class="user">Stephen Dewey</strong>
   <a href="#92192" class="date">13-Jul-2009 12:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
curl_setopt() will not allow you to activate CURLOPT_FOLLOWLOCATION when in safe mode.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77981""></a>
  <div class="note">
   <strong class="user">tschmieder at bitworks dot de</strong>
   <a href="#77981" class="date">22-Sep-2007 06:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
refers to the previuos posting of<br />
<br />
bananarama<br />
15-May-2006 10:11 <br />
<br />
"all file-handling and -management functions are restricted, just in case someones wondering why they're not listed here.<br />
a script can run these functions on files without errors, if the files were created (are owned) by the same UID, the script was created (is owned) by."<br />
<br />
.... or if the directory, in which the file is located, has the same UID as the script, which tries to use a file in that directory...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66116""></a>
  <div class="note">
   <strong class="user">bananarama</strong>
   <a href="#66116" class="date">15-May-2006 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
all file-handling and -management functions are restricted, just in case someones wondering why they're not listed here.<br />
a script can run these functions on files without errors, if the files were created (are owned) by the same UID, the script was created (is owned) by.<br />
<br />
example:<br />
you upload a script, it is owned by UID 720. you upload a picture, it is owned by UID 720. the script creates a thumbnail of the picture. the thumb is owned by UID 30 (the server/apache). this makes it impossible (?) to run a gallery script, which checks for newly uploaded pictures in order to create and display thumbs of them if you want to check, if a thumbnail already exists. the script would be owned by UID 720, the thumb by UID 30.<br />
you could upload a script which creates a file (e.g. from a text file) with .php ending. this script would be owned by UID 30 and could access the thumbs, but it couldnt read the upload pictures.<br />
<br />
&lt;? <br />
&nbsp; $data = fread(fopen("test.txt", "r"), filesize("test.txt")); <br />
&nbsp;&nbsp; <br />
&nbsp; $file = "test.php";&nbsp;&nbsp; <br />
&nbsp; if (!$file_handle = fopen($file,"a")) { echo "Cannot open file"; }&nbsp; <br />
&nbsp; if (!fwrite($file_handle, $data)) { echo "Cannot write to file"; }&nbsp; &nbsp; <br />
&nbsp; fclose($file_handle);<br />
&nbsp; <br />
&nbsp; chmod("test.php", 0777);<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63390""></a>
  <div class="note">
   <strong class="user">zauker</strong>
   <a href="#63390" class="date">21-Mar-2006 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The SAFE_MODE handling of glob() needs a checkup for security reasons.<br />
<br />
In short - always with SAFE_MODE on:<br />
<br />
1) glob() can still fetch all filenames in a directory not owned by the<br />
same UID as the user, if just the first file in the directory (or more<br />
specific, the glob-pattern) happens to be owned by the same user as the<br />
PHP-script.<br />
<br />
2a) No warning is raised if glob is used on another owner's directory<br />
and there is no match.<br />
<br />
2b) In those cases where SAFE_MODE correctly prohibits glob() from<br />
fetching a list of files, the warning still discloses the first<br />
filename.<br />
<br />
Solution: glob() in SAFE_MODE should be restricted in the same way as<br />
opendir() is<br />
<br />
see the link <a href="http://bugs.php.net/bug.php?id=28932" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=28932</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58072""></a>
  <div class="note">
   <strong class="user">Jan</strong>
   <a href="#58072" class="date">23-Oct-2005 02:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems that glob and file_exists functions are also restricted in safe-mode.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ini.sect.safe-mode.html">Security and Safe Mode</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="features.commandline.html">Command line usage</a></div>
 <div class="up"><a href="features.safe-mode.html">Safe Mode</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
