<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Apply a user function recursively to every member of an array</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.array-values.html">array_values</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.array-walk.html">array_walk</a></div>
 <div class="up"><a href="ref.array.html">Array Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.array-walk-recursive" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">array_walk_recursive</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">array_walk_recursive</span> &mdash; <span class="dc-title">Apply a user function recursively to every member of an array</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.array-walk-recursive-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>array_walk_recursive</b></span>
    ( <span class="methodparam"><span class="type">array</span> <tt class="parameter reference">&$input</tt></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.callback" class="type callback">callback</a></span> <tt class="parameter">$funcname</tt></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$userdata</tt></span>
  ] )</div>

  <p class="para rdfs-comment">
   Applies the user-defined function <i><tt class="parameter">funcname</tt></i> to each
   element of the <i><tt class="parameter">input</tt></i> array. This function will recurse
   into deeper arrays.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.array-walk-recursive-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">input</tt></i></span>
     <dd>

      <p class="para">
       The input array.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">funcname</tt></i></span>
     <dd>

      <p class="para">
       Typically, <i><tt class="parameter">funcname</tt></i> takes on two parameters.
       The <i><tt class="parameter">input</tt></i> parameter&#039;s value being the first, and
       the key/index second.
      </p>
      <blockquote class="note"><p><b class="note">Note</b>: 
       <p class="para">
        If <i><tt class="parameter">funcname</tt></i> needs to be working with the
        actual values of the array, specify the first parameter of
        <i><tt class="parameter">funcname</tt></i> as a
        <a href="language.references.html" class="link">reference</a>. Then,
        any changes made to those elements will be made in the
        original array itself.
       </p>
      </p></blockquote>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">userdata</tt></i></span>
     <dd>

      <p class="para">
       If the optional <i><tt class="parameter">userdata</tt></i> parameter is supplied,
       it will be passed as the third parameter to the callback
       <i><tt class="parameter">funcname</tt></i>.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>



 <div class="refsect1 returnvalues" id="refsect1-function.array-walk-recursive-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <b><tt>TRUE</tt></b> on success or <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.array-walk-recursive-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-4541">
    <p><b>Example #1 <span class="function"><b>array_walk_recursive()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sweet&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'a'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'apple'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'b'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'banana'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$fruits&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'sweet'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$sweet</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sour'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'lemon'</span><span style="color: #007700">);<br /><br />function&nbsp;</span><span style="color: #0000BB">test_print</span><span style="color: #007700">(</span><span style="color: #0000BB">$item</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$key</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$key</span><span style="color: #DD0000">&nbsp;holds&nbsp;</span><span style="color: #0000BB">$item</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">array_walk_recursive</span><span style="color: #007700">(</span><span style="color: #0000BB">$fruits</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'test_print'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
a holds apple
b holds banana
sour holds lemon
</pre></div>
    </div>
    <div class="example-contents"><p>
     You may notice that the key &#039;sweet&#039; is never displayed. Any key that holds an
     <span class="type"><a href="language.types.array.html" class="type array">array</a></span> will not be passed to the function.
    </p></div>
   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.array-walk-recursive-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.array-walk.html" class="function" rel="rdfs-seeAlso">array_walk()</a> - Apply a user function to every member of an array</span></li>
    <li class="member">information about the <a href="language.pseudo-types.html#language.types.callback" class="link">callback</a> type</li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106340""></a>
  <div class="note">
   <strong class="user">cyranix at cyranix dot com</strong>
   <a href="#106340" class="date">28-Oct-2011 07:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed to add or modify values in an array with unknown structure. I was hoping to use array_walk_recursive for the task, but because I was also adding new nodes I came up with an alternate solution.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Sets key/value pairs at any depth on an array.<br />
&nbsp;&nbsp; &nbsp; * @param $data an array of key/value pairs to be added/modified<br />
&nbsp;&nbsp; &nbsp; * @param $array the array to operate on<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">setNodes</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, &amp;</span><span class="default">$array</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$separator </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">; </span><span class="comment">// set this to any string that won't occur in your keys<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$name </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$separator</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// If the array doesn't contain a special separator character, just set the key/value pair. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // If $value is an array, you will of course set nested key/value pairs just fine.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// In this case we're trying to target a specific nested node without overwriting any other siblings/ancestors. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // The node or its ancestors may not exist yet.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$separator</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Set the root of the tree.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$opt_tree </span><span class="keyword">=&amp; </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Start traversing the tree using the specified keys.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">while (</span><span class="default">$key </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$keys</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// If there are more keys after the current one...<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$keys</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$opt_tree</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) || !</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$opt_tree</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Create this node if it doesn't already exist.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$opt_tree</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Redefine the "root" of the tree to this node (assign by reference) then process the next key.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$opt_tree </span><span class="keyword">=&amp; </span><span class="default">$opt_tree</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// This is the last key to check, so assign the value.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$opt_tree</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Sample usage: <br />
<br />
<span class="default">&lt;?php<br />
<br />
$x </span><span class="keyword">= array();<br />
</span><span class="default">setNodes</span><span class="keyword">(array(</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">, </span><span class="string">'baz' </span><span class="keyword">=&gt; array(</span><span class="string">'quux' </span><span class="keyword">=&gt; </span><span class="default">42</span><span class="keyword">, </span><span class="string">'hup' </span><span class="keyword">=&gt; </span><span class="default">101</span><span class="keyword">)), </span><span class="default">$x</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">); </span><span class="comment">// $x has the same structure as the first argument<br />
</span><span class="default">setNodes</span><span class="keyword">(array(</span><span class="string">'jif.snee' </span><span class="keyword">=&gt; </span><span class="string">'hello world'</span><span class="keyword">, </span><span class="string">'baz.quux.wek' </span><span class="keyword">=&gt; </span><span class="default">5</span><span class="keyword">), </span><span class="default">$x</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">); </span><span class="comment">// added $x['jif']['snee'] and modified $x['baz']['quux'] to be array('wek' =&gt; 5)<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106146""></a>
  <div class="note">
   <strong class="user">ghoffman at salientdigital dot com</strong>
   <a href="#106146" class="date">13-Oct-2011 10:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are wanting to change the values of an existing multi-dimensional array, as it says above in the note, you need to specify the first argument as a reference. All that means is, be sure to precede the $item variable with an ampersand (&amp;) as in the good_example below. <br />
<br />
Unfortunately the PHP example given doesn't do this. It actually took me a while to figure out why my function wasn't changing the original array, even though I was passing by reference. <br />
<br />
Here's the tip: Don't return any value from the function! Just change the value of $item that you passed in by reference. This is rather counter-intuitive since the vast majority of functions return a value.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// array_walk_recursive fails to change your array unless you pass by reference.<br />
// Don't return values from your filter function, even though it's quite logical at a glance!<br />
</span><span class="keyword">function </span><span class="default">bad_example</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">){<br />
&nbsp;&nbsp; if(</span><span class="default">$key</span><span class="keyword">==</span><span class="string">'test'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="string">'PHP Rocks'</span><span class="keyword">;&nbsp; </span><span class="comment">// Don't do it<br />
&nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$item</span><span class="keyword">;&nbsp; </span><span class="comment">// Don't do this either<br />
&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
</span><span class="comment">// array_walk_recursive pass-by-reference example<br />
</span><span class="keyword">function </span><span class="default">good_example</span><span class="keyword">(&amp;</span><span class="default">$item</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">){<br />
&nbsp;&nbsp; if(</span><span class="default">$key</span><span class="keyword">==</span><span class="string">'test'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item</span><span class="keyword">=</span><span class="string">'PHP Rocks'</span><span class="keyword">; </span><span class="comment">// Do This!<br />
&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
</span><span class="default">$arr </span><span class="keyword">= array(</span><span class="string">'a'</span><span class="keyword">=&gt;</span><span class="string">'1'</span><span class="keyword">,</span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="string">'2'</span><span class="keyword">,</span><span class="string">'test'</span><span class="keyword">=&gt;</span><span class="string">'Replace This'</span><span class="keyword">);<br />
<br />
</span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">,</span><span class="string">'bad_example'</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
</span><span class="comment">/**<br />
&nbsp;* no errors, but prints...<br />
&nbsp;* array('a'=&gt;'1','b'=&gt;'2','test'=&gt;'Replace This');<br />
&nbsp;*/<br />
<br />
</span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">,</span><span class="string">'good_example'</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
</span><span class="comment">/**<br />
&nbsp;* prints...<br />
&nbsp;* array('a'=&gt;'1','b'=&gt;'2','test'=&gt;'PHP Rocks');<br />
&nbsp;*/<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Returning a value from your function does work if you pass by reference and modify $item before you return, but you will eat up memory very, very fast if you try it, even on an example as small as the one here.<br />
<br />
One other silly thing you might try first is something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Resist the urge to do this, it doesn't work.<br />
</span><span class="default">$filtered </span><span class="keyword">= </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$unfiltered</span><span class="keyword">,</span><span class="string">'filter_function'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Of course, $filtered is just TRUE afterwards, not the filtered results you were wanting. Oh, it ran your function recursively alright, but changed all the values in the local function scope only and returns a boolean as the documentation states.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100608""></a>
  <div class="note">
   <strong class="user">rob at yurkowski dot net</strong>
   <a href="#100608" class="date">26-Oct-2010 11:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you don't really particularly care about the keys of an array, you can capture all values quite simply:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$sample </span><span class="keyword">= array(</span><span class="string">'dog' </span><span class="keyword">=&gt; </span><span class="string">'woof'</span><span class="keyword">, </span><span class="string">'cat' </span><span class="keyword">=&gt; array(</span><span class="string">'angry' </span><span class="keyword">=&gt; </span><span class="string">'hiss'</span><span class="keyword">, </span><span class="string">'happy' </span><span class="keyword">=&gt; </span><span class="string">'purr'</span><span class="keyword">), </span><span class="string">'aardvark' </span><span class="keyword">=&gt; </span><span class="string">'kssksskss'</span><span class="keyword">);<br />
</span><span class="default">$output </span><span class="keyword">= array();<br />
<br />
</span><span class="comment">// Push all $val onto $output.<br />
</span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$sample</span><span class="keyword">, </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$val, $key, $obj'</span><span class="keyword">, </span><span class="string">'array_push($obj, $val);'</span><span class="keyword">), &amp;</span><span class="default">output</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Printing<br />
</span><span class="keyword">echo </span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">));<br />
<br />
</span><span class="comment">/* <br />
* Array<br />
* (<br />
*&nbsp; [0] =&gt; woof<br />
*&nbsp; [1] =&gt; hiss<br />
*&nbsp; [2] =&gt; purr<br />
*&nbsp; [3] =&gt; kssksskss<br />
* )<br />
*/<br />
</span><span class="default">?&gt;<br />
</span><br />
[EDIT BY danbrown AT php DOT net: In a note added by 'FaustoFilho' on 17-MAY-2011, the following information was appended to this note.<br />
<br />
[If you intend to use this] "function to extract the last key value of an array, don't forget to insert a currency sign ($) signal before '$output' at 7th line.<br />
<br />
This value must be a variable, and if you forgot to assign this signal, your code won't work, displaying an error like this:<br />
<br />
Parse error: syntax error, unexpected ')', expecting T_PAAMAYIM_NEKUDOTAYIM in /path/to/script.php on line 7."]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99639""></a>
  <div class="note">
   <strong class="user">bradbeattie at gmail dot com</strong>
   <a href="#99639" class="date">27-Aug-2010 11:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The description says "If funcname needs to be working with the actual values of the array, specify the first parameter of funcname as a reference." This isn't necessarily helpful as the function you're calling might be built in (e.g. trim or strip_tags). One option would be to create a version of these like so.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">trim_by_reference</span><span class="keyword">(&amp;</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
The downside to this approach is that you need to create a wrapper function for each function you might want to call. Instead, we can use PHP 5.3's inline function syntax to create a new version of array_walk_recursive.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * This function acts exactly like array_walk_recursive, except that it pretends that the function<br />
&nbsp;&nbsp; &nbsp; * its calling replaces the value with its result.<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @param $array The first value of the array will be passed into $function as the primary argument<br />
&nbsp;&nbsp; &nbsp; * @param $function The function to be called on each element in the array, recursively<br />
&nbsp;&nbsp; &nbsp; * @param $parameters An optional array of the additional parameters to be appeneded to the function<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * Example usage to alter $array to get the second, third and fourth character from each value<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp;&nbsp; array_walk_recursive_referential($array, "substr", array("1","3"));<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">array_walk_recursive_referential</span><span class="keyword">(&amp;</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$function</span><span class="keyword">, </span><span class="default">$parameters </span><span class="keyword">= array()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$reference_function </span><span class="keyword">= function(&amp;</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$userdata</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parameters </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(array(</span><span class="default">$value</span><span class="keyword">), </span><span class="default">$userdata</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="default">$userdata</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$parameters</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$reference_function</span><span class="keyword">, array(</span><span class="default">$function</span><span class="keyword">, </span><span class="default">$parameters</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
The advantage here is that we only explicitly define one wrapper function instead of potentially dozens.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86316""></a>
  <div class="note">
   <strong class="user">devel at starosta dot org</strong>
   <a href="#86316" class="date">12-Oct-2008 05:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Nice system to make DB tree using function array_walk_recursive:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">_CategoriesTree</span><span class="keyword">(&amp;</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">)<br />
{<br />
global </span><span class="default">$objDB</span><span class="keyword">;<br />
<br />
&nbsp; if (</span><span class="default">$key</span><span class="keyword">==</span><span class="string">"childs"</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">$objDB</span><span class="keyword">-&gt;</span><span class="default">getAssoc</span><span class="keyword">(</span><span class="string">'SELECT category_id, name,category_parent_id, category_id AS childs&nbsp; FROM categories WHERE category_parent_id = '</span><span class="keyword">.</span><span class="default">$item</span><span class="keyword">.</span><span class="string">' ORDER BY orderid'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!empty(</span><span class="default">$res</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// walk inside subcategories<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">$res</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// equvalent =&gt; no childs<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">$categories </span><span class="keyword">= </span><span class="default">$objDB</span><span class="keyword">-&gt;</span><span class="default">getAssoc</span><span class="keyword">(</span><span class="string">'SELECT category_id, name,category_parent_id, category_id AS childs&nbsp; FROM categories WHERE category_parent_id = 0 ORDER BY orderid'</span><span class="keyword">);&nbsp; </span><span class="comment">// fetchPairs -&gt; value is the index<br />
</span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$categories</span><span class="keyword">, </span><span class="string">'treeFunc'</span><span class="keyword">,</span><span class="default">$objDB</span><span class="keyword">);<br />
<br />
</span><span class="comment">// test<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$categories</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86010""></a>
  <div class="note">
   <strong class="user">martin dot velek at gmail dot com</strong>
   <a href="#86010" class="date">28-Sep-2008 02:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you will know that a tree in DB is not huge you can use array_walk_recursive to create tree structure e.g. in array.<br />
<br />
let's assume following table:<br />
NAME&nbsp; &nbsp; &nbsp; &nbsp; PARENT<br />
a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; null<br />
b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; null<br />
c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; null<br />
a1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; a<br />
a2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; a<br />
b1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; b<br />
b11&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; b1<br />
b111&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; b11<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">require_once </span><span class="string">'Zend/Db/Adapter/Pdo/Sqlite.php'</span><span class="keyword">;<br />
<br />
function </span><span class="default">treeFunc</span><span class="keyword">(&amp;</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$dbConn</span><span class="keyword">) <br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">$dbConn</span><span class="keyword">-&gt;</span><span class="default">fetchPairs</span><span class="keyword">(</span><span class="string">'SELECT name FROM tree where parent = ?'</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!empty(</span><span class="default">$res</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">$res</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$arr </span><span class="keyword">= </span><span class="default">$dbConn</span><span class="keyword">-&gt;</span><span class="default">fetchPairs</span><span class="keyword">(</span><span class="string">'SELECT name FROM tree where parent is null'</span><span class="keyword">);&nbsp; </span><span class="comment">// fetchPairs -&gt; value is the index<br />
<br />
</span><span class="default">$valid </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
while(</span><span class="default">$valid</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$oldCount&nbsp; </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">,</span><span class="default">COUNT_RECURSIVE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">, </span><span class="string">'treeFunc'</span><span class="keyword">,</span><span class="default">$dbConn</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$newCount </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">,</span><span class="default">COUNT_RECURSIVE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (</span><span class="default">$oldCount </span><span class="keyword">== </span><span class="default">$newCount</span><span class="keyword">)&nbsp; </span><span class="comment">// if there is no change, exit...<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$valid </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;&nbsp; &nbsp;&nbsp; <br />
}<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
--------------------------------------------------<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [a] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [a1] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [a2] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [b] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [b1] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [b11] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [b111] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [c] =&gt; <br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83624""></a>
  <div class="note">
   <strong class="user">amoffat at amoffat dot com</strong>
   <a href="#83624" class="date">04-Jun-2008 05:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&lt;?<br />
function my_array_map() {<br />
&nbsp;&nbsp;&nbsp; $args = func_get_args();<br />
&nbsp;&nbsp;&nbsp; $arr = array_shift($args);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach ($args as $fn) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $nfn = create_function('&amp;$v, $k, $fn', '$v = $fn($v);');<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array_walk_recursive($arr, $nfn, $fn);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $arr;<br />
}<br />
?&gt;<br />
<br />
takes an array as the first argument, and functions as the other arguments.&nbsp; it applies those functions recursively to the array</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81835""></a>
  <div class="note">
   <strong class="user">JW</strong>
   <a href="#81835" class="date">14-Mar-2008 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function has a serious bug, which is still not fixed as of the PHP 5.2.5 release. After you call it, it can accidentally modify your original array. Save yourself hours of frustration by reading on.<br />
<br />
The bug is here: <a href="http://bugs.php.net/bug.php?id=42850, and it looks like it will be fixed for 5.3." rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=42850, and it looks like it will be fixed for 5.3.</a><br />
<br />
If the array that you walk contains other array elements, they will be turned into references. This will happen even if the callback function doesn't take its first argument by reference, and doesn't do anything to the values.<br />
<br />
For example, try this:<br />
<span class="default">&lt;?php<br />
$data </span><span class="keyword">= array (</span><span class="string">'key1' </span><span class="keyword">=&gt; </span><span class="string">'val1'</span><span class="keyword">, </span><span class="string">'key2' </span><span class="keyword">=&gt; array(</span><span class="string">'key3' </span><span class="keyword">=&gt; </span><span class="string">'val3'</span><span class="keyword">));<br />
function </span><span class="default">foo</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">){}<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The original array has no references. Now try this:<br />
<span class="default">&lt;?php<br />
array_walk_recursive</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">,</span><span class="string">'foo'</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Now key2 is a reference, not just an array. So if you do this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">test</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">){</span><span class="default">$item</span><span class="keyword">[</span><span class="string">'key2'</span><span class="keyword">] = array();}<br />
</span><span class="default">test</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
you will see that test modifies $data, even though it shouldn't.<br />
<br />
One workaround is to immediately make a deep copy of the array after calling array_walk_recursive, like this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">array_duplicate</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">) {<br />
&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)) return </span><span class="default">$input</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$output </span><span class="keyword">= array();<br />
&nbsp; foreach (</span><span class="default">$input </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">array_duplicate</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$output</span><span class="keyword">;<br />
}<br />
</span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">,</span><span class="string">'foo'</span><span class="keyword">);<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">array_duplicate</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
After doing that, the references are gone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73682""></a>
  <div class="note">
   <strong class="user">wileur at gmail dot com</strong>
   <a href="#73682" class="date">06-Mar-2007 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple way to use callback functions that are defined in a class is to simply pass the class instance and function names as values in an array:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">testClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">callbackFunction</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$key</span><span class="string">: </span><span class="default">$value</span><span class="string">&lt;br /&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">printArray</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">, array(</span><span class="default">$this</span><span class="keyword">, </span><span class="string">'callbackFunction'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71060""></a>
  <div class="note">
   <strong class="user">adam dott pub att adamswick dott com</strong>
   <a href="#71060" class="date">09-Nov-2006 06:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks to all of you in the prior posts.<br />
<br />
I don't like the fact that the current version of array_walk_recursive() doesn't track all array keys.&nbsp; This version will do that, as well as tracking array depth on multi-dimensional arrays.<br />
<br />
- - - - - - -<br />
<br />
Class Array_walk_recursive3 {<br />
<br />
&nbsp;&nbsp;&nbsp; private $depth = -1;<br />
&nbsp;&nbsp;&nbsp; private $userdata, $funcname;<br />
&nbsp;&nbsp;&nbsp; public $status;<br />
&nbsp;&nbsp;&nbsp; public $input;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function __construct($input, $funcname, $userdata = "") {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;input = $input;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;funcname = $funcname;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;userdata = $userdata;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;status = $this-&gt;array_walk_recursive($this-&gt;input);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private function test_print(&amp;$value, &amp;$key)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo str_repeat("&nbsp; ", $this-&gt;depth)."$key holds ";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!is_array($value)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo $value;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (trim($value) == "banana") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = "cherry";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $key = "c";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "\n";<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private function array_walk_recursive(&amp;$input) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $funcname = array(&amp;$this, $this-&gt;funcname);<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (!is_callable($funcname)) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; if (!is_array($input)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;depth++;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; foreach (array_keys($input) AS $keyIdx =&gt; $key) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $saved_value = $input[$key];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $saved_key = $key;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; call_user_func_array($funcname, array(&amp;$input[$saved_key], &amp;$key));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($input[$saved_key] !== $saved_value || $saved_key !== $key) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $saved_value = $input[$saved_key];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset($input[$saved_key]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $input[$key] = $saved_value;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (is_array($input[$key])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!$this-&gt;array_walk_recursive($input[$key], $funcname)) return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;depth--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; return true;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
$sweet = array('a' =&gt; 'apple', 'b' =&gt; 'banana');<br />
$fruits = array('sweet' =&gt; $sweet, 'sour' =&gt; 'lemon');<br />
<br />
$fruitObj = new Array_walk_recursive3($fruits, 'test_print');<br />
echo $fruitObj-&gt;status;<br />
$newFruitArr = $fruitObj-&gt;input;<br />
print_r($fruits);<br />
print_r($newFruitArr);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70411""></a>
  <div class="note">
   <strong class="user">ik at paulkaspers dot nl</strong>
   <a href="#70411" class="date">15-Oct-2006 01:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To egingell at sisna dot com:<br />
<br />
There is a small bug in your function, the following line should be changed:<br />
From: if ($value != $saved_value || $saved_key != $key) {<br />
Into: if ($value !== $saved_value || $saved_key !== $key) {<br />
<br />
It's a nice function, because I was searching for something to change the keys of a multiple dimension array.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63731""></a>
  <div class="note">
   <strong class="user">gieterke at gmail dot com</strong>
   <a href="#63731" class="date">29-Mar-2006 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think there are a lot of people who want/have to work object oriented.<br />
this is an Object oriented version<br />
<br />
the code is written in PHP5<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//auto overload classes, so you don't have to put in all the includes<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__autoload</span><span class="keyword">(</span><span class="default">$class_name</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; require_once </span><span class="default">$class_name </span><span class="keyword">. </span><span class="string">'.php'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"TESTING: arraywalker&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$anObject </span><span class="keyword">= new </span><span class="default">ClassName</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//array_walk_recursive($anObject-&gt;getFruits(), 'test_print'); =&gt; doesn't work<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$anObject</span><span class="keyword">-&gt;</span><span class="default">getFruits</span><span class="keyword">(), array(&amp;</span><span class="default">$anObject</span><span class="keyword">, </span><span class="string">'test_print'</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; echo</span><span class="string">"&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//if you just want to give the array and not hte function name that handles the array<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$anObject</span><span class="keyword">-&gt;</span><span class="default">arrWalker</span><span class="keyword">(</span><span class="default">$anObject</span><span class="keyword">-&gt;</span><span class="default">getFruits</span><span class="keyword">());<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
</span><span class="comment">//Class description---------------------------------------------<br />
</span><span class="keyword">class </span><span class="default">ClassName </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Class variables<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private </span><span class="default">$sweet </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$fruits </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Constructor<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sweet </span><span class="keyword">= array(</span><span class="string">'a' </span><span class="keyword">=&gt; </span><span class="string">'apple'</span><span class="keyword">, </span><span class="string">'b' </span><span class="keyword">=&gt; </span><span class="string">'banana'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fruits </span><span class="keyword">= array(</span><span class="string">'sweet' </span><span class="keyword">=&gt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sweet</span><span class="keyword">, </span><span class="string">'sour' </span><span class="keyword">=&gt; </span><span class="string">'lemon'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//public methods<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getFruits</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fruits</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">test_print</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$key</span><span class="string"> holds </span><span class="default">$item</span><span class="string">\n&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">arrWalker</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">, array(&amp;</span><span class="default">$this</span><span class="keyword">, </span><span class="string">'test_print'</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
the code above gives following input:<br />
TESTING: arraywalker<br />
a holds apple<br />
b holds banana<br />
sour holds lemon<br />
<br />
a holds apple<br />
b holds banana<br />
sour holds lemon</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63285""></a>
  <div class="note">
   <strong class="user">egingell at sisna dot com</strong>
   <a href="#63285" class="date">18-Mar-2006 01:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Slightly modified version of array_walk_recursive function by "omega13a at sbcglobal dot net"<br />
<br />
$function also modifies the keys in addition to the values.<br />
<br />
Usefull if you want to trim() the keys and values of an array.<br />
<br />
The $key in $funcname would also have to be passed by referrence.<br />
<br />
Named 'array_walk_recursive2' since it is not the same as the PHP5 version, you can rename it to 'array_walk_recursive' if you are running PHP4 and have no reason to upgrade.<br />
<br />
&lt;?<br />
function funcname(&amp;$value, &amp;$key, $userdata = "") {<br />
&nbsp;&nbsp;&nbsp; // Do stuff to $value and $key<br />
}<br />
<br />
function array_walk_recursive2(&amp;$input, $funcname, $userdata = "") {<br />
&nbsp;&nbsp;&nbsp; if (!is_callable($funcname)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (!is_array($input)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; foreach ($input AS $key =&gt; $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (is_array($input[$key])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array_walk_recursive2($input[$key], $funcname, $userdata);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $saved_value = $value;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $saved_key = $key;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty($userdata)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $funcname($value, $key, $userdata);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $funcname($value, $key);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($value != $saved_value || $saved_key != $key) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset($input[$saved_key]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $input[$key] = $value;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return true;<br />
}<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62172""></a>
  <div class="note">
   <strong class="user">gabrielu at hotmail dot com</strong>
   <a href="#62172" class="date">21-Feb-2006 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I decided to add to the previous PHP 4 compatible version of array_walk_recursive() so that it would work within a class and as a standalone function.&nbsp; Both instances are handled by the following function which I modified from omega13a at sbcglobal dot net.<br />
<br />
The following example is for usage within a class.&nbsp; To use as a standalone function take it out of the class and rename it.&nbsp; (Example: array_walk_recursive_2)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">A_Class </span><span class="keyword">{<br />
<br />
function </span><span class="default">array_walk_recursive</span><span class="keyword">(&amp;</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$funcname</span><span class="keyword">, </span><span class="default">$userdata </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp; if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'array_walk_recursive'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">is_callable</span><span class="keyword">(</span><span class="default">$funcname</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$input </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(isset(</span><span class="default">$this</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval(</span><span class="string">'$this-&gt;' </span><span class="keyword">. </span><span class="default">__FUNCTION__ </span><span class="keyword">. </span><span class="string">'($input[$key], $funcname, $userdata);'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(@</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval(</span><span class="default">get_class</span><span class="keyword">() . </span><span class="string">'::' </span><span class="keyword">. </span><span class="default">__FUNCTION__ </span><span class="keyword">. </span><span class="string">'($input[$key], $funcname, $userdata);'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval(</span><span class="default">__FUNCTION__ </span><span class="keyword">. </span><span class="string">'($input[$key], $funcname, $userdata);'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$saved_value </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$funcname</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$a</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$funcname</span><span class="keyword">); </span><span class="default">$a</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$funcname</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">.= </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$funcname</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$a </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">.= </span><span class="string">'::'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">.= </span><span class="default">$funcname</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">.= </span><span class="string">'($value, $key' </span><span class="keyword">. (!empty(</span><span class="default">$userdata</span><span class="keyword">) ? </span><span class="string">', $userdata' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">) . </span><span class="string">');'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval(</span><span class="default">$f</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!empty(</span><span class="default">$userdata</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$funcname</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$userdata</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$funcname</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$value </span><span class="keyword">!= </span><span class="default">$saved_value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$input</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$funcname</span><span class="keyword">, </span><span class="default">$userdata</span><span class="keyword">);<br />
&nbsp; }<br />
}<br />
<br />
function </span><span class="default">kv_addslashes</span><span class="keyword">(&amp;</span><span class="default">$v</span><span class="keyword">, </span><span class="default">$k</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br />
}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Usage:<br />
<span class="default">&lt;?php<br />
$arr </span><span class="keyword">= array(<br />
&nbsp; </span><span class="string">'a' </span><span class="keyword">=&gt; </span><span class="string">'"Hello World"'</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'b' </span><span class="keyword">=&gt; </span><span class="string">"'Hello World'"</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'c' </span><span class="keyword">=&gt; </span><span class="string">"Hello 'Worl\"d"</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'d' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'A' </span><span class="keyword">=&gt; </span><span class="string">'H"e"l"l"o" "W"o"r"l"d'<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp; );<br />
<br />
</span><span class="default">$class </span><span class="keyword">= new </span><span class="default">A_Class</span><span class="keyword">();<br />
</span><span class="default">$class</span><span class="keyword">-&gt;</span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">, array(&amp;</span><span class="default">$class</span><span class="keyword">, </span><span class="string">'kv_addslashes'</span><span class="keyword">));<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59984""></a>
  <div class="note">
   <strong class="user">omega13a at sbcglobal dot net</strong>
   <a href="#59984" class="date">21-Dec-2005 04:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a peice of code I wrote that appears to create this function for PHP 4.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'array_walk_recursive'</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">array_walk_recursive</span><span class="keyword">(&amp;</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$funcname</span><span class="keyword">, </span><span class="default">$userdata </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_callable</span><span class="keyword">(</span><span class="default">$funcname</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$input </span><span class="keyword">AS </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$funcname</span><span class="keyword">, </span><span class="default">$userdata</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$saved_value </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$userdata</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$funcname</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$userdata</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$funcname</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$value </span><span class="keyword">!= </span><span class="default">$saved_value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$input</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Please note it is a conditionaly set function and will have to be put before any call to it.<br />
<br />
If there is anything wrong with it, please email me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59431""></a>
  <div class="note">
   <strong class="user">cory at lavacube dot com</strong>
   <a href="#59431" class="date">06-Dec-2005 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple way to implement array_walk_recursive() in PHP 4 is to use to do the following...<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// first, lets define our function<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">test_array_walkr</span><span class="keyword">( &amp;</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do what you want to do here - in this example we will <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // check to see if $item is an array. If it is, we will <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // check to see if the key '.hide' exists. If this exists, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // we will set the entire array to NULL;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">) &amp;&amp; </span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'.hide'</span><span class="keyword">, </span><span class="default">$item</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// this is the code that causes the recursive effect<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // we do this after, to allow for any changes to $item<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // to be included in the next recursive call...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">__FUNCTION__</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="comment">// next, let's define our array:<br />
</span><span class="default">$test </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'one'&nbsp; &nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'one-&gt;one'</span><span class="keyword">, </span><span class="string">'one-&gt;two'</span><span class="keyword">, </span><span class="string">'one-&gt;three'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'two'&nbsp; &nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'.hide'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">, </span><span class="string">'two-&gt;one'</span><span class="keyword">, </span><span class="string">'two-&gt;two'</span><span class="keyword">, </span><span class="string">'two-&gt;three'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'three'&nbsp; &nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'three-&gt;one'</span><span class="keyword">, </span><span class="string">'three-&gt;two'</span><span class="keyword">, </span><span class="string">'three-&gt;three'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; );<br />
<br />
</span><span class="comment">// lets run the test. ;-)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_walk</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">, </span><span class="string">'test_array_walkr'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// ... and get the results<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This example will yeild:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [one] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; one-&gt;one<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; one-&gt;two<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [2] =&gt; one-&gt;three<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [two] =&gt; <br />
&nbsp;&nbsp;&nbsp; [three] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; three-&gt;one<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; three-&gt;two<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [2] =&gt; three-&gt;three<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
)<br />
<br />
Hope this helps someone. :-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50221""></a>
  <div class="note">
   <strong class="user">aidan at php dot net</strong>
   <a href="#50221" class="date">21-Feb-2005 11:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This functionality is now implemented in the PEAR package PHP_Compat.<br />
<br />
More information about using this function without upgrading your version of PHP can be found on the below link:<br />
<br />
<a href="http://pear.php.net/package/PHP_Compat" rel="nofollow" target="_blank">http://pear.php.net/package/PHP_Compat</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48181""></a>
  <div class="note">
   <strong class="user">hannes (at) tismer.com</strong>
   <a href="#48181" class="date">14-Dec-2004 11:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wondered about an array_mergedown function working with PHP4, using an array_walk_recursive-like function which just merges any number of arrays of any dimension to a one dimension array containing every key=&gt;value part of all arrays:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">array_mergedown</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$outarray</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$outarray </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">array_walk_recphp4</span><span class="keyword">(&amp;</span><span class="default">$val</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global </span><span class="default">$outarray</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) </span><span class="default">array_walk</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="string">'array_walk_recphp4'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$outarray</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$params </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$params </span><span class="keyword">as </span><span class="default">$subarr</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk_recphp4</span><span class="keyword">(</span><span class="default">$subarr</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$outarray</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
For testing:<br />
<br />
<span class="default">&lt;?php<br />
$arr1</span><span class="keyword">[][</span><span class="string">"foo1"</span><span class="keyword">] = </span><span class="string">"bar1"</span><span class="keyword">;<br />
</span><span class="default">$arr2</span><span class="keyword">[</span><span class="string">"foo2"</span><span class="keyword">] = </span><span class="string">"bar2"</span><span class="keyword">;<br />
</span><span class="default">$arr2</span><span class="keyword">[</span><span class="default">12</span><span class="keyword">] = </span><span class="string">"bar3"</span><span class="keyword">;<br />
</span><span class="default">$arr2</span><span class="keyword">[</span><span class="default">10</span><span class="keyword">][</span><span class="string">"foo4"</span><span class="keyword">] = </span><span class="string">"bar4"</span><span class="keyword">;<br />
</span><span class="default">$arr2</span><span class="keyword">[][</span><span class="string">"foo4"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">][</span><span class="string">"foo5"</span><span class="keyword">] = </span><span class="string">"bar5"</span><span class="keyword">;<br />
</span><span class="default">$arr3 </span><span class="keyword">= </span><span class="string">"nono"</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">array_mergedown</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">, </span><span class="default">$arr2</span><span class="keyword">, </span><span class="default">$arr3</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
returns:<br />
Array ( [foo1] =&gt; bar1 [foo2] =&gt; bar2 [12] =&gt; bar3 [foo4] =&gt; bar4 [foo5] =&gt; bar5 )<br />
<br />
I hope this helped someone :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.array-values.html">array_values</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.array-walk.html">array_walk</a></div>
 <div class="up"><a href="ref.array.html">Array Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
