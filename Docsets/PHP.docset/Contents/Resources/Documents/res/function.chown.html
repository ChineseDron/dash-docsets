<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Changes file owner</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.chmod.html">chmod</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.clearstatcache.html">clearstatcache</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.chown" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">chown</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">chown</span> &mdash; <span class="dc-title">Changes file owner</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.chown-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>chown</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$filename</tt></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$user</tt></span>
   )</div>

  <p class="para rdfs-comment">
   Attempts to change the owner of the file <i><tt class="parameter">filename</tt></i>
   to user <i><tt class="parameter">user</tt></i>. Only the superuser may change the
   owner of a file.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.chown-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">filename</tt></i></span>
     <dd>

      <p class="para">
       Path to the file.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">user</tt></i></span>
     <dd>

      <p class="para">
       A user name or number.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.chown-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <b><tt>TRUE</tt></b> on success or <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.chown-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-2146">
    <p><b>Example #1 Simple <span class="function"><b>chown()</b></span> usage</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//&nbsp;File&nbsp;name&nbsp;and&nbsp;username&nbsp;to&nbsp;use<br /></span><span style="color: #0000BB">$file_name</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"foo.php"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/home/sites/php.net/public_html/sandbox/"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$file_name&nbsp;</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$user_name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"root"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Set&nbsp;the&nbsp;user<br /></span><span style="color: #0000BB">chown</span><span style="color: #007700">(</span><span style="color: #0000BB">$path</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user_name</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Check&nbsp;the&nbsp;result<br /></span><span style="color: #0000BB">$stat&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stat</span><span style="color: #007700">(</span><span style="color: #0000BB">$path</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">posix_getpwuid</span><span style="color: #007700">(</span><span style="color: #0000BB">$stat</span><span style="color: #007700">[</span><span style="color: #DD0000">'uid'</span><span style="color: #007700">]));<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [name] =&gt; root
    [passwd] =&gt; x
    [uid] =&gt; 0
    [gid] =&gt; 0
    [gecos] =&gt; root
    [dir] =&gt; /root
    [shell] =&gt; /bin/bash
)
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.chown-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">This function will not work on
<a href="features.remote-files.html" class="link">remote files</a> as the file to
be examined must be accessible via the server&#039;s filesystem.</span></p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">When <a href="features.safe-mode.html" class="link">safe mode</a> is enabled, PHP checks whether
the files or directories being operated upon have the same UID (owner) as the
script that is being executed.</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.chown-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.chmod.html" class="function" rel="rdfs-seeAlso">chmod()</a> - Changes file mode</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="91599""></a>
  <div class="note">
   <strong class="user">rickard at 0x539 dot se</strong>
   <a href="#91599" class="date">18-Jun-2009 02:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For most modern Linux systems your apache user should not be run as root, and in order to change the ownership of a file or directory, you need to be root. To get around this problem you can use sudo, but be careful with what permissions you give. Here is an example which is working for me:<br />
<br />
www-data&nbsp; &nbsp; &nbsp; &nbsp; ALL = NOPASSWD: /bin/chown 1[1-9][0-9][0-9]\:1[1-9][0-9][0-9] /home/www/[a-zA-Z0-9]*<br />
<br />
This allows the apache server to change ownership of files in /home/www with name containing a-z, A-Z or numbers (note: no subdirectories). The only valid input of userid is a four digit numeric id, between 1100 and 1999. <br />
<br />
Hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80818""></a>
  <div class="note">
   <strong class="user">Mikevac at yahoo dot com</strong>
   <a href="#80818" class="date">01-Feb-2008 11:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've only tested this on Solaris 10 so your mileage may vary.<br />
<br />
To allow the apache daemon to change file ownership without being root, add the following line to /etc/system:<br />
<br />
set rstchown=0<br />
<br />
Reboot the server. <br />
<br />
There are security concerns doing this as this modification allows any user to change ownership of their files to anyone else.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60580""></a>
  <div class="note">
   <strong class="user">Tayfun Bilsel</strong>
   <a href="#60580" class="date">11-Jan-2006 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple usage of the chown:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$file_name</span><span class="keyword">= </span><span class="string">"test"</span><span class="keyword">;<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="string">"/var/www/html/test/" </span><span class="keyword">. </span><span class="default">$file_name </span><span class="keyword">;<br />
<br />
</span><span class="default">$user_name </span><span class="keyword">= </span><span class="string">"root"</span><span class="keyword">;<br />
<br />
</span><span class="default">chown</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$user_name</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53079""></a>
  <div class="note">
   <strong class="user">Jens Vieler</strong>
   <a href="#53079" class="date">23-May-2005 12:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for some reason i was searching for chown() with an "on this mashine"-unknown userid and found martijn's hint very interesting. the main problem is, that if the numerical uid is used within a variable, it is checked against the /etc/passwd and returns "unknown user". a little note:<br />
<br />
use intval(), not inval()! so all in all it is:<br />
<br />
&nbsp;&nbsp; chown($path_to_dir,intval($uidnumber));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40159""></a>
  <div class="note">
   <strong class="user">greg _at_ rhythmicdesign d.o.t com</strong>
   <a href="#40159" class="date">23-Feb-2004 04:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">recurse_chown_chgrp</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">, </span><span class="default">$gid</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">opendir </span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">) ;<br />
&nbsp;&nbsp;&nbsp; while((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$typepath </span><span class="keyword">= </span><span class="default">$mypath </span><span class="keyword">. </span><span class="string">"/" </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//print $typepath. " : " . filetype ($typepath). "&lt;BR&gt;" ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">filetype </span><span class="keyword">(</span><span class="default">$typepath</span><span class="keyword">) == </span><span class="string">'dir'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">recurse_chown_chgrp </span><span class="keyword">(</span><span class="default">$typepath</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">, </span><span class="default">$gid</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chown</span><span class="keyword">(</span><span class="default">$typepath</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chgrp</span><span class="keyword">(</span><span class="default">$typepath</span><span class="keyword">, </span><span class="default">$gid</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;}<br />
<br />
</span><span class="default">recurse_chown_chgrp </span><span class="keyword">(</span><span class="string">"uploads"</span><span class="keyword">, </span><span class="string">"unsider"</span><span class="keyword">, </span><span class="string">"unsider"</span><span class="keyword">) ;<br />
</span><span class="default">?&gt;<br />
</span><br />
for older versions.. unfortunately, it seems I do not have permission to perform these functions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36495""></a>
  <div class="note">
   <strong class="user">Richard Esplin</strong>
   <a href="#36495" class="date">11-Oct-2003 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As far as I can tell, PHP's built in functions will not do a recursive chown or chgrp. But it wouldn't be hard to write a function for this. Here is some starter code based on an example written by John Coggeshall which I found at <a href="http://www.coggeshall.org :" rel="nofollow" target="_blank">http://www.coggeshall.org :</a><br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">recurse_chown_chgrp</span><span class="keyword">(</span><span class="default">$path2dir</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">, </span><span class="default">$gid</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= new </span><span class="default">dir</span><span class="keyword">(</span><span class="default">$path2dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">()) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">path</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">recurse_chown_chgrp</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">path</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">, </span><span class="default">$gid</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chown</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chgrp</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$gid</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
I have not tested this code (but I think it will work) because for my current needs, a simple exec("chown -r $user.$group $path"); is sufficient. I would need this code if I were not in control of the contents of these variables because they can be dangerous on the command line.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33488""></a>
  <div class="note">
   <strong class="user">Klaus Zierer</strong>
   <a href="#33488" class="date">27-Jun-2003 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to chown a symlink, PHP will follow the symlink and change the target file.<br />
<br />
If you want to chown the symlink, you have to use shell_exec("/bin/chown user.group symlink");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33261""></a>
  <div class="note">
   <strong class="user">martijn at sigterm dot nl</strong>
   <a href="#33261" class="date">20-Jun-2003 07:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If chown is filled with a variable (&nbsp; chown ("myfile", $uid) the uid will be looked up through pwget_uid.<br />
<br />
So if you need to set a non existing uid use inval($uid).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="8646""></a>
  <div class="note">
   <strong class="user">njs+php at scifi dot squawk dot com</strong>
   <a href="#8646" class="date">21-Sep-2000 11:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you allow sudo execution for chmod by "nobody" (www, webdaemon, httpd, whatever user php is running under)in this manner, it had better be a system on which the owner is able to be root and no one else can run code, else your whole system is compromised.&nbsp; Someone could change the mode of /etc/passwd or the shadow password file.<br />
<br />
Other system commands (sudo mount) and so forth are similar.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.chmod.html">chmod</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.clearstatcache.html">clearstatcache</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
