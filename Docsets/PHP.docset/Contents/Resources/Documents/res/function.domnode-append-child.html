<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Adds a new child at the end of the children</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.domnode-add-namespace.html">DomNode::add_namespace</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.domnode-append-sibling.html">DomNode::append_sibling</a></div>
 <div class="up"><a href="ref.domxml.html">DOM XML (PHP 4) Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.domnode-append-child" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">DomNode::append_child</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.1.0)</p><p class="refpurpose"><span class="refname">DomNode::append_child</span> &mdash; <span class="dc-title">
   Adds a new child at the end of the children
  </span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.domnode-append-child-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="class.domnode.html" class="type DOMNode">DOMNode</a></span> <span class="methodname"><b>DOMNode::append_child</b></span>
    ( <span class="methodparam"><span class="type"><a href="class.domnode.html" class="type DOMNode">DOMNode</a></span> <tt class="parameter">$newnode</tt></span>
   )</div>

  <p class="para rdfs-comment">
   This functions appends a child to an existing list of children or creates
   a new list of children.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.domnode-append-child-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">newnode</tt></i></span>
     <dd>

      <p class="para">
       The node being appended. It can be created with e.g.
       <a href="function.domdocument-create-element.html" class="xref">DomDocument::create_element</a>,
       <a href="function.domdocument-create-text-node.html" class="xref">DomDocument::create_text_node</a> etc. or 
       simply by using any other node.
      </p>
      <blockquote class="note"><p><b class="note">Note</b>: 
       <p class="para">
        You can not append a <b class="classname">DOMAttribute</b> using this
        method. Use <a href="function.domelement-set-attribute.html" class="xref">DomElement::set_attribute</a> 
        instead.
       </p>
      </p></blockquote>
     </dd>

    </dt>

   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.domnode-append-child-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the appended node on success or <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>

 <div class="refsect1 changelog" id="refsect1-function.domnode-append-child-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">4.3.0</td>
       <td align="left">
        You are not allowed anymore to insert a node from another document.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">4.3.0</td>
       <td align="left">
        Prior to PHP 4.3.0, the new child is duplicated before being 
        appended.
        Therefore the new child is a completely new copy which can be 
        modified without changing the node which was passed to this function.
        If the node passed has children itself, they will be duplicated as 
        well, which makes it quite easy to duplicate large parts of an XML 
        document. The return value is the appended child. If you plan to do
        further modifications on the appended child you must use the returned 
        node.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">4.3.0 and 4.3.1</td>
       <td align="left">
        The new child <i><tt class="parameter">newnode</tt></i> is first unlinked from 
        its existing context, if it&#039;s already a child of DomNode. Therefore
        the <i><tt class="parameter">newnode</tt></i> is moved and not copies anymore.
        This is the behaviour according to the W3C specifications. If you 
        need the old behaviour, use <a href="function.domnode-clone-node.html" class="xref">DomNode::clone_node</a> before appending.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">4.3.2</td>
       <td align="left">
        The new child <i><tt class="parameter">newnode</tt></i> is first unlinked from 
        its existing context, if it&#039;s already in the tree. Same rules apply.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>
 
 <div class="refsect1 examples" id="refsect1-function.domnode-append-child-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   The following example adds a new element node to a fresh document and sets
   the attribute <i>align</i> to <i>left</i>.
  </p>
  <p class="para">
   <div class="example" id="example-4965">
    <p><b>Example #1 Adding a child</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$doc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">domxml_new_doc</span><span style="color: #007700">(</span><span style="color: #DD0000">"1.0"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$node&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">create_element</span><span style="color: #007700">(</span><span style="color: #DD0000">"para"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$newnode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">append_child</span><span style="color: #007700">(</span><span style="color: #0000BB">$node</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$newnode</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set_attribute</span><span style="color: #007700">(</span><span style="color: #DD0000">"align"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"left"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   The above example could also be written as the following:
  </p>
  <p class="para">
   <div class="example" id="example-4966">
    <p><b>Example #2 Adding a child</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$doc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">domxml_new_doc</span><span style="color: #007700">(</span><span style="color: #DD0000">"1.0"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$node&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">create_element</span><span style="color: #007700">(</span><span style="color: #DD0000">"para"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$node</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set_attribute</span><span style="color: #007700">(</span><span style="color: #DD0000">"align"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"left"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$newnode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">append_child</span><span style="color: #007700">(</span><span style="color: #0000BB">$node</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   A more complex example is the one below. It first searches for a certain
   element, duplicates it including its children and adds it as a sibling.
   Finally a new attribute is added to one of the children of the new sibling
   and the whole document is dumped.
  </p>
  <p class="para">
   <div class="example" id="example-4967">
    <p><b>Example #3 Adding a child</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include(</span><span style="color: #DD0000">"example.inc"</span><span style="color: #007700">);<br /><br />if&nbsp;(!</span><span style="color: #0000BB">$dom&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">domxml_open_mem</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Error&nbsp;while&nbsp;parsing&nbsp;the&nbsp;document\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #0000BB">$elements&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get_elements_by_tagname</span><span style="color: #007700">(</span><span style="color: #DD0000">"informaltable"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$elements</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$element&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$elements</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br /><br /></span><span style="color: #0000BB">$parent&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$element</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">parent_node</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$newnode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$parent</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">append_child</span><span style="color: #007700">(</span><span style="color: #0000BB">$element</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$children&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$newnode</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">children</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$attr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$children</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">set_attribute</span><span style="color: #007700">(</span><span style="color: #DD0000">"align"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"left"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$xmlfile&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">dump_mem</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlfile</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   The above example could also be done with
   <a href="function.domnode-insert-before.html" class="xref">DomNode::insert_before</a> instead of
   <a href="function.domnode-append-child.html" class="xref">DomNode::append_child</a>.
  </p>
 </div>

 <div class="refsect1 migration" id="refsect1-function.domnode-append-child-migration">
  <h3 class="title">Migrating to PHP 5</h3>
  <p class="para">
   You should use <a href="domnode.appendchild.html" class="xref">DOMNode::appendChild</a>.
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.domnode-append-child-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><a href="function.domnode-insert-before.html" class="xref">DomNode::insert_before</a></li>
    <li class="member"><a href="function.domnode-clone-node.html" class="xref">DomNode::clone_node</a></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="61803""></a>
  <div class="note">
   <strong class="user">andrew at transitionmedia dot co dot uk</strong>
   <a href="#61803" class="date">12-Feb-2006 07:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of version 4.3 PHP doesn't support Appending a child from another source document. If you are trying to&nbsp; import information from multiple sources into a final document [for transformation using XSL as an example] then you can have problems. This technique can be used to do it though.<br />
<br />
I am assuming you have two documents open, $xmldoc1 and $xmldoc2 and you have selected [via XPath or explicit searching] the nodes you want in each document. Thus $xmldoc1_appending_node is the node you would like to add $xmldoc2_importnode to.<br />
<br />
&lt;?<br />
<br />
// first we create a temporary node within the document we want to add to.<br />
$temp_importnode = $xmldoc1-&gt;create_element("import");<br />
<br />
// now we have a node that is in the right document context we can clone the one we want into this one.<br />
$temp_importnode = $xmldoc_importnode-&gt;clone_node(true);<br />
<br />
// by using true in the above call to clone_node() we copy all of the child nodes as well. Use false or nothing if you just want the containing node with no children.<br />
<br />
$xmldoc1_appending-&gt;append_child($importnode);<br />
<br />
?&gt;<br />
<br />
Now your document contains the new nodes imported from a different document.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26501""></a>
  <div class="note">
   <strong class="user">wackysalut at bourget dot cc</strong>
   <a href="#26501" class="date">01-Nov-2002 12:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful of the order you append childs. (PHP &lt;= 4.2)<br />
<br />
If you create let's say:<br />
<br />
$x_html = $x_doc-&gt;create_element('html');<br />
$x_head, $x_title, $x_meta, $x_link and $x_body in the same way.<br />
<br />
If you:<br />
<br />
$x_head-&gt;append_child($x_title);<br />
$x_head-&gt;append_child($x_meta);<br />
$x_head-&gt;append_child($x_link);<br />
<br />
$x_html-&gt;append_child($x_head);<br />
<br />
$x_body_backup = $x_html-&gt;append_child($x_body);<br />
<br />
/* here */<br />
<br />
$x_doc-&gt;append_child($x_html);<br />
<br />
If you now try to modify $x_body_backup.. it will no longer be able to modify the actualy XML tree, because you appended the HTML tree to the DomDocument.. and it has copied ALL the nodes at the end of the DomDocument, so the reference you now have in $x_body_backup is not valid anymore! If you had modified it where the /* here */ line is.. the $x_body_backup would still be valid.. but not after the $x_doc-&gt;append_child($x_html);<br />
<br />
What you can do is, reverse the order of your appendings.. so that you append the highest level node at the end.. so that your reference is still valid after, or wait till you have filled all of the nodes you wanted to add before you append it to your parent node.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.domnode-add-namespace.html">DomNode::add_namespace</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.domnode-append-sibling.html">DomNode::append_sibling</a></div>
 <div class="up"><a href="ref.domxml.html">DOM XML (PHP 4) Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
