<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Escape a string to be used as a shell argument</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ref.exec.html">Program execution Functions</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.escapeshellcmd.html">escapeshellcmd</a></div>
 <div class="up"><a href="ref.exec.html">Program execution Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.escapeshellarg" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">escapeshellarg</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.3, PHP 5)</p><p class="refpurpose"><span class="refname">escapeshellarg</span> &mdash; <span class="dc-title">Escape a string to be used as a shell argument</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.escapeshellarg-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><b>escapeshellarg</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$arg</tt></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>escapeshellarg()</b></span> adds single quotes around a string
   and quotes/escapes any existing single quotes allowing you to pass a
   string directly to a shell function and having it be treated as a single
   safe argument.  This function should be used to escape individual
   arguments to shell functions coming from user input.  The shell functions
   include <span class="function"><a href="function.exec.html" class="function">exec()</a></span>, <span class="function"><a href="function.system.html" class="function">system()</a></span> and the
   <a href="language.operators.execution.html" class="link">backtick operator</a>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.escapeshellarg-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">arg</tt></i></span>
     <dd>

      <p class="para">
       The argument that will be escaped.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.escapeshellarg-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The escaped string.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.escapeshellarg-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-3370">
    <p><b>Example #1 <span class="function"><b>escapeshellarg()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />system</span><span style="color: #007700">(</span><span style="color: #DD0000">'ls&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">escapeshellarg</span><span style="color: #007700">(</span><span style="color: #0000BB">$dir</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.escapeshellarg-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.escapeshellcmd.html" class="function" rel="rdfs-seeAlso">escapeshellcmd()</a> - Escape shell metacharacters</span></li>
    <li class="member"><span class="function"><a href="function.exec.html" class="function" rel="rdfs-seeAlso">exec()</a> - Execute an external program</span></li>
    <li class="member"><span class="function"><a href="function.popen.html" class="function" rel="rdfs-seeAlso">popen()</a> - Opens process file pointer</span></li>
    <li class="member"><span class="function"><a href="function.system.html" class="function" rel="rdfs-seeAlso">system()</a> - Execute an external program and display the output</span></li>
    <li class="member"><a href="language.operators.execution.html" class="link">backtick operator</a></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="99213""></a>
  <div class="note">
   <strong class="user">phil at philfreo dot com</strong>
   <a href="#99213" class="date">03-Aug-2010 03:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When escapeshellarg() was stripping my non-ASCII characters from a UTF-8 string, adding the following fixed the problem:<br />
<br />
<span class="default">&lt;?php<br />
setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">"en_US.UTF-8"</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94020""></a>
  <div class="note">
   <strong class="user">phpman at crustynet dot org dot uk</strong>
   <a href="#94020" class="date">12-Oct-2009 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The comment from 'rmays at castlecomm dot com' is incorrect: single quotes cannot be backslash-escaped inside a single-quoted string when constructing a shell argument. The output from this function is in fact correct. It drops out of the single-quoted string, includes a literal single quote with a backslash-escape, then resumes the single-quoted string. Observe:<br />
<br />
[shellarg.php]<br />
<span class="default">&lt;?php<br />
<br />
system</span><span class="keyword">(</span><span class="string">"echo ' single quote\'d '"</span><span class="keyword">);<br />
</span><span class="default">system</span><span class="keyword">(</span><span class="string">"echo ' single quote'\''d '"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
$ php shellarg.php <br />
sh: -c: line 0: unexpected EOF while looking for matching `''<br />
sh: -c: line 1: syntax error: unexpected end of file<br />
&nbsp;single quote'd</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92421""></a>
  <div class="note">
   <strong class="user">rmays at castlecomm dot com</strong>
   <a href="#92421" class="date">23-Jul-2009 10:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A warning on how this handles single quotes in a string<br />
<br />
Example:<br />
print escapeshellarg(" single quote'd ");<br />
<br />
Expected:<br />
' single quote\'d '<br />
<br />
Actual Result:<br />
' single quote'\''d '<br />
<br />
So if you pass a ' into this function, it will return an incorrectly escaped string!!!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91814""></a>
  <div class="note">
   <strong class="user">jrbeaure at uvm dot edu</strong>
   <a href="#91814" class="date">26-Jun-2009 06:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When running a string of LaTeX code containing hyphens through as an argument to pdflatex escaped using this command, it will result in failure.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88325""></a>
  <div class="note">
   <strong class="user">info at infosoporte dot com</strong>
   <a href="#88325" class="date">20-Jan-2009 04:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If escapeshellarg() function removes your accents (like ла, a with an 'accute') from the given string, ensure your LC_ALL variable is correct. If using it via web, you need to restart Apache or the corresponding web server after setting LC_ALL with a export LC_ALL=es_ES.utf8 (for example) from your shell.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84789""></a>
  <div class="note">
   <strong class="user">Audun</strong>
   <a href="#84789" class="date">30-Jul-2008 05:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The reason why % are replaced with space on windows is that it is impossible in cmd.exe to escape or quote them so that environment variables are not expanded.&nbsp; If for instance %path% is in your argument it will always be expanded, so the only safe thing to do is to replace % with something else.<br />
<br />
Alternatively, you could wipe the environment before making the call to exec(), but that has its side-effects.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82952""></a>
  <div class="note">
   <strong class="user">Cameron</strong>
   <a href="#82952" class="date">02-May-2008 11:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
in regards to the bug returning no string where it should return "" or '', just do <br />
<span class="default">&lt;?php<br />
shell_exec</span><span class="keyword">(</span><span class="string">"example "</span><span class="keyword">. ((</span><span class="default">$arg</span><span class="keyword">=</span><span class="default">escapeshellarg</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">))? </span><span class="default">$arg </span><span class="keyword">: </span><span class="string">"''"</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74815""></a>
  <div class="note">
   <strong class="user">egorinsk at gmail dot com</strong>
   <a href="#74815" class="date">28-Apr-2007 04:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under Windows, this function puts string into double-quotes, not single, and replaces %(percent sign) with a space, that's why it's impossible to pass a filename with percents in its name through this function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73920""></a>
  <div class="note">
   <strong class="user">php at atu dot cjb dot net</strong>
   <a href="#73920" class="date">15-Mar-2007 09:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reply to vosechu at roman-fleuve dot com: Even if it's two "'s or two ''s, this function wouldn't work the way it's supposed to (that is, returning nothing). However, most people do not put "" into their commands...<br />
<br />
When many commands are executed, the order of the parameters is of critical importance, especially with shell scripts where $1, $2, $3, etc. are commonly used without checking what is stored in them first.&nbsp; In such cases, having this function not return even an empty parameter will break things.<br />
<br />
As was mentioned earlier, putting two single quotes '' before the output of this function will remedy this issue, as the '' in itself will not add any characters to that command line parameter, but it will turn it into a placeholder for that parameter when the value is empty.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66430""></a>
  <div class="note">
   
   <a href="#66430" class="date">22-May-2006 05:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Most of the comments above have misunderstood this function. It does not need to escape characters such as '$' and '`' - it uses the fact that the shell does not treat any characters as special inside single quotes (except the single quote character itself). The correct way to use this function is to call it on a variable that is intended to be passed to a command-line program as a single argument to that program - you do not call it on command-line as a whole.<br />
<br />
The person above who comments that this function behaves badly if given the empty string as input is correct - this is a bug. It should indeed return two single quotes in this case.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58680""></a>
  <div class="note">
   <strong class="user">phpnet at lostreality dot org</strong>
   <a href="#58680" class="date">11-Nov-2005 08:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function does not escape $ it seems. This lets user embed shell variables such as $PATH into commands, which you may or may not want to allow.&nbsp; I'm using shell_exec() because I need the entire command as one string, and need access to the stdout data as one string as well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56408""></a>
  <div class="note">
   <strong class="user">ludvig dot ericson at gmail dot com</strong>
   <a href="#56408" class="date">01-Sep-2005 10:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems from my tests that escapeshellarg("`ls -al`") is _NOT_ escaped into \`ls -al\` as it should be.<br />
<br />
Anyway, a bash/sh environment does not seem to interprett ` inside of a singleqoute (').<br />
<br />
$ echo "`echo hello`"<br />
hello<br />
$ echo '`echo hello`'<br />
`echo hello`<br />
$ echo "\`echo hello\`"<br />
`echo hello`<br />
<br />
Just a tip.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52948""></a>
  <div class="note">
   
   <a href="#52948" class="date">18-May-2005 11:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
According to my test (PHP 4.3.10) there is no need to call escapeshellarg() on a filename that is being written to by proc_open, and probably others. E.g.<br />
<span class="default">&lt;?php<br />
$process </span><span class="keyword">= </span><span class="default">proc_open</span><span class="keyword">(</span><span class="string">"echo hi"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; array(</span><span class="string">"pipe"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; array(</span><span class="string">"file"</span><span class="keyword">, </span><span class="string">'filename with spaces'</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; array(</span><span class="string">"pipe"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$pipes</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>creates a file named:<br />
<br />
filename with spaces<br />
<br />
In fact,<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; 1 </span><span class="keyword">=&gt; array(</span><span class="string">"file"</span><span class="keyword">, </span><span class="default">escapeshellarg</span><span class="keyword">(</span><span class="string">'filename with spaces'</span><span class="keyword">)<br />
</span><span class="default">?&gt;<br />
</span>creates a file named:<br />
<br />
'filename with spaces'<br />
<br />
(quotes included in filename.) Maybe all the PHP functions that take a filename as a separate parameter work this way. I guess you just need to escape filenames when they are part of a single string command line such as with the backtick operator, system(), etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41819""></a>
  <div class="note">
   <strong class="user">antony lesuisse</strong>
   <a href="#41819" class="date">22-Apr-2004 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
NOTE: If you are using PHP &gt;= 4.2 you should use the pcntl_* (Process<br />
Control) functions instead of this hack.<br />
<br />
PHP, before version 4.2, didn't provide any execl(3)-like or<br />
execv(3)-like methods to invoke external programs, thus everything<br />
goes trough /bin/sh -c and we are forced to quote arguments.<br />
<br />
To make it worse escapeshellarg() behaves badly (IMHO) with an empty<br />
string:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"mime-construct --to "</span><span class="keyword">.</span><span class="default">escapeshellarg</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">).</span><span class="string">" --cc a@a.com"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The following function is a wrapper to system(), and it can be adapted<br />
to popen(),exec(),shell_exec():<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># system with perl? semantics<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">lib_system</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arg</span><span class="keyword">=</span><span class="default">func_get_args</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arg</span><span class="keyword">=</span><span class="default">$arg</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cmd</span><span class="keyword">=</span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$arg </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cmd</span><span class="keyword">.=</span><span class="string">" ''"</span><span class="keyword">.</span><span class="default">escapeshellarg</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">);;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">system</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># example1<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">lib_system</span><span class="keyword">(</span><span class="string">"mime-construct"</span><span class="keyword">,</span><span class="string">"--output"</span><span class="keyword">, </span><span class="string">"--to"</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">,</span><span class="string">"--string"</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># example2<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">lib_system</span><span class="keyword">(array(</span><span class="string">"mime-construct"</span><span class="keyword">,</span><span class="string">"--output"</span><span class="keyword">, </span><span class="string">"--to"</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">,</span><span class="string">"--string"</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40996""></a>
  <div class="note">
   <strong class="user">vosechu at roman-fleuve dot com</strong>
   <a href="#40996" class="date">25-Mar-2004 05:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If escapeshellarg() returned something on a null input it would probably break more programs than it helps. Even if it's two "'s or two ''s, this function wouldn't work the way it's supposed to (that is, returning nothing). <br />
<br />
However, most people do not put "" into their commands but I can see where it might be useful at the same time. <br />
Perhaps an option in the command that would return the type of null we want. I might want the null character to be returned, someone else might want '', and someone else might want nothing at all.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30709""></a>
  <div class="note">
   <strong class="user">php at floris dot nu</strong>
   <a href="#30709" class="date">26-Mar-2003 07:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i also thought the output was gonna be between 's because that's the way windows handles arguments with spaces in them. i think we have a unix &lt;&gt; windows misunderstanding here...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ref.exec.html">Program execution Functions</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.escapeshellcmd.html">escapeshellcmd</a></div>
 <div class="up"><a href="ref.exec.html">Program execution Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
