<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Gets time of last page modification</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.getenv.html">getenv</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.getmygid.html">getmygid</a></div>
 <div class="up"><a href="ref.info.html">PHP Options/Info Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.getlastmod" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">getlastmod</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">getlastmod</span> &mdash; <span class="dc-title">Gets time of last page modification</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.getlastmod-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><b>getlastmod</b></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para rdfs-comment">
   Gets the time of the last modification of the current page.
  </p>
  <p class="para">
   If you&#039;re interested in getting the last modification time
   of a different file, consider using <span class="function"><a href="function.filemtime.html" class="function">filemtime()</a></span>.
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.getlastmod-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the time of the last modification of the current
   page. The value returned is a Unix timestamp, suitable for
   feeding to <span class="function"><a href="function.date.html" class="function">date()</a></span>. Returns <b><tt>FALSE</tt></b> on error.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.getlastmod-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-462">
    <p><b>Example #1 <span class="function"><b>getlastmod()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;outputs&nbsp;e.g.&nbsp;'Last&nbsp;modified:&nbsp;March&nbsp;04&nbsp;1998&nbsp;20:43:59.'<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Last&nbsp;modified:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">date&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"F&nbsp;d&nbsp;Y&nbsp;H:i:s."</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">getlastmod</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.getlastmod-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.date.html" class="function" rel="rdfs-seeAlso">date()</a> - Format a local time/date</span></li>
    <li class="member"><span class="function"><a href="function.getmyuid.html" class="function" rel="rdfs-seeAlso">getmyuid()</a> - Gets PHP script owner's UID</span></li>
    <li class="member"><span class="function"><a href="function.getmygid.html" class="function" rel="rdfs-seeAlso">getmygid()</a> - Get PHP script owner's GID</span></li>
    <li class="member"><span class="function"><a href="function.get-current-user.html" class="function" rel="rdfs-seeAlso">get_current_user()</a> - Gets the name of the owner of the current PHP script</span></li>
    <li class="member"><span class="function"><a href="function.getmyinode.html" class="function" rel="rdfs-seeAlso">getmyinode()</a> - Gets the inode of the current script</span></li>
    <li class="member"><span class="function"><a href="function.getmypid.html" class="function" rel="rdfs-seeAlso">getmypid()</a> - Gets PHP's process ID</span></li>
    <li class="member"><span class="function"><a href="function.filemtime.html" class="function" rel="rdfs-seeAlso">filemtime()</a> - Gets file modification time</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="105945""></a>
  <div class="note">
   <strong class="user">erik dot stetina at gmail dot com</strong>
   <a href="#105945" class="date">27-Sep-2011 03:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function for displaying last modification time accross more direcotries. e.g. to display last modification date in "about" section of your web page<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">array_prefix_values</span><span class="keyword">(</span><span class="default">$prefix</span><span class="keyword">, </span><span class="default">$array</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$callback </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$s'</span><span class="keyword">,</span><span class="string">'return "'</span><span class="keyword">.</span><span class="default">$prefix</span><span class="keyword">.</span><span class="string">'".$s;'</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">array_map</span><span class="keyword">(</span><span class="default">$callback</span><span class="keyword">,</span><span class="default">$array</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">get_last_update</span><span class="keyword">()<br />
{<br />
&nbsp; if ( </span><span class="default">func_num_args</span><span class="keyword">() &lt; </span><span class="default">1 </span><span class="keyword">) return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();<br />
&nbsp; </span><span class="default">$files </span><span class="keyword">= array();<br />
&nbsp; foreach ( </span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$dir </span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$subfiles </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$subfiles </span><span class="keyword">= </span><span class="default">array_prefix_values</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">$subfiles</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$subfiles </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">$subfiles</span><span class="keyword">,</span><span class="string">"is_file"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">,</span><span class="default">$subfiles</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$maxtimestamp </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$maxfilename </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp; foreach ( </span><span class="default">$files </span><span class="keyword">as </span><span class="default">$file </span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$timestamp </span><span class="keyword">= </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$timestamp </span><span class="keyword">&gt; </span><span class="default">$maxtimestamp </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$maxtimestamp </span><span class="keyword">= </span><span class="default">$timestamp</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$maxfilename </span><span class="keyword">= </span><span class="default">$file</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Ymd"</span><span class="keyword">,</span><span class="default">$maxtimestamp</span><span class="keyword">).</span><span class="string">" (</span><span class="default">$maxfilename</span><span class="string">)"</span><span class="keyword">;<br />
}<br />
<br />
print </span><span class="string">"last update: "</span><span class="keyword">.</span><span class="default">get_last_update</span><span class="keyword">(</span><span class="string">"./lib/"</span><span class="keyword">, </span><span class="string">"./css/"</span><span class="keyword">, </span><span class="string">"./lang/"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
OUTPUT:<br />
last update: 20110927 (./lang/sk.php)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96393""></a>
  <div class="note">
   <strong class="user">Ant P.</strong>
   <a href="#96393" class="date">24-Feb-2010 10:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use register_shutdown_function() on certain SAPIs, various filesystem-related things inside the shutdown function might do unexpected things, one of which being this function can return false.<br />
<br />
On the other hand getlastmod() apparently caches the return value, so if you use it at least once in normal code it should work for the remainder of the request.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46613""></a>
  <div class="note">
   <strong class="user">rwruck</strong>
   <a href="#46613" class="date">17-Oct-2004 06:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
DO NOT use this function unless you are absolutely sure both your Apache and PHP have been compiled with the same value for -DFILE_OFFSET_BITS.<br />
<br />
If not, this function will return the access time (or maybe even garbage) instead of the modification time due do Apache and PHP using different versions of the stat structure.<br />
<br />
This is true regardless of Apache and PHP version.<br />
<br />
To be on the safe side, always use the workaround already posted below:<br />
filemtime($_SERVER['SCRIPT_FILENAME'])</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42506""></a>
  <div class="note">
   
   <a href="#42506" class="date">19-May-2004 04:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Setting the 'Last-Modified' header:<br />
<span class="default">&lt;?php<br />
setlocale</span><span class="keyword">(</span><span class="default">LC_TIME</span><span class="keyword">, </span><span class="string">"C"</span><span class="keyword">);<br />
</span><span class="default">$ft </span><span class="keyword">= </span><span class="default">filemtime </span><span class="keyword">(</span><span class="string">'referencefile'</span><span class="keyword">);<br />
</span><span class="default">$localt </span><span class="keyword">= </span><span class="default">mktime </span><span class="keyword">();<br />
</span><span class="default">$gmtt </span><span class="keyword">= </span><span class="default">gmmktime </span><span class="keyword">();<br />
</span><span class="default">$ft </span><span class="keyword">= </span><span class="default">$ft </span><span class="keyword">- </span><span class="default">$gmtt </span><span class="keyword">+ </span><span class="default">$localt</span><span class="keyword">;<br />
</span><span class="default">$modified </span><span class="keyword">= </span><span class="default">strftime </span><span class="keyword">(</span><span class="string">"%a, %d %b %Y %T GMT"</span><span class="keyword">, </span><span class="default">$ft</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30514""></a>
  <div class="note">
   <strong class="user">timeflys at users dot sourceforget dot net</strong>
   <a href="#30514" class="date">20-Mar-2003 01:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found issues using getlastmod() to test whether or not I was successful in setting the Last Modified date in the header. The code below shows the same Last Modified date before and after I set the Last-Modified header.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//True modified date<br />
</span><span class="default">$modified </span><span class="keyword">= </span><span class="default">date </span><span class="keyword">(</span><span class="string">"F d Y H:i:s."</span><span class="keyword">, </span><span class="default">getlastmod</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="comment">//artificial modified date - sent to header<br />
</span><span class="default">$last_modified </span><span class="keyword">= </span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">'D, d M Y H:i:s T'</span><span class="keyword">, (</span><span class="default">time</span><span class="keyword">() - </span><span class="default">43200</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; <br />
</span><span class="comment">//caching prevention<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Last-Modified: </span><span class="default">$last_modified</span><span class="string"> GMT"</span><span class="keyword">);<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Cache-Control: no-store, no-cache, must-revalidate"</span><span class="keyword">);&nbsp; </span><span class="comment">// HTTP/1.1<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Cache-Control: post-check=0, pre-check=0"</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Pragma: no-cache"</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// HTTP/1.0<br />
<br />
</span><span class="default">$getlast_modified </span><span class="keyword">= </span><span class="default">date </span><span class="keyword">(</span><span class="string">"F d Y H:i:s."</span><span class="keyword">, </span><span class="default">getlastmod</span><span class="keyword">());<br />
<br />
print </span><span class="string">"True modified date(Before): </span><span class="default">$modified</span><span class="string"> &lt;p /&gt; Date sent to header(After): </span><span class="default">$getlast_modified</span><span class="string">"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
I then used the PEAR, HTTP_Request class which worked, the Last-Modified date updates everytime it is requested, the desired effect.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">require </span><span class="string">'HTTP/Request.php'</span><span class="keyword">;<br />
</span><span class="default">$r </span><span class="keyword">= new </span><span class="default">HTTP_Request</span><span class="keyword">(</span><span class="string">'<a href="http://www.sample.com/page.php" rel="nofollow" target="_blank">http://www.sample.com/page.php</a>'</span><span class="keyword">);<br />
</span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">sendRequest</span><span class="keyword">();<br />
</span><span class="default">$response_headers </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">getResponseHeader</span><span class="keyword">();<br />
print </span><span class="default">$response_headers</span><span class="keyword">[</span><span class="string">"last-modified"</span><span class="keyword">];<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26916""></a>
  <div class="note">
   <strong class="user">Richard Anderson(r85anderson at yahoo dot com)</strong>
   <a href="#26916" class="date">17-Nov-2002 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for includes....<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//include.php<br />
</span><span class="default">$file </span><span class="keyword">= </span><span class="default">__FILE__</span><span class="keyword">;<br />
</span><span class="default">$lastmod </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"M d, Y @ h:ia"</span><span class="keyword">, </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
</span><span class="comment">//footer.php<br />
</span><span class="keyword">echo(</span><span class="string">"page last modified: </span><span class="default">$lastmod</span><span class="string">"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
[EDIT by danbrown AT php DOT net: Remember that $lastmod must not be a variable that is set or unset anywhere else in the script, or it will not work as expected when printed from the footer.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25741""></a>
  <div class="note">
   <strong class="user">kworthington ([no@spam)] linuxmaildotorg</strong>
   <a href="#25741" class="date">03-Oct-2002 03:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was just informed of a workaround for the Apache 2.0 issue, do:<br />
echo "Last modified: " . date("D F d Y h:i:s A", filemtime($_SERVER["SCRIPT_FILENAME"]));<br />
Thanks to: Edward S. Marshall</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.getenv.html">getenv</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.getmygid.html">getmygid</a></div>
 <div class="up"><a href="ref.info.html">PHP Options/Info Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
