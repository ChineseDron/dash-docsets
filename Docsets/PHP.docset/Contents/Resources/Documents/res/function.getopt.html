<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Gets options from the command line argument list</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.getmyuid.html">getmyuid</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.getrusage.html">getrusage</a></div>
 <div class="up"><a href="ref.info.html">PHP Options/Info Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.getopt" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">getopt</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5)</p><p class="refpurpose"><span class="refname">getopt</span> &mdash; <span class="dc-title">Gets options from the command line argument list</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.getopt-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><b>getopt</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$options</tt></span>
   [, <span class="methodparam"><span class="type">array</span> <tt class="parameter">$longopts</tt></span>
  ] )</div>

  <p class="para rdfs-comment">
   Parses options passed to the script.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.getopt-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">options</tt></i></span>
     <dd>

      <span class="simpara">
       Each character in this string will be used as option characters and
       matched against options passed to the script starting with a single
       hyphen (<i>-</i>).
      </span>
      <span class="simpara">
       For example, an option string <i>&quot;x&quot;</i> recognizes an
       option <i>-x</i>.
      </span>
      <span class="simpara">
       Only a-z, A-Z and 0-9 are allowed.
      </span>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">longopts</tt></i></span>
     <dd>

      <span class="simpara">
       An array of options. Each element in this array will be used as option
       strings and matched against options passed to the script starting with
       two hyphens (<i>--</i>).
      </span>
      <span class="simpara">
       For example, an longopts element <i>&quot;opt&quot;</i> recognizes an
       option <i>--opt</i>.
      </span>
     </dd>

    </dt>

   </dl>

  </p>
  <p class="para">
   The <i><tt class="parameter">options</tt></i> parameter may contain the following
   elements:
   <ul class="simplelist">
    <li class="member">Individual characters (do not accept values)</li>
    <li class="member">Characters followed by a colon (parameter requires value)</li>
    <li class="member">Characters followed by two colons (optional value)</li>
   </ul>
   Option values are the first argument after the string. It does not matter
   if a value has leading white space or not.
   <blockquote class="note"><p><b class="note">Note</b>: 
    <span class="simpara">
     Optional values do not accept <i>&quot; &quot;</i> (space) as a separator.
    </span>
   </p></blockquote>
  </p>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    The format for the <i><tt class="parameter">options</tt></i> and
    <i><tt class="parameter">longopts</tt></i> is almost the same, the only difference is
    that <i><tt class="parameter">longopts</tt></i> takes an array of options (where each
    element is the option) where as <i><tt class="parameter">options</tt></i> takes a
    string (where each character is the option).
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.getopt-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   This function will return an array of option / argument pairs or <b><tt>FALSE</tt></b> on
   failure.
  </p>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    The parsing of options will end at the first non-option found, anything
    that follows is discarded.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.getopt-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.3.0</td>
       <td align="left">
        Added support for &quot;=&quot; as argument/value separator.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">5.3.0</td>
       <td align="left">
        Added support for optional values (specified with &quot;::&quot;).
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">5.3.0</td>
       <td align="left">
        Parameter <i><tt class="parameter">longopts</tt></i> is available on all systems.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">5.3.0</td>
       <td align="left">
        This function is no longer system dependent, and now works on Windows, too.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.getopt-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="getopt.examples-1">
    <p><b>Example #1 <span class="function"><b>getopt()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$options&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getopt</span><span style="color: #007700">(</span><span style="color: #DD0000">"f:hp:"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$options</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     Running the above script with <i>php script.php -fvalue -h</i>
     will output:
    </p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(2) {
  [&quot;f&quot;]=&gt;
  string(5) &quot;value&quot;
  [&quot;h&quot;]=&gt;
  bool(false)
}
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="getopt.examples-2">
    <p><b>Example #2 <span class="function"><b>getopt()</b></span> example#2</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$shortopts&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$shortopts&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"f:"</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Required&nbsp;value<br /></span><span style="color: #0000BB">$shortopts&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"v::"</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;Optional&nbsp;value<br /></span><span style="color: #0000BB">$shortopts&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"abc"</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;These&nbsp;options&nbsp;do&nbsp;not&nbsp;accept&nbsp;values<br /><br /></span><span style="color: #0000BB">$longopts&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"required:"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Required&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"optional::"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Optional&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"option"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;No&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"opt"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;No&nbsp;value<br /></span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$shortopts</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$longopts</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$options</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     Running the above script with <i>php script.php -f &quot;value for f&quot; -v
     -a --required value --optional=&quot;optional value&quot; --option</i>
     will output:
    </p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(6) {
  [&quot;f&quot;]=&gt;
  string(11) &quot;value for f&quot;
  [&quot;v&quot;]=&gt;
  bool(false)
  [&quot;a&quot;]=&gt;
  bool(false)
  [&quot;required&quot;]=&gt;
  string(5) &quot;value&quot;
  [&quot;optional&quot;]=&gt;
  string(14) &quot;optional value&quot;
  [&quot;option&quot;]=&gt;
  bool(false)
}
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="getopt.examples-3">
    <p><b>Example #3 <span class="function"><b>getopt()</b></span> example#3</b></p>
    <div class="example-contents"><p>Passing multiple options as one</p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$options&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getopt</span><span style="color: #007700">(</span><span style="color: #DD0000">"abc"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$options</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     Running the above script with <i>php script.php -aaac</i>
     will output:
    </p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(2) {
  [&quot;a&quot;]=&gt;
  array(3) {
    [0]=&gt;
    bool(false)
    [1]=&gt;
    bool(false)
    [2]=&gt;
    bool(false)
  }
  [&quot;c&quot;]=&gt;
  bool(false)
}
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.getopt-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><a href="reserved.variables.argv.html" class="link"><var class="varname"><var class="varname"><a href="reserved.variables.argv.html" class="classname">$argv</a></var></var></a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="102211""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#102211" class="date">02-Feb-2011 04:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
getopt() only returns the options specified if they were listed in the options.<br />
<br />
So you cant make a switch() use default: to complain of an unknown option. :(</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100573""></a>
  <div class="note">
   <strong class="user">mpartap at gmx dot net</strong>
   <a href="#100573" class="date">24-Oct-2010 01:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's another way of removing options found by getopt() from the argv[] array. It handles the different kind of parameters without eating chunks that do not belong to an --option. (-nr foo param1 param2 foo)<br />
<span class="default">&lt;?php<br />
$parameters </span><span class="keyword">= array(<br />
&nbsp; </span><span class="string">'n' </span><span class="keyword">=&gt; </span><span class="string">'noparam'</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'r:' </span><span class="keyword">=&gt; </span><span class="string">'required:'</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'o::' </span><span class="keyword">=&gt; </span><span class="string">'optional::'</span><span class="keyword">,<br />
);<br />
<br />
</span><span class="default">$options </span><span class="keyword">= </span><span class="default">getopt</span><span class="keyword">(</span><span class="default">implode</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$parameters</span><span class="keyword">)), </span><span class="default">$parameters</span><span class="keyword">);<br />
</span><span class="default">$pruneargv </span><span class="keyword">= array();<br />
foreach (</span><span class="default">$options </span><span class="keyword">as </span><span class="default">$option </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp; foreach (</span><span class="default">$argv </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$chunk</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regex </span><span class="keyword">= </span><span class="string">'/^'</span><span class="keyword">. (isset(</span><span class="default">$option</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) ? </span><span class="string">'--' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">) . </span><span class="default">$option </span><span class="keyword">. </span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$chunk </span><span class="keyword">== </span><span class="default">$value </span><span class="keyword">&amp;&amp; </span><span class="default">$argv</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] == </span><span class="string">'-' </span><span class="keyword">|| </span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">, </span><span class="default">$chunk</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$pruneargv</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
while (</span><span class="default">$key </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$pruneargv</span><span class="keyword">)) unset(</span><span class="default">$argv</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97787""></a>
  <div class="note">
   <strong class="user">geoff at gosquared dot com</strong>
   <a href="#97787" class="date">08-May-2010 05:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems under PHP 5.3.2, getopt() makes a script fail to load if called via HTTP without any conditions. You'll need something like if(isset($_SERVER['argc'])) $args = getopt(); to prevent that.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89588""></a>
  <div class="note">
   <strong class="user">m at ttcarter dot com</strong>
   <a href="#89588" class="date">15-Mar-2009 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a library some time ago to counter some of the missing features of the rather limited 'getopt' function. The library as well documentation can be found on my website at <a href="http://hash-bang.net/2008/12/missing-php-functions-getopts/" rel="nofollow" target="_blank">http://hash-bang.net/2008/12/missing-php-functions-getopts/</a><br />
<br />
It provides functionality for long switches (e.g. '--delete'), incrementing switches (e.g. '-v -v -v' or '-vvv' for very, very verbose), long values (e.g. '--exclude this.file') and lots more.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85140""></a>
  <div class="note">
   <strong class="user">suichengw at gmail dot com</strong>
   <a href="#85140" class="date">16-Aug-2008 10:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I really need long options but it's not supported in 5.2.6 on my Solaris box so I wrote an _getopt() to simulate getopt().<br />
<br />
An example<br />
<br />
======== a.php ========<br />
#!/usr/local/bin/php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include </span><span class="string">"getopt.inc"</span><span class="keyword">;<br />
<br />
</span><span class="default">$shortopts&nbsp; </span><span class="keyword">= </span><span class="string">"f:v::abc:hp"</span><span class="keyword">;&nbsp; <br />
<br />
</span><span class="default">$longopts&nbsp; </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"required:"</span><span class="keyword">,&nbsp; &nbsp;&nbsp; </span><span class="comment">// Required value<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"optional::"</span><span class="keyword">,&nbsp; &nbsp; </span><span class="comment">// Optional value<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"option"</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// No value<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"opt"</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// No value<br />
</span><span class="keyword">);<br />
<br />
</span><span class="default">$options </span><span class="keyword">= </span><span class="default">_getopt</span><span class="keyword">( </span><span class="default">$shortopts</span><span class="keyword">, </span><span class="default">$longopts</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>====== end of a.php ======<br />
<br />
then run the file a.php,<br />
<br />
# ./a.php -f "test 2" -ab --required "test 1" --optional="test 3" --option -v "test 4" -k<br />
array(7) {<br />
&nbsp; ["f"]=&gt;<br />
&nbsp; string(6) "test 2"<br />
&nbsp; ["a"]=&gt;<br />
&nbsp; bool(false)<br />
&nbsp; ["b"]=&gt;<br />
&nbsp; bool(false)<br />
&nbsp; ["required"]=&gt;<br />
&nbsp; string(6) "test 1"<br />
&nbsp; ["optional"]=&gt;<br />
&nbsp; string(6) "test 3"<br />
&nbsp; ["option"]=&gt;<br />
&nbsp; bool(false)<br />
&nbsp; ["v"]=&gt;<br />
&nbsp; string(6) "test 4"<br />
}<br />
<br />
Source code is a bit longer and not allowed by this site. Please go to my page <a href="http://www.ntu.beautifulworldco.com/weblog/?p=526 for it." rel="nofollow" target="_blank">http://www.ntu.beautifulworldco.com/weblog/?p=526 for it.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83414""></a>
  <div class="note">
   <strong class="user">mbirth at webwriters dot de</strong>
   <a href="#83414" class="date">24-May-2008 01:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After getopt() of PHP5.3.0 (on Windows) ignored some parameters if there was a syntactical problem, I decided to code my own generic parameter parser.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Parses $GLOBALS['argv'] for parameters and assigns them to an array.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * Supports:<br />
&nbsp;&nbsp; &nbsp; * -e<br />
&nbsp;&nbsp; &nbsp; * -e &lt;value&gt;<br />
&nbsp;&nbsp; &nbsp; * --long-param<br />
&nbsp;&nbsp; &nbsp; * --long-param=&lt;value&gt;<br />
&nbsp;&nbsp; &nbsp; * --long-param &lt;value&gt;<br />
&nbsp;&nbsp; &nbsp; * &lt;value&gt;<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param array $noopt List of parameters without values<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">parseParameters</span><span class="keyword">(</span><span class="default">$noopt </span><span class="keyword">= array()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$params </span><span class="keyword">= </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// could use getopt() here (since PHP 5.3.0), but it doesn't work relyingly<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (list(</span><span class="default">$tmp</span><span class="keyword">, </span><span class="default">$p</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$p</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">'-'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pname </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$pname</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">'-'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// long-opt (--&lt;param&gt;)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pname </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$pname</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">, </span><span class="string">'='</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// value specified inline (--&lt;param&gt;=&lt;value&gt;)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">list(</span><span class="default">$pname</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// check if next parameter is a descriptor or a value<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nextparm </span><span class="keyword">= </span><span class="default">current</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$pname</span><span class="keyword">, </span><span class="default">$noopt</span><span class="keyword">) &amp;&amp; </span><span class="default">$value </span><span class="keyword">=== </span><span class="default">true </span><span class="keyword">&amp;&amp; </span><span class="default">$nextparm </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">&amp;&amp; </span><span class="default">$nextparm</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} != </span><span class="string">'-'</span><span class="keyword">) list(</span><span class="default">$tmp</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$pname</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// param doesn't belong to any option<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">$p</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
A call like: php.exe -f test.php -- alfons -a 1 -b2 -c --d 2 --e=3=4 --f "alber t" hans wurst<br />
<br />
and an in-program call parseParameters(array('f')); would yield in a resulting array:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; alfons<br />
&nbsp;&nbsp;&nbsp; [a] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [b2] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [c] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [d] =&gt; 2<br />
&nbsp;&nbsp;&nbsp; [e] =&gt; 3=4<br />
&nbsp;&nbsp;&nbsp; [f] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; alber t<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; hans<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; wurst<br />
)<br />
<br />
As you can see, values without an identifier are stored with numeric indexes. Existing identifiers without values get "true".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82793""></a>
  <div class="note">
   <strong class="user">uberlinuxguy at tulg dot org</strong>
   <a href="#82793" class="date">25-Apr-2008 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One thing of important note would be that getopt() actually respects the '--' option to end an option list.&nbsp; Thus given the code:<br />
<br />
test.php:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $options </span><span class="keyword">= </span><span class="default">getopt</span><span class="keyword">(</span><span class="string">"m:g:h:"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"There was a problem reading in the options.\n\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit(</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$errors </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
And running:<br />
<br />
# ./test.php ./run_vfs&nbsp; -h test1 -g test2 -m test3 -- this is a test -m green<br />
<br />
Will return: <br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [h] =&gt; test1<br />
&nbsp;&nbsp;&nbsp; [g] =&gt; test2<br />
&nbsp;&nbsp;&nbsp; [m] =&gt; test3<br />
)<br />
<br />
Whereas running:<br />
# /test.php ./run_vfs&nbsp; -h test1 -g test2 -m test3 this is a test -m green<br />
<br />
Will return:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [h] =&gt; test1<br />
&nbsp;&nbsp;&nbsp; [g] =&gt; test2<br />
&nbsp;&nbsp;&nbsp; [m] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; test3<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; green<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79286""></a>
  <div class="note">
   <strong class="user">Francois Hill</strong>
   <a href="#79286" class="date">19-Nov-2007 12:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Although very interesting, koenbollen at gnospamail dot com's update of the argv array fails when option values follow the option with no space :<br />
Indeed <br />
&nbsp;&nbsp;&nbsp; php MyScript.php5 -t5 <br />
and<br />
&nbsp;&nbsp;&nbsp; php MyScript.php5 -t 5<br />
with $options="t:" are treated as the same by getopt.<br />
<br />
This upgraded function should take care of it :<br />
<br />
File : shift_test.php5<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">shift</span><span class="keyword">(</span><span class="default">$options_array</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$options_array </span><span class="keyword">as </span><span class="default">$o </span><span class="keyword">=&gt; </span><span class="default">$a </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Look for all occurrences of option in argv and remove if found :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // ----------------------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Look for occurrences of -o (simple option with no value) or -o&lt;val&gt; (no space in between):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">while(</span><span class="default">$k</span><span class="keyword">=</span><span class="default">array_search</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">$o</span><span class="keyword">.</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; </span><span class="comment">// If found remove from argv:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$k</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Look for remaining occurrences of -o &lt;val&gt; (space in between):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">while(</span><span class="default">$k</span><span class="keyword">=</span><span class="default">array_search</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">$o</span><span class="keyword">,</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; </span><span class="comment">// If found remove both option and value from argv:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$k</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; unset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][</span><span class="default">$k</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Reindex :<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">]=</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$argv</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$options_array</span><span class="keyword">=</span><span class="default">getopt</span><span class="keyword">(</span><span class="string">'t:h'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">shift</span><span class="keyword">(</span><span class="default">$options_array</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$argv</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
&gt;php shift_test.php5 -h -t4 param1 param2<br />
will ouptut :<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; test.php5<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; -h<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; -t4<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; param1<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; param2<br />
)<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; test.php5<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; param1<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; param2<br />
)<br />
<br />
&gt;php shift_test.php5 -h -t 4 param1 param2<br />
will ouptut :<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; test.php5<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; -h<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; -t<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; 4<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; param1<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; param2<br />
)<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; test.php5<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; param1<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; param2<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79047""></a>
  <div class="note">
   <strong class="user">Damien B.</strong>
   <a href="#79047" class="date">07-Nov-2007 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is how I handle arguments with getopt: I use switch within a foreach at the beginning of a program.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$opts </span><span class="keyword">= </span><span class="default">getopt</span><span class="keyword">(</span><span class="string">'hs:'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Handle command line arguments<br />
</span><span class="keyword">foreach (</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">) as </span><span class="default">$opt</span><span class="keyword">) switch (</span><span class="default">$opt</span><span class="keyword">) {<br />
&nbsp; case </span><span class="string">'s'</span><span class="keyword">:<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Do something with s parameter<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$something </span><span class="keyword">= </span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'s'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; break;<br />
<br />
&nbsp; case </span><span class="string">'h'</span><span class="keyword">:<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_help_message</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; exit(</span><span class="default">1</span><span class="keyword">);<br />
}<br />
<br />
print </span><span class="string">"</span><span class="default">$something</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74689""></a>
  <div class="note">
   <strong class="user">Gu1ll4um3r0m41n at nospam dot xx</strong>
   <a href="#74689" class="date">23-Apr-2007 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getopt_</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">, </span><span class="default">$argv</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$opts_array </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="default">$opts</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$opts_array </span><span class="keyword">as </span><span class="default">$opt</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">array_search</span><span class="keyword">(</span><span class="default">$opt</span><span class="keyword">, </span><span class="default">$argv</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$key </span><span class="keyword">&amp;&amp; !</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$argv</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">], </span><span class="default">$opts_array</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$opt</span><span class="keyword">] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$argv</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } elseif(</span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$opt</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">getopt</span><span class="keyword">(</span><span class="string">'-h:-o:--help'</span><span class="keyword">, </span><span class="default">$argv</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74190""></a>
  <div class="note">
   <strong class="user">koenbollen at gnospamail dot com</strong>
   <a href="#74190" class="date">29-Mar-2007 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After you use the getopt function you can use the following script to update the $argv array:<br />
<span class="default">&lt;?php<br />
&nbsp; $options </span><span class="keyword">= </span><span class="string">"c:ho:s:t:uvV"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$opts </span><span class="keyword">= </span><span class="default">getopt</span><span class="keyword">( </span><span class="default">$options </span><span class="keyword">);<br />
&nbsp; foreach( </span><span class="default">$opts </span><span class="keyword">as </span><span class="default">$o </span><span class="keyword">=&gt; </span><span class="default">$a </span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; while( </span><span class="default">$k </span><span class="keyword">= </span><span class="default">array_search</span><span class="keyword">( </span><span class="string">"-" </span><span class="keyword">. </span><span class="default">$o</span><span class="keyword">, </span><span class="default">$argv </span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if( </span><span class="default">$k </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset( </span><span class="default">$argv</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] );<br />
&nbsp;&nbsp; &nbsp;&nbsp; if( </span><span class="default">preg_match</span><span class="keyword">( </span><span class="string">"/^.*"</span><span class="keyword">.</span><span class="default">$o</span><span class="keyword">.</span><span class="string">":.*$/i"</span><span class="keyword">, </span><span class="default">$options </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset( </span><span class="default">$argv</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">] );<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$argv </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">( </span><span class="default">$argv </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Note: I used the array_merge function to reindex the array's keys.<br />
<br />
Cheers, Koen Bollen</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72407""></a>
  <div class="note">
   
   <a href="#72407" class="date">17-Jan-2007 11:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About getopt(String):<br />
&nbsp;Parses the command-line arguments into an associative array, using the function's String parameter to specify arguments and options, thus:<br />
* arguments are specified as any letter followed by a colon, e.g. "h:".<br />
* arguments are returned as "h" =&gt; "value".<br />
* options are specified as any letter not followed by a colon, e.g. "r".<br />
* options are returned as "r" =&gt; (boolean) false.<br />
<br />
Also note that:<br />
1) Options or arguments not passed in the command-line parameters are not set in the returned associative array.<br />
2) Options or arguments present in the command-line arguments multiple times are returned as an enumerated array within the returned associative array.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70717""></a>
  <div class="note">
   <strong class="user">yarco dot w at gmail dot com</strong>
   <a href="#70717" class="date">24-Oct-2006 07:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You cant use this function twice or more.<br />
<br />
For example:<br />
<span class="default">&lt;?php<br />
print_r</span><span class="keyword">(</span><span class="default">getopt</span><span class="keyword">(</span><span class="string">'a:b:c:'</span><span class="keyword">));<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">getopt</span><span class="keyword">(</span><span class="string">'d:e:f:'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
You would be confused by the result.<br />
[yarco@localhost ~]$ php test3.php -a love -b love -d love<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [a] =&gt; love<br />
&nbsp;&nbsp;&nbsp; [b] =&gt; love<br />
)<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [e] =&gt; love<br />
&nbsp;&nbsp;&nbsp; [d] =&gt; love<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65427""></a>
  <div class="note">
   <strong class="user">joey at alegria dot co dot jp</strong>
   <a href="#65427" class="date">30-Apr-2006 09:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There are 2 simpler (and much faster) methods for getting good getopt() operation without creating your own handler.<br />
<br />
1. Use the Console_Getopt PEAR class (should be standard in most PHP installations) which lets you specify both short and long form options as well as whether or not arguments supplied to an option are themselves 'optional'. Very simple to use and requires very little code to operate compaired to writing own handler.<br />
<br />
2. If you cannot load external PEAR objects, use your shell's getopt() functions (which in BASHs case work very well) to process options and have your shell script then call your PHP script with a rigid argument structure that is very easy for PHP to digest such as: <br />
% myfile.php -a TRUE -b FALSE -c ARGUMENT ... <br />
If the initial arguments are invalid you can have the shell script return an error without calling the PHP script. Sounds convoluted but is a very simple solution and in fact PHP's own % pear command uses this method. /usr/bin/pear is a shell script that does some simle checking before calling pearcmd.php and repassing the arguments on to it.<br />
<br />
The second method is by far the best for portability because it allows a single shell script to check a few things like your PHP version and respond acordingly e.g. does it call your PHP4 or PHP5 compatible script? Also, because getopt() is not available on Windows, The second solution allows you to do Windows specific testing as a BAT file (as oposed to BASH, ZSH or Korn on UNIX).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53410""></a>
  <div class="note">
   <strong class="user">daevid at daevid dot com</strong>
   <a href="#53410" class="date">31-May-2005 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is how I parse command line options:<br />
<br />
<span class="default">&lt;?php<br />
$OPTION</span><span class="keyword">[</span><span class="string">'debug'</span><span class="keyword">] = </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'test'</span><span class="keyword">] = </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'force'</span><span class="keyword">] = </span><span class="string">""</span><span class="keyword">;<br />
<br />
</span><span class="comment">//loop through our arguments and see what the user selected<br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"argc"</span><span class="keyword">]; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; switch(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"argv"</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">])<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"-v"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--version"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo&nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">" v07.19.04 06:10 PM\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--debug"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'debug'</span><span class="keyword">] = </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--force"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'force'</span><span class="keyword">] = </span><span class="string">" --force"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--db"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--database"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--id"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'CompanyID'</span><span class="keyword">] = </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][++</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="comment">//it must be a database name<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'CompanyDB'</span><span class="keyword">] = </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][++</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--base"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--basedir"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--dir"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'basedir'</span><span class="keyword">] = </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"argv"</span><span class="keyword">][++</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--test"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$OPTION</span><span class="keyword">[</span><span class="string">'test'</span><span class="keyword">] = </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"-?"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"-h"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"--help"</span><span class="keyword">:<br />
</span><span class="default">?&gt;<br />
</span>This will print any .txt files, process any .sql files and <br />
execute any .php files found starting from the base directory<br />
'&lt;?=$OPTION['basedir']?&gt;' in alphabetical order.<br />
<br />
&nbsp;Usage: <span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'argv'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]; </span><span class="default">?&gt;</span> &lt;option&gt;<br />
<br />
&nbsp;--help, -help, -h, or -?&nbsp; &nbsp;&nbsp; to get this help.<br />
&nbsp;--version&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to return the version of this file.<br />
&nbsp;--debug&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to turn on output debugging.<br />
&nbsp;--test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to fake the SQL and PHP commands.<br />
&nbsp;--force&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to ignore SQL errors and keep on going.<br />
&nbsp;--db [CompanyDB]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to apply to only this [CompanyDB].<br />
&nbsp;--id [CompanyID]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to apply to only this [CompanyID].<br />
&nbsp;--basedir [directory]&nbsp; &nbsp; &nbsp; &nbsp; to change base directory from &lt;?=$OPTION['basedir']?&gt;.<br />
&nbsp;Omitting the CompanyID or CompanyDB will cause ALL Company DB's to be updated.<br />
<br />
&nbsp;There are global files and per-company files. Global files are applied to global<br />
&nbsp;databases (see list below). Their filename contains a tag that reflects the database<br />
&nbsp;to apply them against. Per-company files are applied against databases. Their<br />
&nbsp;filename contains a tag that reads 'COMPANY'. Files should be in &lt;?=$OPTION['basedir']?&gt;;<br />
&nbsp;Global files that are understood:<br />
&lt;?=$OPTION['basedir']?&gt; <br />
&nbsp;<span class="default">&lt;?php </span><span class="keyword">foreach (</span><span class="default">$GLOBAL_SQL_FILES </span><span class="keyword">as </span><span class="default">$sqlFile</span><span class="keyword">) echo </span><span class="default">$sqlFile</span><span class="keyword">.</span><span class="string">"&nbsp;&nbsp; "</span><span class="keyword">; </span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; } </span><span class="comment">//parse arguments<br />
<br />
//&nbsp; &nbsp; print_r($OPTION);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41862""></a>
  <div class="note">
   <strong class="user">chris at tiny dot net</strong>
   <a href="#41862" class="date">23-Apr-2004 07:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"phpnotes at kipu dot co dot uk" and "tim at digicol dot de" are both wrong or misleading.&nbsp; Sean was correct.&nbsp; Quoted space-containing strings on the command line are one argument.&nbsp; It has to do with how the shell handles the command line, more than PHP.&nbsp; PHP's getopt() is modeled on and probably built upon the Unix/POSIX/C library getopt(3) which treats strings as strings, and does not break them apart on white space.<br />
<br />
Here's proof:<br />
<br />
$ cat opt.php<br />
#! /usr/local/bin/php<br />
<span class="default">&lt;?php<br />
$options </span><span class="keyword">= </span><span class="default">getopt</span><span class="keyword">(</span><span class="string">"f:"</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>$ opt.php -f a b c<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [f] =&gt; a<br />
)<br />
$ opt.php -f 'a b c'<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [f] =&gt; a b c<br />
)<br />
$ opt.php -f "a b c"<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [f] =&gt; a b c<br />
)<br />
$ opt.php -f a\ b\ c<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [f] =&gt; a b c<br />
)<br />
$</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.getmyuid.html">getmyuid</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.getrusage.html">getrusage</a></div>
 <div class="up"><a href="ref.info.html">PHP Options/Info Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
