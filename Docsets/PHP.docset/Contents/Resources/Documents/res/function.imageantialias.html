<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Should antialias functions be used or not</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.imagealphablending.html">imagealphablending</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.imagearc.html">imagearc</a></div>
 <div class="up"><a href="ref.image.html">GD and Image Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.imageantialias" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imageantialias</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.2, PHP 5)</p><p class="refpurpose"><span class="refname">imageantialias</span> &mdash; <span class="dc-title">Should antialias functions be used or not</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imageantialias-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>imageantialias</b></span>
    ( <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$image</tt></span>
   , <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$enabled</tt></span>
   )</div>

  <p class="para rdfs-comment">
   Activate the fast drawing antialiased methods for lines and wired polygons.
   It does not support alpha components. It works using a direct blend
   operation. It works only with truecolor images.
  </p>
  <p class="para">
   Thickness and styled are not supported.
  </p>
  <p class="para">
   Using antialiased primitives with transparent background color can end with
   some unexpected results. The blend method uses the background color as any
   other colors. The lack of alpha component support does not allow an alpha
   based antialiasing method.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imageantialias-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>
<span class="term"><i><tt class="parameter">
image</tt></i></span><dd>
<p class="para">An image resource, returned by one of the image creation functions,
such as <span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>.</p></dd>
</dt>

    <dt>

     <span class="term"><i><tt class="parameter">enabled</tt></i></span>
     <dd>

      <p class="para">
       Whether to enable antialiasing or not.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imageantialias-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <b><tt>TRUE</tt></b> on success or <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.imageantialias-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-2930">
    <p><b>Example #1 A comparison of two lines, one with anti-aliasing switched on</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Setup&nbsp;an&nbsp;anti-aliased&nbsp;image&nbsp;and&nbsp;a&nbsp;normal&nbsp;image<br /></span><span style="color: #0000BB">$aa&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">400</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$normal&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">200</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Switch&nbsp;antialiasing&nbsp;on&nbsp;for&nbsp;one&nbsp;image<br /></span><span style="color: #0000BB">imageantialias</span><span style="color: #007700">(</span><span style="color: #0000BB">$aa</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Allocate&nbsp;colors<br /></span><span style="color: #0000BB">$red&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$normal</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$red_aa&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$aa</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Draw&nbsp;two&nbsp;lines,&nbsp;one&nbsp;with&nbsp;AA&nbsp;enabled<br /></span><span style="color: #0000BB">imageline</span><span style="color: #007700">(</span><span style="color: #0000BB">$normal</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">200</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$red</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imageline</span><span style="color: #007700">(</span><span style="color: #0000BB">$aa</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">200</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$red_aa</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Merge&nbsp;the&nbsp;two&nbsp;images&nbsp;side&nbsp;by&nbsp;side&nbsp;for&nbsp;output&nbsp;(AA:&nbsp;left,&nbsp;Normal:&nbsp;Right)<br /></span><span style="color: #0000BB">imagecopymerge</span><span style="color: #007700">(</span><span style="color: #0000BB">$aa</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$normal</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">200</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">200</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Output&nbsp;image<br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-type:&nbsp;image/png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$aa</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$aa</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$normal</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="mediaobject">
     
     <div class="imageobject">
      <img src="images/21009b70229598c6a80eef8b45bf282b-imageantialias.png" alt="Output of example : A comparison of two lines, one with anti-aliasing switched on" width="400" height="100" />
     </div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.imageantialias-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">This function is only available if
PHP is compiled with the bundled version of the GD library.</span></p></blockquote>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imageantialias-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imagecreatetruecolor.html" class="function" rel="rdfs-seeAlso">imagecreatetruecolor()</a> - Create a new true color image</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="95472""></a>
  <div class="note">
   <strong class="user">verdy_p at wanadoo dot fr</strong>
   <a href="#95472" class="date">04-Jan-2010 01:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There's a minor edit bug in those lines in the fast algorithm ("20 times faster"):<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx + $ix, $cy + $iy - 1, $cx + $ix, $cy + $ix, $fill );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx + $ix, $cy - $iy + 1, $cx + $ix, $cy - $ix, $fill );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx - $ix, $cy + $iy - 1, $cx - $ix, $cy + $ix, $fill );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx - $ix, $cy - $iy + 1, $cx - $ix, $cy - $ix, $fill );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx + $iy - 1, $cy + $ix, $cx + $ix, $cy + $ix, $fill );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx + $iy - 1, $cy - $ix, $cx + $ix, $cy - $ix, $fill );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx - $iy + 1, $cy + $ix, $cx - $ix, $cy + $ix, $fill );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imageLine( $img, $cx - $iy + 1, $cy - $ix, $cx - $ix, $cy - $ix, $fill );<br />
<br />
the reference to "$ix" in the parameters of each call (just before the ", $fill " parameter) should be sometimes "$iy".<br />
<br />
This algorithm uses the Bresenham midpoint algorithm for circles, but computing successive pixels positions ($ix, $iy) incrementally in the first octant, relative to the circle center ($cx, $cy), then applying the 8 symetries by swapping them or changing signs.<br />
<br />
A similar algorithm exists for ellipses: it uses quadrants symetries instead of octants when the ellipse focal axis is aligned or orthogonal to the two image axis, be subdividing each quadrant in two regions (deminited by the point on the arc where the tangent has a unitary slope).<br />
<br />
For general ellipses (rotated arbitrarily in the plane), there are also 4 quadrants symetries, but they are a bit more complex to compute, as you need to compute the rotations, for this reason you'll only be able to use 2 symetries, but the incremental algorithm still exists: you may think that this would be based on the evaluation of the sum of lengths from the two focal points, which is contant; however the sum of two distance cannot be squared so easily (you would need to compute the square of both distances, then take their respective square root before adding them and testing the difference with the exact length. A cleaner solution uses NURBS (Non-Uniform Rational B-splines) because they are numerically stable and still very fast to compute (you only need some floatting point for the knot constants that separate each quadrant, which is then computed using a simple quadratic parametric equation of the ellipse instead of the implicit equation, given that the quadratic (polynomial) equation has first and scond derivatives that are easy to bound in order to get the needed precision and reduce the number of unnecessary pixel plots : such the parametric eqaution will draw points along the arc with a movement speed varying between 1 and 4 subpixel distance per incremental step, but in fact only between 1 and 2 subpixels when you subdivide the quadrant in two regions).<br />
<br />
Alternatively, you may also draw an antialised "straight" ellipse with a double resolution, and then rotate the antiliased image while also rescale it at half size, and at the same time combining it to the target: depending on implementations (and computing language used), it may be faster (but it may require more memory for the intermediate image at scale 2)...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92622""></a>
  <div class="note">
   <strong class="user">dsl101</strong>
   <a href="#92622" class="date">31-Jul-2009 08:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Having tried long and hard to get a decent antialiased circle function, I finally gave in a wrote something from scratch. Its very very naive - basically examining every single pixel in the enclosing square, but as a result produces very nice antialiasing, with decent control over stroke width, antialiasing amount and tightness of antialiasing. I'm sure it could be optimised considerably, but it was fast enough for what I was doing. Hope its of some use.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">imagecircleaa</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">, </span><span class="default">$t</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">) </span><span class="comment">// image, centerX, centerY, radius, stroke width, aa width, tightness, color<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$adj </span><span class="keyword">= </span><span class="default">$w </span><span class="keyword">+ </span><span class="default">$s</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sCol </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="string">'r'</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[</span><span class="string">'g'</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[</span><span class="string">'b'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x </span><span class="keyword">= -</span><span class="default">$r </span><span class="keyword">- </span><span class="default">$adj</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt;= </span><span class="default">$r </span><span class="keyword">+ </span><span class="default">$adj</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y </span><span class="keyword">= -</span><span class="default">$r </span><span class="keyword">- </span><span class="default">$adj</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt;= </span><span class="default">$r </span><span class="keyword">+ </span><span class="default">$adj</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">sqrt</span><span class="keyword">(</span><span class="default">$x </span><span class="keyword">* </span><span class="default">$x </span><span class="keyword">+ </span><span class="default">$y </span><span class="keyword">* </span><span class="default">$y</span><span class="keyword">); </span><span class="comment">// distance from pixel to center<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$err </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$d </span><span class="keyword">- </span><span class="default">$r</span><span class="keyword">); </span><span class="comment">// absolute distance from pixel to circle edge<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$err </span><span class="keyword">&lt;= </span><span class="default">$w </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">+ </span><span class="default">$s</span><span class="keyword">) </span><span class="comment">// within the stroke width + smoothing radius<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$err </span><span class="keyword">&lt;= </span><span class="default">$w </span><span class="keyword">/ </span><span class="default">2</span><span class="keyword">) </span><span class="comment">// inside the stroke width so make it solid color<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aaCol </span><span class="keyword">= </span><span class="default">$sCol</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="comment">// in the antialisaing region so make it a blended color<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$err </span><span class="keyword">-= </span><span class="default">$w </span><span class="keyword">/ </span><span class="default">2</span><span class="keyword">; </span><span class="comment">// adjust to the aliased part<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$err </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">- </span><span class="default">$err </span><span class="keyword">/ </span><span class="default">$s</span><span class="keyword">; </span><span class="comment">// adjust to between 0 and 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$err </span><span class="keyword">= (</span><span class="default">$err </span><span class="keyword">- </span><span class="default">0.5</span><span class="keyword">) * </span><span class="default">$t </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">; </span><span class="comment">// adjust to -$t to +$t for tightness <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$err </span><span class="keyword">= (</span><span class="default">$err </span><span class="keyword">/ </span><span class="default">sqrt</span><span class="keyword">(</span><span class="default">1 </span><span class="keyword">+ </span><span class="default">$err </span><span class="keyword">* </span><span class="default">$err</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">) / </span><span class="default">2</span><span class="keyword">; </span><span class="comment">// sigmoid curve to smooth edges<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x </span><span class="keyword">+ </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$y </span><span class="keyword">+ </span><span class="default">$cy</span><span class="keyword">); </span><span class="comment">// Get current background color<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rB </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$gB </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bB </span><span class="keyword">= </span><span class="default">$rgb </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rDelta </span><span class="keyword">= (</span><span class="default">$rB </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="string">'r'</span><span class="keyword">]); </span><span class="comment">// change in Red from background<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rComp </span><span class="keyword">= </span><span class="default">$rB </span><span class="keyword">- </span><span class="default">$rDelta </span><span class="keyword">* </span><span class="default">$err</span><span class="keyword">; </span><span class="comment">// mix Red<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$gDelta </span><span class="keyword">= (</span><span class="default">$gB </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="string">'g'</span><span class="keyword">]); </span><span class="comment">// change in Red from background<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$gComp </span><span class="keyword">= </span><span class="default">$gB </span><span class="keyword">- </span><span class="default">$gDelta </span><span class="keyword">* </span><span class="default">$err</span><span class="keyword">; </span><span class="comment">// mix Red<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bDelta </span><span class="keyword">= (</span><span class="default">$bB </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="string">'b'</span><span class="keyword">]); </span><span class="comment">// change in Red from background<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bComp </span><span class="keyword">= </span><span class="default">$bB </span><span class="keyword">- </span><span class="default">$bDelta </span><span class="keyword">* </span><span class="default">$err</span><span class="keyword">; </span><span class="comment">// mix Red<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aaCol </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$rComp</span><span class="keyword">, </span><span class="default">$gComp</span><span class="keyword">, </span><span class="default">$bComp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x </span><span class="keyword">+ </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$y </span><span class="keyword">+ </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$aaCol</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">500</span><span class="keyword">,</span><span class="default">500</span><span class="keyword">);<br />
<br />
</span><span class="default">$cBlack </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$cGrey </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">120</span><span class="keyword">, </span><span class="default">120</span><span class="keyword">, </span><span class="default">120</span><span class="keyword">);<br />
</span><span class="default">$cWhite </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
<br />
</span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$cWhite</span><span class="keyword">);<br />
</span><span class="default">imagepolygon</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, array(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,</span><span class="default">200</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">), </span><span class="default">4</span><span class="keyword">, </span><span class="default">cBlack</span><span class="keyword">);<br />
<br />
</span><span class="default">$aWhite </span><span class="keyword">= array(</span><span class="string">'r'</span><span class="keyword">=&gt;</span><span class="default">255</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">=&gt;</span><span class="default">255</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="default">255</span><span class="keyword">);<br />
</span><span class="default">$aBlack </span><span class="keyword">= array(</span><span class="string">'r'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$aRed </span><span class="keyword">= array(</span><span class="string">'r'</span><span class="keyword">=&gt;</span><span class="default">200</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$aGreen </span><span class="keyword">= array(</span><span class="string">'r'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">=&gt;</span><span class="default">200</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$aBlue </span><span class="keyword">= array(</span><span class="string">'r'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="default">255</span><span class="keyword">);<br />
<br />
</span><span class="comment">// standard ellipse function for comparison<br />
</span><span class="default">imageellipse</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">$cBlack</span><span class="keyword">);<br />
<br />
</span><span class="comment">// compare different tightnesses - good values are between 2 and 8<br />
// note overall width is stroke width + 2 * aa width (e.g. 12 pixels below)<br />
</span><span class="default">imagecircleaa</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">$aBlue</span><span class="keyword">);<br />
</span><span class="default">imagecircleaa</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">, </span><span class="default">$aBlue</span><span class="keyword">);<br />
<br />
</span><span class="comment">// different coloured background to show blending<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">,</span><span class="default">150</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">, </span><span class="default">$cGrey</span><span class="keyword">);<br />
</span><span class="default">imagecircleaa</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">$aRed</span><span class="keyword">);<br />
<br />
</span><span class="comment">// overlapping circles still aa nicely, although the colour blending algorithm produces quite dark intermediate shades<br />
</span><span class="default">imagecircleaa</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">60</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">$aBlue</span><span class="keyword">);<br />
</span><span class="default">imagecircleaa</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">$aGreen</span><span class="keyword">);<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73424""></a>
  <div class="note">
   <strong class="user">Godfather of Image Processing</strong>
   <a href="#73424" class="date">22-Feb-2007 10:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Of course, this IS a way to do antialiasing. Graphiccards do so. But for good results you should use at least a 4 times bigger source image than the destination to scale down. This is a 16 times higher fillrate. If you only use the proposed doublesized image, quality is still poor...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72971""></a>
  <div class="note">
   <strong class="user">padigan</strong>
   <a href="#72971" class="date">06-Feb-2007 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you can't be bothered creating (or searching for) a full screen antialias function.<br />
You can actually cheat (well a bit of a dirty inefficient hack really!!) <br />
and perform a fake antialias on an image by using 'imagecopyresampled'...<br />
<br />
first create your source image twice the size of what you really want.<br />
<br />
Then use 'imagecopyresampled' to shrink it to half the size, the function <br />
automatically interpolates pixels to create an antialias effect!<br />
<br />
I've used this in a pie chart function and it works brilliantly,<br />
not as slow as I thought it might be!<br />
<br />
the rough code below should give you the idea...<br />
<br />
<span class="default">&lt;?php<br />
$realWidth </span><span class="keyword">= </span><span class="default">500</span><span class="keyword">;<br />
</span><span class="default">$realHeight </span><span class="keyword">= </span><span class="default">500</span><span class="keyword">;<br />
</span><span class="default">$srcWidth </span><span class="keyword">= </span><span class="default">$realWidth </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">;<br />
</span><span class="default">$srcHeight </span><span class="keyword">= </span><span class="default">$realHeight </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">;<br />
<br />
</span><span class="comment">// create the larger source image<br />
</span><span class="default">$srcImage </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$srcWidth</span><span class="keyword">,</span><span class="default">$srcHeight</span><span class="keyword">);<br />
<br />
</span><span class="comment">// create the real/final image<br />
</span><span class="default">$destImage </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$realWidth</span><span class="keyword">,</span><span class="default">$realHeight</span><span class="keyword">);<br />
<br />
</span><span class="comment">// now do whatever you want to draw in the source image<br />
// blah....<br />
<br />
// now the picture is finished, do the shrink...<br />
</span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$destImage</span><span class="keyword">,</span><span class="default">$srcImage</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,<br />
</span><span class="default">$realWidth</span><span class="keyword">,</span><span class="default">$realHeight</span><span class="keyword">,</span><span class="default">$srcWidth</span><span class="keyword">,</span><span class="default">$srcHeight</span><span class="keyword">);<br />
<br />
</span><span class="comment">// now just do whatever you want with '$destImage' (e.g. display or output to file!)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68789""></a>
  <div class="note">
   <strong class="user">Ulrich Mierendorff</strong>
   <a href="#68789" class="date">10-Aug-2006 12:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've written a php function which draws antialiased and filled elliptic arcs (segments of ellipses or full ellipses). It does not require the imageantialias function of php!<br />
It's available at<br />
<a href="http://icewind.ic.funpic.de/index.php?content=ellipse" rel="nofollow" target="_blank">http://icewind.ic.funpic.de/index.php?content=ellipse</a><br />
Best Regards,<br />
Ulrich</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="67985""></a>
  <div class="note">
   <strong class="user">php at 3d-box dot com</strong>
   <a href="#67985" class="date">08-Jul-2006 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might help some people but I have created an antialiased, filled, ellipse function - the source for which is here:-<br />
<br />
<a href="http://personal.3d-box.com/php/filledellipseaa.php" rel="nofollow" target="_blank">http://personal.3d-box.com/php/filledellipseaa.php</a><br />
<br />
As the code is too much to put here!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62062""></a>
  <div class="note">
   <strong class="user">n-dream at gmx dot ch</strong>
   <a href="#62062" class="date">18-Feb-2006 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following function draws an AntiAliased (unfilled) Ellipse.<br />
It is used just liked the nomral ImageEllipse function.<br />
The optional parameter sets the number of segments...<br />
<br />
function ImageEllipseAA( &amp;$img, $x, $y, $w, $h,$color,$segments=70) <br />
{<br />
&nbsp;&nbsp;&nbsp; $w=$w/2;<br />
&nbsp;&nbsp;&nbsp; $h=$h/2;<br />
&nbsp;&nbsp;&nbsp; $jump=2*M_PI/$segments;<br />
&nbsp;&nbsp;&nbsp; $oldx=$x+sin(-$jump)*$w;<br />
&nbsp;&nbsp;&nbsp; $oldy=$y+cos(-$jump)*$h;<br />
&nbsp;&nbsp;&nbsp; for($i=0;$i&lt;2*(M_PI);$i+=$jump)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $newx=$x+sin($i)*$w;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $newy=$y+cos($i)*$h;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ImageLine($img,$newx,$newy,$oldx,$oldy,$color);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $oldx=$newx;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $oldy=$newy;<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61932""></a>
  <div class="note">
   <strong class="user">klaas at kosmokrator dot com</strong>
   <a href="#61932" class="date">15-Feb-2006 05:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an optimized version of the optimized version of the antialiased circle function by sebbi: (more than 20 times faster)...<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">imageSmoothCircle</span><span class="keyword">( &amp;</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$cr</span><span class="keyword">, </span><span class="default">$color </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ir </span><span class="keyword">= </span><span class="default">$cr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ix </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$iy </span><span class="keyword">= </span><span class="default">$ir</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ig </span><span class="keyword">= </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$ir </span><span class="keyword">- </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$idgr </span><span class="keyword">= -</span><span class="default">6</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$idgd </span><span class="keyword">= </span><span class="default">4 </span><span class="keyword">* </span><span class="default">$ir </span><span class="keyword">- </span><span class="default">10</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fill </span><span class="keyword">= </span><span class="default">imageColorExactAlpha</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'R' </span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'G' </span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'B' </span><span class="keyword">], </span><span class="default">0 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$cr </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$cr </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$cr </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$cr </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$draw </span><span class="keyword">= </span><span class="default">imageColorExactAlpha</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'R' </span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'G' </span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'B' </span><span class="keyword">], </span><span class="default">42 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$cr</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$cr</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$cr</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$cr</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while ( </span><span class="default">$ix </span><span class="keyword">&lt;= </span><span class="default">$iy </span><span class="keyword">- </span><span class="default">2 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$ig </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ig </span><span class="keyword">+= </span><span class="default">$idgd</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$idgd </span><span class="keyword">-= </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$iy</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ig </span><span class="keyword">+= </span><span class="default">$idgr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$idgd </span><span class="keyword">-= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$idgr </span><span class="keyword">-= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ix</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$iy </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$iy </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$iy </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$iy </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$iy </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$iy </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$iy </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageLine</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$iy </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$fill </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filled </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ( </span><span class="default">$xx </span><span class="keyword">= </span><span class="default">$ix </span><span class="keyword">- </span><span class="default">0.45</span><span class="keyword">; </span><span class="default">$xx </span><span class="keyword">&lt; </span><span class="default">$ix </span><span class="keyword">+ </span><span class="default">0.5</span><span class="keyword">; </span><span class="default">$xx </span><span class="keyword">+= </span><span class="default">0.2 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ( </span><span class="default">$yy </span><span class="keyword">= </span><span class="default">$iy </span><span class="keyword">- </span><span class="default">0.45</span><span class="keyword">; </span><span class="default">$yy </span><span class="keyword">&lt; </span><span class="default">$iy </span><span class="keyword">+ </span><span class="default">0.5</span><span class="keyword">; </span><span class="default">$yy </span><span class="keyword">+= </span><span class="default">0.2 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">sqrt</span><span class="keyword">( </span><span class="default">pow</span><span class="keyword">( </span><span class="default">$xx</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) + </span><span class="default">pow</span><span class="keyword">( </span><span class="default">$yy</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) ) &lt; </span><span class="default">$cr </span><span class="keyword">) </span><span class="default">$filled </span><span class="keyword">+= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$draw </span><span class="keyword">= </span><span class="default">imageColorExactAlpha</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'R' </span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'G' </span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[ </span><span class="string">'B' </span><span class="keyword">], ( </span><span class="default">100 </span><span class="keyword">- </span><span class="default">$filled </span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageSetPixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$iy</span><span class="keyword">, </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$ix</span><span class="keyword">, </span><span class="default">$draw </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imageCreateTrueColor</span><span class="keyword">( </span><span class="default">320</span><span class="keyword">, </span><span class="default">240 </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imageSmoothCircle</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">160</span><span class="keyword">, </span><span class="default">120</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, array( </span><span class="string">'R' </span><span class="keyword">=&gt; </span><span class="default">0xCC</span><span class="keyword">, </span><span class="string">'G' </span><span class="keyword">=&gt; </span><span class="default">0x33</span><span class="keyword">, </span><span class="string">'B' </span><span class="keyword">=&gt; </span><span class="default">0x00 </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imageSmoothCircle</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">170</span><span class="keyword">, </span><span class="default">110</span><span class="keyword">,&nbsp; </span><span class="default">75</span><span class="keyword">, array( </span><span class="string">'R' </span><span class="keyword">=&gt; </span><span class="default">0xDD</span><span class="keyword">, </span><span class="string">'G' </span><span class="keyword">=&gt; </span><span class="default">0x66</span><span class="keyword">, </span><span class="string">'B' </span><span class="keyword">=&gt; </span><span class="default">0x00 </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imageSmoothCircle</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">180</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">,&nbsp; </span><span class="default">50</span><span class="keyword">, array( </span><span class="string">'R' </span><span class="keyword">=&gt; </span><span class="default">0xEE</span><span class="keyword">, </span><span class="string">'G' </span><span class="keyword">=&gt; </span><span class="default">0x99</span><span class="keyword">, </span><span class="string">'B' </span><span class="keyword">=&gt; </span><span class="default">0x00 </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imageSmoothCircle</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">190</span><span class="keyword">,&nbsp; </span><span class="default">90</span><span class="keyword">,&nbsp; </span><span class="default">25</span><span class="keyword">, array( </span><span class="string">'R' </span><span class="keyword">=&gt; </span><span class="default">0xFF</span><span class="keyword">, </span><span class="string">'G' </span><span class="keyword">=&gt; </span><span class="default">0xCC</span><span class="keyword">, </span><span class="string">'B' </span><span class="keyword">=&gt; </span><span class="default">0x00 </span><span class="keyword">) );<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="string">'Content-Type: image/png' </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagePNG</span><span class="keyword">( </span><span class="default">$img </span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60643""></a>
  <div class="note">
   <strong class="user">voinic at NOSgmailPAM dot com</strong>
   <a href="#60643" class="date">12-Jan-2006 02:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The only trick I found to draw an antialiased polygon AND keep it transparent (to use them as overlays in google maps for example)... make two images and merge them. Order of operations is important and the transparency color of the final image must be set after the merge:<br />
<br />
&lt;?<br />
header("Content-type: image/png");<br />
<br />
$values = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 40,&nbsp; 50,&nbsp; // Point 1 (x, y)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 20,&nbsp; 240, // Point 2 (x, y)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 60,&nbsp; 60,&nbsp; // Point 3 (x, y)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 240, 20,&nbsp; // Point 4 (x, y)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 50,&nbsp; 40,&nbsp; // Point 5 (x, y)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10,&nbsp; 10&nbsp; // Point 6 (x, y)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
<br />
$im = imagecreate(250, 250);<br />
$bg = imagecolorallocate($im, 255, 255, 255);<br />
<br />
$im2 = imagecreatetruecolor(250, 250);<br />
$bg2 = imagecolorallocate($im2, 255, 255, 255);<br />
imagefilledrectangle($im2,0,0,249,249,$bg2);<br />
imagecolortransparent($im2, $bg);<br />
imageantialias($im2, true);<br />
$c_red = imagecolorallocate($im2, 255, 0, 0);<br />
imagepolygon($im2, $values, 6, $c_red);<br />
imageantialias($im2, false);<br />
<br />
imagecopymerge($im, $im2,0,0,0,0,250,250,50);<br />
<br />
imagecolortransparent($im, $bg);<br />
$c_red_alpha = imagecolorallocatealpha($im, 255, 0, 0, 60);<br />
imagefilledpolygon($im, $values, 6, $c_red_alpha);<br />
<br />
imagepng($im);<br />
imagedestroy($im);<br />
imagedestroy($im2);<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57181""></a>
  <div class="note">
   <strong class="user">sebbi at conceptT dot com</strong>
   <a href="#57181" class="date">26-Sep-2005 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I did a search in google and got following url:<br />
<a href="http://www.isocalc.com/tutorials/antialias.htm" rel="nofollow" target="_blank">http://www.isocalc.com/tutorials/antialias.htm</a><br />
With this tutorial I was able to write a function to convert this algorithm into php, the result for a filled circel is this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagefilledcircleantialiased</span><span class="keyword">(&amp;</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$fgcolor</span><span class="keyword">, </span><span class="default">$bgcolor</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$fgcolors </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">$fgcolor</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$bgcolors </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">$bgcolor</span><span class="keyword">);<br />
&nbsp; for ( </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$cx </span><span class="keyword">- </span><span class="default">$r</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt;= </span><span class="default">$cx </span><span class="keyword">+ </span><span class="default">$r</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++ ) {<br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$cy </span><span class="keyword">- </span><span class="default">$r</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt;= </span><span class="default">$cy </span><span class="keyword">+ </span><span class="default">$r</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++ ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$rx </span><span class="keyword">= </span><span class="default">$x </span><span class="keyword">- </span><span class="default">$cx</span><span class="keyword">; </span><span class="default">$ry </span><span class="keyword">= </span><span class="default">$y </span><span class="keyword">- </span><span class="default">$cy</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ir </span><span class="keyword">= </span><span class="default">sqrt</span><span class="keyword">(( </span><span class="default">$rx </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">pow</span><span class="keyword">(</span><span class="default">$rx </span><span class="keyword">- </span><span class="default">0.5</span><span class="keyword">*</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$rx</span><span class="keyword">)/</span><span class="default">$rx</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">) ) + ( </span><span class="default">$ry </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">pow</span><span class="keyword">(</span><span class="default">$ry </span><span class="keyword">- </span><span class="default">0.5</span><span class="keyword">*</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$ry</span><span class="keyword">)/</span><span class="default">$ry</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">) ));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= </span><span class="default">sqrt</span><span class="keyword">(( </span><span class="default">$rx </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">pow</span><span class="keyword">(</span><span class="default">$rx </span><span class="keyword">+ </span><span class="default">0.5</span><span class="keyword">*</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$rx</span><span class="keyword">)/</span><span class="default">$rx</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">) ) + ( </span><span class="default">$ry </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">pow</span><span class="keyword">(</span><span class="default">$ry </span><span class="keyword">+ </span><span class="default">0.5</span><span class="keyword">*</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$ry</span><span class="keyword">)/</span><span class="default">$ry</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">) ));<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ( </span><span class="default">$or </span><span class="keyword">&lt;= </span><span class="default">$r </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$fgcolor</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; elseif ( </span><span class="default">$ir </span><span class="keyword">&lt; </span><span class="default">$r </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filled </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ( </span><span class="default">$xx </span><span class="keyword">= </span><span class="default">$x </span><span class="keyword">- </span><span class="default">0.45</span><span class="keyword">; </span><span class="default">$xx </span><span class="keyword">&lt; </span><span class="default">$x </span><span class="keyword">+ </span><span class="default">0.5</span><span class="keyword">; </span><span class="default">$xx</span><span class="keyword">+=</span><span class="default">0.1 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ( </span><span class="default">$yy </span><span class="keyword">= </span><span class="default">$y </span><span class="keyword">- </span><span class="default">0.45</span><span class="keyword">; </span><span class="default">$yy </span><span class="keyword">&lt; </span><span class="default">$y </span><span class="keyword">+ </span><span class="default">0.5</span><span class="keyword">; </span><span class="default">$yy</span><span class="keyword">+=</span><span class="default">0.1 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rxx </span><span class="keyword">= </span><span class="default">$xx </span><span class="keyword">- </span><span class="default">$cx</span><span class="keyword">; </span><span class="default">$ryy </span><span class="keyword">= </span><span class="default">$yy </span><span class="keyword">- </span><span class="default">$cy</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">sqrt</span><span class="keyword">(</span><span class="default">pow</span><span class="keyword">(</span><span class="default">$rxx</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">) + </span><span class="default">pow</span><span class="keyword">(</span><span class="default">$ryy</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)) &lt; </span><span class="default">$r </span><span class="keyword">) </span><span class="default">$filled</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$red </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$bgcolors</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">] + ( </span><span class="default">$fgcolors</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">] - </span><span class="default">$bgcolors</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">] ) * </span><span class="default">$filled </span><span class="keyword">/ </span><span class="default">100</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$green </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$bgcolors</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">] + ( </span><span class="default">$fgcolors</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">] - </span><span class="default">$bgcolors</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">] ) * </span><span class="default">$filled </span><span class="keyword">/ </span><span class="default">100</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$blue </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$bgcolors</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">] + ( </span><span class="default">$fgcolors</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">] - </span><span class="default">$bgcolors</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">] ) * </span><span class="default">$filled </span><span class="keyword">/ </span><span class="default">100</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">imagecolorclosest</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$red</span><span class="keyword">, </span><span class="default">$green</span><span class="keyword">, </span><span class="default">$blue</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">$width </span><span class="keyword">= </span><span class="default">160</span><span class="keyword">;<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">200</span><span class="keyword">;<br />
</span><span class="default">$r </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">;<br />
</span><span class="default">$bgc </span><span class="keyword">= </span><span class="string">"651713"</span><span class="keyword">;<br />
</span><span class="default">$fgc </span><span class="keyword">= </span><span class="string">"b12b2c"</span><span class="keyword">;<br />
<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
</span><span class="default">$bgcolor </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bgc</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)), </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bgc</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)), </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bgc</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)));<br />
for( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">100</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ ) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, ( </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fgc</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)) + </span><span class="default">$i</span><span class="keyword">*</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bgc</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">))) / (</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">), ( </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fgc</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)) + </span><span class="default">$i</span><span class="keyword">*</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bgc</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">))) / (</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">), ( </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fgc</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)) + </span><span class="default">$i</span><span class="keyword">*</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bgc</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">))) / (</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">));<br />
}<br />
</span><span class="default">$fgcolor </span><span class="keyword">= </span><span class="default">imagecolorclosest</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fgc</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)), </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fgc</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)), </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fgc</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)));<br />
<br />
</span><span class="default">imagefilledcircleantialiased</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">80</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$fgcolor</span><span class="keyword">, </span><span class="default">$bgcolor</span><span class="keyword">);<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Type: image/png"</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>An improvement would be to draw the inner rectangle or more rectangles in the circle with the builtin rectangle function to reduce the usage of imagesetpixel() from (2*r)^2 to 2*Pi*(r + epsilon), in other words, the dependency on r would break down from square to linear.<br />
Another improvement would be to determine filled and unfilled triangles in the observed pixel and calculate their areas, so we can get rid of the inner loops for getting the fraction filled/unfilled.<br />
One can easily modify this function to solve other problems like lines, unfilled circles, etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56521""></a>
  <div class="note">
   <strong class="user">trimbo</strong>
   <a href="#56521" class="date">06-Sep-2005 12:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
So far using PHP 5.0.4 I've managed to get Imageantialias() to work well with:<br />
ImageLine()<br />
ImagePolygon()<br />
<br />
but not with:<br />
ImageArc()<br />
ImageEllipse()<br />
ImageFilled*()<br />
<br />
You can still draw antialiased filled polygons by drawing a hollow polygon on top of a filled one with the same dimensions:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $points</span><span class="keyword">=array(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">, </span><span class="default">$x2</span><span class="keyword">,</span><span class="default">$y2</span><span class="keyword">, </span><span class="default">$x3</span><span class="keyword">,</span><span class="default">$y3</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageFilledPolygon</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">$gray </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagePolygon</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">$gray </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.imagealphablending.html">imagealphablending</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.imagearc.html">imagearc</a></div>
 <div class="up"><a href="ref.image.html">GD and Image Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
