<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Search LDAP tree</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.ldap-sasl-bind.html">ldap_sasl_bind</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.ldap-set-option.html">ldap_set_option</a></div>
 <div class="up"><a href="ref.ldap.html">LDAP Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.ldap-search" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ldap_search</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">ldap_search</span> &mdash; <span class="dc-title">Search LDAP tree</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.ldap-search-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><b>ldap_search</b></span>
    ( <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$link_identifier</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$base_dn</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$filter</tt></span>
   [, <span class="methodparam"><span class="type">array</span> <tt class="parameter">$attributes</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$attrsonly</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$sizelimit</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$timelimit</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$deref</tt></span>
  ]]]]] )</div>

  <p class="para rdfs-comment">
   Performs the search for a specified filter on the directory with the scope
   of <b><tt>LDAP_SCOPE_SUBTREE</tt></b>. This is equivalent to searching
   the entire directory.
  </p>
  <p class="para">
   From 4.0.5 on it&#039;s also possible to do parallel searches. To do this
   you use an array of link identifiers, rather than a single identifier,
   as the first argument. If you don&#039;t want the same base DN and the
   same filter for all the searches, you can also use an array of base DNs
   and/or an array of filters. Those arrays must be of the same size as
   the link identifier array since the first entries of the arrays are
   used for one search, the second entries are used for another, and so
   on. When doing parallel searches an array of search result
   identifiers is returned, except in case of error, then the entry
   corresponding to the search will be <b><tt>FALSE</tt></b>. This is very much like
   the value normally returned, except that a result identifier is always
   returned when a search was made. There are some rare cases where the
   normal search returns <b><tt>FALSE</tt></b> while the parallel search returns an
   identifier.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.ldap-search-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">link_identifier</tt></i></span>
     <dd>

      <p class="para">
       An LDAP link identifier, returned by <span class="function"><a href="function.ldap-connect.html" class="function">ldap_connect()</a></span>.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">base_dn</tt></i></span>
     <dd>

      <p class="para">
       The base DN for the directory.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">filter</tt></i></span>
     <dd>

      <p class="para">
       The search filter can be simple or advanced, using boolean operators in
       the format described in the LDAP documentation (see the <a href="http://www.mozilla.org/directory/csdk-docs/filter.htm" class="link external" title="Link : http://www.mozilla.org/directory/csdk-docs/filter.htm">&raquo;&nbsp;Netscape Directory SDK</a> for full
       information on filters).
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">attributes</tt></i></span>
     <dd>

      <p class="para">
       An array of the required attributes, e.g. <i>array(&quot;mail&quot;, &quot;sn&quot;, &quot;cn&quot;)</i>.
       Note that the &quot;dn&quot; is always returned irrespective of which attributes
       types are requested.
      </p>
      <p class="para">
       Using this parameter is much more efficient than the default action
       (which is to return all attributes and their associated values). 
       The use of this parameter should therefore be considered good
       practice.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">attrsonly</tt></i></span>
     <dd>

      <p class="para">
       Should be set to 1 if only attribute types are wanted. If set to 0
       both attributes types and attribute values are fetched which is the
       default behaviour.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">sizelimit</tt></i></span>
     <dd>

      <p class="para">
       Enables you to limit the count of entries fetched. Setting this to 0
       means no limit.
      </p>
      <blockquote class="note"><p><b class="note">Note</b>: 
       <p class="para">
        This parameter can NOT override server-side preset sizelimit. You can
        set it lower though.
       </p>
       <p class="para">
        Some directory server hosts will be configured to return no more than
        a preset number of entries. If this occurs, the server will indicate
        that it has only returned a partial results set. This also occurs if
        you use this parameter to limit the count of fetched entries.
       </p>
      </p></blockquote>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">timelimit</tt></i></span>
     <dd>

      <p class="para">
       Sets the number of seconds how long is spend on the search. Setting
       this to 0 means no limit.
      </p>
      <blockquote class="note"><p><b class="note">Note</b>: 
       <p class="para">
        This parameter can NOT override server-side preset timelimit. You can
        set it lower though.
       </p>
      </p></blockquote>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">deref</tt></i></span>
     <dd>

      <p class="para">
       Specifies how aliases should be handled during the search. It can be
       one of the following:
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <b><tt>LDAP_DEREF_NEVER</tt></b> - (default) aliases are never
          dereferenced.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <b><tt>LDAP_DEREF_SEARCHING</tt></b> - aliases should be
          dereferenced during the search but not when locating the base object
          of the search.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <b><tt>LDAP_DEREF_FINDING</tt></b> - aliases should be
          dereferenced when locating the base object but not during the search.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <b><tt>LDAP_DEREF_ALWAYS</tt></b> - aliases should be dereferenced
          always.
         </span>
        </li>
       </ul>
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.ldap-search-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a search result identifier or <b><tt>FALSE</tt></b> on error.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.ldap-search-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">4.0.5</td>
       <td align="left">
        Parallel searches support was added.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">4.0.2</td>
       <td align="left">
        The <i><tt class="parameter">attrsonly</tt></i>, <i><tt class="parameter">sizelimit</tt></i>,
        <i><tt class="parameter">timelimit</tt></i> and <i><tt class="parameter">deref</tt></i> were
        added.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.ldap-search-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   The example below retrieves the organizational unit, surname,
   given name and email address for all people in &quot;My Company&quot; where
   the surname or given name contains the substring <var class="varname"><var class="varname">$person</var></var>. This
   example uses a boolean filter to tell the server to look for
   information in more than one attribute.
   <div class="example" id="example-3967">
    <p><b>Example #1 LDAP search</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;$ds&nbsp;is&nbsp;a&nbsp;valid&nbsp;link&nbsp;identifier&nbsp;for&nbsp;a&nbsp;directory&nbsp;server<br /><br />//&nbsp;$person&nbsp;is&nbsp;all&nbsp;or&nbsp;part&nbsp;of&nbsp;a&nbsp;person's&nbsp;name,&nbsp;eg&nbsp;"Jo"<br /><br /></span><span style="color: #0000BB">$dn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"o=My&nbsp;Company,&nbsp;c=US"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$filter</span><span style="color: #007700">=</span><span style="color: #DD0000">"(|(sn=</span><span style="color: #0000BB">$person</span><span style="color: #DD0000">*)(givenname=</span><span style="color: #0000BB">$person</span><span style="color: #DD0000">*))"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$justthese&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"ou"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"sn"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"givenname"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mail"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$sr</span><span style="color: #007700">=</span><span style="color: #0000BB">ldap_search</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$dn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$filter</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$justthese</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$info&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ldap_get_entries</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sr</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"count"</span><span style="color: #007700">].</span><span style="color: #DD0000">"&nbsp;entries&nbsp;returned\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="105836""></a>
  <div class="note">
   <strong class="user">info at acpower dot biz</strong>
   <a href="#105836" class="date">19-Sep-2011 03:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm a newbie, so I hope this helps some other newbie with a head scratcher...<br />
<br />
This code returned an error of 'No Such Object':<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; $search </span><span class="keyword">= </span><span class="default">ldap_search </span><span class="keyword">(</span><span class="default">$ldapcon</span><span class="keyword">, </span><span class="string">"cn=admin,dc=acpower,dc=biz"</span><span class="keyword">, </span><span class="string">"(filters)"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I took out the cn, and magic! it works:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; $search </span><span class="keyword">= </span><span class="default">ldap_search </span><span class="keyword">(</span><span class="default">$ldapcon</span><span class="keyword">, </span><span class="string">"dc=acpower,dc=biz"</span><span class="keyword">, </span><span class="string">"(filters)"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105631""></a>
  <div class="note">
   <strong class="user">nick</strong>
   <a href="#105631" class="date">01-Sep-2011 11:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Results from ActiveDirectory may be ordered by objectSid.<br />
We can get all users for each page size by modify filter.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// ... connect to ldap<br />
</span><span class="default">$lastsid</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
while (</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$filter </span><span class="keyword">= </span><span class="string">'(objectClass=user)'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$lastsid</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$v</span><span class="keyword">)=</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'V'</span><span class="keyword">,</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$lastsid</span><span class="keyword">,</span><span class="default">24</span><span class="keyword">))); </span><span class="comment">// id for user.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$lastsid</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">24</span><span class="keyword">).</span><span class="default">pack</span><span class="keyword">(</span><span class="string">'V'</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">+</span><span class="default">$v</span><span class="keyword">); </span><span class="comment">// next sid.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/../'</span><span class="keyword">,</span><span class="string">'\\\\$0'</span><span class="keyword">,</span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">)); </span><span class="comment">// escape for fiter<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filter </span><span class="keyword">= </span><span class="string">'(&amp;'</span><span class="keyword">.</span><span class="default">$filter</span><span class="keyword">.</span><span class="string">'(objectSid&gt;='</span><span class="keyword">.</span><span class="default">$s</span><span class="keyword">.</span><span class="string">'))'</span><span class="keyword">; </span><span class="comment">// fiter for next entries.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$basedn</span><span class="keyword">,</span><span class="default">$filter</span><span class="keyword">,array(</span><span class="string">'objectSid'</span><span class="keyword">,</span><span class="string">'cn'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$res</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$ent</span><span class="keyword">=</span><span class="default">ldap_first_entry</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$res</span><span class="keyword">); </span><span class="default">$ent</span><span class="keyword">; </span><span class="default">$ent</span><span class="keyword">=</span><span class="default">ldap_next_entry</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$ent</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$lastsid</span><span class="keyword">) = </span><span class="default">ldap_get_values_len</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$ent</span><span class="keyword">,</span><span class="string">'objectSid'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103918""></a>
  <div class="note">
   <strong class="user">Arnold</strong>
   <a href="#103918" class="date">11-May-2011 01:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have been working on a script where I needed to get all the users who were member of a specific MS AD group. Because of PHP bug #42060 ( <a href="http://bugs.php.net/bug.php?id=42060 " rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=42060 </a>) I could not get all the users back who were member of the group.<br />
After googling for a day I found an article and a patch but it required that I downloaded the source code for php 5.1.6 or 5.2.10 run the patch and than recompile the code to fix the problem. <br />
Problem was <br />
1) I am not a Linux goeroe so I was not very comfortable doing this....<br />
2) I am running the script on a production machine with other code using PHP and did not know what the consequence would bee for that code.<br />
3) I could not update PHP anymore because in newer versions this patch would probably not work any more.<br />
<br />
But yesterday I saw the light and wrote some code to get around this problem, maybe other people can use it that have the same problem.<br />
<br />
<span class="default">&lt;?PHP<br />
$startFilter&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"(&amp;(memberOf=" </span><span class="keyword">.</span><span class="default">$ADGroup</span><span class="keyword">. </span><span class="string">"))"</span><span class="keyword">;<br />
</span><span class="default">$startResults&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">, </span><span class="default">$userBase</span><span class="keyword">, </span><span class="default">$startFilter</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">);<br />
</span><span class="default">$countResult&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$startResults</span><span class="keyword">);<br />
<br />
IF(</span><span class="default">$countResult </span><span class="keyword">== </span><span class="default">1000 </span><span class="keyword">OR </span><span class="default">$countResult </span><span class="keyword">== </span><span class="default">1500</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// loop trough the number 97-122 (ASCII number for the characters a-z)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">For(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">97</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;=</span><span class="default">122</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// translate the number to a character<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$character&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// the new search filter withs returns all users with a last name starting with $character<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filter&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"(&amp;(sn=</span><span class="default">$character</span><span class="string">*)(memberOf=</span><span class="default">$ADGroup</span><span class="string">))"</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">, </span><span class="default">$userBase</span><span class="keyword">, </span><span class="default">$filter</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$countResult2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// See if the search for all users starting with a specific character still hits the search limit<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // if so than do a new search to find all the users where the last name starts with "aa" and <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // than with "ab", "ac" etc. etc<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // In the best case we can now find 675.324 users per group when the search limit is 1000<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ((26 * 999&nbsp; for the fist character) * 26 for the second character)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // and 1.013.324 when the search limit is 1500<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">If(</span><span class="default">$countResult2 </span><span class="keyword">== </span><span class="default">1000 </span><span class="keyword">or </span><span class="default">$countResult2 </span><span class="keyword">== </span><span class="default">1500</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; For(</span><span class="default">$b</span><span class="keyword">=</span><span class="default">97</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">&lt;=</span><span class="default">122</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$character2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filter2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"(&amp;(sn=</span><span class="default">$character$character2</span><span class="string">*)(memberOf=</span><span class="default">$ADGroup</span><span class="string">))"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">, </span><span class="default">$userBase</span><span class="keyword">, </span><span class="default">$filter2</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count2&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results2</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entries2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results2</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do your thing<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entries&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do your thing<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
else<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$entries&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$startResults</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// do your thing<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95859""></a>
  <div class="note">
   <strong class="user">David Fontanella</strong>
   <a href="#95859" class="date">26-Jan-2010 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get all attributes + special attributes:<br />
<br />
<span class="default">&lt;?php<br />
ldap_search</span><span class="keyword">(..., </span><span class="default">$filter</span><span class="keyword">, array(</span><span class="string">'*'</span><span class="keyword">,</span><span class="string">'createtimestamp'</span><span class="keyword">,</span><span class="string">'modifytimestamp'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
* -&gt; all attributes (normally requested by default)<br />
+<br />
the special attributes you want</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95746""></a>
  <div class="note">
   <strong class="user">ben _at_ onshop.co.uk</strong>
   <a href="#95746" class="date">19-Jan-2010 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Following from my note of 11-Nov-2009 06:56 regarding DN issues when using LDAP instead of the Global Catalog when querying AD, further investigation was showing that although the results were in the packet, I was getting an error instead:<br />
<br />
'Search: Can't contact LDAP server' AKA Error 81.<br />
<br />
Using more detailed analysis:<br />
<br />
ldap_get_option($ds,LDAP_OPT_ERROR_STRING,$error);<br />
<br />
echo $error<br />
<br />
Displayed:<br />
<br />
Referral: ldap://DomainDnsZones.defg.de.bc.ac.uk/ DC=DomainDnsZonesDC=defg,DC=de,DC=abc,DC=ac,DC=uk<br />
<br />
By using trial and error, the error went away and results returned when using:<br />
<br />
ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94555""></a>
  <div class="note">
   <strong class="user">ben _at_ onshop_co_uk</strong>
   <a href="#94555" class="date">11-Nov-2009 10:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When searching Active Directory, if you are not getting all the attributes back you are expecting such as AD system/hidden attributes such as 'employeeType' then check the following:<br />
<br />
First, ensure you are not connecting to the Global Catalog port (e.g. 3269/3268). You need to connect to an LDAP port such as 636 (SSL) or 389 (non-SSL).<br />
<br />
Second, check the DN you are binding with when changing from the Global Catalog port to an LDAP port. I found that a DN without an OU returned a 'Search: Can't contact LDAP server' error. For example this fails:<br />
<br />
DC=defg,DC=de,DC=abc,DC=ac,DC=uk<br />
<br />
Whilst adding the OU to the DN returned an error free result:<br />
<br />
OU=FGH,DC=defg,DC=de,DC=abc,DC=ac,DC=uk<br />
<br />
If you consequently need to interrogate multiple DNs then an array of DNs can be passed to ldap_search.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94554""></a>
  <div class="note">
   <strong class="user">ben _at_ onshop_co_uk</strong>
   <a href="#94554" class="date">11-Nov-2009 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example to illustrate searching more than one DN (multiple DNs):<br />
<br />
<span class="default">&lt;?php<br />
$ds</span><span class="keyword">=</span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="default">$ldapserver</span><span class="keyword">);<br />
<br />
</span><span class="default">$dn</span><span class="keyword">[]=</span><span class="string">'OU=ABC,DC=xyz,DC=ac,DC=uk'</span><span class="keyword">;<br />
</span><span class="default">$dn</span><span class="keyword">[]=</span><span class="string">'OU=DEF,DC=xyz,DC=ac,DC=uk'</span><span class="keyword">;<br />
<br />
</span><span class="default">$id</span><span class="keyword">[] = </span><span class="default">$ds</span><span class="keyword">;<br />
</span><span class="default">$id</span><span class="keyword">[] = </span><span class="default">$ds</span><span class="keyword">;<br />
<br />
</span><span class="default">$filter </span><span class="keyword">= </span><span class="string">'samaccountname='</span><span class="keyword">.</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">];<br />
&nbsp;<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">,</span><span class="default">$dn</span><span class="keyword">,</span><span class="default">$filter</span><span class="keyword">);<br />
<br />
</span><span class="default">$search </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
<br />
foreach (</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$search </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
if(</span><span class="default">$search</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$search</span><span class="keyword">);<br />
}else{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'No results found'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94245""></a>
  <div class="note">
   <strong class="user">eugene at hutorny dot in dot ua</strong>
   <a href="#94245" class="date">24-Oct-2009 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function accepts LDAP search results and return a flat table (2-d array) with search results.<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;* This function returns flat table out of search results<br />
&nbsp;* $ad - a valid connection to Active Directory (returned by ldap_connect)<br />
&nbsp;* $sr - a search result (returned by ldap_search)<br />
&nbsp;* $key- an attribute name to be used as the key in the resulting array<br />
&nbsp;* Returns 2-d array as the following:<br />
&nbsp;*&nbsp;&nbsp; return_value["keyfieldvalue"]["attributename"] = "attribute value"; // entries with key filed present<br />
&nbsp;*&nbsp; return_value[i]["attributename"] = "attribute value"; // entries with key fields missing<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">ldap_flatresults</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">,</span><span class="default">$sr</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp; for (</span><span class="default">$entry</span><span class="keyword">=</span><span class="default">ldap_first_entry</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">,</span><span class="default">$sr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entry</span><span class="keyword">!=</span><span class="default">false</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entry</span><span class="keyword">=</span><span class="default">ldap_next_entry</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">,</span><span class="default">$entry</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$user </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$attributes </span><span class="keyword">= </span><span class="default">ldap_get_attributes</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">,</span><span class="default">$entry</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$attributes</span><span class="keyword">[</span><span class="string">'count'</span><span class="keyword">];</span><span class="default">$i</span><span class="keyword">-- &gt;</span><span class="default">0</span><span class="keyword">;) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$user</span><span class="keyword">[</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$attributes</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])] = </span><span class="default">$attributes</span><span class="keyword">[</span><span class="default">$attributes</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]][</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$key </span><span class="keyword">&amp;&amp; </span><span class="default">$user</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] )<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$users</span><span class="keyword">[</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])] = </span><span class="default">$user</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$users</span><span class="keyword">[] = </span><span class="default">$user</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$users</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93979""></a>
  <div class="note">
   <strong class="user">rtdees at gapac dot com</strong>
   <a href="#93979" class="date">09-Oct-2009 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of today, I have found for me that ldap_search and ldap_list are reversed in functionality.&nbsp; ldap_list now searches the subtree and ldap_search does not.&nbsp; This is witnessed when searching against an AD forest running on Windows 2008 in what I believe is 2003 mode.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93793""></a>
  <div class="note">
   <strong class="user">john dot saterfiel at act dot org</strong>
   <a href="#93793" class="date">29-Sep-2009 10:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's an example of how to connect to an active directory (2003 windows ad tested). And retrieve a specific person's information when given only their username (sAMAccountName).&nbsp; Note: I have noticed that some active directory servers do care about what case the attributes are in and others don't.&nbsp; This site was very useful in looking up the AD attributes but I did have to lowercase them all to work for me. <br />
Do a google search on "active directory person attributes" to find the site. www.computerperformance.co.uk<br />
<br />
I doubt the code below will work for everybody as is but it should give ad users a good start in how to get a logged in user's data without knowing what organization or security group they're in.&nbsp; This was needed because my company didn't put all their users in the same organization.<br />
<br />
<span class="default">&lt;?PHP<br />
$ldap_url </span><span class="keyword">= </span><span class="string">'examplead.mycomp.com'</span><span class="keyword">;<br />
</span><span class="default">$ldap_domain </span><span class="keyword">= </span><span class="string">'mycomp.com'</span><span class="keyword">;<br />
</span><span class="default">$ldap_dn </span><span class="keyword">= </span><span class="string">"dc=mycomp,dc=com"</span><span class="keyword">;<br />
<br />
</span><span class="default">$ds </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">( </span><span class="default">$ldap_url </span><span class="keyword">);<br />
</span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">LDAP_OPT_PROTOCOL_VERSION</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
</span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">LDAP_OPT_REFERRALS</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="default">$username </span><span class="keyword">= </span><span class="string">"your_user_name_here"</span><span class="keyword">;<br />
</span><span class="comment">//must always check that password length &gt; 0<br />
</span><span class="default">$password </span><span class="keyword">= </span><span class="string">"your_password_here"</span><span class="keyword">; <br />
<br />
</span><span class="comment">// now try a real login<br />
</span><span class="default">$login </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">( </span><span class="default">$ds</span><span class="keyword">, </span><span class="string">"</span><span class="default">$username</span><span class="string">@</span><span class="default">$ldap_domain</span><span class="string">"</span><span class="keyword">, </span><span class="default">$password </span><span class="keyword">); <br />
echo </span><span class="string">'- Logged In Successfully&lt;br/&gt;&lt;br/&gt;'</span><span class="keyword">;<br />
try{<br />
</span><span class="default">$attributes </span><span class="keyword">= array(</span><span class="string">"displayname"</span><span class="keyword">, </span><span class="string">"mail"</span><span class="keyword">,<br />
</span><span class="string">"department"</span><span class="keyword">,<br />
</span><span class="string">"title"</span><span class="keyword">,<br />
</span><span class="string">"physicaldeliveryofficename"</span><span class="keyword">,<br />
</span><span class="string">"manager"</span><span class="keyword">);<br />
</span><span class="default">$filter </span><span class="keyword">= </span><span class="string">"(&amp;(objectCategory=person)(sAMAccountName=</span><span class="default">$username</span><span class="string">))"</span><span class="keyword">;<br />
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$ldap_dn</span><span class="keyword">, </span><span class="default">$filter</span><span class="keyword">, </span><span class="default">$attributes</span><span class="keyword">);<br />
<br />
</span><span class="default">$entries </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$entries</span><span class="keyword">[</span><span class="string">"count"</span><span class="keyword">] &gt; </span><span class="default">0</span><span class="keyword">){<br />
</span><span class="comment">//echo print_r($entries[$i],1)."&lt;br /&gt;";<br />
</span><span class="keyword">echo </span><span class="string">"&lt;b&gt;User Information:&lt;/b&gt;&lt;br/&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"displayName: "</span><span class="keyword">.</span><span class="default">$entries</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'displayname'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"email: "</span><span class="keyword">.</span><span class="default">$entries</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'mail'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"department: "</span><span class="keyword">.</span><span class="default">$entries</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'department'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"title: "</span><span class="keyword">.</span><span class="default">$entries</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'title'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"office: "</span><span class="keyword">.</span><span class="default">$entries</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'physicaldeliveryofficename'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
</span><span class="comment">//echo "manager: ".$entries[$i]['manager'][0]."&lt;br/&gt;";<br />
</span><span class="default">$manager_result </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">,<br />
</span><span class="default">$entries</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'manager'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">],<br />
</span><span class="string">'(objectCategory=person)'</span><span class="keyword">,<br />
array(</span><span class="string">"displayname"</span><span class="keyword">));<br />
<br />
</span><span class="default">$manager_entries </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$manager_result</span><span class="keyword">);<br />
if(</span><span class="default">$manager_entries</span><span class="keyword">[</span><span class="string">"count"</span><span class="keyword">] &gt; </span><span class="default">0</span><span class="keyword">){<br />
echo </span><span class="string">"manager: "</span><span class="keyword">. </span><span class="default">$manager_entries</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'displayname'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br />
}<br />
}<br />
}catch(</span><span class="default">Exception $e</span><span class="keyword">){<br />
</span><span class="default">ldap_unbind</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">);<br />
return;<br />
}<br />
</span><span class="default">ldap_unbind</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;br/&gt;&lt;br/&gt;- Logged Out'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90158""></a>
  <div class="note">
   <strong class="user">douglass_davis at earthlink dot net</strong>
   <a href="#90158" class="date">08-Apr-2009 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A better ldap_escape, if you don't need nested filters such as those in the Pear package.&nbsp; Escapes for both filters and distinguished names.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">ldap_escape</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$for_dn </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// see: <br />
&nbsp;&nbsp;&nbsp; // RFC2254<br />
&nbsp;&nbsp;&nbsp; // <a href="http://msdn.microsoft.com/en-us/library/ms675768(VS.85" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/ms675768(VS.85</a>).aspx<br />
&nbsp;&nbsp;&nbsp; // <a href="http://www-03.ibm.com/systems/i/software/ldap/underdn.html&nbsp; &nbsp; &nbsp; &nbsp; " rel="nofollow" target="_blank">http://www-03.ibm.com/systems/i/software/ldap/underdn.html&nbsp; &nbsp; &nbsp; &nbsp; </a><br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if&nbsp; (</span><span class="default">$for_dn</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$metaChars </span><span class="keyword">= array(</span><span class="string">','</span><span class="keyword">,</span><span class="string">'='</span><span class="keyword">, </span><span class="string">'+'</span><span class="keyword">, </span><span class="string">'&lt;'</span><span class="keyword">,</span><span class="string">'&gt;'</span><span class="keyword">,</span><span class="string">';'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">, </span><span class="string">'#'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$metaChars </span><span class="keyword">= array(</span><span class="string">'*'</span><span class="keyword">, </span><span class="string">'('</span><span class="keyword">, </span><span class="string">')'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$quotedMetaChars </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$metaChars </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) </span><span class="default">$quotedMetaChars</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="string">'\\'</span><span class="keyword">.</span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)), </span><span class="default">2</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$metaChars</span><span class="keyword">,</span><span class="default">$quotedMetaChars</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">); </span><span class="comment">//replace them<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return (</span><span class="default">$str</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85356""></a>
  <div class="note">
   <strong class="user">beni at php dot net</strong>
   <a href="#85356" class="date">27-Aug-2008 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note, that your example is not fully implementing filter escaping needs and is thus not safe for every case (see RFC 2254).<br />
<br />
Filter stuff is also available in pears Net_LDAP: <a href="http://pear.php.net/manual/en/package.networking.net-ldap.filter.php" rel="nofollow" target="_blank">http://pear.php.net/manual/en/package.networking.net-ldap.filter.php</a><br />
<br />
With this class you can easily create nested filters without worrying for escaping issues (those are handled by the class itnernally in a rfc compatible maner).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83774""></a>
  <div class="note">
   <strong class="user">metala at metala dot org</strong>
   <a href="#83774" class="date">11-Jun-2008 02:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// Escape string<br />
// see: RFC2254<br />
function ldap_escape($str){<br />
&nbsp;&nbsp;&nbsp; $metaChars = array('\\', '(', ')', '#', '*');<br />
&nbsp;&nbsp;&nbsp; $quotedMetaChars = array();<br />
&nbsp;&nbsp;&nbsp; foreach ($metaChars as $key =&gt; $value) $quotedMetaChars[$key] = '\\'.dechex(ord($value));<br />
&nbsp;&nbsp;&nbsp; $str=str_replace($metaChars,$quotedMetaChars,$str); //replace them<br />
&nbsp;&nbsp;&nbsp; return ($str);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76982""></a>
  <div class="note">
   <strong class="user">chrisbloom7 at gmail dot com</strong>
   <a href="#76982" class="date">08-Aug-2007 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are a couple of resources for proper construction of filters. <br />
<br />
<a href="http://msdn2.microsoft.com/En-US/library/aa746475.aspx" rel="nofollow" target="_blank">http://msdn2.microsoft.com/En-US/library/aa746475.aspx</a><br />
<br />
<a href="http://technet.microsoft.com/en-us/library/aa996205.aspx" rel="nofollow" target="_blank">http://technet.microsoft.com/en-us/library/aa996205.aspx</a><br />
<br />
Before finding these I had been stumped for hours on how to do something like "all users starting with "a" except those from OU 'foo'"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75993""></a>
  <div class="note">
   <strong class="user">beni at php dot net</strong>
   <a href="#75993" class="date">25-Jun-2007 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
LDAP stuff is very nicely capsulated in the object oriented Net_LDAP class provided by PEAR:<br />
<a href="http://pear.php.net/package/net_ldap" rel="nofollow" target="_blank">http://pear.php.net/package/net_ldap</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75321""></a>
  <div class="note">
   <strong class="user">lifo at liche dot net</strong>
   <a href="#75321" class="date">23-May-2007 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When I discovered I couldn't get searches to work with complex strings (in my case searching on displayName which can have parens and slashes in it). I made this quick function to quote ldap strings in accordance with the RFC. Except I encode spaces as well since searching wouldn't work with spaces. Note, technically speaking a search filter can be encoded into the \xx format for all characters but then filters wouldn't be human readable.<br />
<br />
I'm somewhat surprised there wasn't a built in ldap_quote() type of function already.<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// see: RFC2254<br />
</span><span class="keyword">function </span><span class="default">ldap_quote</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( </span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">, </span><span class="string">'*'</span><span class="keyword">, </span><span class="string">'('</span><span class="keyword">, </span><span class="string">')' </span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( </span><span class="string">'\\5c'</span><span class="keyword">, </span><span class="string">'\\20'</span><span class="keyword">, </span><span class="string">'\\2a'</span><span class="keyword">, </span><span class="string">'\\28'</span><span class="keyword">, </span><span class="string">'\\29' </span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73693""></a>
  <div class="note">
   <strong class="user">Allie</strong>
   <a href="#73693" class="date">06-Mar-2007 02:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just posted on the ldap_bind, but I figured it couldn't hurt here since this was the first place I stopped when trying to figure out my problem.&nbsp; My error pointed to ldap_search, but specifying the ldap_connect port was the fix.<br />
<br />
When you want to search the entire directory for MS AD, you must specify port 3268 in your bind.&nbsp; This is also true for apache auth_ldap.<br />
<br />
&nbsp;$ldapserver = ldap_connect($server,3268);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73636""></a>
  <div class="note">
   <strong class="user">Alain SCHNERB</strong>
   <a href="#73636" class="date">05-Mar-2007 05:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had problem searching into Microsoft Active Directory<br />
with ldap_search.<br />
<br />
System administrator does not want to change the 1.000 limit<br />
of returned result because of Domain Controler performance.<br />
<br />
Here is a example of code that activates the Page Mode.<br />
<br />
See "searching with ActiveX Data Objects (ADO)" on MSDN<br />
for more details.<br />
<br />
$connection = New COM("ADODB.Connection");<br />
$commande = New COM("ADODB.Command");<br />
$resultat = New COM("ADODB.Recordset");<br />
$connection-&gt;Provider = "ADsDSOObject";<br />
$connection-&gt;Open();<br />
$commande-&gt;ActiveConnection = $connection ;<br />
$commande-&gt;Properties["Cache results"] = false;<br />
<br />
// ACTIVATE PAGE MODE<br />
$commande-&gt;Properties["Page size"] = 1000;<br />
<br />
$recherche1 = "&lt;LDAP://OU=XXXX,OU=Ressources_Locales,DC=COMMUN,<br />
DC=AD,DC=YYYY,DC=FR&gt;";<br />
$recherche2 = ";(&amp;(objectCategory=group)<br />
(sIDHistory=*));distinguishedname;subtree";<br />
<br />
$commande-&gt;commandtext = $recherche1.$recherche2;<br />
$resultat = $commande-&gt;Execute();<br />
<br />
$count = 0;<br />
while (!$resultat-&gt;eof())<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if ($count&lt;10)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $resultat["distinguishedname"]."&lt;br&gt;";&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; $resultat-&gt;MoveNext();<br />
&nbsp;&nbsp;&nbsp; $count = $count +1;<br />
&nbsp;&nbsp;&nbsp; }<br />
echo $count."&lt;br&gt;";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72526""></a>
  <div class="note">
   <strong class="user">cbrinker at contronicssolutions dot com</strong>
   <a href="#72526" class="date">23-Jan-2007 02:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was completely lost trying to setup LDAP access with a Windows Server 2003 environment, but I finally got it to work. Here's a lifesaving tip:<br />
<br />
-Script/web server cannot be located on the Active Directory server that you are querying<br />
<br />
As well, here's the sample code I used:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//This code cannot be executed on the same server as AD is installed on!!!<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //Connect<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ad </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="string">"ad server"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Set some variables<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">, </span><span class="default">LDAP_OPT_PROTOCOL_VERSION</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">, </span><span class="default">LDAP_OPT_REFERRALS</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Bind to the ldap directory<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bd </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">,</span><span class="string">"user@domain.com"</span><span class="keyword">,</span><span class="string">"password"</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; or die(</span><span class="string">"Couldn't bind to AD!"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Search the directory<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">, </span><span class="string">"OU=orginizational unit,DC=domain,DC=com"</span><span class="keyword">, </span><span class="string">"(CN=*)"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Create result set<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$entries </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Sort and print<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"User count: " </span><span class="keyword">. </span><span class="default">$entries</span><span class="keyword">[</span><span class="string">"count"</span><span class="keyword">] . </span><span class="string">"&lt;br /&gt;&lt;br /&gt;&lt;b&gt;Users:&lt;/b&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$entries</span><span class="keyword">[</span><span class="string">"count"</span><span class="keyword">]; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$entries</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">"displayname"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//never forget to unbind!<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ldap_unbind</span><span class="keyword">(</span><span class="default">$ad</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63909""></a>
  <div class="note">
   <strong class="user">buhreen at shaw dot ca</strong>
   <a href="#63909" class="date">03-Apr-2006 09:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are just trying to run LDAP searches against Active Directory, you might find it easier to use the COM objects and use the ADSI ldap search function.&nbsp; This allows you to use SQL based LDAP queries.&nbsp; It also allows you to perform subtree level searches in AD.<br />
<br />
Here is a quick example.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$Conn </span><span class="keyword">= New </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">);<br />
</span><span class="default">$RS </span><span class="keyword">= New </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Recordset"</span><span class="keyword">);<br />
<br />
</span><span class="default">$Conn</span><span class="keyword">-&gt;</span><span class="default">Provider </span><span class="keyword">= </span><span class="string">"ADsDSOObject"</span><span class="keyword">;<br />
</span><span class="default">$Conn</span><span class="keyword">-&gt;</span><span class="default">Properties</span><span class="keyword">[</span><span class="string">'User ID'</span><span class="keyword">] = </span><span class="string">"CN=ZimZam,CN=Users,DC=corp,DC=ad,DC=bob,DC=prv"</span><span class="keyword">;<br />
</span><span class="default">$Conn</span><span class="keyword">-&gt;</span><span class="default">Properties</span><span class="keyword">[</span><span class="string">'Password'</span><span class="keyword">] = </span><span class="string">"anythingyouwant"</span><span class="keyword">;<br />
</span><span class="default">$strConn </span><span class="keyword">= </span><span class="string">"Active Directory Provider"</span><span class="keyword">;<br />
</span><span class="default">$Conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$strConn</span><span class="keyword">);<br />
<br />
</span><span class="default">$strRS </span><span class="keyword">= </span><span class="string">"Select givenname,sn,displayName,mail,SAMAccountName from 'LDAP://corp.ad.bob.prv/DC=corp,DC=ad,DC=bob,DC=prv' where objectClass='user' and SAMAccountName='abc123';<br />
<br />
</span><span class="default">$RS</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="string">(</span><span class="default">$strRS</span><span class="string">, </span><span class="default">$Conn</span><span class="string">, 1, 1);<br />
echo </span><span class="default">$RS</span><span class="keyword">[</span><span class="string">'givenname'] ." </span><span class="keyword">- </span><span class="string">". </span><span class="default">$RS</span><span class="keyword">[</span><span class="string">'sn'] ." </span><span class="keyword">- </span><span class="string">". </span><span class="default">$RS</span><span class="keyword">[</span><span class="string">'displayName'] ." </span><span class="keyword">- </span><span class="string">". </span><span class="default">$RS</span><span class="keyword">[</span><span class="string">'mail'] ." </span><span class="keyword">- </span><span class="string">".&nbsp; </span><span class="default">$RS</span><span class="keyword">[</span><span class="string">'SAMAccountName'] ."</span><span class="keyword">&lt;</span><span class="default">br</span><span class="keyword">&gt;</span><span class="string">";<br />
<br />
</span><span class="default">$RS</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="string">;<br />
</span><span class="default">$Conn</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="string">;<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61173""></a>
  <div class="note">
   
   <a href="#61173" class="date">27-Jan-2006 03:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
HOWTO list LDAP users.<br />
<br />
This CODE list one user from LDAP tree, but I' like list all user from LDAP one ou=Organization<br />
<br />
<span class="default">&lt;?php<br />
<br />
$ldaprdn </span><span class="keyword">= </span><span class="string">'cn=user,dc=domain,dc=org'</span><span class="keyword">; <br />
</span><span class="default">$ldappass </span><span class="keyword">= </span><span class="string">'password'</span><span class="keyword">;<br />
</span><span class="default">$sdn </span><span class="keyword">= </span><span class="string">'cn=user,ou=group,dc=domain,dc=org'</span><span class="keyword">;<br />
<br />
</span><span class="default">$ldapconn </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="string">"ldap://localhost"</span><span class="keyword">, </span><span class="default">389</span><span class="keyword">) <br />
or die(</span><span class="string">"Not connect: </span><span class="default">$ldaphost</span><span class="string"> "</span><span class="keyword">);<br />
<br />
if (</span><span class="default">$ldapconn</span><span class="keyword">) {<br />
<br />
</span><span class="comment">// binding to ldap server<br />
</span><span class="default">$ldapbind </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$ldaprdn</span><span class="keyword">, </span><span class="default">$ldappass</span><span class="keyword">);<br />
<br />
</span><span class="comment">// verify binding<br />
</span><span class="keyword">if (</span><span class="default">$ldapbind</span><span class="keyword">) {<br />
</span><span class="default">$filter</span><span class="keyword">=</span><span class="string">"uid=*"</span><span class="keyword">; <br />
</span><span class="default">$justthese </span><span class="keyword">= array(</span><span class="string">"uid"</span><span class="keyword">); <br />
<br />
</span><span class="default">$sr</span><span class="keyword">=</span><span class="default">ldap_read</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$srdn</span><span class="keyword">, </span><span class="default">$filter</span><span class="keyword">, </span><span class="default">$justthese</span><span class="keyword">);<br />
</span><span class="default">$entry </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$sr</span><span class="keyword">);<br />
<br />
} else {<br />
echo </span><span class="string">"LDAP conn ok..."</span><span class="keyword">;<br />
}<br />
<br />
}<br />
<br />
</span><span class="default">ldap_close</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span> <br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">"mail"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] . </span><span class="string">" mail adress "</span><span class="keyword">;<br />
echo </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">"sn"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] . </span><span class="string">" Name "</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56320""></a>
  <div class="note">
   <strong class="user">cruzfern at chuchuwa dot com dot ar</strong>
   <a href="#56320" class="date">30-Aug-2005 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The internal attributes (like createTimestamp, modifyTimestamp, etc), don't come by default (when the optional parameter attributes is not set). You have to specify it:<br />
<br />
&lt;?<br />
$r=ldap_search($ds,$base,$filter,array("createTimestamp"));<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50483""></a>
  <div class="note">
   <strong class="user">fmouse at fmp dot com</strong>
   <a href="#50483" class="date">01-Mar-2005 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that the Netscape Directory SDK (developer.netscape.com) referenced for LDAP filter information is no longer accepting connections.&nbsp;&nbsp; The A copy of RFC 2254 which defines the standard for string representations of LDAP filters can be found&nbsp; at <a href="http://www.ietf.org/rfc/rfc2254.txt" rel="nofollow" target="_blank">http://www.ietf.org/rfc/rfc2254.txt</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49905""></a>
  <div class="note">
   <strong class="user">openldap at mail dot doris dot cc</strong>
   <a href="#49905" class="date">11-Feb-2005 07:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 4.3.10<br />
<br />
I was trying to do an ldapsearch without a basedn.&nbsp; First, I tried with ' ', as suggested above, but it gave me invalid dn syntax error. <br />
<br />
ie: <br />
$sr=ldap_search($ds, ' ', $filter);<br />
Warning: ldap_search(): Search: Invalid DN syntax in ...<br />
<br />
Then I changed it to<br />
$sr=ldap_search($ds, "", $filter);<br />
<br />
Which gave me the following error:<br />
Warning: ldap_search(): Search: No such object in ...<br />
<br />
With that I then modified my ldap.conf file and commented out the BASE field<br />
#BASE&nbsp;&nbsp; dc=example, dc=com<br />
<br />
Then it worked!<br />
<br />
So it looks like if you supply a blank basedn, then it will use your default basedn in ldap.conf.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49889""></a>
  <div class="note">
   <strong class="user">rsu_friend at yahoo dot com</strong>
   <a href="#49889" class="date">11-Feb-2005 01:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was doing a ldap_search with<br />
$searchbasedn = "miDomainName=" . $_SESSION['selectDomain'] ."," . LDAP_DOMAINBASE;<br />
$filter = "(&amp;(mpsAccountNumber=". $acctNumber .")(objectclass=mpsAccountDetails))";&nbsp; &nbsp; <br />
$attributes = array("mpsparentchild");<br />
<br />
&nbsp;$sr = ldap_search($ldapconn, $searchbasedn, $filter,$attributes);&nbsp; <br />
<br />
For some reasone this search was failing<br />
but I was able to do successful search only when I gave the search filter as<br />
$filter = "(&amp;(mpsAccountNumber= $acctNumber )(objectclass=mpsAccountDetails))";&nbsp; &nbsp; <br />
<br />
I did not get why the ldap_search was not able to search in the first case.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45388""></a>
  <div class="note">
   <strong class="user">sema at technion dot ac dot il</strong>
   <a href="#45388" class="date">04-Sep-2004 10:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to perform the searches on Windows 2003 Server Active Directory you have to set the LDAP_OPT_REFERRALS option to 0:<br />
<br />
ldap_set_option($ldap, LDAP_OPT_REFERRALS, 0);<br />
<br />
Without this, you will get "Operations error" if you try to search the whole AD schema (using root of the domain as a $base_dn).<br />
<br />
As opposed to Windows 2000 Server, where this option was optional and only increased the performance.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37582""></a>
  <div class="note">
   <strong class="user">chester at the dot underground dot com dot au</strong>
   <a href="#37582" class="date">20-Nov-2003 01:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are searching active directory and are experiencing lag or time outs, it may be that you are being given ldap referrals from the ldap server. The following code will disable this.<br />
<br />
&lt;?<br />
ldap_set_option($connect, LDAP_OPT_REFERRALS, 0);<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37475""></a>
  <div class="note">
   <strong class="user">sembiance at cosmicrealms dot com</strong>
   <a href="#37475" class="date">16-Nov-2003 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When searching for BINARY data (such as an Active Directory objectGUID) you need to escape each hexadecimal character with a backslash.<br />
<br />
The following command line run of ldapsearch shows:<br />
ldapsearch -b "dc=blahblah,dc=com" "(objectGUID=\AE\C3\23\35\F7)"<br />
<br />
In PHP, you need to escape the escape for the backslash:<br />
ldap_search($ds,"dc=blahblah,dc=com", "(objectGUID=\\AE\\C3\\23\\35\\F7)");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37317""></a>
  <div class="note">
   <strong class="user">francis dot tyers at hp dot com</strong>
   <a href="#37317" class="date">10-Nov-2003 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
it seems that all fields must be used in lower case even if they are mixed case in the ldapsearch output.<br />
<br />
example:<br />
<br />
gidNumber: 1010<br />
homeDirectory: /home/dnt<br />
<br />
must be:<br />
<br />
echo "gid: " . $info[$i]["gidnumber"][0] . "&lt;br&gt;";<br />
echo "home directory: ". $info[$i]["homedirectory"][0] ."&lt;br&gt;";<br />
<br />
not ( $info[$i]["homeDirectory"][0] ) etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35095""></a>
  <div class="note">
   <strong class="user">nicolas at atanis dot net</strong>
   <a href="#35095" class="date">19-Aug-2003 11:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a little script that make a complete subtree search ( i know a script above seems do that but it doesnt work fine)<br />
This is my version:<br />
<br />
Voila ce que j'ai fait aujourd'hui ...<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $ldap_host = "192.168.0.50";<br />
&nbsp;&nbsp;&nbsp; $ldap_port = "389";<br />
&nbsp;&nbsp;&nbsp; $base_dn = "dc=fr";<br />
&nbsp;&nbsp;&nbsp; $filter = "(cn=*)";<br />
&nbsp;&nbsp;&nbsp; $ldap_user ="cn=admin,dc=fr";<br />
&nbsp;&nbsp;&nbsp; $ldap_pass = "hellodelu";<br />
&nbsp;&nbsp;&nbsp; $connect = ldap_connect( $ldap_host, $ldap_port);<br />
&nbsp;&nbsp;&nbsp; ldap_set_option($connect, LDAP_OPT_PROTOCOL_VERSION, 3);<br />
<br />
&nbsp;&nbsp;&nbsp; $bind = ldap_bind($connect, $ldap_user, $ldap_pass);<br />
&nbsp;&nbsp;&nbsp; $read = ldap_search($connect, $base_dn, $filter);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $info = ldap_get_entries($connect, $read); <br />
&nbsp;&nbsp;&nbsp; echo $info["count"]." entrees retournees&lt;BR&gt;&lt;BR&gt;"; <br />
&nbsp;&nbsp;&nbsp; for($ligne = 0; $ligne&lt;$info["count"]; $ligne++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($colonne = 0; $colonne&lt;$info[$ligne]["count"]; $colonne++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $data = $info[$ligne][$colonne];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo $data.":".$info[$ligne][$data][0]."&lt;BR&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "&lt;BR&gt;";<br />
&nbsp;&nbsp;&nbsp; }<br />
ldap_close($connect);<br />
<br />
--------<br />
nicolas</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35019""></a>
  <div class="note">
   <strong class="user">me at gavinadams dot org</strong>
   <a href="#35019" class="date">15-Aug-2003 01:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Minor clarification on AD LDAP searchs. Small typo in previous example, and does not display multiple values per attribute. Here's the for loop to enumerate all entries, attributes, and values:<br />
<br />
$bind = ldap_bind($connect) // asume anon connect or add user/pass<br />
&nbsp;&nbsp; &nbsp; or exit("&gt;&gt;Could not bind to $ldap_host&lt;&lt;");<br />
$read = ldap_search($connect, $base_dn, $filter)<br />
&nbsp;&nbsp; &nbsp; or exit("&gt;&gt;Unable to search ldap server&lt;&lt;");<br />
$info = ldap_get_entries($connect, $read);<br />
echo $info["count"]." entries returned&lt;br&gt;";<br />
// $i = entries<br />
// $ii = attributes for entry<br />
// $iii = values per attribute<br />
for ($i = 0; $i&lt;$info["count"]; $i++) {<br />
&nbsp; for ($ii=0; $ii&lt;$info[$i]["count"]; $ii++){<br />
&nbsp;&nbsp; &nbsp; $data = $info[$i][$ii];<br />
&nbsp;&nbsp; &nbsp; for ($iii=0; $iii&lt;$info[$i][$data]["count"]; $iii++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo $data.":&amp;nbsp;&amp;nbsp;".$info[$i][$data][$iii]."&lt;br&gt;";<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp; }<br />
echo "&lt;p&gt;"; // separate entries</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31171""></a>
  <div class="note">
   <strong class="user">php @ fccfurn dot com</strong>
   <a href="#31171" class="date">11-Apr-2003 03:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To do subtree search from top DN in Active Directory, Make sure you do your ldap_set_option().<br />
<br />
<span class="default">&lt;?php<br />
$ldap_host </span><span class="keyword">= </span><span class="string">"pdc.php.net"</span><span class="keyword">;<br />
</span><span class="default">$base_dn </span><span class="keyword">= </span><span class="string">"DC=php,DC=net"</span><span class="keyword">;<br />
</span><span class="default">$filter </span><span class="keyword">= </span><span class="string">"(cn=Joe User)"</span><span class="keyword">;<br />
</span><span class="default">$ldap_user&nbsp; </span><span class="keyword">= </span><span class="string">"CN=Joe User,OU=Sales,DC=php,DC=net"</span><span class="keyword">;<br />
</span><span class="default">$ldap_pass </span><span class="keyword">= </span><span class="string">"pass"</span><span class="keyword">;<br />
</span><span class="default">$connect </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">( </span><span class="default">$ldap_host</span><span class="keyword">, </span><span class="default">$ldap_port</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; or exit(</span><span class="string">"&gt;&gt;Could not connect to LDAP server&lt;&lt;"</span><span class="keyword">);<br />
</span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">LDAP_OPT_PROTOCOL_VERSION</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
</span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">LDAP_OPT_REFERRALS</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$bind </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$ldap_user</span><span class="keyword">, </span><span class="default">$ldap_pass</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; or exit(</span><span class="string">"&gt;&gt;Could not bind to </span><span class="default">$ldap_host</span><span class="string">&lt;&lt;"</span><span class="keyword">);<br />
</span><span class="default">$read </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$base_dn</span><span class="keyword">, </span><span class="default">$filter</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; or exit(</span><span class="string">"&gt;&gt;Unable to search ldap server&lt;&lt;"</span><span class="keyword">);<br />
</span><span class="default">$info </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$read</span><span class="keyword">);<br />
echo </span><span class="default">$info</span><span class="keyword">[</span><span class="string">"count"</span><span class="keyword">].</span><span class="string">" entries returned&lt;p&gt;"</span><span class="keyword">;<br />
</span><span class="default">$ii</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$ii</span><span class="keyword">&lt;</span><span class="default">$info</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">"count"</span><span class="keyword">]; </span><span class="default">$ii</span><span class="keyword">++){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$ii</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$data</span><span class="keyword">.</span><span class="string">":&amp;nbsp;&amp;nbsp;"</span><span class="keyword">.</span><span class="default">$info</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$data</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">ldap_close</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29838""></a>
  <div class="note">
   <strong class="user">Kamil Kukura &lt;kamk at nexen dot cz&gt;</strong>
   <a href="#29838" class="date">26-Feb-2003 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When I tried to search with empty base DN on OpenLDAP server which had "" namingContext I got result "no such object". In the log file there was query for dn: dc=example,dc=com (!).<br />
As a workaround, it seems it's enough to feed it with space (' ') as base DN - ldap_search($ds, ' ', '(...filter...)', ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28991""></a>
  <div class="note">
   <strong class="user">neumeyed at city dot bloomington dot in dot us</strong>
   <a href="#28991" class="date">29-Jan-2003 04:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A previous comment noted: "I've also noticed that the departmentNumber, employeeNumber (and maybe others in inetorgperson.schema) are not returned from a search."<br />
<br />
This is incorrect. These attributes are returned, but you must reference them with lowercase names. That is, instead of doing this:<br />
<br />
$entries[0]["departmentNumber"][0]<br />
<br />
Do this:<br />
<br />
$entries[0]["departmentnumber"][0]<br />
<br />
This doesn't seem like "correct" behavior to me, but I don't know enough about LDAP to say for sure.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28593""></a>
  <div class="note">
   <strong class="user">nick dot veitch at futurenet dot co dot</strong>
   <a href="#28593" class="date">17-Jan-2003 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It might be useful to list here the operators that work:<br />
<br />
=&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - matches exact value<br />
=*xxx&nbsp; - matches values ending xxx<br />
=xxx*&nbsp; - matches values beginning xxx<br />
=*xxx* - matches values containing xxx<br />
=*&nbsp; &nbsp; &nbsp;&nbsp; - matches all values (if set - NULLS are not returned)<br />
<br />
&gt;=xxx&nbsp; - matches everthing from xxx to end of directory<br />
&lt;=xxx&nbsp; - matches everything up to xxx in directory<br />
<br />
~=xxx&nbsp; &nbsp; &nbsp; - matches similar entries (not all systems)<br />
<br />
Boolean operators for constructing complex search<br />
<br />
&amp;(term1)(term2)&nbsp; - matches term1 AND term2<br />
| (term1)(term2)&nbsp; - matches term1 OR term2<br />
!(term1)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - matches NOT term1<br />
&amp;(|(term1)(term2))(!(&amp;(term1)(term2)) - matches XOR term1 term2<br />
<br />
some of the more compelx constructions seem to work with varying&nbsp; degrees of efficiency - sometimes it can be better to filter some of the results with the search and do further filtering in PHP.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25629""></a>
  <div class="note">
   <strong class="user">emrecio at netscape dot net</strong>
   <a href="#25629" class="date">30-Sep-2002 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
implode(", ",$uentry[0]["rfc822mailalias"]);<br />
<br />
doesn't work as expected because "count" is in there... one /must/ use the 'for' loop to cycle through results (discarding "count" element).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25050""></a>
  <div class="note">
   <strong class="user">jpdalbec at ysu dot edu</strong>
   <a href="#25050" class="date">09-Sep-2002 07:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found that spaces need to be escaped in search filters ("\20"), at least using the Red Hat PHP 4.1.2 package.&nbsp; Otherwise no results are returned.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22728""></a>
  <div class="note">
   <strong class="user">john_taylor_1973 at yahoo dot com</strong>
   <a href="#22728" class="date">27-Jun-2002 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Try to use ldap_list(), if possible.&nbsp; It is much faster.&nbsp; ldap_search searches a scope of LDAP_SCOPE_SUBTREE, but ldap_list searches a scope of just LDAP_SCOPE_ONELEVEL.&nbsp; This made a big difference on Novell eDirectory 8.6.1, even for a query that only returned 130 objects.&nbsp; Using an attribute list, the 4th function parameter (of either function), also made queries faster.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15215""></a>
  <div class="note">
   
   <a href="#15215" class="date">31-Aug-2001 07:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I used the following to retrieve all entries from an ILS (Netmeeting) Server:&lt;p&gt;&nbsp; &nbsp; $sr=ldap_search($ds, "objectclass=rtperson","(&amp;(cn=%)(objectclass=rtperson))");<br />
&lt;p&gt;Have fun!<br />
&lt;p&gt;Kees</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="10421""></a>
  <div class="note">
   <strong class="user">cdaveb at csua dot berkeley dot edu</strong>
   <a href="#10421" class="date">02-Jan-2001 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FYI, for those doing LDAP searches on Exchange servers, there seems to be some preference in Exchange to disallow searches that aren't initial searches (i.e. only x* will work, not * or *x). I'd been going nuts trying to figure out why I kept getting errors doing * searches.<br />
<br />
More info at:<br />
<a href="http://www.microsoft.com/Exchange/en/55/help/documents/server/XOG16007.HTM" rel="nofollow" target="_blank">http://www.microsoft.com/Exchange/en/55/help/documents/server/XOG16007.HTM</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="2376""></a>
  <div class="note">
   <strong class="user">aa529 at nospamchebucto dot ns dot ca</strong>
   <a href="#2376" class="date">22-Nov-1999 01:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful of special characters when generating filters from user input.<br />
<br />
*, (, ), \ and NUL should be backslash-escaped. See section 4 of RFC 2254 (I found it here:<br />
<a href="http://www.cis.ohio-state.edu/htbin/rfc/rfc2254.html" rel="nofollow" target="_blank">http://www.cis.ohio-state.edu/htbin/rfc/rfc2254.html</a>)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.ldap-sasl-bind.html">ldap_sasl_bind</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.ldap-set-option.html">ldap_set_option</a></div>
 <div class="up"><a href="ref.ldap.html">LDAP Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
