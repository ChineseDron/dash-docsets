<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Calculate the metaphone key of a string</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.md5.html">md5</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.money-format.html">money_format</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.metaphone" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">metaphone</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">metaphone</span> &mdash; <span class="dc-title">Calculate the metaphone key of a string</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.metaphone-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><b>metaphone</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$str</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$phonemes</tt><span class="initializer"> = 0</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   Calculates the metaphone key of <i><tt class="parameter">str</tt></i>.
  </p>
  <p class="para">
   Similar to <span class="function"><a href="function.soundex.html" class="function">soundex()</a></span> metaphone creates the same key for
   similar sounding words. It&#039;s more accurate than
   <span class="function"><a href="function.soundex.html" class="function">soundex()</a></span> as it knows the basic rules of English
   pronunciation.  The metaphone generated keys are of variable length.
  </p>
  <p class="para">
   Metaphone was developed by Lawrence Philips
   &lt;lphilips at verity dot com&gt;. It is described in [&quot;Practical
   Algorithms for Programmers&quot;, Binstock &amp; Rex, Addison Wesley,
   1995].
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.metaphone-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">str</tt></i></span>
     <dd>

      <p class="para">
       The input string.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">phonemes</tt></i></span>
     <dd>

      <p class="para">
       This parameter restricts the returned metaphone key to 
       <i><tt class="parameter">phonemes</tt></i> characters in length.
       The default value of <i>0</i> means no restriction.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.metaphone-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the metaphone key as a string,  or <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.metaphone-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="metaphone.example.basic">
    <p><b>Example #1 <span class="function"><b>metaphone()</b></span> basic example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programming'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programmer'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(7) &quot;PRKRMNK&quot;
string(6) &quot;PRKRMR&quot;
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="metaphone.example.phonemes">
    <p><b>Example #2 Using the <i><tt class="parameter">phonemes</tt></i> parameter</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programming'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programmer'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(5) &quot;PRKRM&quot;
string(5) &quot;PRKRM&quot;
</pre></div>
    </div>
   </div>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="97443""></a>
  <div class="note">
   <strong class="user">usedformyjunk at gmail dot com</strong>
   <a href="#97443" class="date">19-Apr-2010 11:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I submitted my spanish metaphone version previously on 13-Oct-2005 05:44, but it was hosted on Geocities which is now gone, so it can now be found here.<br />
<br />
Here is the link to my spanish metaphone implementation:<br />
<br />
<a href="http://www.calvilloweb.com/spanish_metaphone.php" rel="nofollow" target="_blank">http://www.calvilloweb.com/spanish_metaphone.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83095""></a>
  <div class="note">
   <strong class="user">Vipindas K.S</strong>
   <a href="#83095" class="date">09-May-2008 09:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
metaphone<br />
=======================<br />
The metaphone() function can be used for spelling applications.This function returns the metaphone key of the string on success, or FALSE on failure.Its main use is when you are searching a genealogy database. check to see if a metaphone search is offered. It is also useful in making/searching family tree.<br />
Given below is a simple code that calculates and compares two strings to find whether its metaphone codes are equivalent.<br />
<br />
html code<br />
==========<br />
&lt;html&gt;<br />
&lt;body&gt;<br />
&lt;form action="test.php" name="test" method="get"&gt;<br />
Name1:&lt;input type="text" name="name1" /&gt;&lt;br /&gt;<br />
Name2:&lt;input type="text" name="name2" /&gt;&lt;br /&gt;<br />
&lt;input type="submit" name="submit" value="compare" /&gt;<br />
&lt;/form&gt;<br />
<br />
&lt;!--php code begins here --&gt;<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'submit'</span><span class="keyword">]))<br />
{<br />
</span><span class="default">$str1 </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'name1'</span><span class="keyword">];<br />
</span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'name2'</span><span class="keyword">];<br />
</span><span class="default">$meta_one</span><span class="keyword">=</span><span class="default">metaphone</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">);<br />
</span><span class="default">$meta_two</span><span class="keyword">=</span><span class="default">metaphone</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">);<br />
echo </span><span class="string">"metaphone code for "</span><span class="keyword">.</span><span class="default">$str1</span><span class="keyword">.</span><span class="string">" is "</span><span class="keyword">. </span><span class="default">$meta_one</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"metaphone code for "</span><span class="keyword">.</span><span class="default">$str2</span><span class="keyword">.</span><span class="string">" is "</span><span class="keyword">. </span><span class="default">$meta_two</span><span class="keyword">.</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
if(</span><span class="default">$meta_one</span><span class="keyword">==</span><span class="default">$meta_two</span><span class="keyword">)<br />
{<br />
echo </span><span class="string">"metaphone codes are matching"</span><span class="keyword">;<br />
}<br />
else<br />
{<br />
echo </span><span class="string">"metaphone codes are not matching"</span><span class="keyword">;<br />
}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
&lt;/body&gt;<br />
&lt;/html&gt;<br />
<br />
Metaphone&nbsp; algorithm was developed by Lawrence Philips.<br />
<br />
Lawrence Philips' RULES follow:<br />
<br />
&nbsp;The 16 consonant sounds:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |--- ZERO represents "th"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
&nbsp;&nbsp; &nbsp;&nbsp; B&nbsp; X&nbsp; S&nbsp; K&nbsp; J&nbsp; T&nbsp; F&nbsp; H&nbsp; L&nbsp; M&nbsp; N&nbsp; P&nbsp; R&nbsp; 0&nbsp; W&nbsp; Y<br />
<br />
&nbsp;Exceptions:<br />
<br />
&nbsp;&nbsp; Beginning of word: "ae-", "gn", "kn-", "pn-", "wr-"&nbsp; ----&gt; drop first letter<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "Aebersold", "Gnagy", "Knuth", "Pniewski", "Wright"<br />
<br />
&nbsp;&nbsp; Beginning of word: "x"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ----&gt; change to "s"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; as in "Deng Xiaopeng"<br />
<br />
&nbsp;&nbsp; Beginning of word: "wh-"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ----&gt; change to "w"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; as in "Whalen"<br />
<br />
&nbsp;Transformations:<br />
<br />
&nbsp;&nbsp; B ----&gt; B&nbsp; &nbsp; &nbsp; unless at the end of word after "m", as in "dumb", "McComb"<br />
<br />
&nbsp;&nbsp; C ----&gt; X&nbsp; &nbsp; &nbsp; (sh) if "-cia-" or "-ch-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S&nbsp; &nbsp; &nbsp; if "-ci-", "-ce-", or "-cy-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; SILENT if "-sci-", "-sce-", or "-scy-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; &nbsp; &nbsp; otherwise, including in "-sch-"<br />
<br />
&nbsp;&nbsp; D ----&gt; J&nbsp; &nbsp; &nbsp; if in "-dge-", "-dgy-", or "-dgi-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; T&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; F ----&gt; F<br />
<br />
&nbsp;&nbsp; G ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if in "-gh-" and not at end or before a vowel<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in "-gn" or "-gned"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in "-dge-" etc., as in above rule<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; J&nbsp; &nbsp; &nbsp; if before "i", or "e", or "y" if not double "gg"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; H ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if after vowel and no vowel follows<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or after "-ch-", "-sh-", "-ph-", "-th-", "-gh-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; H&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; J ----&gt; J<br />
<br />
&nbsp;&nbsp; K ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if after "c"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; L ----&gt; L<br />
<br />
&nbsp;&nbsp; M ----&gt; M<br />
<br />
&nbsp;&nbsp; N ----&gt; N<br />
<br />
&nbsp;&nbsp; P ----&gt; F&nbsp; &nbsp; &nbsp; if before "h"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; P&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; Q ----&gt; K<br />
<br />
&nbsp;&nbsp; R ----&gt; R<br />
<br />
&nbsp;&nbsp; S ----&gt; X&nbsp; &nbsp; &nbsp; (sh) if before "h" or in "-sio-" or "-sia-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; T ----&gt; X&nbsp; &nbsp; &nbsp; (sh) if "-tia-" or "-tio-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; (th) if before "h"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; silent if in "-tch-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; T&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; V ----&gt; F<br />
<br />
&nbsp;&nbsp; W ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if not followed by a vowel<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; W&nbsp; &nbsp; &nbsp; if followed by a vowel<br />
<br />
&nbsp;&nbsp; X ----&gt; KS<br />
<br />
&nbsp;&nbsp; Y ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if not followed by a vowel<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Y&nbsp; &nbsp; &nbsp; if followed by a vowel<br />
<br />
&nbsp;&nbsp; Z ----&gt; S</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82103""></a>
  <div class="note">
   <strong class="user">php at casadebender dot com</strong>
   <a href="#82103" class="date">27-Mar-2008 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A double metaphone pecl module is available: <a href="http://pecl.php.net/package/doublemetaphone" rel="nofollow" target="_blank">http://pecl.php.net/package/doublemetaphone</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59046""></a>
  <div class="note">
   <strong class="user">altano at bigfoot dot com</strong>
   <a href="#59046" class="date">24-Nov-2005 01:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can find the source code of a working example on how to use metaphones for spell checking, plus a free MySQL database dump of American English words and their metaphones at <a href="http://dubi.org/spell-checker" rel="nofollow" target="_blank">http://dubi.org/spell-checker</a><br />
<br />
That should get you started on writing a spell-checker or whatever in no time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57748""></a>
  <div class="note">
   
   <a href="#57748" class="date">12-Oct-2005 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have a forum for spanish speakers and the speller that I was using was using the metaphone function&nbsp; and it didn't make a lot of sense. I looked for an equivalent&nbsp; metaphone function for spanish and I never even came close to find it, so I was very happy to find the functional DoubleMetaphone().&nbsp; Thanks to that function, I came up with this spanish_metaphone function.<br />
<br />
[Editor's Note: link is updated in a later comment]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43946""></a>
  <div class="note">
   <strong class="user">stpierre(ta)nebr]NOSPAM[wesleyan(tod)edu</strong>
   <a href="#43946" class="date">09-Jul-2004 11:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A C implementation of double metaphone is at <a href="http://www.cpan.org/modules/ by-authors/id/MAURICE/Text-DoubleMetaphone-0.07.tar.gz.&nbsp; (Sorry I had to break that URL up; wouldn" rel="nofollow" target="_blank">http://www.cpan.org/modules/ by-authors/id/MAURICE/Text-DoubleMetaphone-0.07.tar.gz.&nbsp; (Sorry I had to break that URL up; wouldn</a>'t let me post it otherwise.)&nbsp; If you really need double metaphone that badly, you could roll this into your PHP build for (I would suspect) substantial performance gains.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39076""></a>
  <div class="note">
   <strong class="user">mail at spam-off dot iaindooley dot com</strong>
   <a href="#39076" class="date">16-Jan-2004 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you can use the metaphone function quite effectively with phrases by taking the levenshtein distances between two metaphone codes, and then taking this as a percentage of the length of the original metaphone code. thus you can define a percentage error, (say 20%) and accept only matches that are closer than that. i've found this works quite effectively in a function i am using on my website where an album name that the user entered is verified against existing album names that may be similar. this is also an excellent way of people being able to vaguely remember a phrase and get several suggestions out of the database. so you could type "i stiched nine times" with an error percentage of, say, 50 and still get 'a stitch in time saves nine' back as a match.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37768""></a>
  <div class="note">
   <strong class="user">server: zinkconsulting.com user: galen@</strong>
   <a href="#37768" class="date">26-Nov-2003 02:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A small warning about the double metaphone function/class implemented in php: it's slow. Very slow. <br />
<br />
On my Mac OS X box it takes roughly 4 seconds to calculate the double_metaphone of a given string 1,000 times and set a variable to that value. Given the exact same code, the built in metaphone function takes a mere 0.03 seconds. That's a huge difference. For reference, soundex takes about 0.015 seconds. <br />
<br />
I had dreams of ranking my person database search results with double_metaphone, but with searches yielding a few thousand results sometimes, this isn't terribly reasonable. I'm back to basic metaphone functions.<br />
<br />
I'd suggest anyone considering the use of the double_metaphone functionality weigh the slight improvement in results with the fact it's 100 times slower than the php function metaphone. I believe this difference is probably due mostly to implementation and optimization (php code vs. optimized internal php function). <br />
<br />
Anybody up for writing a double_metaphone function for php? Maybe php 5?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="5251""></a>
  <div class="note">
   <strong class="user">davef at getacard dot com</strong>
   <a href="#5251" class="date">21-Apr-2000 06:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A good reference to explain how the metaphone stuff works (and show you a working example) is: <br />
<a href="http://www.lanw.com/java/phonetic/" rel="nofollow" target="_blank">http://www.lanw.com/java/phonetic/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.md5.html">md5</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.money-format.html">money_format</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
