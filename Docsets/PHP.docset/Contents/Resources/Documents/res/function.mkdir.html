<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Makes directory</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.lstat.html">lstat</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.move-uploaded-file.html">move_uploaded_file</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.mkdir" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mkdir</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mkdir</span> &mdash; <span class="dc-title">Makes directory</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.mkdir-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>mkdir</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$pathname</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$mode</tt><span class="initializer"> = 0777</span></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$recursive</tt><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$context</tt></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   Attempts to create the directory specified by pathname.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mkdir-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">pathname</tt></i></span>
     <dd>

      <p class="para">
       The directory path.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">mode</tt></i></span>
     <dd>

      <p class="para">
       The mode is 0777 by default, which means the widest possible
       access. For more information on modes, read the details
       on the <span class="function"><a href="function.chmod.html" class="function">chmod()</a></span> page.
      </p>
      <blockquote class="note"><p><b class="note">Note</b>: 
       <p class="para">
        <i><tt class="parameter">mode</tt></i> is ignored on Windows.
       </p>
      </p></blockquote>
      <p class="para">
       Note that you probably want to specify the mode as an octal number,
       which means it should have a leading zero. The mode is also modified
       by the current umask, which you can change using
       <span class="function"><a href="function.umask.html" class="function">umask()</a></span>.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">recursive</tt></i></span>
     <dd>

      <p class="para">
       Allows the creation of nested directories specified in the 
       <i><tt class="parameter">pathname</tt></i>. Defaults to <b><tt>FALSE</tt></b>.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">context</tt></i></span>
     <dd>

      <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">Context support was added
with PHP 5.0.0. For a description of <i>contexts</i>, refer to
<a href="book.stream.html" class="xref">Streams</a>.</span></p></blockquote>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mkdir-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <b><tt>TRUE</tt></b> on success or <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.mkdir-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.0.0</td>
       <td align="left">
        The <i><tt class="parameter">recursive</tt></i> parameter was added
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">5.0.0</td>
       <td align="left">
        As of PHP 5.0.0 <span class="function"><b>mkdir()</b></span> can also be used with
        <em class="emphasis">some</em> URL wrappers.  Refer to <a href="wrappers.html" class="xref">Supported Protocols and Wrappers</a> for a listing of which wrappers support
        <span class="function"><b>mkdir()</b></span>
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">4.2.0</td>
       <td align="left">
        The <i><tt class="parameter">mode</tt></i> parameter became optional.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mkdir-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-2207">
    <p><b>Example #1 <span class="function"><b>mkdir()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />mkdir</span><span style="color: #007700">(</span><span style="color: #DD0000">"/path/to/my/dir"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0700</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2208">
    <p><b>Example #2 <span class="function"><b>mkdir()</b></span> using the <i><tt class="parameter">recursive</tt></i> parameter</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Desired&nbsp;folder&nbsp;structure<br /></span><span style="color: #0000BB">$structure&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'./depth1/depth2/depth3/'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;create&nbsp;the&nbsp;nested&nbsp;structure,&nbsp;the&nbsp;$recursive&nbsp;parameter&nbsp;<br />//&nbsp;to&nbsp;mkdir()&nbsp;must&nbsp;be&nbsp;specified.<br /><br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$structure</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'Failed&nbsp;to&nbsp;create&nbsp;folders...'</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;...<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mkdir-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">When <a href="features.safe-mode.html" class="link">safe mode</a> is enabled, PHP checks whether
the directory in which the script is operating has the same UID (owner) as the
script that is being executed.</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mkdir-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.is-dir.html" class="function" rel="rdfs-seeAlso">is_dir()</a> - Tells whether the filename is a directory</span></li>    
    <li class="member"><span class="function"><a href="function.rmdir.html" class="function" rel="rdfs-seeAlso">rmdir()</a> - Removes directory</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="107265""></a>
  <div class="note">
   <strong class="user">getaufan at gmail dot com</strong>
   <a href="#107265" class="date">26-Jan-2012 07:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Help me, I try make directory <br />
<br />
mkdir("my-second-dir",0777,true); but doesn't work at my Linux Server.<br />
I make directory "my-second-dir" in "my-first-dir"<br />
And I have been tried chmod("my-first-dir",0777); before.<br />
<br />
Solution???</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107018""></a>
  <div class="note">
   <strong class="user">Mick</strong>
   <a href="#107018" class="date">28-Dec-2011 05:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was able to resolve this problem by ensuring the containing folder had write permission enabled (CHMOD 775) where I wanted to create a new folder.<br />
<br />
As others have said, it's worth checking, then double checking, the permissions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105227""></a>
  <div class="note">
   <strong class="user">matt at imaketheweb dot com</strong>
   <a href="#105227" class="date">03-Aug-2011 06:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're getting a Permission Denied error, but are certain the permissions and ownership where you are trying to create the directory are correct, check again:<br />
<br />
The location where you are trying to create the directory in must have the Execute permission for the owner trying to create it, regardless of if the folder is Readable, or Writable.<br />
<br />
This may be obvious to some, but was not to me at first. Hopefully this will save you the trouble I went through.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104752""></a>
  <div class="note">
   <strong class="user">pz</strong>
   <a href="#104752" class="date">05-Jul-2011 09:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mkdir works with stream wrappers, so it's ok to write mkdir('<a href="ftp://user:pass@server/mydir" rel="nofollow" target="_blank">ftp://user:pass@server/mydir</a>');<br />
<br />
which really made my day</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104301""></a>
  <div class="note">
   <strong class="user">toppi at kacke dot de</strong>
   <a href="#104301" class="date">07-Jun-2011 08:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have problems with the SAFE MODE Restriction in effect i.e. if you try to create and access to subdirectorys recursive you can use ftp-lib like this.<br />
<br />
<span class="default">&lt;?php<br />
<br />
DEFINE </span><span class="keyword">(</span><span class="string">'FTP_USER'</span><span class="keyword">,</span><span class="string">'yourUser'</span><span class="keyword">); <br />
</span><span class="default">DEFINE </span><span class="keyword">(</span><span class="string">'FTP_PASS'</span><span class="keyword">,</span><span class="string">'yourPassword'</span><span class="keyword">);<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Returns the created directory or false.<br />
&nbsp;*<br />
&nbsp;* @param Directory to create (String)<br />
&nbsp;* @return Created directory or false;<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">function </span><span class="default">mkDirFix </span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">,</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn_id </span><span class="keyword">= @</span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$conn_id</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (@</span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">FTP_USER</span><span class="keyword">, </span><span class="default">FTP_PASS</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$path </span><span class="keyword">as </span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currPath</span><span class="keyword">.=</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!@</span><span class="default">ftp_chdir</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">,</span><span class="default">$currPath</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!@</span><span class="default">ftp_mkdir</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">,</span><span class="default">$currPath</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">ftp_chmod</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">$currPath</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$currPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Maybe it helps.<br />
Toppi</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104153""></a>
  <div class="note">
   <strong class="user">nickcarenza at gmail dot com</strong>
   <a href="#104153" class="date">26-May-2011 01:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having trouble with the pathname, use:<br />
<br />
echo dirname( __FILE__ );<br />
<br />
That will show you the pathname of the current script and you will be able to use that to see where you have to start your pathname.<br />
<br />
I tried forever to do mkdir('dirname') and was getting permission denied. I can see now its because it was trying to create that folder up at home when i wanted it down in public_html.<br />
<br />
I hope this saves someone some time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103772""></a>
  <div class="note">
   <strong class="user">[Rakesh Verma] rakeshnsony at gmail dot com</strong>
   <a href="#103772" class="date">02-May-2011 11:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you are unable to create recursive folder(s) using 0755 mode in your php script.<br />
<br />
Then try it by changing your current user to apache and test it again. <br />
<br />
Hopefully you will get positive results</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102823""></a>
  <div class="note">
   <strong class="user">julius - grantzau - c-o-m</strong>
   <a href="#102823" class="date">08-Mar-2011 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remember to use clearstatcache()<br />
<br />
... when working with filesystem functions.<br />
<br />
Otherwise, as an example, you can get an error creating a folder (using mkdir) just after deleting it (using rmdir).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101213""></a>
  <div class="note">
   <strong class="user">Benjamin Rack</strong>
   <a href="#101213" class="date">02-Dec-2010 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be mentioned that - at least on Windows - when using UNC paths with mkdir the 2nd parameter $mode should not be specified. Otherwise mkdir fails to create the directory on the given UNC path.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100106""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#100106" class="date">25-Sep-2010 07:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The mode on your directory is affected by your current umask.&nbsp; It will end<br />
up having (&lt;mkdir-mode&gt; and (not &lt;umask&gt;)).&nbsp; If you want to create one<br />
that is publicly readable, do something like this:<br />
<br />
<span class="default">&lt;?php<br />
$oldumask </span><span class="keyword">= </span><span class="default">umask</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="string">'mydir'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">); </span><span class="comment">// or even 01777 so you get the sticky bit set<br />
</span><span class="default">umask</span><span class="keyword">(</span><span class="default">$oldumask</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
____________<br />
<a href="http://kuritelnye-smesi.od.ua" rel="nofollow" target="_blank">http://kuritelnye-smesi.od.ua</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99810""></a>
  <div class="note">
   <strong class="user">satis at clankiller dot com</strong>
   <a href="#99810" class="date">08-Sep-2010 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that in a shared environment I failed to take into account an existing umask when I did a mkdir(dirname, 0755).&nbsp; This ended up creating the directory (function returned true), but I didn't have rights to do anything inside the folder, nor could I even view that it existed via ftp.<br />
<br />
However, file_exists(dirname) returned true.&nbsp; Eventually I figured out what happened and was able to rmdir(dirname), then created the directory correctly.<br />
<br />
So, when writing scripts you expect to be portable, either use umask to set your umask accordingly, or do a straight mkdir(dirname) followed by chmod(dirname, 0755) (or whatever it is you're looking for).&nbsp; If you make the same mistake I did, you should be able to rmdir() or chmod() the folder so it's accessible.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99628""></a>
  <div class="note">
   <strong class="user">vishal at e-arth dot in</strong>
   <a href="#99628" class="date">27-Aug-2010 12:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I used the following syntax to create directory<br />
<br />
mkdir('mydir', 0777); <br />
<br />
directory get created but it's permissions not set to 777, that is why I am not able to upload the images in this folder. <br />
my server is linux<br />
any solutions??</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96990""></a>
  <div class="note">
   <strong class="user">jack dot sleight at gmail dot com</strong>
   <a href="#96990" class="date">26-Mar-2010 03:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using the recursive parameter bear in mind that if you're using chmod() after mkdir() to set the mode without it being modified by the value of uchar() you need to call chmod() on all created directories. ie:<br />
<br />
<span class="default">&lt;?php<br />
mkdir</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">chmod</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
May result in "/test1/test2" having a mode of 0777 but "/test1" still having a mode of 0755 from the mkdir() call. You'd need to do:<br />
<br />
<span class="default">&lt;?php<br />
mkdir</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">chmod</span><span class="keyword">(</span><span class="string">'/test1'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">chmod</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95891""></a>
  <div class="note">
   <strong class="user">michael at neo dot co dot il</strong>
   <a href="#95891" class="date">27-Jan-2010 07:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
sometimes the directory created with another mode than specified ( 0755 instead 0777&nbsp; etc).<br />
to solve that use :<br />
<br />
<span class="default">&lt;?php<br />
$old </span><span class="keyword">= </span><span class="default">umask</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">umask</span><span class="keyword">(</span><span class="default">$old</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92844""></a>
  <div class="note">
   <strong class="user">Brian S</strong>
   <a href="#92844" class="date">11-Aug-2009 08:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The example from "hinom - iMasters" below is broken -- here's a version that works:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">handleError</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'MY ERROR'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/** usage sample<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @handleError();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $php_errormsg;<br />
&nbsp;&nbsp;&nbsp; */<br />
</span><span class="keyword">}<br />
<br />
</span><span class="comment">// detect slash/backslash nomenclature dirname<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">( </span><span class="default">__FILE__ </span><span class="keyword">);<br />
</span><span class="default">$slash </span><span class="keyword">= </span><span class="string">'/'</span><span class="keyword">; <br />
<br />
(</span><span class="default">stristr</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$slash </span><span class="keyword">)) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="default">$slash </span><span class="keyword">= </span><span class="string">'\\'</span><span class="keyword">;<br />
</span><span class="default">define</span><span class="keyword">( </span><span class="string">'BASE_DIR'</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">. </span><span class="default">$slash </span><span class="keyword">);<br />
<br />
</span><span class="default">$folder&nbsp; </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// folder name<br />
</span><span class="default">$dirPath </span><span class="keyword">= </span><span class="default">BASE_DIR </span><span class="keyword">. </span><span class="default">$folder</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// folder path<br />
<br />
// print results<br />
</span><span class="keyword">echo </span><span class="default">$slash</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="default">$rs </span><span class="keyword">= @</span><span class="default">mkdir</span><span class="keyword">( </span><span class="default">$dirPath</span><span class="keyword">, </span><span class="default">0777 </span><span class="keyword">);<br />
@</span><span class="default">handleError</span><span class="keyword">();<br />
if( </span><span class="default">$rs </span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print success information<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'was done!'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;folder: &lt;a href="' </span><span class="keyword">. </span><span class="default">$folder </span><span class="keyword">. </span><span class="string">'"&gt;' </span><span class="keyword">. </span><span class="default">$folder </span><span class="keyword">. </span><span class="string">'&lt;/a&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;dirPath: ' </span><span class="keyword">. </span><span class="default">$dirPath</span><span class="keyword">;<br />
<br />
}else{<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print error information<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'an error was occurred. Attempting create folder'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;dirPath: ' </span><span class="keyword">. </span><span class="default">$dirPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;php_errormsg: ' </span><span class="keyword">. </span><span class="default">$php_errormsg</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
[EDIT by thiago AT php DOT net: This function has a fix from imran@curl.phptrack.com]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92678""></a>
  <div class="note">
   <strong class="user">ethaizone at hotmail dot com</strong>
   <a href="#92678" class="date">03-Aug-2009 01:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When I created folder on windows with mkdir, I found some problem from folder nam so I write this function.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">filename_safe</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$except </span><span class="keyword">= array(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">, </span><span class="string">'*'</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">, </span><span class="string">'&lt;'</span><span class="keyword">, </span><span class="string">'&gt;'</span><span class="keyword">, </span><span class="string">'|'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$except</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It can use with another functions about file system as file_put_contents to clean up file name.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89390""></a>
  <div class="note">
   <strong class="user">vlad at todosv dot com</strong>
   <a href="#89390" class="date">05-Mar-2009 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that you should NOT enter the $mode value with "" or '' sorrounding it.<br />
<br />
So, this should be valid:<br />
<span class="default">&lt;?php mkdir</span><span class="keyword">(</span><span class="string">"dir1/dir2"</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
But this is not:<br />
<span class="default">&lt;?php mkdir</span><span class="keyword">(</span><span class="string">"dir1/dir2"</span><span class="keyword">,</span><span class="string">"0777"</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
Nor this:<br />
<span class="default">&lt;?php mkdir</span><span class="keyword">(</span><span class="string">"dir1/dir2"</span><span class="keyword">,</span><span class="string">'0777'</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89069""></a>
  <div class="note">
   <strong class="user">d dot kok at kadova dot nl</strong>
   <a href="#89069" class="date">20-Feb-2009 12:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that when specifying the recursive option the function returns false anyway if the directory already exists. <br />
<br />
For some reason however I expected it to behave like `mkdir -p` on the command line which succeeds if the directory already exists.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87696""></a>
  <div class="note">
   <strong class="user">t-k-r at o2 dot pl</strong>
   <a href="#87696" class="date">17-Dec-2008 01:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Very simple script, may be useful to someone.<br />
Creating a directory structure liki this:<br />
<br />
0 ------ 0<br />
1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1<br />
2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 -------- 0<br />
3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 1<br />
4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 2<br />
5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3<br />
6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...<br />
7<br />
[....]<br />
e<br />
f<br />
<br />
Used by my as structure to store uploaded files:<br />
someone upload file -&gt; its name + microtime is md5 -&gt; first 3 letters of md5 string are first 3 subfolders in this folder structure, and at least file is stroed with md5 name.<br />
Naturally SQL- or other type - Database is needed to store infos about files position in this structure.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">for (</span><span class="default">$a</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;=</span><span class="default">15</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">),</span><span class="default">0755</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$b</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">&lt;=</span><span class="default">15</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">++) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">),</span><span class="default">0755</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$c</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$c</span><span class="keyword">&lt;=</span><span class="default">15</span><span class="keyword">;</span><span class="default">$c</span><span class="keyword">++) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">),</span><span class="default">0755</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85821""></a>
  <div class="note">
   <strong class="user">hinom - iMasters</strong>
   <a href="#85821" class="date">18-Sep-2008 10:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mkdir simple test with "exception handler"<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">handleError</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'MY ERROR'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/** usage sample<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @handleError();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $php_errormsg;<br />
&nbsp;&nbsp;&nbsp; */<br />
</span><span class="keyword">}<br />
<br />
</span><span class="comment">// detect slash/backslash nomenclature dirname<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">( </span><span class="default">__FILE__ </span><span class="keyword">);<br />
</span><span class="default">$slash </span><span class="keyword">= </span><span class="string">'/'</span><span class="keyword">; </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$slash </span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="default">$slash </span><span class="keyword">= </span><span class="string">'\\'</span><span class="keyword">;<br />
</span><span class="default">define</span><span class="keyword">( </span><span class="string">'BASE_DIR'</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">. </span><span class="default">$slash </span><span class="keyword">);<br />
<br />
</span><span class="default">$folder&nbsp; </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// folder name<br />
</span><span class="default">$dirPath </span><span class="keyword">= </span><span class="default">BASE_DIR </span><span class="keyword">. </span><span class="default">$folder</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// folder path<br />
<br />
// print results<br />
</span><span class="keyword">echo </span><span class="default">$slash</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="default">$rs </span><span class="keyword">= @</span><span class="default">mkdir</span><span class="keyword">( </span><span class="default">$dirPath</span><span class="keyword">, </span><span class="string">'0777' </span><span class="keyword">);<br />
@</span><span class="default">handleError</span><span class="keyword">();<br />
if( </span><span class="default">$rs </span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print success information<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'was done!'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;folder: &lt;a href="' </span><span class="keyword">. </span><span class="default">$folder </span><span class="keyword">. </span><span class="string">'"&gt;' </span><span class="keyword">. </span><span class="default">$folder </span><span class="keyword">. </span><span class="string">'&lt;/a&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;dirPath: ' </span><span class="keyword">. </span><span class="default">$dirPath</span><span class="keyword">;<br />
<br />
}else{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print error information<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'an error was occurred. Attempting create folder'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;dirPath: ' </span><span class="keyword">. </span><span class="default">$dirPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;php_errormsg: ' </span><span class="keyword">. </span><span class="default">$php_errormsg</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84458""></a>
  <div class="note">
   <strong class="user">php at mike2k dot com</strong>
   <a href="#84458" class="date">15-Jul-2008 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that all of the recursive mkdir functions coded below are no longer required - as of 5.0.0 it says the "recursive" flag is available. I just tested it, it properly works (and I would assume it works for streams and Windows as well, if not, then it would be a bug)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83265""></a>
  <div class="note">
   <strong class="user">GelaMu at GMail dot com</strong>
   <a href="#83265" class="date">17-May-2008 05:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Makes directory and returns BOOL(TRUE) if exists OR made.<br />
&nbsp;*<br />
&nbsp;* @param&nbsp; $path Path name<br />
&nbsp;* @return bool<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">rmkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">0755</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">"/\\\\/"</span><span class="keyword">, </span><span class="string">"/\/{2,}/"</span><span class="keyword">), </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">), </span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">ltrim</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">"/"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cp </span><span class="keyword">= </span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$c</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$cp</span><span class="keyword">) &amp;&amp; !@</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$cp</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cp </span><span class="keyword">.= </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return @</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81656""></a>
  <div class="note">
   <strong class="user">php at msn dot net</strong>
   <a href="#81656" class="date">08-Mar-2008 10:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Makes directory, returns TRUE if exists or made<br />
&nbsp;*<br />
&nbsp;* @param string $pathname The directory path.<br />
&nbsp;* @return boolean returns TRUE if exists or made or FALSE on failure.<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">function </span><span class="default">mkdir_recursive</span><span class="keyword">(</span><span class="default">$pathname</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$pathname</span><span class="keyword">)) || </span><span class="default">mkdir_recursive</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$pathname</span><span class="keyword">), </span><span class="default">$mode</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$pathname</span><span class="keyword">) || @</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$pathname</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81119""></a>
  <div class="note">
   <strong class="user">code at ashleyhunt dot co dot uk</strong>
   <a href="#81119" class="date">14-Feb-2008 11:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a script to create a recursive directory path on NAS or another server using Common Internet File System (CIFS)<br />
<br />
e.g. you already have a directory on a server<br />
\\server/share/dir1/dir2<br />
<br />
you want to create some more directories<br />
\\server/share/dir1/dir2/dir3/dir4<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">remote_mkpath</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">)&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(\/){2,}|(\\\){1,}/'</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$path</span><span class="keyword">); </span><span class="comment">//only forward-slash<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="string">"\\\\" </span><span class="keyword">. </span><span class="default">$server </span><span class="keyword">. </span><span class="string">"/"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$dirs </span><span class="keyword">AS </span><span class="default">$element</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="default">$element </span><span class="keyword">. </span><span class="string">"/"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">$i </span><span class="keyword">!= </span><span class="default">0</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)){ <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"something was wrong at : " </span><span class="keyword">. </span><span class="default">$path</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$path</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// example usage<br />
</span><span class="default">remote_mkpath</span><span class="keyword">(</span><span class="string">"SERVER"</span><span class="keyword">, </span><span class="string">"share/dir1/dir2/dir3/dir4"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Good luck!<br />
<br />
Ashley</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80553""></a>
  <div class="note">
   <strong class="user">david dot NOSPAM at ajnewmedia dot NOSPAM dot co dot uk</strong>
   <a href="#80553" class="date">21-Jan-2008 09:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
p-garcia : since PHP 5, setting the recursive flag (which currently has no notes in the manual entry) will allow you to create nested directories in the same way as Windows / Linux mkdir -p, so long as the webserver has permissions to write in the root directory of the path specified<br />
eg:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; mkdir </span><span class="keyword">(</span><span class="string">"./newdir1/newdir2/newdir3/"</span><span class="keyword">, </span><span class="default">0755</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// Returns TRUE if you have permission to write to the current directory <br />
&nbsp; //&nbsp;&nbsp; and creates nested directories with permissionsrwxr-xr-x<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80549""></a>
  <div class="note">
   <strong class="user">p-garcia at uniandes dot edu dot co</strong>
   <a href="#80549" class="date">21-Jan-2008 05:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a long time trying to catch the cause of the warning: "mkdir() [function.mkdir]: No such file or directory", I finally realized that this function is not recursive; I mean, that if you want to create the folder -for example- c:\temp\t1\t2, you must do:<br />
mkdir("c:\\temp\\t1") ;<br />
mkdir("c:\\temp\\t1\\t2") ;<br />
<br />
because mkdir is not like the windows mkdir where you can acomplish this in one single step.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77383""></a>
  <div class="note">
   <strong class="user">Michal Nazarewicz, mina86 at mina86 dot com</strong>
   <a href="#77383" class="date">27-Aug-2007 07:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On the other hand, splitting path on something else then a DIRECTORY_SEPARATOR may give unexpected results when someone accualy wants a file name with backslash in it! Moreover, neither Alan's nor pluto's code check for errors or return any value. Also, I don't like the isset($folder[$i]) technique -- there is a count() function you know.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">recursive_mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">0777</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$dirs</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$dirs</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; !</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It will only fail if someone specifies a mode which does not allow owner to create new entries in directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74925""></a>
  <div class="note">
   <strong class="user">kendsnyder at gmail dot com</strong>
   <a href="#74925" class="date">04-May-2007 08:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When creating directories in Windows, trailing periods (".") are ignored.&nbsp; for example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
mkdir</span><span class="keyword">(</span><span class="string">'c:/Buck Jr.'</span><span class="keyword">,</span><span class="default">0755</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// on Windows creates "c:/Buck Jr"<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="string">'c:/Elipses...'</span><span class="keyword">,</span><span class="default">0755</span><span class="keyword">);&nbsp; </span><span class="comment">// on Windows creates "c:/Elipses"<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="string">'c:/php.com'</span><span class="keyword">,</span><span class="default">0755</span><span class="keyword">);&nbsp; &nbsp;&nbsp; </span><span class="comment">// on Windows creates "c:/php.com"<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This is a Window's quirk, not a php shortcoming--meaning that you get the same results from a Window's command prompt.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73848""></a>
  <div class="note">
   <strong class="user">glenn at bengeweb dot co dot nz</strong>
   <a href="#73848" class="date">12-Mar-2007 09:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've discovered that since my (shared) hosting provider upgraded to PHP 5.1.6 , a script containing this mkdir doesn't work:<br />
<br />
<span class="default">&lt;?php<br />
mkdir</span><span class="keyword">(</span><span class="string">'/home/benge/photos/gallery1/extra_large/'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
but this does work:<br />
<span class="default">&lt;?php<br />
mkdir</span><span class="keyword">(</span><span class="string">'/home/benge/photos/gallery1/extra_large'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
the difference being, the trailing slash "/" after "extra_large.<br />
<br />
There were three ways to fix the problem:<br />
1. remove the trailing slash from the script code<br />
2. downgrade to &lt; PHP 5.1.6<br />
3. turn safe mode off<br />
<br />
I went with option 1.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73760""></a>
  <div class="note">
   <strong class="user">sean at pedlr dot com</strong>
   <a href="#73760" class="date">08-Mar-2007 08:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that although the documentation says that&nbsp; the default permissions for mkdir are 0777, this is not always the case.<br />
<br />
I'm running LAMP and without explicitly setting the permissions, the directories created had permissions of 0755.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72235""></a>
  <div class="note">
   <strong class="user">Ari Schulman (ario [] mail utexas edu)</strong>
   <a href="#72235" class="date">08-Jan-2007 03:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re: john 4t idserver d0t org, and djneoform at gmail dot com's posts from 27 Oct 2006:<br />
<br />
On Windows systems, several keywords are reserved and cannot be used as filenames, in addition to just CON and PRN.&nbsp; Attempting to create a folder with one of these names using mkdir will throw the unhelpful error "Invalid argument".&nbsp; According to <a href="http://msdn.microsoft.com/library/default.asp ?url=/library/en-us/fileio/fs/naming_a_file.asp :" rel="nofollow" target="_blank">http://msdn.microsoft.com/library/default.asp ?url=/library/en-us/fileio/fs/naming_a_file.asp :</a><br />
<br />
"Do not use the following reserved device names for the name of a file: CON, PRN, AUX, NUL, COM1, COM2, COM3, COM4, COM5, COM6, COM7, COM8, COM9, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8, and LPT9. Also avoid these names followed by an extension, for example, NUL.tx7.<br />
<br />
&nbsp;&nbsp;&nbsp; Windows NT:&nbsp; CLOCK$ is also a reserved device name."<br />
<br />
These keywords are also case-insensitive.&nbsp; I don't know what problems are posed by using these keywords with extensions, but I successfully created a folder named "con_f".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71880""></a>
  <div class="note">
   <strong class="user">fantasysportswire at yahoo dot com</strong>
   <a href="#71880" class="date">20-Dec-2006 06:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One small correction on a note from Frank in June 2006 on recursive directories under Windows.<br />
<br />
First - this should be in the documentation as its the only function that I know of that php does not fix the slashes automatically.<br />
<br />
Franks note stated:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $mypath</span><span class="keyword">=</span><span class="string">"testdir\subdir\test"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This doesn't work in windows:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $mypath</span><span class="keyword">=</span><span class="string">"testdir/subdir/test"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
----<br />
<br />
This will work a bit better :)<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $mypath</span><span class="keyword">=</span><span class="string">"testdir\\subdir\\test"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68855""></a>
  <div class="note">
   <strong class="user">PHGN</strong>
   <a href="#68855" class="date">13-Aug-2006 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've been wrestling with mkdir on a server with safe mode turned on (I think, I kept getting barmy permissions on the new dirs). <br />
<br />
In the end the solution was to use:<br />
exec (mkdir ...<br />
exec (chmod ...<br />
<br />
For this to work I had to use the setuid bit on the script itself. I tried this with the mkdir() function, but to no avail. (To do the setuid bit I ran chmod 4775 on the script file from the command line.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68207""></a>
  <div class="note">
   <strong class="user">kungla at gmail dot com</strong>
   <a href="#68207" class="date">18-Jul-2006 05:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Somehow the recursive version of mkdir didn't work for me on Mac and the workaraounds listed below alsow didn't work for me, so heres my solution:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mkdir_r</span><span class="keyword">(</span><span class="default">$dirName</span><span class="keyword">, </span><span class="default">$rights</span><span class="keyword">=</span><span class="default">0777</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$dirName</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">.=</span><span class="default">$part</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) &amp;&amp; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$rights</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Tested and works ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64136""></a>
  <div class="note">
   <strong class="user">jamespilcher1hotmail</strong>
   <a href="#64136" class="date">08-Apr-2006 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
one small gotcha:<br />
<br />
mkdir(""), mkdir(false), and mkdir(null) give a "file exists" error. this is also true of a directory name consisting of any string that only contains space characters.<br />
<br />
(this was on php 5.1.2 on Windows 2000)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63406""></a>
  <div class="note">
   <strong class="user">bat at flurf dot net</strong>
   <a href="#63406" class="date">21-Mar-2006 09:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A little understanding of LISPlike programming makes this sort of task (recursive mkdir()ing in PHP4) much simpler.&nbsp; This version works nicely:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">MakeDirectory</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">0755</span><span class="keyword">)<br />
{<br />
&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) || @</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">$mode</span><span class="keyword">)) return </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp; if (!</span><span class="default">MakeDirectory</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">),</span><span class="default">$mode</span><span class="keyword">)) return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp; return @</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">$mode</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
How it works: line one attempts to make the directory, and returns TRUE if it works or if it already exists.&nbsp; That's the easy case if the parent directories all exist.<br />
<br />
Line two trims off the last directory name using dirname(), and calls MakeDirectory recursively on that shorter directory.&nbsp; If that fails, it returns FALSE, but otherwise we come out of it knowing that the parent directory definitely exists.<br />
<br />
Finally, presuming the recursive call worked, once we get to line three we can create the requested directory.<br />
<br />
Note the use of @ to suppress warning messages from mkdir.<br />
<br />
The beauty of this is that if, say, the great-grandparent directory exists but the grandparent and parent directories don't, the function will simply call itself recursively until it gets high enough up the tree to do some work, then carry on unwinding back until all the new directories have been created.<br />
<br />
This is pretty bog-standard recursive programming.&nbsp; Anyone who can't wrap their head around it after a few minutes of concentration should probably try a career in sales.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62852""></a>
  <div class="note">
   <strong class="user">Ali Baba</strong>
   <a href="#62852" class="date">10-Mar-2006 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Greg, your code does not work for me; maybe it has a bug or we have configuration changes. Anyway, this one works to create recursively the directory DIRECTORY. <br />
<br />
&lt;?<br />
define ("DIRECTORY", "/tmp/mydir/mysubdir");<br />
<br />
do {<br />
&nbsp;&nbsp;&nbsp; $dir = DIRECTORY;<br />
&nbsp;&nbsp;&nbsp; while (!is_dir($dir)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $basedir = dirname($dir);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($basedir == '/' || is_dir($basedir))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mkdir($dir,0777);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $dir=$basedir;<br />
&nbsp;&nbsp; }<br />
} while ($dir != DIRECTORY);<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60861""></a>
  <div class="note">
   
   <a href="#60861" class="date">18-Jan-2006 09:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function mkdirs($dir, $mode = 0777, $recursive = true) {<br />
&nbsp; if( is_null($dir) || $dir === "" ){<br />
&nbsp;&nbsp;&nbsp; return FALSE;<br />
&nbsp; }<br />
&nbsp; if( is_dir($dir) || $dir === "/" ){<br />
&nbsp;&nbsp;&nbsp; return TRUE;<br />
&nbsp; }<br />
&nbsp; if( mkdirs(dirname($dir), $mode, $recursive) ){<br />
&nbsp;&nbsp;&nbsp; return mkdir($dir, $mode);<br />
&nbsp; }<br />
&nbsp; return FALSE;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60051""></a>
  <div class="note">
   <strong class="user">Sean  at  seanj dot jcink dot com</strong>
   <a href="#60051" class="date">23-Dec-2005 06:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Mkdir will work on parent directories as long as file permissions are right and the openbase restriction is not on.<br />
<br />
~Sean</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58393""></a>
  <div class="note">
   <strong class="user">Kevin Cook</strong>
   <a href="#58393" class="date">02-Nov-2005 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I could not get the sticky bit set properly using the octal mode: 2775 (rwxrwsr-x)<br />
<br />
$foo='my_directory';<br />
<br />
$old_umask = umask(0);<br />
mkdir($foo,2775);<br />
umask($old_umask);<br />
<br />
using the above lines renders a directory with permissions:<br />
<br />
d-wx-wSrwt&nbsp; 2 www www 4096 Nov&nbsp; 2 11:43 my_directory<br />
<br />
Not exactly what I was looking for.<br />
<br />
This gets closer to the mark:<br />
<br />
$foo='my_directory';<br />
<br />
$old_umask = umask(0);<br />
mkdir($foo,0777); // the default chmod<br />
umask($old_umask);<br />
<br />
drwxrwsrwx&nbsp; 2 www www 4096 Nov&nbsp; 2 11:46 my_directory</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57680""></a>
  <div class="note">
   <strong class="user">ephraim at coder-board dot info</strong>
   <a href="#57680" class="date">10-Oct-2005 11:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When safe_mode is enabled, and you create a directory via mkdir, you can't create a second inside the first because the first folder's user is that one of the webserver and not that one of the script. This is dumb and very annoying :(</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56850""></a>
  <div class="note">
   <strong class="user">funke</strong>
   <a href="#56850" class="date">16-Sep-2005 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ive onlybeen coding in PHP for a couple of months so i Don't have all the syntax tricks down yet.<br />
<br />
I wrote this function to create all the dirs in a path if they don't exist. its not actually recursive but i was to lazy to change the name&nbsp; :)<br />
theoretically i want it to work for both win and nix. As soon my project manager gets me a win box i'm gonna test it out.&nbsp; anyrevisions to the function below would be appreciated.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// \<br />
<br />
</span><span class="keyword">function </span><span class="default">recur_mkdirs</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">0777</span><span class="keyword">) </span><span class="comment">//creates directory tree recursively<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//$GLOBALS["dirseparator"]<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">"dirseparator"</span><span class="keyword">],</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="string">"."</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$pos </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) { </span><span class="comment">// note: three equal signs<br />
&nbsp;&nbsp; &nbsp; &nbsp; // not found, means path ends in a dir not file<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subamount</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subamount</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$c</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$dirs</span><span class="keyword">) - </span><span class="default">$subamount</span><span class="keyword">; </span><span class="default">$c</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thispath</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$cc</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$cc </span><span class="keyword">&lt;= </span><span class="default">$c</span><span class="keyword">; </span><span class="default">$cc</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thispath</span><span class="keyword">.=</span><span class="default">$dirs</span><span class="keyword">[</span><span class="default">$cc</span><span class="keyword">].</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">"dirseparator"</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$thispath</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//print "$thispath&lt;br&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$thispath</span><span class="keyword">,</span><span class="default">$mode</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53075""></a>
  <div class="note">
   <strong class="user">roth at egotec dot com</strong>
   <a href="#53075" class="date">22-May-2005 11:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The 'mkdir' function doesn't function correctly on Windows when the path<br />
contains forward slashes. The part of the path with the forward slashes<br />
doesn't get created.<br />
<br />
mkdir('c:/a/b/c/d', 0775, true);<br />
<br />
You get the error message:<br />
Warning: mkdir() [function.mkdir]: No such file or directory<br />
<br />
Please use backslashes under Windows or use the constant DIRECTORY_SEPARATOR.<br />
<br />
mkdir('c:\a\b\c\d', 0775, true);<br />
mkdir('c:'.DIRECTORY_SEPARATOR.'a'.<br />
DIRECTORY_SEPARATOR.'b'.<br />
DIRECTORY_SEPARATOR.'c'.<br />
DIRECTORY_SEPARATOR.'d', 0775, true);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52355""></a>
  <div class="note">
   <strong class="user">webmaster2007 at home dot nl</strong>
   <a href="#52355" class="date">28-Apr-2005 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Maybe you can use this:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">open_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$newdir</span><span class="keyword">){&nbsp; &nbsp; </span><span class="comment">//The function that will copy the files<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) &amp;&amp; </span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$open_dir</span><span class="keyword">=</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$open_dir</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">) &amp;&amp; </span><span class="default">filetype</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">) != </span><span class="string">"dir"</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">filetype</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">) == </span><span class="string">"dir"</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">open_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">copy</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">open_dir</span><span class="keyword">(</span><span class="string">"Your source map"</span><span class="keyword">, </span><span class="string">"Your destination map"</span><span class="keyword">); </span><span class="comment">//Here you can fill in your source en destination map<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50568""></a>
  <div class="note">
   <strong class="user">Protik Mukherjee</strong>
   <a href="#50568" class="date">03-Mar-2005 09:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mkdir, file rw, permission related notes for Fedora 3////<br />
If you are using Fedora 3 and are facing permission problems, better check if SElinux is enabled on ur system. It add an additional layer of security and as a result PHP cant write to the folder eventhough it has 777 permissions. It took me almost a week to deal with this!<br />
<br />
If you are not sure google for SElinux or 'disabling SELinux' and it may be the cure! Best of luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33513""></a>
  <div class="note">
   
   <a href="#33513" class="date">28-Jun-2003 04:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You might notice that when you create a new directory using this code:<br />
<br />
mkdir($dir, 0777);<br />
<br />
The created folder actually has permissions of 0755, instead of the specified<br />
0777. Why is this you ask? Because of umask(): <a href="http://www.php.net/umask" rel="nofollow" target="_blank">http://www.php.net/umask</a><br />
<br />
The default value of umask, at least on my setup, is 18. Which is 22 octal, or<br />
0022. This means that when you use mkdir() to CHMOD the created folder to 0777,<br />
PHP takes 0777 and substracts the current value of umask, in our case 0022, so<br />
the result is 0755 - which is not what you wanted, probably.<br />
<br />
The "fix" for this is simple, include this line:<br />
<br />
$old_umask = umask(0);<br />
<br />
Right before creating a folder with mkdir() to have the actual value you put be<br />
used as the CHMOD. If you would like to return umask to its original value when<br />
you're done, use this:<br />
<br />
umask($old_umask);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="1207""></a>
  <div class="note">
   <strong class="user">aulbach at unter dot franken dot de</strong>
   <a href="#1207" class="date">22-Jul-1999 02:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an annotation from Stig Bakken:<br />
<br />
The mode on your directory is affected by your current umask.&nbsp; It will end<br />
up having (&lt;mkdir-mode&gt; and (not &lt;umask&gt;)).&nbsp; If you want to create one<br />
that is publicly readable, do something like this:<br />
<br />
<span class="default">&lt;?php<br />
$oldumask </span><span class="keyword">= </span><span class="default">umask</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="string">'mydir'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">); </span><span class="comment">// or even 01777 so you get the sticky bit set<br />
</span><span class="default">umask</span><span class="keyword">(</span><span class="default">$oldumask</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.lstat.html">lstat</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.move-uploaded-file.html">move_uploaded_file</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
