<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Send a message to a message queue</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.msg-remove-queue.html">msg_remove_queue</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.msg-set-queue.html">msg_set_queue</a></div>
 <div class="up"><a href="ref.sem.html">Semaphore Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.msg-send" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">msg_send</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5)</p><p class="refpurpose"><span class="refname">msg_send</span> &mdash; <span class="dc-title">Send a message to a message queue</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.msg-send-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>msg_send</b></span>
    ( <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$queue</tt></span>
   , <span class="methodparam"><span class="type">int</span> <tt class="parameter">$msgtype</tt></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$message</tt></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$serialize</tt><span class="initializer"> = true</span></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$blocking</tt><span class="initializer"> = true</span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter reference">&$errorcode</tt></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>msg_send()</b></span> sends a <i><tt class="parameter">message</tt></i> of type
   <i><tt class="parameter">msgtype</tt></i> (which MUST be greater than 0) to
   the message queue specified by <i><tt class="parameter">queue</tt></i>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.msg-send-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">queue</tt></i></span>
     <dd>

      <p class="para">
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">msgtype</tt></i></span>
     <dd>

      <p class="para">
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">message</tt></i></span>
     <dd>

      <p class="para">
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">serialize</tt></i></span>
     <dd>

      <p class="para">
       The optional <i><tt class="parameter">serialize</tt></i> controls how the
       <i><tt class="parameter">message</tt></i> is sent.  <i><tt class="parameter">serialize</tt></i>
       defaults to <b><tt>TRUE</tt></b> which means that the <i><tt class="parameter">message</tt></i> is
       serialized using the same mechanism as the session module before being
       sent to the queue.  This allows complex arrays and objects to be sent to
       other PHP scripts, or if you are using the WDDX serializer, to any WDDX
       compatible client.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">blocking</tt></i></span>
     <dd>

      <p class="para">
       If the message is too large to fit in the queue, your script will wait
       until another process reads messages from the queue and frees enough
       space for your message to be sent.
       This is called blocking; you can prevent blocking by setting the
       optional <i><tt class="parameter">blocking</tt></i> parameter to <b><tt>FALSE</tt></b>, in which
       case <span class="function"><b>msg_send()</b></span> will immediately return <b><tt>FALSE</tt></b> if the
       message is too big for the queue, and set the optional
       <i><tt class="parameter">errorcode</tt></i> to <b><tt>MSG_EAGAIN</tt></b>,
       indicating that you should try to send your message again a little
       later on.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">errorcode</tt></i></span>
     <dd>

      <p class="para">
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.msg-send-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <b><tt>TRUE</tt></b> on success or <b><tt>FALSE</tt></b> on failure.
  </p>
  <p class="para">
   Upon successful completion the message queue data structure is updated as
   follows: <i><tt class="parameter">msg_lspid</tt></i> is set to the process-ID of the
   calling process, <i><tt class="parameter">msg_qnum</tt></i> is incremented by 1 and
   <i><tt class="parameter">msg_stime</tt></i> is set to the current time.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.msg-send-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.msg-remove-queue.html" class="function" rel="rdfs-seeAlso">msg_remove_queue()</a> - Destroy a message queue</span></li>
    <li class="member"><span class="function"><a href="function.msg-receive.html" class="function" rel="rdfs-seeAlso">msg_receive()</a> - Receive a message from a message queue</span></li>
    <li class="member"><span class="function"><a href="function.msg-stat-queue.html" class="function" rel="rdfs-seeAlso">msg_stat_queue()</a> - Returns information from the message queue data structure</span></li>
    <li class="member"><span class="function"><a href="function.msg-set-queue.html" class="function" rel="rdfs-seeAlso">msg_set_queue()</a> - Set information in the message queue data structure</span></li>
   </ul>
  </p>
 </div>
  

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="94101""></a>
  <div class="note">
   <strong class="user">michael dot NO dot SP dot AM dot cordover+php at gmail dot com</strong>
   <a href="#94101" class="date">16-Oct-2009 04:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After about an hour of debugging I've discovered the meaning of the undocumented "PHP Warning: msg_send(): msgsnd failed: Invalid argument" ($errorcode = 13).<br />
<br />
This occurred when the size of $message was larger than msg_qbytes (see msg_stat_queue() for how to determine and change msg_qbytes).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91944""></a>
  <div class="note">
   <strong class="user">shepik at yandex dot ru</strong>
   <a href="#91944" class="date">02-Jul-2009 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
$msgtype used in msg_send function can be any positive integer.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83197""></a>
  <div class="note">
   <strong class="user">bryan-boone at msn dot com</strong>
   <a href="#83197" class="date">14-May-2008 03:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think it is kinda lame why I cannot find out (easily) explicitly which types of messages are allowed and which ones are not.&nbsp; Maybe we can start our own little list.&nbsp; I know that strings work, and arrays do not.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31116""></a>
  <div class="note">
   <strong class="user">webmaster at toolshed51 dot com</strong>
   <a href="#31116" class="date">10-Apr-2003 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sample sending webpage, see msg_receive for matching service<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $MSGKEY </span><span class="keyword">= </span><span class="default">519051</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$msg_id </span><span class="keyword">= </span><span class="default">msg_get_queue </span><span class="keyword">(</span><span class="default">$MSGKEY</span><span class="keyword">, </span><span class="default">0600</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">msg_send </span><span class="keyword">(</span><span class="default">$msg_id</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="string">'Hi'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">, </span><span class="default">$msg_err</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Msg not sent because </span><span class="default">$msg_err</span><span class="string">\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.msg-remove-queue.html">msg_remove_queue</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.msg-set-queue.html">msg_set_queue</a></div>
 <div class="up"><a href="ref.sem.html">Semaphore Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
