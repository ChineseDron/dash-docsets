<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Fetch a result row as an associative array</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.mysql-fetch-array.html">mysql_fetch_array</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.mysql-fetch-field.html">mysql_fetch_field</a></div>
 <div class="up"><a href="ref.mysql.html">MySQL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.mysql-fetch-assoc" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_fetch_assoc</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.3, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_fetch_assoc</span> &mdash; <span class="dc-title">Fetch a result row as an associative array</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-fetch-assoc-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><b>mysql_fetch_assoc</b></span>
    ( <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$result</tt></span>
   )</div>

  <p class="para rdfs-comment">
   Returns an associative array that corresponds to the fetched row
   and moves the internal data pointer ahead.
   <span class="function"><b>mysql_fetch_assoc()</b></span> is equivalent to calling
   <span class="function"><a href="function.mysql-fetch-array.html" class="function">mysql_fetch_array()</a></span> with MYSQL_ASSOC for the
   optional second parameter. It only returns an associative array.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-fetch-assoc-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>
<span class="term"><i><tt class="parameter">
result</tt></i></span><dd>
<p class="para">The result <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> that
is being evaluated. This result comes from a call to
<span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span>.</p></dd>
</dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-fetch-assoc-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns an associative array of strings that corresponds to the fetched row, or 
   <b><tt>FALSE</tt></b> if there are no more rows.
  </p>
  <p class="para">
   If two or more columns of the result have the same field names,
   the last column will take precedence. To access the other
   column(s) of the same name, you either need to access the
   result with numeric indices by using
   <span class="function"><a href="function.mysql-fetch-row.html" class="function">mysql_fetch_row()</a></span> or add alias names.
   See the example at the <span class="function"><a href="function.mysql-fetch-array.html" class="function">mysql_fetch_array()</a></span>
   description about aliases.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mysql-fetch-assoc-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-1515">
    <p><b>Example #1 An expanded <span class="function"><b>mysql_fetch_assoc()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mysql_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mysql_password"</span><span style="color: #007700">);<br /><br />if&nbsp;(!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Unable&nbsp;to&nbsp;connect&nbsp;to&nbsp;DB:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br />&nbsp;&nbsp;<br />if&nbsp;(!</span><span style="color: #0000BB">mysql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">"mydbname"</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Unable&nbsp;to&nbsp;select&nbsp;mydbname:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;id&nbsp;as&nbsp;userid,&nbsp;fullname,&nbsp;userstatus&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;sometable<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;userstatus&nbsp;=&nbsp;1"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /><br />if&nbsp;(!</span><span style="color: #0000BB">$result</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;successfully&nbsp;run&nbsp;query&nbsp;(</span><span style="color: #0000BB">$sql</span><span style="color: #DD0000">)&nbsp;from&nbsp;DB:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br />if&nbsp;(</span><span style="color: #0000BB">mysql_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"No&nbsp;rows&nbsp;found,&nbsp;nothing&nbsp;to&nbsp;print&nbsp;so&nbsp;am&nbsp;exiting"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;While&nbsp;a&nbsp;row&nbsp;of&nbsp;data&nbsp;exists,&nbsp;put&nbsp;that&nbsp;row&nbsp;in&nbsp;$row&nbsp;as&nbsp;an&nbsp;associative&nbsp;array<br />//&nbsp;Note:&nbsp;If&nbsp;you're&nbsp;expecting&nbsp;just&nbsp;one&nbsp;row,&nbsp;no&nbsp;need&nbsp;to&nbsp;use&nbsp;a&nbsp;loop<br />//&nbsp;Note:&nbsp;If&nbsp;you&nbsp;put&nbsp;extract($row);&nbsp;inside&nbsp;the&nbsp;following&nbsp;loop,&nbsp;you'll<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;create&nbsp;$userid,&nbsp;$fullname,&nbsp;and&nbsp;$userstatus<br /></span><span style="color: #007700">while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"userid"</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"fullname"</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"userstatus"</span><span style="color: #007700">];<br />}<br /><br /></span><span style="color: #0000BB">mysql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-fetch-assoc-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <b>Performance</b><br />
   <p class="para">
    An important thing to note is that using 
    <span class="function"><b>mysql_fetch_assoc()</b></span> is <em class="emphasis">not 
    significantly</em> slower than using
    <span class="function"><a href="function.mysql-fetch-row.html" class="function">mysql_fetch_row()</a></span>, while it 
    provides a significant added value.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">Field names returned by this function
are <em class="emphasis">case-sensitive</em>.</span></p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">This function sets NULL fields to
the PHP <b><tt>NULL</tt></b> value.</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-fetch-assoc-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-fetch-row.html" class="function" rel="rdfs-seeAlso">mysql_fetch_row()</a> - Get a result row as an enumerated array</span></li>
    <li class="member"><span class="function"><a href="function.mysql-fetch-array.html" class="function" rel="rdfs-seeAlso">mysql_fetch_array()</a> - Fetch a result row as an associative array, a numeric array, or both</span></li>
    <li class="member"><span class="function"><a href="function.mysql-data-seek.html" class="function" rel="rdfs-seeAlso">mysql_data_seek()</a> - Move internal result pointer</span></li>
    <li class="member"><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - Send a MySQL query</span></li>
    <li class="member"><span class="function"><a href="function.mysql-error.html" class="function" rel="rdfs-seeAlso">mysql_error()</a> - Returns the text of the error message from previous MySQL operation</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="107038""></a>
  <div class="note">
   <strong class="user">andy dot g dot mac at gmail dot com</strong>
   <a href="#107038" class="date">30-Dec-2011 01:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use the MySQL MAX() function as part of your query, reference it with, for example:<br />
<span class="default">&lt;?php<br />
$ID </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'MAX(ID)'</span><span class="keyword">];<br />
</span><span class="default">?&gt;<br />
</span>not<br />
<span class="default">&lt;?php<br />
$ID </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'MAX(`ID`)'</span><span class="keyword">];<br />
</span><span class="default">?&gt;<br />
</span>as I tried ... I hope that saves someone a few minutes ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107008""></a>
  <div class="note">
   <strong class="user">Gorm</strong>
   <a href="#107008" class="date">28-Dec-2011 04:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function to retrieve _all_ fields as fully qualified names:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mysql_fetch_assoc_fullname</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Does the same thing a as mysql_fetch_assoc, but the keys are fully qualified like &lt;table name&gt;.&lt;field name&gt;.<br />
&nbsp;&nbsp;&nbsp; // That way all fields is perserved and adressable like mysql_fetch_row is.<br />
&nbsp;&nbsp;&nbsp; // table name will be blank if its a computed field. F.ex: 'select 5+5 as ten' will give array('.ten' =&gt; 10)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$f </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$f </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">mysql_field_table</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">, </span><span class="default">$k</span><span class="keyword">) . </span><span class="string">'.' </span><span class="keyword">. </span><span class="default">mysql_field_name</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">, </span><span class="default">$k</span><span class="keyword">)] = </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$tmp</span><span class="keyword">;<br />
&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90416""></a>
  <div class="note">
   <strong class="user">george at georgefisher dot com</strong>
   <a href="#90416" class="date">21-Apr-2009 07:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks to to R. Bradley for the implode idea. The following fixes a few bugs and includes quote_smart functionality (and has been tested)<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mysql_insert_assoc </span><span class="keyword">(</span><span class="default">$my_table</span><span class="keyword">, </span><span class="default">$my_array</span><span class="keyword">) {<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp; // Insert values into a MySQL database<br />
&nbsp;&nbsp; // Includes quote_smart code to foil SQL Injection<br />
&nbsp;&nbsp; //<br />
&nbsp;&nbsp; // A call to this function of:<br />
&nbsp;&nbsp; //<br />
&nbsp;&nbsp; //&nbsp; $val1 = "foobar";<br />
&nbsp;&nbsp; //&nbsp; $val2 = 495;<br />
&nbsp;&nbsp; //&nbsp; mysql_insert_assoc("tablename", array(col1=&gt;$val1, col2=&gt;$val2, col3=&gt;"val3", col4=&gt;720, col5=&gt;834.987));<br />
&nbsp;&nbsp; //<br />
&nbsp;&nbsp; // Sends the following query:<br />
&nbsp;&nbsp; //&nbsp; INSERT INTO 'tablename' (col1, col2, col3, col4, col5) values ('foobar', 495, 'val3', 720, 834.987)<br />
&nbsp;&nbsp; //<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">global </span><span class="default">$db_link</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Find all the keys (column names) from the array $my_array<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$columns </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Find all the values from the array $my_array<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$values </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// quote_smart the values<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$values_number </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$values_number</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">$values</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">get_magic_quotes_gpc</span><span class="keyword">()) { </span><span class="default">$value </span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))&nbsp; &nbsp; { </span><span class="default">$value </span><span class="keyword">= </span><span class="string">"'" </span><span class="keyword">. </span><span class="default">mysql_real_escape_string</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$db_link</span><span class="keyword">) . </span><span class="string">"'"</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$values</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Compose the query<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"INSERT INTO </span><span class="default">$my_table</span><span class="string"> "</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// create comma-separated string of column names, enclosed in parentheses<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">"(" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">", "</span><span class="keyword">, </span><span class="default">$columns</span><span class="keyword">) . </span><span class="string">")"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" values "</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// create comma-separated string of values, enclosed in parentheses<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">"(" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">", "</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">) . </span><span class="string">")"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= @</span><span class="default">mysql_query </span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">) OR die (</span><span class="string">"&lt;br /&gt;\n&lt;span style=\"color:red\"&gt;Query: </span><span class="default">$sql</span><span class="string"> UNsuccessful :&lt;/span&gt; " </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">() . </span><span class="string">"\n&lt;br /&gt;"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; return (</span><span class="default">$result</span><span class="keyword">) ? </span><span class="default">true </span><span class="keyword">: </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90030""></a>
  <div class="note">
   <strong class="user">Daniel Chcouri - 333222 +A-T+ gmail</strong>
   <a href="#90030" class="date">02-Apr-2009 03:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Fetching all the results to array with one liner:<br />
<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(...);<br />
while((</span><span class="default">$resultArray</span><span class="keyword">[] = </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) || </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$resultArray</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87859""></a>
  <div class="note">
   <strong class="user">josh at joshstrike dot com</strong>
   <a href="#87859" class="date">27-Dec-2008 03:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a nifty function to copy a whole table to another table. Takes as its arguments<br />
$z -&gt; the result of a SQL query with columns matching the table you're copying into. <br />
$toTable -&gt; string name of the table to copy into. <br />
$link_identifier -&gt; the db resource of the table you're copying into.<br />
If anyone can find a faster way to do this, I'd be glad to know about it...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mysql_multirow_copy</span><span class="keyword">(</span><span class="default">$z</span><span class="keyword">,</span><span class="default">$toTable</span><span class="keyword">,</span><span class="default">$link_identifier</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fields </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">mysql_num_fields</span><span class="keyword">(</span><span class="default">$z</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$i</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fields </span><span class="keyword">.= </span><span class="string">","</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fields </span><span class="keyword">.= </span><span class="default">mysql_field_name</span><span class="keyword">(</span><span class="default">$z</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$q </span><span class="keyword">= </span><span class="string">"INSERT INTO </span><span class="default">$toTable</span><span class="string"> (</span><span class="default">$fields</span><span class="string">) VALUES"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_data_seek</span><span class="keyword">(</span><span class="default">$z</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); </span><span class="comment">//critical reset in case $z has been parsed beforehand. !<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">while (</span><span class="default">$a </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$z</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$as</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">[</span><span class="default">key</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">)] = </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$as</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">next </span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$c</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$q </span><span class="keyword">.= </span><span class="string">","</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$q </span><span class="keyword">.= </span><span class="string">"('"</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">),</span><span class="string">"','"</span><span class="keyword">).</span><span class="string">"')"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$q </span><span class="keyword">.= </span><span class="string">";"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$z </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">,</span><span class="default">$link_identifier</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$q</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82203""></a>
  <div class="note">
   <strong class="user">alx at inbox dot lv</strong>
   <a href="#82203" class="date">31-Mar-2008 04:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Alternate option for mysqk_fetch_assoc<br />
<br />
I spent a day thinking.. damn!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function &amp;</span><span class="default">dbFetch</span><span class="keyword">(&amp;</span><span class="default">$result</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">dbTimeOn</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$EOF</span><span class="keyword">) </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">dbMoveNext</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="default">$fields</span><span class="keyword">,</span><span class="default">$EOF</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$fields</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">dbTimeOff</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$rs</span><span class="keyword">;<br />
}<br />
<br />
function &amp;</span><span class="default">dbMoveNext</span><span class="keyword">(&amp;</span><span class="default">$result</span><span class="keyword">,&amp;</span><span class="default">$fields</span><span class="keyword">,&amp;</span><span class="default">$EOF</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fields </span><span class="keyword">=&amp; </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="default">MYSQL_ASSOC</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$EOF</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$EOF </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Hope it willl help someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74048""></a>
  <div class="note">
   <strong class="user">nick at homefeedback dot com</strong>
   <a href="#74048" class="date">21-Mar-2007 04:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function array2table: small fix to the post below that handles data returned from mysql that is either null or 0...<br />
<br />
This is a useful script for displaying MySQL results in an HTML table.<br />
<br />
&lt;?<br />
<br />
function array2table($arr,$width)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; $count = count($arr);<br />
&nbsp;&nbsp; if($count &gt; 0){<br />
&nbsp;&nbsp; &nbsp; &nbsp; reset($arr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; $num = count(current($arr));<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;table align=\"center\" border=\"1\"cellpadding=\"5\" cellspacing=\"0\" width=\"$width\"&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; foreach(current($arr) as $key =&gt; $value){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;th&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo $key."&amp;nbsp;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/th&gt;\n";&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;/tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; while ($curr_row = current($arr)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $col = 1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (false !== ($curr_field = current($curr_row))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;td&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo $curr_field."&amp;nbsp;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/td&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next($curr_row);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $col++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while($col &lt;= $num){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $col++;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next($arr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;/table&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
<br />
?&gt;<br />
<br />
&lt;?<br />
<br />
// Add DB connection script here<br />
<br />
$query = "SELECT * FROM mytable";<br />
$result = mysql_query($query);<br />
while($row = mysql_fetch_assoc($result)){<br />
&nbsp; $array[] = $row; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
array2table($array,600); // Will output a table of 600px width<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71483""></a>
  <div class="note">
   <strong class="user">Typer85 at gmail dot com</strong>
   <a href="#71483" class="date">30-Nov-2006 05:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please be advised that the resource result that you pass to this function can be thought of as being passed by reference because a resource is simply a pointer to a memory location.<br />
<br />
Because of this, you can not loop through a resource result twice in the same script before resetting the pointer back to the start position.<br />
<br />
For example:<br />
<br />
----------------<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Assume We Already Queried Our Database.<br />
<br />
// Loop Through Result Set.<br />
<br />
</span><span class="keyword">while( </span><span class="default">$queryContent </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">( </span><span class="default">$queryResult </span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Display.<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$queryContent</span><span class="keyword">[ </span><span class="default">0 </span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// We looped through the resource result already so the<br />
// the pointer is no longer pointing at any rows.<br />
<br />
// If we decide to loop through the same resource result<br />
// again, the function will always return false because it<br />
// will assume there are no more rows.<br />
<br />
// So the following code, if executed after the previous code<br />
// segment will not work.<br />
<br />
</span><span class="keyword">while( </span><span class="default">$queryContent </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">( </span><span class="default">$queryResult </span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Display.<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$queryContent</span><span class="keyword">[ </span><span class="default">0 </span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// Because $queryContent is now equal to FALSE, the loop<br />
// will not be entered.<br />
<br />
</span><span class="default">?&gt;<br />
</span>----------------<br />
<br />
The only solution to this is to reset the pointer to make it point at the first row again before the second code segment, so now the complete code will look as follows:<br />
<br />
----------------<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Assume We Already Queried Our Database.<br />
<br />
// Loop Through Result Set.<br />
<br />
</span><span class="keyword">while( </span><span class="default">$queryContent </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">( </span><span class="default">$queryResult </span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Display.<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$queryContent</span><span class="keyword">[ </span><span class="default">0 </span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// Reset Our Pointer.<br />
<br />
</span><span class="default">mysql_data_seek</span><span class="keyword">( </span><span class="default">$queryResult </span><span class="keyword">);<br />
<br />
</span><span class="comment">// Loop Again.<br />
<br />
</span><span class="keyword">while( </span><span class="default">$queryContent </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">( </span><span class="default">$queryResult </span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Display.<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$queryContent</span><span class="keyword">[ </span><span class="default">0 </span><span class="keyword">];<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span>----------------<br />
<br />
Of course you would have to do extra checks to make sure that the number of rows in the result is not 0 or else mysql_data_seek itself will return false and an error will be raised.<br />
<br />
Also please note that this applies to all functions that fetch result sets, including mysql_fetch_row, mysql_fetch_assos, and mysql_fetch_array.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71405""></a>
  <div class="note">
   <strong class="user">AK-Palme</strong>
   <a href="#71405" class="date">27-Nov-2006 08:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a fetch-function useful while using multiple tables in your query:<br />
<br />
function sqlf($result){<br />
&nbsp;&nbsp;&nbsp; $row = mysql_fetch_row($result);<br />
&nbsp;&nbsp;&nbsp; if($row === FALSE) return FALSE;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for ($i = 0; $i &lt; mysql_num_fields($result); $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $meta = mysql_fetch_field($result, $i);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $data[$meta -&gt;table . '.' . $meta-&gt;name] = $row[$i];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $data;<br />
}<br />
<br />
the result will be an array containing fields like this:<br />
[table.field] =&gt; value</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70793""></a>
  <div class="note">
   <strong class="user">JPM</strong>
   <a href="#70793" class="date">28-Oct-2006 01:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For the last post, I thing there is a little mistake :<br />
<br />
the second <br />
<br />
if (count($columns)&gt;0)<br />
<br />
should be<br />
<br />
if (count($values)&gt;0)<br />
<br />
By the way, thx for this useful function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70435""></a>
  <div class="note">
   
   <a href="#70435" class="date">16-Oct-2006 12:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just fixed some things in my own mysql_insert_assoc - I used it in development and just noticed things that went wrong...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MySQL </span><span class="keyword">{<br />
&nbsp;static </span><span class="default">$link </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;static function </span><span class="default">uncached_insert </span><span class="keyword">(</span><span class="default">$table</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// Find all the keys (column names) from the array $my_array<br />
&nbsp; </span><span class="default">$columns </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// Find all the values from the array<br />
<br />
&nbsp; </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">);<br />
&nbsp; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">);<br />
&nbsp; while (list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">)) {<br />
&nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">mysql_real_escape_string</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="default">self</span><span class="keyword">::</span><span class="default">$link</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="comment">// We compose the query<br />
&nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="string">'INSERT INTO `'</span><span class="keyword">.</span><span class="default">$table</span><span class="keyword">.</span><span class="string">'` '</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">// implode the column names, inserting '`, `' between each<br />
&nbsp; // we add the enclosing quotes at the same time<br />
&nbsp; </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">'(`' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'`, `'</span><span class="keyword">, </span><span class="default">$columns</span><span class="keyword">) . </span><span class="string">'`)'</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">' VALUES '</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">// Same with the values<br />
&nbsp; </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">) { <br />
&nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">'(\'' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'\', \''</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">) . </span><span class="string">'\')'</span><span class="keyword">;<br />
&nbsp; } else {<br />
&nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">'()'</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">,</span><span class="default">self</span><span class="keyword">::</span><span class="default">$link</span><span class="keyword">);<br />
&nbsp; </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br />
&nbsp; if (!</span><span class="default">$result</span><span class="keyword">) echo </span><span class="string">'The row was not added&lt;br&gt;The error was ' </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">();<br />
&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Unfortunately it looks way different from what I had before (because I copied it from my program), but it fixes these bugs:<br />
- fields MUST have backticks, no single quotes<br />
- empty arrays did trouble<br />
- space after the error echo</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69791""></a>
  <div class="note">
   <strong class="user">q-tech at phreaker dot net</strong>
   <a href="#69791" class="date">21-Sep-2006 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In regards to Maviee's fetch function I suggest a more functional approach:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">msq</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; global </span><span class="default">$dbqcount</span><span class="keyword">; </span><span class="comment">//Count queries for the page;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$dbqcount</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (!</span><span class="default">$res</span><span class="keyword">=</span><span class="default">mysql_query </span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">)) die (</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$rr</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]=</span><span class="default">0</span><span class="keyword">; </span><span class="comment">//$rr[0] countains number of the returned results<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; while (</span><span class="default">$rr</span><span class="keyword">[]=</span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)) </span><span class="default">$rr</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">mysql_free_result</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$rr</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Also I would like to point out that mysql_fetch_assoc does associate array EXACTLY to the name of the fields/functions you've recieved results for! E.g.: <br />
<br />
<span class="default">&lt;?php<br />
$rez</span><span class="keyword">=</span><span class="default">msq</span><span class="keyword">(</span><span class="string">"SELECT MAX(`ID`) FROM `table1`"</span><span class="keyword">); </span><span class="comment">// $rez will contain assoc. variable named $rez[1]['MAX(`ID`)'], not $rez[1]['ID']<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69666""></a>
  <div class="note">
   <strong class="user">R. Bradley</strong>
   <a href="#69666" class="date">14-Sep-2006 08:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to Sergiu's function - implode() would make things a lot easier ... as below:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mysql_insert_assoc </span><span class="keyword">(</span><span class="default">$my_table</span><span class="keyword">, </span><span class="default">$my_array</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Find all the keys (column names) from the array $my_array<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$columns </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Find all the values from the array<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$values </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// We compose the query<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"insert into `</span><span class="default">$my_table</span><span class="string">` "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// implode the column names, inserting "\", \"" between each (but not after the last one)<br />
&nbsp;&nbsp; &nbsp; &nbsp; // we add the enclosing quotes at the same time<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">"(\"" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"\", \""</span><span class="keyword">, </span><span class="default">$column_names</span><span class="keyword">) . </span><span class="string">"\")"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" values "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Same with the values<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">"(" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">", "</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">) . </span><span class="string">")"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (</span><span class="default">$result</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"The row was added sucessfully"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo (</span><span class="string">"The row was not added&lt;br&gt;The error was" </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Thus, a call to this function of:<br />
mysql_insert_assoc("tablename", array("col1"=&gt;"val1", "col2"=&gt;"val2"));<br />
<br />
Sends the following sql query to mysql:<br />
INSERT INTO `tablename` ("col1", "col2") VALUES ("val1", "val2")</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69320""></a>
  <div class="note">
   <strong class="user">Sergiu</strong>
   <a href="#69320" class="date">31-Aug-2006 07:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function, fully commented, for inserting an associative array into a table.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mysql_insert_assoc </span><span class="keyword">(</span><span class="default">$my_table</span><span class="keyword">, </span><span class="default">$my_array</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Find all the keys from the array $my_array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Find the number of the keys<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keys_number </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$keys</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Generate the column name for the $sql query<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$column_names </span><span class="keyword">= </span><span class="string">"("</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">= </span><span class="string">"("</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$keys_number</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$column_name </span><span class="keyword">= </span><span class="default">$keys</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// We don't add "," after the last one<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$i </span><span class="keyword">== (</span><span class="default">$keys_number </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$column_names </span><span class="keyword">.= </span><span class="string">"`</span><span class="default">$keys</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]</span><span class="string">`"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">.= </span><span class="string">"'</span><span class="default">$my_array</span><span class="keyword">[</span><span class="default">$column_name</span><span class="keyword">]</span><span class="string">'"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$column_names </span><span class="keyword">.= </span><span class="string">"`</span><span class="default">$keys</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]</span><span class="string">`" </span><span class="keyword">. </span><span class="string">", "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">.= </span><span class="string">"'</span><span class="default">$my_array</span><span class="keyword">[</span><span class="default">$column_name</span><span class="keyword">]</span><span class="string">'" </span><span class="keyword">. </span><span class="string">", "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Proper end the column name and the value <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$column_names </span><span class="keyword">.= </span><span class="string">")"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">.= </span><span class="string">")"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// We compose the query<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"insert into `</span><span class="default">$my_table</span><span class="string">` "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="default">$column_names</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">' values '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="default">$values</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$result</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"The row was added sucessfully"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo (</span><span class="string">"The row was not added&lt;br&gt;The error was" </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68501""></a>
  <div class="note">
   <strong class="user">rinke van den berg</strong>
   <a href="#68501" class="date">30-Jul-2006 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I read someone posting 'I have the philosphy that a function has exactly one return point.'<br />
<br />
It seems to me that always having only one return point takes away a little power from 'return' making code less efficient. Compare:<br />
<br />
function doSomething($a,$b) {<br />
&nbsp;&nbsp; $returnVal = 1;<br />
&nbsp;&nbsp; if($a==$b) { $returnVal = false; }<br />
&nbsp;&nbsp; if($returnVal !== false) { //didnt we discover that already?<br />
&nbsp;&nbsp; &nbsp;&nbsp; //do something as we know a and b is what we expect<br />
&nbsp;&nbsp; &nbsp;&nbsp; $returnVal = $a - $b;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return $returnVal;<br />
}<br />
<br />
with:<br />
<br />
function doSomething($a,$b) {<br />
&nbsp;&nbsp; if($a==$b) { return false; //early exit }<br />
&nbsp;&nbsp; //do something as we know a and b is what we expect<br />
&nbsp;&nbsp; return $a-$b;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62596""></a>
  <div class="note">
   <strong class="user">paintedgauthier at gmail dot com</strong>
   <a href="#62596" class="date">04-Mar-2006 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sorry the last one i posted does a normal non-mysql array , this will work the magic on a assoc array<br />
<br />
&lt;? function assoc_array_to_mysql() {<br />
global $array;<br />
&nbsp;&nbsp;&nbsp; $update = 'update player set ';<br />
&nbsp;&nbsp;&nbsp; foreach($array as $key =&gt; $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($i) { $update .= key($array);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $check = current($array);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (isset($check)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $update .= '=\''.current($array).'\'';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {&nbsp; $update .= '=null'; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else { $key = key($array);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $current = current($array);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $end = "where $key = $current"; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; next($array);<br />
&nbsp;&nbsp; &nbsp; &nbsp; $check = key($array);<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (isset($check)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($i) {$update .= ', '; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {$update .= ' '.$end; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $result = mysql_query($update) or die(mysql_oops($update));<br />
&nbsp;&nbsp;&nbsp; echo 'Updated';<br />
&nbsp;} ?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62270""></a>
  <div class="note">
   <strong class="user">chasfileDELETE_ALL_CAPS at gmail dot com</strong>
   <a href="#62270" class="date">23-Feb-2006 11:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
What if you *want* a two dimensional array?&nbsp; Useful for output as an HTML table, for instance.<br />
<br />
function mysql_resultTo2DAssocArray ( $result) {<br />
&nbsp;&nbsp;&nbsp; $i=0;<br />
&nbsp;&nbsp;&nbsp; $ret = array();<br />
&nbsp;&nbsp;&nbsp; while ($row = mysql_fetch_assoc($result)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($row as $key =&gt; $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ret[$i][$key] = $value;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return ($ret);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
print_r(mysql_resultTo2DAssocArray(mysql_query("SELECT * FROM something")));<br />
<br />
Array ( [0] =&gt; Array ( [symbol] =&gt; ARNA<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [datetime] =&gt; 2006-02-17 16:00:00<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [price] =&gt; 16.83 )<br />
&nbsp;&nbsp; &nbsp; [1] =&gt; Array ( [symbol] =&gt; CALP<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [datetime] =&gt; 2006-02-17 16:00:00<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [price] =&gt; 6.54 )<br />
&nbsp;&nbsp; &nbsp; [2] =&gt; Array ( [symbol] =&gt; CROX<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [datetime] =&gt; 2006-02-17 16:00:00<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [price] =&gt; 27.4 ))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61387""></a>
  <div class="note">
   <strong class="user">jono</strong>
   <a href="#61387" class="date">01-Feb-2006 09:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the field names quoted within $row[] are case sensitive whereas many sql commands are case insensitive.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60667""></a>
  <div class="note">
   <strong class="user">Maviee at gmx dot net</strong>
   <a href="#60667" class="date">13-Jan-2006 02:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'll show you a small function which creates a normal array out of a mysql_fetch_assoc foreach loop.<br />
First of all, I want to say, I have the philosphy that a function has exactly one return point. That's why I'm working with a return variable.<br />
<br />
Now here is the code:<br />
<br />
public function DBSelect($statement)<br />
{<br />
&nbsp;&nbsp;&nbsp; $ident = mysql_query($statement);<br />
&nbsp;&nbsp;&nbsp; $result = true;<br />
<br />
&nbsp;&nbsp;&nbsp; if ($ident == false || mysql_num_rows($ident) == 0)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result = false;<br />
<br />
&nbsp;&nbsp;&nbsp; // only create the array when everything went fine<br />
&nbsp;&nbsp;&nbsp; if ($result != false)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($result);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // workaround to avoid a 2-dimensional array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(mysql_fetch_assoc($ident) as $key =&gt; $value)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result[$key] = $value;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; mysql_free_result($ident);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $result;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59703""></a>
  <div class="note">
   
   <a href="#59703" class="date">13-Dec-2005 03:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following code retrieves all rows but adds an empty array element to the end:<br />
&nbsp;&nbsp;&nbsp; while ($arr[] = mysql_fetch_assoc($result));<br />
One way to remove it is to also execute the following:<br />
&nbsp;&nbsp;&nbsp; array_pop($arr);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57619""></a>
  <div class="note">
   
   <a href="#57619" class="date">08-Oct-2005 07:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a useful script for displaying MySQL results in an HTML table. <br />
<br />
&lt;?<br />
<br />
function array2table($arr,$width)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; $count = count($arr);<br />
&nbsp;&nbsp; if($count &gt; 0){<br />
&nbsp;&nbsp; &nbsp; &nbsp; reset($arr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; $num = count(current($arr));<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;table align=\"center\" border=\"1\"cellpadding=\"5\" cellspacing=\"0\" width=\"$width\"&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; foreach(current($arr) as $key =&gt; $value){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;th&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo $key."&amp;nbsp;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/th&gt;\n";&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;/tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; while ($curr_row = current($arr)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $col = 1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while ($curr_field = current($curr_row)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;td&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo $curr_field."&amp;nbsp;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/td&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next($curr_row);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $col++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while($col &lt;= $num){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $col++;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/tr&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next($arr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo "&lt;/table&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
<br />
?&gt;<br />
<br />
&lt;?<br />
<br />
// Add DB connection script here<br />
<br />
$query = "SELECT * FROM mytable";<br />
$result = mysql_query($query);<br />
while($row = mysql_fetch_assoc($result)){ <br />
&nbsp; $array[] = $row; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
array2table($array,600); // Will output a table of 600px width<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56112""></a>
  <div class="note">
   <strong class="user">benlanc at ster dot me dot uk</strong>
   <a href="#56112" class="date">23-Aug-2005 04:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It probably without saying, but using list() in conjunction with mysql_fetch_assoc() does not work - use mysql_fetch_row() instead.<br />
<br />
<span class="default">&lt;?php<br />
$sql </span><span class="keyword">= </span><span class="string">"SELECT `id`,`field`,`value` FROM `table`"</span><span class="keyword">;<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br />
<br />
</span><span class="comment">// this results in empty values for rowID,fieldName,myValue<br />
</span><span class="keyword">list(</span><span class="default">$rowID</span><span class="keyword">,</span><span class="default">$fieldName</span><span class="keyword">,</span><span class="default">$myValue</span><span class="keyword">) = </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
<br />
</span><span class="comment">// this is what you want:<br />
</span><span class="keyword">list(</span><span class="default">$rowID</span><span class="keyword">,</span><span class="default">$fieldName</span><span class="keyword">,</span><span class="default">$myValue</span><span class="keyword">) = </span><span class="default">mysql_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54021""></a>
  <div class="note">
   <strong class="user">jo at durchholz dot org</strong>
   <a href="#54021" class="date">21-Jun-2005 01:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To sum up moverton at northshropshiredc dot gov dot uk and Olivier Fabre:<br />
<br />
If the query is "SELECT something1, something2, .... FROM tbl WHERE some_condition", the keys in the returned array will be 'something1', 'something2', etc. *even for those "somethings" that are not just field names*.<br />
<br />
Examples of non-fieldname "somethings" are:<br />
NULL<br />
NOW<br />
MAX(some_fieldname)<br />
<br />
I haven't tested whether this applies to table.fieldname, but I see no reason why it shouldn't (I'd suspect a typo in my code if I didn't get the expected results; I certainly have had my share of them!)<br />
<br />
I found it most convenient to check for typos by simply var_dumping the resulting row, like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">'&lt;pre&gt;Got this row:'<br />
</span><span class="default">var_dump </span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
where $row is the result from the last call to mysql_fetch_assoc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52848""></a>
  <div class="note">
   <strong class="user">erik[at]phpcastle.com</strong>
   <a href="#52848" class="date">14-May-2005 12:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you have to loop multiple times through the result of a query you can set the result pointer to 0 (zero) with mysql_data_seek ()<br />
<br />
The advantage is that you do not have to query database twice with te same query :)<br />
<br />
So:<br />
<span class="default">&lt;?php<br />
&nbsp; $query </span><span class="keyword">= </span><span class="string">"<br />
&nbsp;&nbsp;&nbsp; SELECT *<br />
&nbsp;&nbsp;&nbsp; FROM database<br />
&nbsp; "</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">//Query database<br />
&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query </span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">//Iterate result<br />
&nbsp; </span><span class="keyword">while (</span><span class="default">$record </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; ...<br />
<br />
&nbsp; </span><span class="comment">//Point to 0 (zero)<br />
&nbsp; </span><span class="default">mysql_data_seek </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">//Re-use the result<br />
&nbsp; </span><span class="keyword">while (</span><span class="default">$record </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">);<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46093""></a>
  <div class="note">
   <strong class="user">joe at kybert dot com</strong>
   <a href="#46093" class="date">29-Sep-2004 01:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Worth pointing out that the internal row pointer is incremented once the data is collected for the current row.<br />
<br />
This means that multiple calls will iterate through the row data, so you DONT need to mysql_data_seek(..) between calls.<br />
<br />
This is noted in the&nbsp; mysql_fetch_row() docs, but not here!?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45757""></a>
  <div class="note">
   <strong class="user">moverton at northshropshiredc dot gov dot uk</strong>
   <a href="#45757" class="date">17-Sep-2004 05:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Actually, Olivier, you're completely wrong about that, because there's a bug in your sample code. It will indeed return $row['MAX(time)'] - you have to pass the MySQL resource to mysql_fetch_assoc() and you're not doing that. This:<br />
<br />
$row = mysql_fetch_assoc($conn)<br />
<br />
...where $conn is your DB connection, would in fact produce a result. The complete example below is taken from my own self-written content management system:<br />
<br />
$query = 'SELECT MAX(ctRevDate) FROM content group by ctPage';<br />
$querySet = mysql_query($query, $conn);<br />
$row = mysql_fetch_assoc($querySet);<br />
print_r($row);<br />
<br />
This produces:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [MAX(ctRevDate)] =&gt; 2004-01-15<br />
)<br />
<br />
..on my testbed. So it doesn't in fact need an alias at all.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35553""></a>
  <div class="note">
   <strong class="user">marREtijn dot posthMOuma at hoVEme dot nl</strong>
   <a href="#35553" class="date">04-Sep-2003 04:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that you can't have table.field names in the resulting array. <br />
Just use an alias if your results come up empty and you are using multi-table query's:<br />
<br />
$res=mysql_query("SELECT user.ID AS uID, order.ID AS oID FROM user, order WHERE ( order.userid=uID )";<br />
while ($row=mysql_fetch_assoc($res)) {<br />
&nbsp;&nbsp; echo "&lt;p&gt;userid: $row['uID'], orderid: $row['oID']&lt;/p&gt;";<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.mysql-fetch-array.html">mysql_fetch_array</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.mysql-fetch-field.html">mysql_fetch_field</a></div>
 <div class="up"><a href="ref.mysql.html">MySQL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
