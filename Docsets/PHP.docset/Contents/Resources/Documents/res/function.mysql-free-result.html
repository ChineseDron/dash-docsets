<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Free result memory</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.mysql-field-type.html">mysql_field_type</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.mysql-get-client-info.html">mysql_get_client_info</a></div>
 <div class="up"><a href="ref.mysql.html">MySQL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.mysql-free-result" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_free_result</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_free_result</span> &mdash; <span class="dc-title">Free result memory</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-free-result-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>mysql_free_result</b></span>
    ( <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$result</tt></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>mysql_free_result()</b></span> will free all memory
   associated with the result identifier <i><tt class="parameter">result</tt></i>.
  </p>
  <p class="para">
   <span class="function"><b>mysql_free_result()</b></span> only needs to be called if
   you are concerned about how much memory is being used for queries
   that return large result sets.  All associated result memory is
   automatically freed at the end of the script&#039;s execution.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-free-result-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>
<span class="term"><i><tt class="parameter">
result</tt></i></span><dd>
<p class="para">The result <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> that
is being evaluated. This result comes from a call to
<span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span>.</p></dd>
</dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-free-result-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <b><tt>TRUE</tt></b> on success or <b><tt>FALSE</tt></b> on failure.
  </p>
  <p class="para">
   If a non-resource is used for the <i><tt class="parameter">result</tt></i>, an
   error of level E_WARNING will be emitted.  It&#039;s worth noting that
   <span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span> only returns a <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
   for SELECT, SHOW, EXPLAIN, and DESCRIBE queries.
  </p>
 </div>

 
  <div class="refsect1 examples" id="refsect1-function.mysql-free-result-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-1526">
    <p><b>Example #1 A <span class="function"><b>mysql_free_result()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;id,email&nbsp;FROM&nbsp;people&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;'42'"</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$result</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Could&nbsp;not&nbsp;run&nbsp;query:&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /></span><span style="color: #FF8000">/*&nbsp;Use&nbsp;the&nbsp;result,&nbsp;assuming&nbsp;we're&nbsp;done&nbsp;with&nbsp;it&nbsp;afterwards&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Now&nbsp;we&nbsp;free&nbsp;up&nbsp;the&nbsp;result&nbsp;and&nbsp;continue&nbsp;on&nbsp;with&nbsp;our&nbsp;script&nbsp;*/<br /></span><span style="color: #0000BB">mysql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">];<br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-free-result-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    For backward compatibility, the following
deprecated alias may be used: 
    <span class="function"><b>mysql_freeresult()</b></span>
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-free-result-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - Send a MySQL query</span></li>
    <li class="member"><span class="function"><a href="function.is-resource.html" class="function" rel="rdfs-seeAlso">is_resource()</a> - Finds whether a variable is a resource</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="102949""></a>
  <div class="note">
   <strong class="user">webmaster at bluesting dot co dot za</strong>
   <a href="#102949" class="date">16-Mar-2011 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mysql_query() also returns a resource for "OPTIMIZE TABLE" statements!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83880""></a>
  <div class="note">
   <strong class="user">webmaster at wforums dot net</strong>
   <a href="#83880" class="date">16-Jun-2008 01:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I agree with Joachim Kruyswijk (posted on 14-Jun-2005 11:42). I just did the test on my beta version of my new site (who needs to get dynamically news and user login from a database) and i use 1000kb less memory when i do not use mysql_free_result. I guess it is because the data it needs to load are not that large (for news: date, short description and for the user login: username, password). It may only be in the user control panel that it will be more, but since that isn't developed totally yet, i'll have to test :p</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81891""></a>
  <div class="note">
   <strong class="user">admin at ifyouwantblood dot de</strong>
   <a href="#81891" class="date">18-Mar-2008 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
yes this function may increase the memory usage if you use unbuffered querys and if you have not fetched all the data from mysql. in this case the mysql api has a problem: you want to free the result but do not want to close the connection. now mysql will only accept another query if all data has been fetched, so the api now must fetch the rest of the data when calling mysql_free_result().<br />
<br />
so only use unbuffered querys if you fetch all the data (and need it).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71289""></a>
  <div class="note">
   
   <a href="#71289" class="date">21-Nov-2006 02:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're seeing warnings like "Warning: Unknown: 6 result set(s) not freed. Use mysql_free_result to free result sets which were requested using mysql_query() in Unknown on line 0" and want to turn them off, set mysql.trace_mode = Off in your php.ini</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62356""></a>
  <div class="note">
   <strong class="user">Nairebis</strong>
   <a href="#62356" class="date">25-Feb-2006 06:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ALWAYS use this function! I just encountered a bug in my code where I forgot to use this function. I also happen to be using mysql_pconnect() for a persistent connection. If you forget to free the result, it can hold the old result set open indefinitely within the HTTP process.<br />
<br />
The upshot (in my application) was that I did updates that happened in a different HTTP process, but they mysteriously didn't show up in another HTTP process. After panicking that MySQL had mysterious data corruption and/or synchronization problems, I traced it back to this where an old result set was held open.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56958""></a>
  <div class="note">
   <strong class="user">mdeininger at jyujin dot de</strong>
   <a href="#56958" class="date">20-Sep-2005 04:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
yes, i encountered that too. as far as i could tell, that's because the script is stored in memory after being compiled and that's as much more memory as it needs for a call to that function.<br />
<br />
if you always get lotsa data in your results, using this function will decrease memory usage tho, unless you use non-buffered queries (which are preferable unless you absolutely *have* to use mysql_seek(), or you need to do another query while the last one hasn't finished reporting back, as they can provide a small speedup)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54390""></a>
  <div class="note">
   <strong class="user">macronesia at macronesia dot net</strong>
   <a href="#54390" class="date">02-Jul-2005 12:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You not need to use this if you are using PHP 4.<br />
<br />
The comment below this comment may explain why it's actually costing more memory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53816""></a>
  <div class="note">
   <strong class="user">Joachim Kruyswijk</strong>
   <a href="#53816" class="date">14-Jun-2005 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using this function may actually increase the amount of memory used. In my case, the script used 208 bytes less memory when *not* using mysql_free_result().<br />
Check for yourself: call memory_get_usage() at the end of the script.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.mysql-field-type.html">mysql_field_type</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.mysql-get-client-info.html">mysql_get_client_info</a></div>
 <div class="up"><a href="ref.mysql.html">MySQL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
