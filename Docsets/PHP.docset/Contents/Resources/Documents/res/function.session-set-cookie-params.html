<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Set the session cookie parameters</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.session-save-path.html">session_save_path</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.session-set-save-handler.html">session_set_save_handler</a></div>
 <div class="up"><a href="ref.session.html">Session Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.session-set-cookie-params" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_set_cookie_params</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">session_set_cookie_params</span> &mdash; <span class="dc-title">Set the session cookie parameters</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.session-set-cookie-params-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><span class="type void">void</span></span> <span class="methodname"><b>session_set_cookie_params</b></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$lifetime</tt></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$path</tt></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$domain</tt></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$secure</tt><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$httponly</tt><span class="initializer"> = false</span></span>
  ]]]] )</div>

  <p class="para rdfs-comment">
   Set cookie parameters defined in the <var class="filename">php.ini</var> file. The effect of this
   function only lasts for the duration of the script. Thus, you need to
   call <span class="function"><b>session_set_cookie_params()</b></span> for every request and
   before <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span> is called.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.session-set-cookie-params-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">lifetime</tt></i></span>
     <dd>

      <p class="para">
       <a href="session.configuration.html#ini.session.cookie-lifetime" class="link">Lifetime</a> of the
       session cookie, defined in seconds.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">path</tt></i></span>
     <dd>

      <p class="para">
       <a href="session.configuration.html#ini.session.cookie-path" class="link">Path</a> on the domain where
       the cookie will work. Use a single slash (&#039;/&#039;) for all paths on the
       domain.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">domain</tt></i></span>
     <dd>

      <p class="para">
       Cookie <a href="session.configuration.html#ini.session.cookie-domain" class="link">domain</a>, for
       example &#039;www.php.net&#039;. To make cookies visible on all subdomains then
       the domain must be prefixed with a dot like &#039;.php.net&#039;.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">secure</tt></i></span>
     <dd>

      <p class="para">
       If <b><tt>TRUE</tt></b> cookie will only be sent over
       <a href="session.configuration.html#ini.session.cookie-secure" class="link">secure</a> connections.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">httponly</tt></i></span>
     <dd>

      <p class="para">
       If set to <b><tt>TRUE</tt></b> then PHP will attempt to send the
       <a href="session.configuration.html#ini.session.cookie-httponly" class="link">httponly</a>
       flag when setting the session cookie.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.session-set-cookie-params-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   No value is returned.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.session-set-cookie-params-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.2.0</td>
       <td align="left">
        The <i><tt class="parameter">httponly</tt></i> parameter was added.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">4.0.4</td>
       <td align="left">
        The <i><tt class="parameter">secure</tt></i> parameter was added.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.session-set-cookie-params-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member">
     <a href="session.configuration.html#ini.session.cookie-lifetime" class="link">session.cookie_lifetime</a>
    </li>
    <li class="member">
     <a href="session.configuration.html#ini.session.cookie-domain" class="link">session.cookie_domain</a>
    </li>
    <li class="member">
     <a href="session.configuration.html#ini.session.cookie-secure" class="link">session.cookie_secure</a>
    </li>
    <li class="member">
     <a href="session.configuration.html#ini.session.cookie-httponly" class="link">session.cookie_httponly</a>
    </li>
    <li class="member"><span class="function"><a href="function.session-get-cookie-params.html" class="function" rel="rdfs-seeAlso">session_get_cookie_params()</a> - Get the session cookie parameters</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104678""></a>
  <div class="note">
   <strong class="user">Danack dot Ackroyd at gmail dot com</strong>
   <a href="#104678" class="date">30-Jun-2011 01:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Setting the domain for cookies in session_set_cookie_params() only affects the domain used for the session cookie which is set by PHP.<br />
<br />
All other cookies set by calling the function setcookie() either:<br />
i) Use the domain set explicitly in the call to setcookie()<br />
or <br />
ii) Don't set the domain at all on the cookie and so the browser assumes it's for the current domain.<br />
<br />
So to make all your cookies be available across all sub-domains of your site you need to do this:<br />
<br />
<span class="default">&lt;?php<br />
$currentCookieParams </span><span class="keyword">= </span><span class="default">session_get_cookie_params</span><span class="keyword">();<br />
<br />
</span><span class="default">$rootDomain </span><span class="keyword">= </span><span class="string">'.example.com'</span><span class="keyword">;<br />
<br />
</span><span class="default">session_set_cookie_params</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentCookieParams</span><span class="keyword">[</span><span class="string">"lifetime"</span><span class="keyword">],<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentCookieParams</span><span class="keyword">[</span><span class="string">"path"</span><span class="keyword">],<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rootDomain</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentCookieParams</span><span class="keyword">[</span><span class="string">"secure"</span><span class="keyword">],<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentCookieParams</span><span class="keyword">[</span><span class="string">"httponly"</span><span class="keyword">]<br />
);<br />
<br />
</span><span class="default">session_name</span><span class="keyword">(</span><span class="string">'mysessionname'</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$cookieName</span><span class="keyword">, </span><span class="default">$cookieValue</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() + </span><span class="default">3600</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$rootDomain</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100672""></a>
  <div class="note">
   <strong class="user">php at rijkvanwel dot nl</strong>
   <a href="#100672" class="date">29-Oct-2010 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
No matter how your server's gc is configured, a user will still experience an expired session when the cookie containing his session id is dropped.<br />
<br />
The problem (that some people before me have already noticed) with this is, that the cookie's timestamp is not updated on every new request. So while the visitor's navigating through your site or application, his session file's timestamp is updated and your gc_lifetime is configured properly so the file's not deleted by the server, but meanwhile the clock is ticking away on his locally stored session cookie. When it reaches the time limit: boom, session gone. (Actually, the session is still there on the server, the browser just stops sending the id with the requests, so the server can't identify the visitor and starts a new session.)<br />
<br />
One solution for this is to regenerate the cookie with each request (either by manually overwriting the cookie with setcookie(), or by regenerating the session id with session_regenerate_id()). However, this is needless overhead.<br />
<br />
If it works for your application, a better and much simpler solution is to just set the session cookie's lifetime to 0 (which will make it live until the browser is closed):<br />
<br />
<span class="default">&lt;?php<br />
session_set_cookie_params</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
You will only have to do this the first time your session is started (as this is the only time the cookie is sent to the client).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100657""></a>
  <div class="note">
   <strong class="user">final dot wharf at gmail dot com</strong>
   <a href="#100657" class="date">28-Oct-2010 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As PHP's Session Control does not handle session lifetimes correctly when using session_set_cookie_params(), we need to do something in order to change the session expiry time every time the user visits our site. So, here's the problem.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; $lifetime</span><span class="keyword">=</span><span class="default">600</span><span class="keyword">;<br />
&nbsp; </span><span class="default">session_set_cookie_params</span><span class="keyword">(</span><span class="default">$lifetime</span><span class="keyword">);<br />
&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
This code doesn't change the lifetime of the session when the user gets back at our site or refreshes the page. The session WILL expire after $lifetime seconds, no matter how many times the user requests the page. So we just overwrite the session cookie as follows:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; $lifetime</span><span class="keyword">=</span><span class="default">600</span><span class="keyword">;<br />
&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">session_name</span><span class="keyword">(),</span><span class="default">session_id</span><span class="keyword">(),</span><span class="default">time</span><span class="keyword">()+</span><span class="default">$lifetime</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
And now we have the same session cookie with the lifetime set to the proper value.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97072""></a>
  <div class="note">
   <strong class="user">digitalmagnets at gmail dot com</strong>
   <a href="#97072" class="date">31-Mar-2010 01:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that if you are setting a session cookie on https://subdomain123.example.com for .example.com that the default of the secure cookie is not false but true.<br />
<br />
So your cookie won't work on <a href="http://subdomainxyz.example.com unless you set the secure option to false." rel="nofollow" target="_blank">http://subdomainxyz.example.com unless you set the secure option to false.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96868""></a>
  <div class="note">
   <strong class="user">jan at dewal dot net</strong>
   <a href="#96868" class="date">19-Mar-2010 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The information above about this function that it can only be used BEFORE session_start depends on how you use it. Because its also useful AFTER a session has started as follows:<br />
<br />
Example you wand to change an already set value of the session cookie expire time:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;</span><span class="comment">// Here we start as usual<br />
</span><span class="default">session_set_cookie_params</span><span class="keyword">(</span><span class="string">'3600'</span><span class="keyword">); </span><span class="comment">// 1 hour<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="comment">// More code...<br />
<br />
// Now we found in some database that the user whishes<br />
// the cookie to expire after for example 10 minutes<br />
// we can change it instantly ! <br />
<br />
</span><span class="default">session_set_cookie_params</span><span class="keyword">(</span><span class="string">'600'</span><span class="keyword">); </span><span class="comment">// 10 minutes.<br />
</span><span class="default">session_regenerate_id</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">); <br />
<br />
</span><span class="comment">// This will delete old cookie and adopt new expire settings and the<br />
// old cookie variables in a new cookie<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Please note i only explained the browser (client) side changes of session cookie's expire time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96404""></a>
  <div class="note">
   <strong class="user">quintellarosa at yahoo dot com dot br</strong>
   <a href="#96404" class="date">25-Feb-2010 06:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks to dan at vespernet dot co dot uk and MaxTheDragon at NOSPAMhome dot nl, I've started solving some issues here.<br />
<br />
I've found that using:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp; session_name</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />
&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">], </span><span class="default">time</span><span class="keyword">() + </span><span class="default">$lifetime</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">, </span><span class="default">$httponly</span><span class="keyword">);<br />
&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
works fine, while:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp; session_name</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />
&nbsp; </span><span class="default">session_set_cookie_params</span><span class="keyword">(</span><span class="default">$lifetime</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">, </span><span class="default">$httponly</span><span class="keyword">);<br />
&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
doesn't seem to work properly, like not updating the lifetime properly.<br />
<br />
For anyone interested. Any comments would be appreciated.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94961""></a>
  <div class="note">
   <strong class="user">Miki</strong>
   <a href="#94961" class="date">04-Dec-2009 10:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
REMEMBER, that if you have a multi-subdomain site, you must put the following to enable a session id on the whole website:<br />
<br />
<span class="default">&lt;?php<br />
session_set_cookie_params</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'.example.com'</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Otherwise, you'll have 2 diffrent sessions on e.g. news.example.com and download.example.com</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92541""></a>
  <div class="note">
   <strong class="user">seth36 at gmail dot com</strong>
   <a href="#92541" class="date">28-Jul-2009 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found session_set_cookie_params to be ineffective at changing the session lifetime, to change the session lifetime I do the following:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$Lifetime </span><span class="keyword">= </span><span class="default">3600</span><span class="keyword">;<br />
</span><span class="default">$Seperator </span><span class="keyword">= (</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">PHP_OS</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">)), </span><span class="string">"WIN"</span><span class="keyword">)) ? </span><span class="string">"\\" </span><span class="keyword">: </span><span class="string">"/"</span><span class="keyword">;<br />
</span><span class="default">$DirectoryPath </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">"</span><span class="keyword">{</span><span class="default">$Seperator</span><span class="keyword">}</span><span class="string">SessionData"</span><span class="keyword">;<br />
</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$DirectoryPath</span><span class="keyword">) or </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$DirectoryPath</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
<br />
if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">"session.use_trans_sid"</span><span class="keyword">) == </span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"url_rewriter.tags"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.use_trans_sid"</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
<br />
}<br />
<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.gc_maxlifetime"</span><span class="keyword">, </span><span class="default">$Lifetime</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.gc_divisor"</span><span class="keyword">, </span><span class="string">"1"</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.gc_probability"</span><span class="keyword">, </span><span class="string">"1"</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.cookie_lifetime"</span><span class="keyword">, </span><span class="string">"0"</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.save_path"</span><span class="keyword">, </span><span class="default">$DirectoryPath</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I switched to this after having many failed attempts at having a session remain active for longer than the default 24 minutes, the problem it seems is what many suggest that appears to be wrong - Setting the cookie lifetime to be the same as session.gc_maxlifetime, although the expiry of the cookie is set, it isn't updated when the user remains active in the session, so even if the session is actively being used, once the cookie life runs out, the sessions gets invalidated, using the above seems to work for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87070""></a>
  <div class="note">
   <strong class="user">Ashus</strong>
   <a href="#87070" class="date">18-Nov-2008 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Cross-domain Cookies do work in all browsers (path '/' server '.example.com'), except the case you try it in IE6/7 and the server name is retreived from :etc/hosts: file, in that case the cookie won't be even saved.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85107""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#85107" class="date">14-Aug-2008 11:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In Response to RC<br />
&gt;23-Apr-2008 04:45<br />
&gt;For anyone looking for which browsers support the HTTPOnly &gt;flag, per my research:<br />
&gt;<br />
&gt;IE 6 SP 1 and higher.<br />
&gt;Firefox 3 and higher.<br />
&gt;Opera 9.50 and higher.<br />
<br />
Firefox 2.0 also supports them, but only since version 2.0.0.5.<br />
<br />
<a href="http://bugzilla.mozilla.org/show_bug.cgi?id=178993" rel="nofollow" target="_blank">http://bugzilla.mozilla.org/show_bug.cgi?id=178993</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83484""></a>
  <div class="note">
   <strong class="user">brandan, bildungsroman.org</strong>
   <a href="#83484" class="date">27-May-2008 08:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i found it somewhat difficult to work with sessions due to the documentation not really denoting the necessity for the session name to be set via session_name() in order for session_set_cookie_params() to be of any use.&nbsp; i found no reference to session_name() in this article, and my session functions would have been a disastrous mess were it not for a friend familiar with session.<br />
<br />
so, in essence, for anybody wondering about where to start: declare a session name before using session_set_cookie_params(), otherwise you might agitate php to the point of committing some atrocity against your webserver.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82724""></a>
  <div class="note">
   <strong class="user">RC</strong>
   <a href="#82724" class="date">23-Apr-2008 07:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For anyone looking for which browsers support the HTTPOnly flag, per my research:<br />
<br />
IE 6 SP 1 and higher.<br />
Firefox 3 and higher.<br />
Opera 9.50 and higher.<br />
<br />
As of Safari 3.1.1 (April 2008), Safari did not yet support this flag.<br />
<br />
This cookie flag was developed by Microsoft and is slowly making its way into other browsers: <a href="http://msdn2.microsoft.com/en-us/library/ms533046.aspx" rel="nofollow" target="_blank">http://msdn2.microsoft.com/en-us/library/ms533046.aspx</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81840""></a>
  <div class="note">
   <strong class="user">eddie at roosenmaallen dot com</strong>
   <a href="#81840" class="date">15-Mar-2008 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Further to "info at xyzsite dot ru" and William Leslie, Safari on OS X also doesn't honour cookies with an underscore in the subdomain.<br />
<br />
The workaround I've found is to specify the parent domain as the cookie domain -- instead of "bad_name.example.com", set the path to ".example.com"; it's suboptimal, but gets the job done.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80970""></a>
  <div class="note">
   <strong class="user">William Leslie</strong>
   <a href="#80970" class="date">08-Feb-2008 09:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"Info at xyzsite dot ru" writes that Internet Explorer does not correctly handle cookies whose domain contains an underscore character.<br />
<br />
However, There's a good reason for this apparently faulty behavior: the underscore character is forbidden in DNS names.&nbsp; RFC 3696 says:<br />
<br />
"The labels ... that make up a domain name must consist of only the ASCII alphabetic and numeric characters, plus the hyphen.&nbsp; No other symbols or punctuation characters are permitted, nor is blank space."<br />
<br />
If the underscore works in Mozilla or other browsers, it's only because they are being lenient in the validation of domain names.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79946""></a>
  <div class="note">
   <strong class="user">info at xyzsite dot ru</strong>
   <a href="#79946" class="date">20-Dec-2007 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just one more bad situation - cookies in Internet Explorer do not work with '_' in domain name. FF and Opera are O.K. So if your hostname is like test_host.example.com, IE cookies will not function correctly/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78930""></a>
  <div class="note">
   <strong class="user">dan at vespernet dot co dot uk</strong>
   <a href="#78930" class="date">02-Nov-2007 11:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The below note is an excellent example of how to 'reset' the session expiration time upon a page refresh.<br />
<br />
However, take care to compensate for when the session expires and doesn't renew itself (a bug I believe). If the below example is run every time a script is executed, it will give an 'Undefined index &lt;session name&gt; error' after the session fails to renew. Precede it with and if isset() condition.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">private function </span><span class="default">startSession</span><span class="keyword">(</span><span class="default">$time </span><span class="keyword">= </span><span class="default">3600</span><span class="keyword">, </span><span class="default">$ses </span><span class="keyword">= </span><span class="string">'MYSES'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_set_cookie_params</span><span class="keyword">(</span><span class="default">$time</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_name</span><span class="keyword">(</span><span class="default">$ses</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Reset the expiration time upon page load<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$ses</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$ses</span><span class="keyword">, </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$ses</span><span class="keyword">], </span><span class="default">time</span><span class="keyword">() + </span><span class="default">$time</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The above example states that a session will last an hour without a page refresh until it is scrapped. Upon a page refresh, the expiration time is reset back to one hour again. If you wish to give users the option of 'staying logged in forever', just feed startSession a value of '99999999', which should last about 3 years.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77726""></a>
  <div class="note">
   <strong class="user">MaxTheDragon at NOSPAMhome dot nl</strong>
   <a href="#77726" class="date">10-Sep-2007 01:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This article states that one must define the lifetime of the cookie using session_set_cookie_params(), before calling session_start(). This is correct.<br />
<br />
However, suppose you would need to change the session cookie lifetime, during the session. You would have to delete the session in order to pass the correct lifetime. If however, the session contains important data, you might not want to delete the session.<br />
<br />
This seems to be a problem, since the session already exists.<br />
<br />
The following code:<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="default">session_name</span><span class="keyword">(), </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">session_name</span><span class="keyword">()], </span><span class="default">time</span><span class="keyword">()+</span><span class="default">10000</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
allows you to change the cookie lifetime, during the session, and without the need to delete the session. Basically it grabs the existing cookie, and just updates the lifetime, leaving the data intact.<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="default">session_name</span><span class="keyword">(), </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">session_name</span><span class="keyword">()], </span><span class="default">0</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Similarly, the above code allows you to turn the existing session, into one that is destroyed, when the browser screen closes.<br />
<br />
Please note that this is not a replacement of session_set_cookie_params! You must still call that function before the session start to set a lifetime for the cookie. If somewhere after the session_start(), you need to change the lifetime, use the code supplied above, and also make sure that the new lifetime gets included in the next calls of<br />
session_set_cookie_params(). This ensures that the cookie will work properly with the new lifetime, even after page browsing/refreshes.<br />
<br />
I have tested this, and it seems to work properly.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47397""></a>
  <div class="note">
   <strong class="user">jordi at jcanals dot net</strong>
   <a href="#47397" class="date">15-Nov-2004 05:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Something that has taken me some time to debug: session_set_cookie_params() does not work when the domain param is just a one level domain, like it was a TLD.<br />
<br />
I have a site in an intranet and our internal domain is .local, so trying to set the cookie session to the .local domain does not work:<br />
<br />
session_set_cookie_params(0, '/', '.local'); // Does not work<br />
<br />
In all test I've done, setting the domain only works for SLDs and above: <br />
<br />
session_set_cookie_params(0 , '/', '.sld.local'); Does work<br />
<br />
This is nothing to do with PHP but the http protocol, witch does not permit setting cookies for TLDs for obvious security reasons.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22458""></a>
  <div class="note">
   <strong class="user">shrockc at inhsNO dot SPAMorg</strong>
   <a href="#22458" class="date">18-Jun-2002 09:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
when setting the path that the cookie is valid for, always remember to have that trailing '/'.<br />
<br />
CORRECT:<br />
session_set_cookie_params (0, '/yourpath/');<br />
<br />
INCORRECT:<br />
session_set_cookie_params (0, '/yourpath');<br />
<br />
no comment on how long it took me to realize that this was the cause of my authentication/session problems...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19409""></a>
  <div class="note">
   <strong class="user">gavin_spam at skypaint dot com</strong>
   <a href="#19409" class="date">26-Feb-2002 02:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The first argument to session_set_cookie_params is the number of seconds in the future (based on the server's current time) that the session will expire.&nbsp; So if you want your sessions to last 100 days:<br />
<br />
$expireTime = 60*60*24*100; // 100 days<br />
session_set_cookie_params($expireTime);<br />
<br />
I was using time()+$expireTime, which is WRONG (a lot of the session_set_cookie_params() examples I found get this wrong, but probably don't care because they are just doing "infinite" sessions).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="12811""></a>
  <div class="note">
   <strong class="user">php at mike2k dot com</strong>
   <a href="#12811" class="date">09-May-2001 02:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's Note:<br />
<br />
Rasmus' Solution from the PHP-General list:<br />
<br />
Just use a session cookie (by not providing an expiry time) and add the<br />
server's expiry timestamp to the value of the cookie.&nbsp; Then when you get<br />
that cookie sent to you, check it against your server's time and make the<br />
decision on whether to accept the cookie or not based on that.<br />
<br />
That way you are immune from people not having their system clocks set<br />
right.<br />
<br />
-Rasmus<br />
<br />
--zak@php.net]<br />
<br />
A couple things I noticed when using this. I think it only works if you set the session_set_cookie_params() function BEFORE the session_start() function.<br />
<br />
Also, when you set the "lifetime" on the cookie, it takes the seconds offset from the SERVER. it sends the cookie encoded to timeout at the SERVER time. So if your server is +2 minutes ahead of the client, and you set the cookie to timeout after 30 seconds, the client actually has 2 minutes and 30 seconds before the cookie times out. I don't know if there's any way that this can be patched in future versions, and the only alternative I think is setting cookies in javascript, which is hardly the point when using all these specific session functions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.session-save-path.html">session_save_path</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.session-set-save-handler.html">session_set_save_handler</a></div>
 <div class="up"><a href="ref.session.html">Session Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
