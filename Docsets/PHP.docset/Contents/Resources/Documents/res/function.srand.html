<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Seed the random number generator</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.sqrt.html">sqrt</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.tan.html">tan</a></div>
 <div class="up"><a href="ref.math.html">Math Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.srand" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">srand</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">srand</span> &mdash; <span class="dc-title">Seed the random number generator</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.srand-description">
  <h3 class="title">Description</h3>
   <div class="methodsynopsis dc-description">
    <span class="type"><span class="type void">void</span></span> <span class="methodname"><b>srand</b></span>
     ([ <span class="methodparam"><span class="type">int</span> <tt class="parameter">$seed</tt></span>
   ] )</div>

  <p class="para rdfs-comment">
   Seeds the random number generator with <i><tt class="parameter">seed</tt></i>
   or with a random value if no <i><tt class="parameter">seed</tt></i> is given.
  </p>

  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">As of PHP 4.2.0, there is no need
to seed the random number generator with <span class="function"><b>srand()</b></span> or
<span class="function"><a href="function.mt-srand.html" class="function">mt_srand()</a></span> as this is now done automatically.
</span></p></blockquote>

 </div>

 <div class="refsect1 parameters" id="refsect1-function.srand-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">seed</tt></i></span>
     <dd>

      <p class="para">
       Optional seed value
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.srand-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   No value is returned.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.srand-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">Since 4.2.0</td>
       <td align="left">
        The <i><tt class="parameter">seed</tt></i> becomes optional
        and defaults to a random value if omitted.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.srand-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-3201">
    <p><b>Example #1 <span class="function"><b>srand()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;seed&nbsp;with&nbsp;microseconds<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">make_seed</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;list(</span><span style="color: #0000BB">$usec</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sec</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">'&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">());<br />&nbsp;&nbsp;return&nbsp;(float)&nbsp;</span><span style="color: #0000BB">$sec&nbsp;</span><span style="color: #007700">+&nbsp;((float)&nbsp;</span><span style="color: #0000BB">$usec&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">100000</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">srand</span><span style="color: #007700">(</span><span style="color: #0000BB">make_seed</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">$randval&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.srand-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.rand.html" class="function" rel="rdfs-seeAlso">rand()</a> - Generate a random integer</span></li>
    <li class="member"><span class="function"><a href="function.getrandmax.html" class="function" rel="rdfs-seeAlso">getrandmax()</a> - Show largest possible random value</span></li>
    <li class="member"><span class="function"><a href="function.mt-srand.html" class="function" rel="rdfs-seeAlso">mt_srand()</a> - Seed the better random number generator</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104039""></a>
  <div class="note">
   <strong class="user">dev+php at alepe dot com</strong>
   <a href="#104039" class="date">18-May-2011 06:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be sure to "reset" srand() to a random seed once you use it (if you don't need the seed after that). <br />
For example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">myRandomArray</span><span class="keyword">(&amp;</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$seed</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">srand</span><span class="keyword">(</span><span class="default">$seed</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">shuffle</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
}<br />
</span><span class="comment">//...<br />
</span><span class="default">myRandomArray</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">12345</span><span class="keyword">);<br />
</span><span class="comment">//...<br />
//...<br />
//...<br />
</span><span class="default">$y </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">100</span><span class="keyword">); </span><span class="comment">//&lt;-- Will always return the same sequence as srand is still on effect.<br />
</span><span class="default">?&gt;<br />
</span><br />
To prevent that, one way is to set the srand() back to "normal":<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">function </span><span class="default">myRandomArray</span><span class="keyword">(&amp;</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$seed</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">srand</span><span class="keyword">(</span><span class="default">$seed</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">shuffle</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">srand</span><span class="keyword">(); </span><span class="comment">//&lt;-- this would do the trick<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
This also applies for mt_srand().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102636""></a>
  <div class="note">
   <strong class="user">Niels Keurentjes</strong>
   <a href="#102636" class="date">25-Feb-2011 05:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Keep in mind that the Suhosin patch which is installed by default on many PHP-installs such as Debian and DirectAdmin completely disables the srand and mt_srand functions for encryption security reasons. To generate reproducible random numbers from a fixed seed on a Suhosin-hardened server you will need to include your own pseudorandom generator code.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90215""></a>
  <div class="note">
   <strong class="user">harmen at no dot spam dot rdzl dot nl</strong>
   <a href="#90215" class="date">10-Apr-2009 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To generate a random number which is different every day, I used the number of days after unix epoch as a seed:<br />
<br />
<span class="default">&lt;?php&nbsp; <br />
&nbsp;&nbsp; srand</span><span class="keyword">(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">time</span><span class="keyword">() / (</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">)));<br />
&nbsp;&nbsp; echo </span><span class="default">rand</span><span class="keyword">() % </span><span class="default">100</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
My provider upgraded the php server recently, and calling srand(seed) does not seem to set the seed anymore. To let srand set the seed, add the following line to your .htaccess file<br />
<br />
php_value suhosin.srand.ignore 0 <br />
<br />
Kudos to doc_z (<a href="http://www.webmasterworld.com/php/3777515.htm" rel="nofollow" target="_blank">http://www.webmasterworld.com/php/3777515.htm</a>)<br />
<br />
Harmen</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76340""></a>
  <div class="note">
   <strong class="user">php at capuzza dot net</strong>
   <a href="#76340" class="date">11-Jul-2007 04:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Richard's statement, that calling srand more than once per script will impair you chance to get a true random number, is not necessarily correct. In fact using srand more than once can even improve randomness if you understand how.<br />
<br />
The rand function uses a certain algorithm to calculate a number out of the seed given to srand. This algorithm, of course, is always the same, so without knowing the seed (which is assumed to be random) you can calculate any value returned by rand other than the first one if you know the first one. The chances to do so get better the higher the range of your random number is (and are pretty good if the range of the random number exceeds the possible range of the seed).<br />
<br />
In the following example the range of the desired random number is 10 times higher than the possible range of the seed:<br />
<br />
&lt;?<br />
list($usec, $sec) = explode(" ", microtime());<br />
srand((int)($usec*10));<br />
$rand_value = rand(0, 99);<br />
echo($rand_value."&lt;br&gt;");<br />
$rand_value = rand(0, 99);<br />
echo($rand_value."&lt;br&gt;");<br />
$rand_value = rand(0, 99);<br />
echo($rand_value."&lt;br&gt;");<br />
?&gt;<br />
<br />
The code will return 3 numbers. Execute the code several times and write down each set of numbers, you will notice that after a short time you will know the second and the third number by only seeing the first one and compare it to what you've written down. All that without knowing the random seed! Of course seeding with (double)microtime()*1000000 gives a 100,000 times higher range, but if the range of the random numbers you want to generate was 100,000 times higher too, it's just a matter of time for someone being able to predict all your random numbers after the first one.<br />
<br />
But simply calling srand in between the rands wouldn't do the trick either, because the execution time of the code in between the srands is highly predictable. The key is to do something before each call of srand, which has a real random time of execution. Requesting a website from another server would be such a thing (can also be a SQL request or something).<br />
<br />
&lt;?<br />
list($usec, $sec) = explode(" ", microtime());<br />
srand((int)($usec*10));<br />
$rand_value = rand(0, 99);<br />
echo($rand_value."&lt;br&gt;");<br />
$foo=file_get_contents<br />
("<a href="http://www.google.com/search?q=sea" rel="nofollow" target="_blank">http://www.google.com/search?q=sea</a><br />
rch+term+does+not+matter&amp;hl=en");<br />
list($usec, $sec) = explode(" ", microtime());<br />
srand((int)($usec*10));<br />
$rand_value = rand(0, 99);<br />
echo($rand_value."&lt;br&gt;");<br />
$foo=file_get_contents<br />
("<a href="http://www.google.com/search?q=sea" rel="nofollow" target="_blank">http://www.google.com/search?q=sea</a><br />
rch+term+still+does+not+matter&amp;hl=en");<br />
list($usec, $sec) = explode(" ", microtime());<br />
srand((int)($usec*10));<br />
$rand_value = rand(0, 99);<br />
echo($rand_value."&lt;br&gt;");<br />
?&gt;<br />
<br />
You can probably execute this code a thousand times with hardly getting any set of 3 numbers repeated. Try what you did with the other code snippet above and note that you improved randomness by using srand more than once.<br />
<br />
Via <a href="http://www.capuzza.com/detail.php?ID=115293" rel="nofollow" target="_blank">http://www.capuzza.com/detail.php?ID=115293</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53577""></a>
  <div class="note">
   <strong class="user">bootc at bootc dot net</strong>
   <a href="#53577" class="date">06-Jun-2005 08:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
OK, to summarize what people have been saying so far:<br />
<br />
1. DO NOT seed the RNG more than once if you can help it!<br />
2. You HAVE TO seed the RNG yourself if you are using PHP &lt; 4.2.0.<br />
3. Using a prime multiplier to microtime() probably does very little. Use the Mersenne Twister instead.<br />
4. You can use the Mersenne Twister PRNG with the mt_rand and mt_srand functions. This is faster and is more random.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48768""></a>
  <div class="note">
   <strong class="user">corey at eyewantmedia dot com</strong>
   <a href="#48768" class="date">06-Jan-2005 08:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hey, I use rand() all the time to get a rough probability of something happening. I went ahead and wrote a little function to help with the situation "I wish this thing would happen 2% of the time, so here is 5 lines of code to figure it out" since I run into it so much. Obviously, this is pretty similar to the if rand($x, $y) &lt;$soething way, but I find it a little more flexible.<br />
<br />
/**<br />
&nbsp;* @return boolean<br />
&nbsp;* @param int $baseChance<br />
&nbsp;* @param int $chanceAmplifier<br />
&nbsp;* @desc Returns a true or false value based on a whether a random number <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; in the range 1 - (100 * $chanceAmplifier) is less than $baseChance. <br />
*/<br />
function RandomChance($baseChance, $chanceAmplifier = 1) {<br />
&nbsp;&nbsp;&nbsp; srand( ((int)((double)microtime()*1000003)) ); // get a good seed<br />
&nbsp;&nbsp;&nbsp; $totalBag = 100 * $chanceAmplifier; // set up max limit<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $probCheck = rand(1,$totalBag); // get random number<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if ( ($probCheck &lt; $baseChance) ) { //compare it to $baseChance<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result = true;<br />
&nbsp;&nbsp;&nbsp; }&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result = false;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $result; //Yay!<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48652""></a>
  <div class="note">
   <strong class="user">davidaylmer zebra gmail.com (zebra = at)</strong>
   <a href="#48652" class="date">03-Jan-2005 06:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just for the convienience of others...<br />
1000003 is a prime number<br />
<br />
So (double)microtime()*1000003 may work better for some applications.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48424""></a>
  <div class="note">
   <strong class="user">edublancoa at gmail dot com</strong>
   <a href="#48424" class="date">23-Dec-2004 01:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another use of srand is to obtain the same value of rand in a determined time interval. Example: you have an array of 100 elements and you need to obtain a random item every day but not to change in the 24h period (just imagine "Today's Photo" or similar).<br />
<span class="default">&lt;?php<br />
$seed </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">time</span><span class="keyword">()/</span><span class="default">86400</span><span class="keyword">);<br />
</span><span class="default">srand</span><span class="keyword">(</span><span class="default">$seed</span><span class="keyword">);<br />
</span><span class="default">$item </span><span class="keyword">= </span><span class="default">$examplearray</span><span class="keyword">[</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">99</span><span class="keyword">)];<br />
</span><span class="default">?&gt;<br />
</span>You obtain the same value every time you load the page all the 24h period.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45320""></a>
  <div class="note">
   <strong class="user">no at spam dot com</strong>
   <a href="#45320" class="date">01-Sep-2004 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I simply use this, and it has always worked fine:<br />
<br />
function initRand ()<br />
{<br />
&nbsp;&nbsp;&nbsp; static $randCalled = FALSE;<br />
&nbsp;&nbsp;&nbsp; if (!$randCalled)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; srand((double) microtime() * 1000000);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $randCalled = TRUE;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
function randNum ($low, $high)<br />
{<br />
&nbsp;&nbsp;&nbsp; initRand();<br />
&nbsp;&nbsp;&nbsp; $rNum = rand($low, $high);<br />
&nbsp;&nbsp;&nbsp; return $rNum;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43277""></a>
  <div class="note">
   <strong class="user">Codaholics dot com</strong>
   <a href="#43277" class="date">16-Jun-2004 10:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
office's comment about multiplying by 1234567 instead of 1000000 is slightly misguided for a couple of reasons.<br />
<br />
first, as the editor note would indicate, 1234567 is not a prime number.<br />
<br />
second, the problem he is attempting to fix is that the random values are slowly converging. this, however, is not a problem with the seeding of the random number generator, but a problem with the RNG itself.&nbsp; most default RNGs that come with programming languages will converge because they were written for efficiency and to function in everyday programs.<br />
<br />
if you need a Pseudo Random Number Generator (PRNG) that is cryptographically secure and does not converge after repeated use without seeding... you will unfortunately have to use a different generator.&nbsp; There are several out there such as the MersenneTwister, Yarrow (by Bruce Schneierer of Counterpane Security) and more being made every day.&nbsp; Due to the hassle of finding a reputable PRNG, it is recommended that you only need to use those for issues that require strong security such as gambling games and cryptography.<br />
<br />
hope this cleared things up :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26146""></a>
  <div class="note">
   <strong class="user">vinod at todays-deals dot com</strong>
   <a href="#26146" class="date">19-Oct-2002 01:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
hi,<br />
Here is one useful function that returns random string for given length<br />
<br />
//#########################//<br />
<br />
function randomstring($len) <br />
{<br />
&nbsp;&nbsp;&nbsp; srand(date("s"));<br />
&nbsp;&nbsp;&nbsp; while($i&lt;$len)<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $str.=chr((rand()%26)+97);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; <br />
&nbsp;&nbsp;&nbsp; $str=$str.substr(uniqid (""),0,22);<br />
&nbsp;&nbsp;&nbsp; return $str;<br />
}<br />
<br />
$rand_value=randomstring(10);<br />
<br />
//#########################//<br />
<br />
Thanks <br />
Vinod<br />
<br />
<a href="http://www.todays-deals.com" rel="nofollow" target="_blank">http://www.todays-deals.com</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="21052""></a>
  <div class="note">
   <strong class="user">office at  at universalmetropolis dot com</strong>
   <a href="#21052" class="date">26-Apr-2002 02:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's note: 1234567 is NOT a prime number]<br />
<br />
I created an application that requires millions of different random values replicating dice and have found over substantial time, the numbers even up towards the middle.<br />
<br />
May I suggest rather than this:<br />
<br />
(double)microtime()*1000000<br />
<br />
Use this instead:<br />
<br />
(double)microtime()*1234567<br />
<br />
1000000 is an even number, divisible by almost anything. 1234567 is a prime number and is hence uneven so it gives a little more flexibility with range.<br />
<br />
Don't know if this change was the main reason for affecting the application, but it seemed to help.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19321""></a>
  <div class="note">
   <strong class="user">ceo at l-i-e dot com</strong>
   <a href="#19321" class="date">22-Feb-2002 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In addition to my earlier post being stupidly coded with $wasseeded = TRUE :-| here is an update:<br />
<br />
In PHP4, I *BELIEVE* the random number generator will seed itself if you don't seed it.<br />
<br />
In PHP3, or some versions of PHP3?, that was not the case -- An unseeded rand() wouldn't be random.<br />
<br />
While it would "work fine" in terms of spitting out a number, an unseeded random number generator won't be very random in many situations unless it has been properly seeded.<br />
<br />
I'm afraid I can't explain all the details of why this is because A) it would be an entire textbook, and B) I don't know them all by heart, even if I understood them 20 years ago in college.<br />
<br />
If you are running PHP4, you are probably okay, and if you are happy with the randomness of your values, you are fine, but you may want to do a little test like:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; $stats</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$stats</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] = </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$stats</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] = </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">1000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$choice </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$i</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"First random choice: </span><span class="default">$choice</span><span class="string">&lt;BR&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$stats</span><span class="keyword">[</span><span class="default">$choice</span><span class="keyword">]++;<br />
&nbsp; }<br />
&nbsp; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$stats</span><span class="keyword">);<br />
&nbsp; while (list(</span><span class="default">$num</span><span class="keyword">, </span><span class="default">$count</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$stats</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$num</span><span class="string">: </span><span class="default">$count</span><span class="string">&lt;BR&gt;\n"</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Run the test a half-dozen times and check that the distribution of 1, 2, and 3 is even, and that the first number chosen is not the same every time.<br />
<br />
This is hardly an exhaustive test, but it at least gives some reassurance that the numbers aren't completely predictable.<br />
<br />
You may also wish to switch to <a href="http://php.net/mt_rand which is faster (if you generate a *LOT* of numbers" rel="nofollow" target="_blank">http://php.net/mt_rand which is faster (if you generate a *LOT* of numbers</a>) and allegedly a "better" (more random) function.<br />
<br />
Again, it would be an entire book to explain why mt_rand is "more random"...<br />
<br />
YMMV.&nbsp; If you're doing "Casino Slots" with real money, you'd better do your homework on this.&nbsp; If you're giving away a free CD or something silly, who cares?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="18393""></a>
  <div class="note">
   <strong class="user">sinister at cyberfrag dot com</strong>
   <a href="#18393" class="date">21-Jan-2002 11:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's pretty easy how he's getting a highly random number. Microtime measures the time since the Epoch (0:00:00 January 1, 1970 GMT). Microtime() returns a string of 2 parts, the current microsecond count, a space, and then the time since the Epoch. By using (double), he chops off the seconds-since-Epoch time, and uses the "current microsecond count" until the next second.<br />
<br />
Since time moves constantly, microseconds is the smallest unit a programming language makes use of, the current microseconds up until the next second will give you a million different numbers, every second. Now simply multiply the 0.xxxxxx number by 1,000,000 (like back in Jr. High School), and it will niftily place the 0.xxxxxx number in xxxxxx fashion for your seed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="16513""></a>
  <div class="note">
   <strong class="user">mlwmohawk at mohawksoft dot com</strong>
   <a href="#16513" class="date">02-Nov-2001 07:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
srand() is pretty tricky to get right. You should never seed a random number generator more than once per php process, if you do, your randomness is limited to the source of your seed.<br />
<br />
The microtime function's micro-seconds portion has a very finite resolution, that is why the make_seed function was added to the document. You should never get the same seed twice.<br />
<br />
In the later CVS versions, PHP will seed the random generator prior to performing a rand() if srand() was not previously called.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="16504""></a>
  <div class="note">
   <strong class="user">trobinson-a-t-gksystems-d-o-t-com</strong>
   <a href="#16504" class="date">02-Nov-2001 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The need to seed.<br />
You might run a script like this:<br />
&nbsp;&nbsp; echo mt_rand(0,99999999);<br />
a bunch of times, say by pressing Refresh in the browser, and get a different result each time. That is dependent on your web server. If the same apache/mod-php process lives through several invocations of the script, it won't reset the seed each time. But every php process will start with the same seed. If php is invoked as an external cgi, seed will always be the same. So... always seed!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15891""></a>
  <div class="note">
   <strong class="user">php_public at macfreek dot nl</strong>
   <a href="#15891" class="date">07-Oct-2001 08:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The make_seed() function in the example code is VERY bad, and is in fact responsible for seeding always the same value, so that the output of rand() is the same with every page reload (!)<br />
<br />
ALWAYS use:<br />
(double)microtime()*1000000<br />
<br />
See for more details my note on the mt_srand() page [ function.mt_srand.php ]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15866""></a>
  <div class="note">
   <strong class="user">houtex_boy-at-yahoo-dot-com</strong>
   <a href="#15866" class="date">05-Oct-2001 05:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The above function ^ will never execute anything. It should be something like this:<br />
<br />
function my_srand($seed = '')<br />
{<br />
&nbsp;&nbsp;&nbsp; static $wascalled = FALSE;<br />
&nbsp;&nbsp;&nbsp; if (!$wascalled){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $seed = $seed === '' ? (double) microtime() * 1000000 : $seed;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; srand($seed);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $wascalled = TRUE;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
&amp;nbsp;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15032""></a>
  <div class="note">
   <strong class="user">ceo at l-i-e dot com (fka richard at zend dot com)</strong>
   <a href="#15032" class="date">24-Aug-2001 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a way to be sure you only call srand once:<br />
<br />
function my_srand($seed = ''){<br />
&nbsp;&nbsp;&nbsp; static $wascalled = TRUE;<br />
&nbsp;&nbsp;&nbsp; if (!$wascalled){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $seed = $seed === '' ? (double) microtime() * 1000000 : $seed;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; srand($seed);<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14790""></a>
  <div class="note">
   
   <a href="#14790" class="date">14-Aug-2001 10:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have a ramdon circulater that changes a piece of text once a day, and I use the following code to make sure the see is unique enough.<br />
<br />
$tm = time();<br />
$today = mktime(0, 0, 0, (int)date("n", $tm), (int)date("j", $tm), (int)date("Y", $tm));&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
srand($today / pi());<br />
<br />
The pi works wonders for the whole thing and it works like a charm. Any other big decimal number will do as well, but pi is the most common "big" number.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14774""></a>
  <div class="note">
   <strong class="user">akukula at min dot pl</strong>
   <a href="#14774" class="date">14-Aug-2001 07:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Calling srand((double)microtime()*1000000),<br />
then $a=rand(1000000,9999999), then srand((double)microtime()*$a)<br />
adds nothing to the entrophy: the execution time of rand and srand is<br />
constant, so the second microtime() produces nothing really fascinating. You may safely use just the first srand().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14350""></a>
  <div class="note">
   <strong class="user">vonStahl at NOPE2SPAM dot ratio dot net</strong>
   <a href="#14350" class="date">27-Jul-2001 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How about&lt;br&gt;<br />
&lt;?<br />
srand((double)microtime()*1000000);<br />
$seed = rand(1000000,9999999);<br />
srand((double)microtime()*$seed);<br />
$yadda = rand (1,100);<br />
?&gt;&lt;br&gt;<br />
I used this in a test run with 1,000.000 calls for $yadda. Processing time increased by 0.0000061 seconds compared to a simple "srand((double)microtime()*1000000);" <br />
$yadda had the value of each number between 1 and 100 for between 0.99999122% and 1.00000872% of all calls. That's random and fast enough for me. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13136""></a>
  <div class="note">
   <strong class="user">rjones at ditzed dot org</strong>
   <a href="#13136" class="date">29-May-2001 12:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As a sidenote on the usage of srand():<br />
<br />
If you are making use of modular programming, it is probably better to try and call the srand routine from the parent script than from any modules you may be using (using REQUIRE or INCLUDE).<br />
This way you get around the possibility of calling srand() more than once from different modules.<br />
<br />
The flaw in this solution, of course, is when using modules produced by another programmer, or when producing modules for another programmer.<br />
You cannot rely on another programmer calling the srand function before calling the modular function, so you would have to include the srand function inside the module in this case.<br />
<br />
If you produce modules for use by other programmers then it is good practice to documentise the fact you have already called the srand function.<br />
Or if you use a modular function produced by someone else, check their documentation, or check their source code.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13135""></a>
  <div class="note">
   <strong class="user">rjones at ditzed dot org</strong>
   <a href="#13135" class="date">29-May-2001 11:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use the srand() seed "(double)microtime()*1000000" as mentioned by the richard@zend.com at the top of these user notes.<br />
<br />
The most notable effect of using any other seed is that your random numbers tend to follow the same, or very similar, sequences each time the script is invoked.<br />
<br />
Take note of the following script:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; srand</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
<br />
&nbsp; echo </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">) . </span><span class="string">", "</span><span class="keyword">;<br />
&nbsp; echo </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">) . </span><span class="string">", "</span><span class="keyword">;<br />
&nbsp; echo </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">) . </span><span class="string">", "</span><span class="keyword">;<br />
&nbsp; echo </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">) . </span><span class="string">", "</span><span class="keyword">;<br />
&nbsp; echo </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
If you seed the generator with a constant, say; the number 5 ($val = 5), then the sequence generated is always the same, in this case (0, 18, 7, 15, 17) (for me at least, different processors/processor speeds/operating systems/OS releases/PHP releases/webserver software may generate different sequences).<br />
<br />
If you seed the generator with time(), then the sequence is more random, but invokations that are very close together will have similar outputs.<br />
<br />
As richard@zend.com above suggests, the best seed to use is (double) microtime() * 1000000, as this gives the greatest amount of psuedo-randomness. In fact, it is random enough to suit most users.<br />
In a test program of 100000 random numbers between 1 and 20, the results were fairly balanced, giving an average of 5000 results per number, give or take 100. The deviation in each case varied with each invokation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="10953""></a>
  <div class="note">
   <strong class="user">MakeMoolah at themail dot com</strong>
   <a href="#10953" class="date">28-Jan-2001 03:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sorry about that...&nbsp; ok, forget have of what I said up there ^.<br />
<br />
The code that would prove my example is this:<br />
<br />
<span class="default">&lt;?php<br />
srand</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br />
echo(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">));<br />
</span><span class="default">srand</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br />
echo(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">));<br />
</span><span class="default">srand</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br />
echo(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
Each time you SHOULD get the same answer, but if you did this:<br />
<br />
<span class="default">&lt;?php<br />
srand</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br />
echo(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">));<br />
echo(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">));<br />
echo(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
then the answers would be different, and you'd be letting the random number formula do it's duty.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="8986""></a>
  <div class="note">
   <strong class="user">hagen at von-eitzen dot de</strong>
   <a href="#8986" class="date">10-Oct-2000 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is REALLY essential to make sure that srand is called only once.<br />
This is a bit difficult if the call is hidden somewhere in third-party code you include. For example, I used a standard banner script that *seemed* to work well putting<br />
three random banners in one frame. But in the long run, the choice appeared<br />
somewhat biased - probably because srand was called once per banner, not<br />
once per run.<br />
It would be nice if the random number generator worked like in PERL: If You use the random function without having called srand ever before in a script,<br />
srand is invoked before (and automatically with a nice seed, hopefully).<br />
I suggest that one should do something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">"IHaveCalledSrandBefore"</span><span class="keyword">]++) { <br />
&nbsp; </span><span class="default">srand</span><span class="keyword">((double) </span><span class="default">microtime</span><span class="keyword">() * </span><span class="default">1000000</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
(Depending on the situation, one might also work with a static variable instead)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="8911""></a>
  <div class="note">
   <strong class="user">richard at zend dot com</strong>
   <a href="#8911" class="date">05-Oct-2000 12:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
*ALWAYS* use<br />
(double)microtime()*1000000<br />
as your seed.<br />
Do *NOT* just use time().&nbsp; Do not add an extra 0 to make it "bigger".<br />
<br />
Take care to call srand() only *ONCE* per script.<br />
<br />
Calling<br />
(double)microtime()*1000000<br />
once, and only once, per script gives you the maximum "randomness" you can get.<br />
<br />
Anything else is sub-standard.&nbsp; If you want to understand why, there's a lot of reading you need to do...&nbsp; I don't know enough to point you to the best text to get started on this reading.&nbsp; For now, just trust the PHP Developers, okay?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.sqrt.html">sqrt</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.tan.html">tan</a></div>
 <div class="up"><a href="ref.math.html">Math Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
