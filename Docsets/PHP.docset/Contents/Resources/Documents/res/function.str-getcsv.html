<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Parse a CSV string into an array</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.sscanf.html">sscanf</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.str-ireplace.html">str_ireplace</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.str-getcsv" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">str_getcsv</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.3.0)</p><p class="refpurpose"><span class="refname">str_getcsv</span> &mdash; <span class="dc-title">
   Parse a CSV string into an array
  </span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.str-getcsv-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><b>str_getcsv</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$input</tt></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$delimiter</tt><span class="initializer"> = &#039;,&#039;</span></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$enclosure</tt><span class="initializer"> = &#039;&quot;&#039;</span></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$escape</tt><span class="initializer"> = &#039;\\&#039;</span></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   Parses a string input for fields in <acronym title="Comma Separated Value">CSV</acronym> format
   and returns an array containing the fields read.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.str-getcsv-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">input</tt></i></span>
     <dd>

      <p class="para">
       The string to parse.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">delimiter</tt></i></span>
     <dd>

      <p class="para">
       Set the field delimiter (one character only).
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">enclosure</tt></i></span>
     <dd>

      <p class="para">
       Set the field enclosure character (one character only).
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">escape</tt></i></span>
     <dd>

      <p class="para">
       Set the escape character (one character only). Defaults as a backslash
       (<i>\</i>)
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.str-getcsv-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns an indexed array containing the fields read.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.str-getcsv-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.fgetcsv.html" class="function" rel="rdfs-seeAlso">fgetcsv()</a> - Gets line from file pointer and parse for CSV fields</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106888""></a>
  <div class="note">
   <strong class="user">silaspalmer at gmail dot com</strong>
   <a href="#106888" class="date">15-Dec-2011 12:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a piece of code that parses Excel CSV correctly.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_csv</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">$comma</span><span class="keyword">=</span><span class="string">','</span><span class="keyword">,</span><span class="default">$quote</span><span class="keyword">=</span><span class="string">'"'</span><span class="keyword">,</span><span class="default">$newline</span><span class="keyword">=</span><span class="string">"\n"</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$db_quote </span><span class="keyword">= </span><span class="default">$quote </span><span class="keyword">. </span><span class="default">$quote</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Clean up file<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\r\n"</span><span class="keyword">,</span><span class="default">$newline</span><span class="keyword">,</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$db_quote</span><span class="keyword">,</span><span class="string">'&amp;quot;'</span><span class="keyword">,</span><span class="default">$file</span><span class="keyword">); </span><span class="comment">// replace double quotes with &amp;quot; HTML entities<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">',&amp;quot;,'</span><span class="keyword">,</span><span class="string">',,'</span><span class="keyword">,</span><span class="default">$file</span><span class="keyword">); </span><span class="comment">// handle ,"", empty cells correctly<br />
&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">.= </span><span class="default">$comma</span><span class="keyword">; </span><span class="comment">// Put a comma on the end, so we parse last cell&nbsp; <br />
&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$inquotes </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$start_point </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$row </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">$file</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$char </span><span class="keyword">== </span><span class="default">$quote</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$inquotes</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$inquotes </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$inquotes </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$char </span><span class="keyword">== </span><span class="default">$comma </span><span class="keyword">or </span><span class="default">$char </span><span class="keyword">== </span><span class="default">$newline</span><span class="keyword">) and !</span><span class="default">$inquotes</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">$start_point</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$start_point</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$quote</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$cell</span><span class="keyword">); </span><span class="comment">// Remove delimiter quotes<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'&amp;quot;'</span><span class="keyword">,</span><span class="default">$quote</span><span class="keyword">,</span><span class="default">$cell</span><span class="keyword">); </span><span class="comment">// Add in data quotes<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$row</span><span class="keyword">][] = </span><span class="default">$cell</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$start_point </span><span class="keyword">= </span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$char </span><span class="keyword">== </span><span class="default">$newline</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$row </span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">$file </span><span class="keyword">=</span><span class="string">'Year,Make,Model,Description,Price<br />
1997,Ford,E350,"ac, abs, moon",3000.00<br />
1999,Chevy,"Venture ""Extended Edition""","",4900.00<br />
1999,Chevy,"Venture ""Extended Edition, Very Large""","",5000.00<br />
1996,Jeep,Grand Cherokee,"MUST SELL!<br />
air, moon roof, loaded",4799.00'</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">parse_csv</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)); </span><span class="comment">// Returns what you'd expect. See <a href="http://en.wikipedia.org/wiki/Comma-separated_values for example" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Comma-separated_values for example</a><br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106674""></a>
  <div class="note">
   <strong class="user">xoneca at gmail dot com</strong>
   <a href="#106674" class="date">27-Nov-2011 04:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this function can also be used to parse other types of constructions. For example, I have used to parse .htaccess AddDescription lines:<br />
<br />
&nbsp;&nbsp;&nbsp; AddDescription "My description to the file." filename.jpg<br />
<br />
Those lines can be parsed like this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$line </span><span class="keyword">= </span><span class="string">'AddDescription "My description to the file." filename.jpg'</span><span class="keyword">;<br />
<br />
</span><span class="default">$parsed </span><span class="keyword">= </span><span class="default">str_getcsv</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$line</span><span class="keyword">, </span><span class="comment"># Input line<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">' '</span><span class="keyword">,&nbsp;&nbsp; </span><span class="comment"># Delimiter<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'"'</span><span class="keyword">,&nbsp;&nbsp; </span><span class="comment"># Enclosure<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'\\'&nbsp;&nbsp; </span><span class="comment"># Escape char<br />
</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">( </span><span class="default">$parsed </span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The output:<br />
<br />
array(3) {<br />
&nbsp; [0]=&gt;<br />
&nbsp; string(14) "AddDescription"<br />
&nbsp; [1]=&gt;<br />
&nbsp; string(27) "My description to the file."<br />
&nbsp; [2]=&gt;<br />
&nbsp; string(12) "filename.jpg"<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105981""></a>
  <div class="note">
   <strong class="user">ioplex at gmail dot com</strong>
   <a href="#105981" class="date">29-Sep-2011 08:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the CSV format handled by this function is not even close to being the same as the CSV emitted and consumed by spreadsheet programs. In truth, one could argue that the real CSV "specification" is actually just the behavior of Microsoft Excel and not an RFC that was written 20 years after Excel used CSV (although thankfully RFC 4180 is actually the same as Excel behavior with the exception that Excel actually uses a tab as a separator by default).<br />
<br />
CSV used by spreadsheet programs like Excel do not use escape characters to escape stray separator characters. Again, the default separator character is actually a tab and not a comma (but historically this is usually still referred to it as CSV). Excel uses quotes to enclose an element that has literal separator characters in it (and an extra quote to escape each literal quote within the quotes - strange but true). Another quirk is that Excel will not trim extra space around elements including line breaks. Meaning you can have multiple lines of text within an element by just putting it in quotes. See the Wikipedia entry for "Comma-separated values" for good examples that have quotes and escaped quotes and newlines and so on.<br />
<br />
Note that if you want to generate data that Excel will load into cells when someone clicks on a link, use tab as a separator, quote elements that have tabs or quotes and escape literal quotes with an extra preceding quote.<br />
<br />
The following routine can be used to properly quote an element and escape quotes with an extra quote in the way Excel expects:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">escapeCsvElement</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$sep</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$quot </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$si </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$slen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$si </span><span class="keyword">&lt; </span><span class="default">$slen</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$si</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$ch </span><span class="keyword">== </span><span class="default">$sep</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$quot </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$ch </span><span class="keyword">== </span><span class="string">'"'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$quot </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'"'</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$ch</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$si</span><span class="keyword">++;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$quot</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'"' </span><span class="keyword">. </span><span class="default">$ret </span><span class="keyword">. </span><span class="string">'"'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Then write each row to the browser terminated by carriage-return / newline linebreaks and send headers like:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; header</span><span class="keyword">(</span><span class="string">'Content-type: application/csv'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Disposition: attachment; filename=' </span><span class="keyword">. </span><span class="default">$filename</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This is what Excel and other spreadsheet programs expect to automatically load your cell data as expected without triggering the file import wizard.<br />
<br />
As for parsing real CSV, the *getcsv functions are not going to work. To parse the quotes and escaped quotes and literal line breaks and so on, that would be handled best with a proper state-machine parser.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105209""></a>
  <div class="note">
   <strong class="user">w_barath@hotmail,com</strong>
   <a href="#105209" class="date">02-Aug-2011 07:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For people who haven't got access to str_getcsv() in their version of PHP and want to convert strings from CSV, I have seen many huge swaths of code and regexes to do this extremely simple task.&nbsp; Here's minimal, fast code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">csv2array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">,</span><span class="default">$delimiter</span><span class="keyword">=</span><span class="string">','</span><span class="keyword">,</span><span class="default">$enclosure</span><span class="keyword">=</span><span class="string">'"'</span><span class="keyword">,</span><span class="default">$escape</span><span class="keyword">=</span><span class="string">'\\'</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fields</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$enclosure</span><span class="keyword">.</span><span class="default">$delimiter</span><span class="keyword">.</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$fields </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$escape</span><span class="keyword">.</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">$fields</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">array2csv</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">,</span><span class="default">$delimiter</span><span class="keyword">=</span><span class="string">','</span><span class="keyword">,</span><span class="default">$enclosure</span><span class="keyword">=</span><span class="string">'"'</span><span class="keyword">,</span><span class="default">$escape</span><span class="keyword">=</span><span class="string">'\\'</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$input </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$input</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">$escape</span><span class="keyword">.</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$enclosure</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="default">$enclosure</span><span class="keyword">.</span><span class="default">$delimiter</span><span class="keyword">.</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">$input</span><span class="keyword">).</span><span class="default">$enclosure</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$data</span><span class="keyword">=array(</span><span class="string">"one"</span><span class="keyword">,</span><span class="string">"\"two\""</span><span class="keyword">);<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">100</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$data</span><span class="keyword">=array(</span><span class="default">array2csv</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">),</span><span class="default">$i</span><span class="keyword">);<br />
echo </span><span class="string">"Encoded </span><span class="default">$i</span><span class="string"> times..."</span><span class="keyword">.</span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
for (</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$i</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">++) </span><span class="default">$data</span><span class="keyword">=</span><span class="default">csv2array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
echo </span><span class="string">"Decoded </span><span class="default">$i</span><span class="string"> times..."</span><span class="keyword">.</span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Pretty straightforward.&nbsp; ;-)<br />
<br />
Yes, I intentionally changed the function names,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104558""></a>
  <div class="note">
   <strong class="user">M. Bunge (TLC Communications, DE)</strong>
   <a href="#104558" class="date">22-Jun-2011 05:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just another way to convert a csv file to an associative array.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//<br />
// Convert csv file to associative array:<br />
//<br />
<br />
</span><span class="keyword">function </span><span class="default">csv_to_array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">=</span><span class="string">'|'</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$csvData </span><span class="keyword">= </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$csvData </span><span class="keyword">as </span><span class="default">$csvLine</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">)) </span><span class="default">$header </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$csvLine</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$csvLine</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$n </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$m </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">); </span><span class="default">$n </span><span class="keyword">&lt; </span><span class="default">$m</span><span class="keyword">; </span><span class="default">$n</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$prepareData</span><span class="keyword">[</span><span class="default">$header</span><span class="keyword">[</span><span class="default">$n</span><span class="keyword">]] = </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$n</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[] = </span><span class="default">$prepareData</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//-----------------------------------<br />
//<br />
//Usage:<br />
<br />
</span><span class="default">$csvArr </span><span class="keyword">= </span><span class="default">csv_to_array</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'test.csv'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101888""></a>
  <div class="note">
   <strong class="user">durik at 3ilab dot net</strong>
   <a href="#101888" class="date">16-Jan-2011 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As the str_getcsv(), unlike to fgetcsv(), does not parse the rows in CSV string, I have found following easy workaround:<br />
<br />
<span class="default">&lt;?php<br />
$Data </span><span class="keyword">= </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$CsvString</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">); </span><span class="comment">//parse the rows<br />
</span><span class="keyword">foreach(</span><span class="default">$Data </span><span class="keyword">as &amp;</span><span class="default">$Row</span><span class="keyword">) </span><span class="default">$Row </span><span class="keyword">= </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$Row</span><span class="keyword">, </span><span class="string">";"</span><span class="keyword">); </span><span class="comment">//parse the items in rows<br />
</span><span class="default">?&gt;<br />
</span><br />
Why not use explode() instead of str_getcsv() to parse rows? Because explode() would not treat possible enclosured parts of string or escaped characters correctly.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100579""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#100579" class="date">25-Oct-2010 12:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your version of PHP doesn't have `str_getcsv` and you don't need custom $escape or $eol values, try this:<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'str_getcsv'</span><span class="keyword">)) {<br />
&nbsp;<br />
function </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">=</span><span class="string">','</span><span class="keyword">, </span><span class="default">$enclosure</span><span class="keyword">=</span><span class="string">'"'</span><span class="keyword">, </span><span class="default">$escape</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">, </span><span class="default">$eol</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$temp</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"php://memory"</span><span class="keyword">, </span><span class="string">"rw"</span><span class="keyword">);<br />
&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">);<br />
&nbsp; </span><span class="default">fseek</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">= array();<br />
&nbsp; while ((</span><span class="default">$data </span><span class="keyword">= </span><span class="default">fgetcsv</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$enclosure</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[] = </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$r</span><span class="keyword">;<br />
}<br />
&nbsp;<br />
} </span><span class="default">?&gt;<br />
</span><br />
[EDIT BY danbrown AT php DOT net: Contains a bugfix provided by (depely AT IAMNOTABOT prestaconcept.net) on 04-MAR-2011 with the following note: "The previous anonymous function only read the first line".]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99323""></a>
  <div class="note">
   <strong class="user">Jay Williams</strong>
   <a href="#99323" class="date">10-Aug-2010 01:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a quick and easy way to convert a CSV file to an associated array:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* @link <a href="http://gist.github.com/385876" rel="nofollow" target="_blank">http://gist.github.com/385876</a><br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">csv_to_array</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">=</span><span class="string">','</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) || !</span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; if ((</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">)) !== </span><span class="default">FALSE</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$row </span><span class="keyword">= </span><span class="default">fgetcsv</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">1000</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">)) !== </span><span class="default">FALSE</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$header</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">$row</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[] = </span><span class="default">array_combine</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98088""></a>
  <div class="note">
   <strong class="user">hpartidas at deuz dot net</strong>
   <a href="#98088" class="date">25-May-2010 09:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found myself wanting to parse a CSV and didn't have access to str_getcsv, so I wrote substitute for PHP &lt; 5.3, hope it helps someone out there stuck in the same situation.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'str_getcsv'</span><span class="keyword">)) { <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter </span><span class="keyword">= </span><span class="string">','</span><span class="keyword">, </span><span class="default">$enclosure </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">, </span><span class="default">$escape </span><span class="keyword">= </span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">$eol </span><span class="keyword">= </span><span class="string">'\n'</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">) &amp;&amp; !empty(</span><span class="default">$input</span><span class="keyword">)) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">= array(); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$eol</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">,</span><span class="default">$input</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">) &amp;&amp; !empty(</span><span class="default">$tmp</span><span class="keyword">)) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (list(</span><span class="default">$line_num</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">)) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$escape</span><span class="keyword">.</span><span class="default">$enclosure</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">,</span><span class="default">$line</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$strlen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">)) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos_delimiter&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">,</span><span class="default">$delimiter</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos_enclosure_start </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">,</span><span class="default">$enclosure</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$pos_delimiter</span><span class="keyword">) &amp;&amp; </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$pos_enclosure_start</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &amp;&amp; (</span><span class="default">$pos_enclosure_start </span><span class="keyword">&lt; </span><span class="default">$pos_delimiter</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$enclosed_str </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos_enclosure_end </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$enclosed_str</span><span class="keyword">,</span><span class="default">$enclosure</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$enclosed_str </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$enclosed_str</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$pos_enclosure_end</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[</span><span class="default">$line_num</span><span class="keyword">][] = </span><span class="default">$enclosed_str</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">$pos_enclosure_end</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (empty(</span><span class="default">$pos_delimiter</span><span class="keyword">) &amp;&amp; empty(</span><span class="default">$pos_enclosure_start</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[</span><span class="default">$line_num</span><span class="keyword">][] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[</span><span class="default">$line_num</span><span class="keyword">][] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$pos_delimiter</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; !empty(</span><span class="default">$pos_enclosure_start</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &amp;&amp; (</span><span class="default">$pos_enclosure_start </span><span class="keyword">&lt; </span><span class="default">$pos_delimiter</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ?</span><span class="default">$pos_enclosure_start<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">:</span><span class="default">$pos_delimiter</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">,</span><span class="default">$offset</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$delimiter</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">,</span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * Validating against pesky extra line breaks creating false rows.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">) &amp;&amp; !empty(</span><span class="default">$line</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[</span><span class="default">$line_num</span><span class="keyword">] = </span><span class="default">$line</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$output</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96299""></a>
  <div class="note">
   <strong class="user">vincent dot enjalbert at gmail dot com</strong>
   <a href="#96299" class="date">19-Feb-2010 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For multiline array, just use :<br />
<br />
<span class="default">&lt;?php<br />
$csvData </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">);<br />
</span><span class="default">$csvNumColumns </span><span class="keyword">= </span><span class="default">22</span><span class="keyword">;<br />
</span><span class="default">$csvDelim </span><span class="keyword">= </span><span class="string">";"</span><span class="keyword">;<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">array_chunk</span><span class="keyword">(</span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$csvData</span><span class="keyword">, </span><span class="default">$csvDelim</span><span class="keyword">), </span><span class="default">$csvNumColumns</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95132""></a>
  <div class="note">
   <strong class="user">Raymond</strong>
   <a href="#95132" class="date">14-Dec-2009 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a little function to convert a multi-line CSV string to an array:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">csv_to_array</span><span class="keyword">(</span><span class="default">$csv</span><span class="keyword">, </span><span class="default">$delimiter </span><span class="keyword">= </span><span class="string">','</span><span class="keyword">, </span><span class="default">$enclosure </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">, </span><span class="default">$escape </span><span class="keyword">= </span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">$terminator </span><span class="keyword">= </span><span class="string">"\n"</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rows </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$terminator</span><span class="keyword">,</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$csv</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$names </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$rows</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$names </span><span class="keyword">= </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$names</span><span class="keyword">,</span><span class="default">$delimiter</span><span class="keyword">,</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">$escape</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nc </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$names</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$rows </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">= </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">,</span><span class="default">$delimiter</span><span class="keyword">,</span><span class="default">$enclosure</span><span class="keyword">,</span><span class="default">$escape</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$values</span><span class="keyword">) </span><span class="default">$values </span><span class="keyword">= </span><span class="default">array_fill</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$nc</span><span class="keyword">,</span><span class="default">null</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[] = </span><span class="default">array_combine</span><span class="keyword">(</span><span class="default">$names</span><span class="keyword">,</span><span class="default">$values</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$r</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94022""></a>
  <div class="note">
   <strong class="user">Jrg Wagner</strong>
   <a href="#94022" class="date">12-Oct-2009 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a very concise replacement for str_getcsv. <br />
No escaping of the enclosure char though, but an additional possibility to preserve the enclosing characters around a field. <br />
Note that the fourth parameter therefore has a different meaning!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">csv_explode</span><span class="keyword">(</span><span class="default">$delim</span><span class="keyword">=</span><span class="string">','</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$enclose</span><span class="keyword">=</span><span class="string">'"'</span><span class="keyword">, </span><span class="default">$preserve</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">){<br />
&nbsp; </span><span class="default">$resArr </span><span class="keyword">= array();<br />
&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$expEncArr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$enclose</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
&nbsp; foreach(</span><span class="default">$expEncArr </span><span class="keyword">as </span><span class="default">$EncItem</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$n</span><span class="keyword">++%</span><span class="default">2</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$resArr</span><span class="keyword">, </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$resArr</span><span class="keyword">) . (</span><span class="default">$preserve</span><span class="keyword">?</span><span class="default">$enclose</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">) . </span><span class="default">$EncItem</span><span class="keyword">.(</span><span class="default">$preserve</span><span class="keyword">?</span><span class="default">$enclose</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$expDelArr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delim</span><span class="keyword">, </span><span class="default">$EncItem</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$resArr</span><span class="keyword">, </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$resArr</span><span class="keyword">) . </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$expDelArr</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$resArr </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$resArr</span><span class="keyword">, </span><span class="default">$expDelArr</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$resArr</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91306""></a>
  <div class="note">
   <strong class="user">dave_walter at yahoo dot com</strong>
   <a href="#91306" class="date">04-Jun-2009 09:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to clarify, my str_putcsv() function was only ever designed to complement the functionality of the str_getcsv() built-in function, which can only handle converting one line of input into a single level array. For example, this code:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; var_dump</span><span class="keyword">( </span><span class="default">str_getcsv</span><span class="keyword">( </span><span class="string">"a,b,c\nd,e,f"</span><span class="keyword">, </span><span class="string">"," </span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
generates this output:<br />
<br />
array(5) {<br />
&nbsp;&nbsp;&nbsp; [0]=&gt;<br />
&nbsp;&nbsp;&nbsp; string(1) "a"<br />
&nbsp;&nbsp;&nbsp; [1]=&gt;<br />
&nbsp;&nbsp;&nbsp; string(1) "b"<br />
&nbsp;&nbsp;&nbsp; [2]=&gt;<br />
&nbsp;&nbsp;&nbsp; string(3) "c<br />
&nbsp;&nbsp;&nbsp; d"<br />
&nbsp;&nbsp;&nbsp; [3]=&gt;<br />
&nbsp;&nbsp;&nbsp; string(1) "e"<br />
&nbsp;&nbsp;&nbsp; [4]=&gt;<br />
&nbsp;&nbsp;&nbsp; string(1) "f"<br />
}<br />
<br />
Even fgetcsv() and fputcsv() only work with a single line. All the examples show them being used within a loop of some sort.<br />
<br />
I was also avoiding the artificial restriction on the length of the CSV string introduced by Ulf's modification.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91170""></a>
  <div class="note">
   <strong class="user">Ulf</strong>
   <a href="#91170" class="date">28-May-2009 06:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As Dave's function also had the problem with only one line being returned here's a slightly changed version:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">str_putcsv</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter </span><span class="keyword">= </span><span class="string">','</span><span class="keyword">, </span><span class="default">$enclosure </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// Open a memory "file" for read/write...<br />
&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://temp'</span><span class="keyword">, </span><span class="string">'r+'</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// ... write the $input array to the "file" using fputcsv()...<br />
&nbsp; </span><span class="default">fputcsv</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$enclosure</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// ... rewind the "file" so we can read what we just wrote...<br />
&nbsp; </span><span class="default">rewind</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// ... read the entire line into a variable...<br />
&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1048576</span><span class="keyword">); </span><span class="comment">// [changed]<br />
&nbsp; // ... close the "file"...<br />
&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// ... and return the $data to the caller, with the trailing newline from fgets() removed.<br />
&nbsp; </span><span class="keyword">return </span><span class="default">rtrim</span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, </span><span class="string">"\n" </span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span>It assumes that one line won't exceed 1Mb of data. That should be more than enough.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89619""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#89619" class="date">16-Mar-2009 10:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For some reason o'connor's code only reads one line of a csv for me... I had to replace the line <br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $data = fgetcsv($fp, 1000, $delimiter, $enclosure); //&nbsp; $escape only got added in 5.3.0 <br />
<br />
with this:<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $data;<br />
&nbsp;&nbsp; &nbsp;&nbsp; while (!feof($fp))<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $data[] = fgetcsv($fp, 0, $delimiter, $enclosure); //&nbsp; $escape only got added in 5.3.0<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
...to get all of the data out of my string (some post data pasted into a textbox and processed only with stripslashes).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88773""></a>
  <div class="note">
   <strong class="user">dave_walter at NOSPAM dot yahoo dot com</strong>
   <a href="#88773" class="date">06-Feb-2009 03:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Drawing inspiration from daniel dot oconnor at gmail dot com, here's an alternative str_putcsv() that leverages existing PHP core functionality (5.1.0+) to avoid re-inventing the wheel.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'str_putcsv'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">str_putcsv</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter </span><span class="keyword">= </span><span class="string">','</span><span class="keyword">, </span><span class="default">$enclosure </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Open a memory "file" for read/write...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://temp'</span><span class="keyword">, </span><span class="string">'r+'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ... write the $input array to the "file" using fputcsv()...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputcsv</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$enclosure</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ... rewind the "file" so we can read what we just wrote...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">rewind</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ... read the entire line into a variable...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ... close the "file"...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ... and return the $data to the caller, with the trailing newline from fgets() removed.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">rtrim</span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, </span><span class="string">"\n" </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88353""></a>
  <div class="note">
   <strong class="user">Jeremy</strong>
   <a href="#88353" class="date">20-Jan-2009 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After using several methods in the past to create CSV strings without using files (disk IO sucks), I finally decided it's time to write a function to handle it all. This function could use some cleanup, and the variable type test might be overkill for what is needed, I haven't thought about it too much.<br />
<br />
Also, I took the liberty of replacing fields with certain data types with strings which I find much easier to work with. Some of you may not agree with those. Also, please note that the type "double" or float has been coded specifically for two digit precision because if I am using a float, it's most likely for currency.<br />
<br />
I am sure some of you out there would appreciate this function.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">str_putcsv</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$delimiter </span><span class="keyword">= </span><span class="string">','</span><span class="keyword">, </span><span class="default">$enclosure </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">, </span><span class="default">$terminator </span><span class="keyword">= </span><span class="string">"\n"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># First convert associative array to numeric indexed array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) </span><span class="default">$workArray</span><span class="keyword">[] = </span><span class="default">$value</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnString </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Initialize return string<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arraySize </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$workArray</span><span class="keyword">);&nbsp; &nbsp;&nbsp; </span><span class="comment"># Get size of array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$arraySize</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Nested array, process nest item<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$workArray</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnString </span><span class="keyword">.= </span><span class="default">str_putcsv</span><span class="keyword">(</span><span class="default">$workArray</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$enclosure</span><span class="keyword">, </span><span class="default">$terminator</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$workArray</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Manually set some strings<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">"NULL"</span><span class="keyword">:&nbsp; &nbsp;&nbsp; </span><span class="default">$_spFormat </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"boolean"</span><span class="keyword">:&nbsp; </span><span class="default">$_spFormat </span><span class="keyword">= (</span><span class="default">$workArray</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] == </span><span class="default">true</span><span class="keyword">) ? </span><span class="string">'true'</span><span class="keyword">: </span><span class="string">'false'</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Make sure sprintf has a good datatype to work with<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">"integer"</span><span class="keyword">:&nbsp; </span><span class="default">$_spFormat </span><span class="keyword">= </span><span class="string">'%i'</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"double"</span><span class="keyword">:&nbsp;&nbsp; </span><span class="default">$_spFormat </span><span class="keyword">= </span><span class="string">'%0.2f'</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"string"</span><span class="keyword">:&nbsp;&nbsp; </span><span class="default">$_spFormat </span><span class="keyword">= </span><span class="string">'%s'</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Unknown or invalid items for a csv - note: the datatype of array is already handled above, assuming the data is nested<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">"object"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"resource"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_spFormat </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnString </span><span class="keyword">.= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%2$s'</span><span class="keyword">.</span><span class="default">$_spFormat</span><span class="keyword">.</span><span class="string">'%2$s'</span><span class="keyword">, </span><span class="default">$workArray</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$enclosure</span><span class="keyword">);<br />
</span><span class="default">$returnString </span><span class="keyword">.= (</span><span class="default">$i </span><span class="keyword">&lt; (</span><span class="default">$arraySize</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)) ? </span><span class="default">$delimiter </span><span class="keyword">: </span><span class="default">$terminator</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Done the workload, return the output information<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$returnString</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88311""></a>
  <div class="note">
   <strong class="user">daniel dot oconnor at gmail dot com</strong>
   <a href="#88311" class="date">19-Jan-2009 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't have this? Ask fgetcsv() to do it for you.<br />
<br />
5.1.0+<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'str_getcsv'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$delimiter </span><span class="keyword">= </span><span class="string">","</span><span class="keyword">, </span><span class="default">$enclosure </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">, </span><span class="default">$escape </span><span class="keyword">= </span><span class="string">"\\"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fiveMBs </span><span class="keyword">= </span><span class="default">5 </span><span class="keyword">* </span><span class="default">1024 </span><span class="keyword">* </span><span class="default">1024</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"php://temp/maxmemory:</span><span class="default">$fiveMBs</span><span class="string">"</span><span class="keyword">, </span><span class="string">'r+'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">rewind</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">fgetcsv</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1000</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$enclosure</span><span class="keyword">); </span><span class="comment">//&nbsp; $escape only got added in 5.3.0<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88141""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#88141" class="date">12-Jan-2009 08:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks Rob, have used your code. It needs a minor tweak so that the delimiter option is processed as it should be. Line 5 should read:<br />
<br />
<span class="default">&lt;?php&nbsp; &nbsp; $expr</span><span class="keyword">=</span><span class="string">"/</span><span class="default">$delimiter</span><span class="string">(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))/"</span><span class="keyword">; </span><span class="comment">// added </span><span class="default">?&gt;<br />
</span><br />
instead of:<br />
<br />
<span class="default">&lt;?php&nbsp; &nbsp; $expr</span><span class="keyword">=</span><span class="string">"/,(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))/"</span><span class="keyword">; </span><span class="comment">// added </span><span class="default">?&gt;<br />
</span><br />
JS, London</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86879""></a>
  <div class="note">
   <strong class="user">Rob</strong>
   <a href="#86879" class="date">07-Nov-2008 08:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This does the same as the example below, giving you an array, but it allows to parse csv with commas in between quotes (used for addresses)... and it takes out the quotes from an array entry as well.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_csv</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$options </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$delimiter </span><span class="keyword">= empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'delimiter'</span><span class="keyword">]) ? </span><span class="string">"," </span><span class="keyword">: </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'delimiter'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$to_object </span><span class="keyword">= empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'to_object'</span><span class="keyword">]) ? </span><span class="default">false </span><span class="keyword">: </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$expr</span><span class="keyword">=</span><span class="string">"/</span><span class="default">$delimiter</span><span class="string">(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))/"</span><span class="keyword">; </span><span class="comment">// added<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$field_names </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$lines </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Skip the empty line<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (empty(</span><span class="default">$line</span><span class="keyword">)) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fields </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="default">$expr</span><span class="keyword">,</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">)); </span><span class="comment">// added<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fields </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/^\"(.*)\"$/s"</span><span class="keyword">,</span><span class="string">"$1"</span><span class="keyword">,</span><span class="default">$fields</span><span class="keyword">); </span><span class="comment">//added<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //$fields = explode($delimiter, $line);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_res </span><span class="keyword">= </span><span class="default">$to_object </span><span class="keyword">? new </span><span class="default">stdClass </span><span class="keyword">: array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$field_names </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$f</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$to_object</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_res</span><span class="keyword">-&gt;{</span><span class="default">$f</span><span class="keyword">} = </span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_res</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">] = </span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res</span><span class="keyword">[] = </span><span class="default">$_res</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$res</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
[EDIT BY danbrown AT php DOT net: Includes bugfixes provided by "Anonymous" on 12-JAN-09 and "joelfromlollypins.com" on 19-JAN-09.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85799""></a>
  <div class="note">
   <strong class="user">william dot j dot weir at gmail dot com</strong>
   <a href="#85799" class="date">18-Sep-2008 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your happy enough having just a multi-dimensional array, this should work fine. I had wanted to use the one provided by keananda but it was choking on pr($lines).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">f_parse_csv</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$longest</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$mdarray </span><span class="keyword">= array();<br />
&nbsp; </span><span class="default">$file&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br />
&nbsp; while (</span><span class="default">$line </span><span class="keyword">= </span><span class="default">fgetcsv</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$longest</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$mdarray</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$mdarray</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
$longest is a number that represents the longest line in the csv file as required by fgetcsv().&nbsp; The page for fgetcsv() said that the longest line could be set to 0 or left out, but I couldn't get it to work without. I just made it extra large when I had to use it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85733""></a>
  <div class="note">
   <strong class="user">keananda at gmail dot com</strong>
   <a href="#85733" class="date">15-Sep-2008 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who need this function but not yet installed in their environment, you can use my function bellow.<br />
<br />
You can parse your csv file into an associative array (by default) for each lines, or into an object.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_csv</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$options </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$delimiter </span><span class="keyword">= empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'delimiter'</span><span class="keyword">]) ? </span><span class="string">"," </span><span class="keyword">: </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'delimiter'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$to_object </span><span class="keyword">= empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'to_object'</span><span class="keyword">]) ? </span><span class="default">false </span><span class="keyword">: </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">pr</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$field_names </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$lines </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Skip the empty line<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (empty(</span><span class="default">$line</span><span class="keyword">)) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fields </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_res </span><span class="keyword">= </span><span class="default">$to_object </span><span class="keyword">? new </span><span class="default">stdClass </span><span class="keyword">: array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$field_names </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$f</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$to_object</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_res</span><span class="keyword">-&gt;{</span><span class="default">$f</span><span class="keyword">} = </span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_res</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">] = </span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res</span><span class="keyword">[] = </span><span class="default">$_res</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$res</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
NOTE:<br />
Line number 1 of the csv file will be considered as header (field names).<br />
<br />
TODO:<br />
- Enclosure handling<br />
- Escape character handling<br />
- Other features/enhancements as you need<br />
<br />
EXAMPLE USE:<br />
Content of /path/to/file.csv:<br />
CODE,COUNTRY<br />
AD,Andorra<br />
AE,United Arab Emirates<br />
AF,Afghanistan<br />
AG,Antigua and Barbuda<br />
<br />
<span class="default">&lt;?php<br />
$arr_csv </span><span class="keyword">= </span><span class="default">parse_csv</span><span class="keyword">(</span><span class="string">"/path/to/file.csv"</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arr_csv</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>// Output:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AD<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; Andorra<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AE<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; United Arab Emirates<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AF<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; Afghanistan<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AG<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; Antigua and Barbuda<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
)<br />
<br />
<span class="default">&lt;?php<br />
$obj_csv </span><span class="keyword">= </span><span class="default">parse_csv</span><span class="keyword">(</span><span class="string">"/path/to/file.csv"</span><span class="keyword">, array(</span><span class="string">"to_object" </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">));<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$obj_csv</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>// Output:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; stdClass Object<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AD<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; Andorra&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; stdClass Object<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AE<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; United Arab Emirates&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; stdClass Object<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AF<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; Afghanistan&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; stdClass Object<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; AG<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; Antigua and Barbuda&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; stdClass Object<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [CODE] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [COUNTRY] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
)<br />
<br />
// If you use character | (pipe) as delimiter in your csv file, use:<br />
<span class="default">&lt;?php<br />
$arr_csv </span><span class="keyword">= </span><span class="default">parse_csv</span><span class="keyword">(</span><span class="string">"/path/to/file.csv"</span><span class="keyword">, array(</span><span class="string">"delimiter"</span><span class="keyword">=&gt;</span><span class="string">"|"</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
==NSD==</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83729""></a>
  <div class="note">
   <strong class="user">colin_mckinnon at slc dot co dot uk</strong>
   <a href="#83729" class="date">09-Jun-2008 09:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding RFC 4180 - I asked the author about the specifics of the format described which poses a number of technical difficulties in building a parser - his response is shown below:<br />
<br />
quote:<br />
<br />
Please do keep one thing in mind - this RFC<br />
was meant to define the MIME type for CSV rather than the format. It<br />
happens to be that no format definition existed and I was forced to<br />
define one. As the RFC states:<br />
<br />
"This section documents the format that seems to be followed by most<br />
implementations"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82995""></a>
  <div class="note">
   <strong class="user">csv at rfc dot org</strong>
   <a href="#82995" class="date">05-May-2008 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
RFC 4180 which deals with CSVs states the escape character is supposed to be a double quotation mark: (page 2)<br />
&nbsp;&nbsp; 7.&nbsp; If double-quotes are used to enclose fields, then a double-quote<br />
&nbsp;&nbsp; &nbsp; &nbsp; appearing inside a field must be escaped by preceding it with<br />
&nbsp;&nbsp; &nbsp; &nbsp; another double quote.&nbsp; For example:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; "aaa","b""bb","ccc"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82651""></a>
  <div class="note">
   <strong class="user">peev[dot]alexander at gmail dot com</strong>
   <a href="#82651" class="date">20-Apr-2008 02:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
CSV parsing and storage is not that hard to implement - see my example functions ( I believe they do a pretty good job - I use them in a production environment ):<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if( !</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">"parse_csv"</span><span class="keyword">) ){<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">parse_csv</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">){<br />
</span><span class="comment">/* Author : Alexander Peev, posted at PHP.NET */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( !</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">"parse_csv_aux"</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">parse_csv_aux</span><span class="keyword">( </span><span class="default">$string </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$in_quote </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$skipped_quote </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) ; </span><span class="default">$i</span><span class="keyword">++&nbsp; ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">} == </span><span class="string">"\"" </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$in_quote</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$skipped_quote</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">"\""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$skipped_quote </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if( !</span><span class="default">$skipped_quote </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$skipped_quote </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$skipped_quote</span><span class="keyword">) </span><span class="default">$skipped_quote </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$in_quote </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if( </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">} == </span><span class="string">";" </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$in_quote</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">";"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">" ; "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$in_quote</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$in_quote </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$product</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(&nbsp; </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) &amp;&amp; ( </span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">) !== </span><span class="default">FALSE </span><span class="keyword">)&nbsp; ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">parse_csv_aux</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$row</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$columns </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//$row = strtr(&nbsp; $row, array( "\";\"" =&gt; "\";\"", ";" =&gt; " ; " )&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">, </span><span class="string">" ; "</span><span class="keyword">) !== </span><span class="default">FALSE </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$columns </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">" ; "</span><span class="keyword">, </span><span class="default">$row </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">) )</span><span class="default">$columns </span><span class="keyword">= array( </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$columns</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if(&nbsp; </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) &amp;&amp; ( </span><span class="default">stripos</span><span class="keyword">( (</span><span class="default">$string </span><span class="keyword">=&nbsp; </span><span class="default">parse_csv_aux</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)), </span><span class="string">" ; "</span><span class="keyword">) !== </span><span class="default">FALSE </span><span class="keyword">)&nbsp; ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$columns </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">" ; "</span><span class="keyword">, </span><span class="default">$string </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">) )</span><span class="default">$columns </span><span class="keyword">= array( </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return array(</span><span class="default">$columns</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else return </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } </span><span class="comment">/* end function parse_csv */<br />
</span><span class="keyword">} </span><span class="comment">/* end not function exists parse_csv */<br />
<br />
</span><span class="keyword">if( !</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">"store_csv"</span><span class="keyword">) ){<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">store_csv</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">){<br />
</span><span class="comment">/* Author : Alexander Peev, posted at PHP.NET */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( !</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">"store_csv_aux"</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">store_csv_aux</span><span class="keyword">( </span><span class="default">$string </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">strtr</span><span class="keyword">( </span><span class="default">$string</span><span class="keyword">, array( </span><span class="string">"\n" </span><span class="keyword">=&gt; </span><span class="string">"" </span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$in_quote </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) ; </span><span class="default">$i</span><span class="keyword">++&nbsp; ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">} == </span><span class="string">"\"" </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$in_quote</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">"\"\""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">"\"\"\""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$in_quote </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if( </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">} == </span><span class="string">";" </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$in_quote</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">";"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">"\";"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$in_quote </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$in_quote</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="string">"\""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$in_quote </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$in_quote</span><span class="keyword">)</span><span class="default">$product </span><span class="keyword">.= </span><span class="string">"\""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$product</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">))return </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$passed_rows </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$passed_rows </span><span class="keyword">)</span><span class="default">$product </span><span class="keyword">.= </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$columns </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$passed_cols </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$row </span><span class="keyword">as </span><span class="default">$column</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$passed_cols </span><span class="keyword">)</span><span class="default">$columns </span><span class="keyword">.= </span><span class="string">";"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$columns </span><span class="keyword">.= </span><span class="default">store_csv_aux</span><span class="keyword">( </span><span class="default">$column </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$passed_cols </span><span class="keyword">=</span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$columns</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$product </span><span class="keyword">.= </span><span class="default">strtr</span><span class="keyword">( </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">), array(</span><span class="string">"\n" </span><span class="keyword">=&gt; </span><span class="string">""</span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$passed_rows </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$product</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } </span><span class="comment">/* end function store_csv */<br />
</span><span class="keyword">} </span><span class="comment">/* end not function exists store_csv */<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73287""></a>
  <div class="note">
   <strong class="user">justin at cam dot org</strong>
   <a href="#73287" class="date">15-Feb-2007 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There's a discussion of how to perform this task in the user notes for the split() function.<br />
<a href="http://www.php.net/manual/en/function.split.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/function.split.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.sscanf.html">sscanf</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.str-ireplace.html">str_ireplace</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
