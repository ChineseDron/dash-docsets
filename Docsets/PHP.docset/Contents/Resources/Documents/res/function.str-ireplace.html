<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Case-insensitive version of str_replace.</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.str-getcsv.html">str_getcsv</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.str-pad.html">str_pad</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.str-ireplace" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">str_ireplace</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">str_ireplace</span> &mdash; <span class="dc-title">Case-insensitive version of <span class="function"><a href="function.str-replace.html" class="function">str_replace()</a></span>.</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.str-ireplace-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <span class="methodname"><b>str_ireplace</b></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$search</tt></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$replace</tt></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$subject</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter reference">&$count</tt></span>
  ] )</div>

  <p class="para rdfs-comment">
   This function returns a string or an array with all occurrences of
   <i><tt class="parameter">search</tt></i> in <i><tt class="parameter">subject</tt></i>
   (ignoring case) replaced with the given <i><tt class="parameter">replace</tt></i>
   value.  If you don&#039;t need fancy replacing rules, you should generally
   use this function instead of
   <span class="function"><a href="function.preg-replace.html" class="function">preg_replace()</a></span> with the <i>i</i> modifier.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.str-ireplace-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   If <i><tt class="parameter">search</tt></i> and <i><tt class="parameter">replace</tt></i> are
   arrays, then <span class="function"><b>str_ireplace()</b></span> takes a value from each
   array and uses them to search and replace on
   <i><tt class="parameter">subject</tt></i>. If <i><tt class="parameter">replace</tt></i> has fewer
   values than <i><tt class="parameter">search</tt></i>, then an empty string is used for
   the rest of replacement values. If <i><tt class="parameter">search</tt></i> is an
   array and <i><tt class="parameter">replace</tt></i> is a string, then this replacement
   string is used for every value of <i><tt class="parameter">search</tt></i>. The
   converse would not make sense, though.
  </p>
  <p class="para">
   If <i><tt class="parameter">search</tt></i> or <i><tt class="parameter">replace</tt></i>
   are arrays, their elements are processed first to last.
  </p>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">search</tt></i></span>
     <dd>

      <p class="para">
       The value being searched for, otherwise known as the
       <em class="emphasis">needle</em>.  An array may be used to designate
       multiple needles.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">replace</tt></i></span>
     <dd>

      <p class="para">
       The replacement value that replaces found <i><tt class="parameter">search</tt></i>
       values. An array may be used to designate multiple replacements.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">subject</tt></i></span>
     <dd>

      <p class="para">
       The string or array being searched and replaced on,
       otherwise known as the <em class="emphasis">haystack</em>.
      </p>
      <p class="para">
       If <i><tt class="parameter">subject</tt></i> is an array, then the search and
       replace is performed with every entry of 
       <i><tt class="parameter">subject</tt></i>, and the return value is an array as
       well.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">count</tt></i></span>
     <dd>

      <p class="para">
       If passed, this will be set to the number of replacements performed.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.str-ireplace-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a string or an array of replacements.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.str-ireplace-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.0.0</td>
       <td align="left">
        The <i><tt class="parameter">count</tt></i> parameter was added.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.str-ireplace-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-4422">
    <p><b>Example #1 <span class="function"><b>str_ireplace()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$bodytag&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_ireplace</span><span style="color: #007700">(</span><span style="color: #DD0000">"%body%"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"black"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"&lt;body&nbsp;text=%BODY%&gt;"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.str-ireplace-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">This function is
binary-safe.</span></p></blockquote>
  <div class="caution"><b class="caution">Caution</b>
   <h1 class="title">Replacement order gotcha</h1>
   <p class="para">
    Because <span class="function"><b>str_ireplace()</b></span> replaces left to right, it might
    replace a previously inserted value when doing multiple replacements.
    Example #2 in the <span class="function"><a href="function.str-replace.html" class="function">str_replace()</a></span> documentation
    demonstrates how this may affect you in practice.
   </p>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.str-ireplace-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.str-replace.html" class="function" rel="rdfs-seeAlso">str_replace()</a> - Replace all occurrences of the search string with the replacement string</span></li>
    <li class="member"><span class="function"><a href="function.preg-replace.html" class="function" rel="rdfs-seeAlso">preg_replace()</a> - Perform a regular expression search and replace</span></li>
    <li class="member"><span class="function"><a href="function.strtr.html" class="function" rel="rdfs-seeAlso">strtr()</a> - Translate characters or replace substrings</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="107168""></a>
  <div class="note">
   <strong class="user">chud37.com</strong>
   <a href="#107168" class="date">11-Jan-2012 12:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After searching through the forums and laboriously testing all the highlight functions (as I was too lazy to write my own, I wanted a quick solution), I found that none of them did what I wanted at all.<br />
<br />
I just wanted a function that took a string and did not modify it in anyway, apart from just surrounding the matching words with some kind of highlighting HTML.&nbsp; At best all the ones of the forums here changed the text but also the case as well.&nbsp; The example given by sawdust *did* work except when given a single&nbsp; character when it continued to loop-replace the letter 'a' in the inserted 'background-color:'.&nbsp; So, here is a fool proof, no-nonsense replace method that should work always.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">highlight</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">|| </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">) &lt; </span><span class="default">1</span><span class="keyword">) {return </span><span class="default">$haystack</span><span class="keyword">;}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">"/</span><span class="default">$needle</span><span class="string">+/i"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$match</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exploded </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/</span><span class="default">$needle</span><span class="string">+/i"</span><span class="keyword">,</span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$replaced </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$exploded </span><span class="keyword">as </span><span class="default">$e</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$match </span><span class="keyword">as </span><span class="default">$m</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$e</span><span class="keyword">!=</span><span class="default">$exploded</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$exploded</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">]) {</span><span class="default">$replaced </span><span class="keyword">.= </span><span class="default">$e </span><span class="keyword">. </span><span class="string">"&lt;font style=\"background-color:yellow\"&gt;" </span><span class="keyword">. </span><span class="default">$m</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] . </span><span class="string">"&lt;/font&gt;"</span><span class="keyword">;} else {</span><span class="default">$replaced </span><span class="keyword">.= </span><span class="default">$e</span><span class="keyword">;} <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$replaced</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104676""></a>
  <div class="note">
   <strong class="user">Psudo - thepsudo at gmail dot com</strong>
   <a href="#104676" class="date">29-Jun-2011 09:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For highlighting without the overhead of regex and without destroying capitalization, try this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">highlight</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ind </span><span class="keyword">= </span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$ind </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$ind</span><span class="keyword">) . </span><span class="string">"&lt;b&gt;" </span><span class="keyword">. </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$ind</span><span class="keyword">, </span><span class="default">$len</span><span class="keyword">) . </span><span class="string">"&lt;/b&gt;" </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">highlight</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$ind </span><span class="keyword">+ </span><span class="default">$len</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; } else return </span><span class="default">$haystack</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This example uses HTML bold tags, but you can easily change the highlighting method.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102845""></a>
  <div class="note">
   <strong class="user">holblin at holblin dot com</strong>
   <a href="#102845" class="date">09-Mar-2011 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning with highlighting ...<br />
<br />
I used :<br />
<br />
<span class="default">&lt;?php<br />
$text </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/('</span><span class="keyword">.</span><span class="default">$q</span><span class="keyword">.</span><span class="string">')/i'</span><span class="keyword">,</span><span class="string">'&lt;span class=highlighting ""&gt;$1&lt;/span&gt;' </span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Because this line do not allow to highlight uppercase and lowercase correctly (transform uppercase to lowercase for exemple)<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;$text </span><span class="keyword">= </span><span class="default">str_ireplace</span><span class="keyword">( </span><span class="default">$q </span><span class="keyword">, </span><span class="string">'&lt;span class=highlighting ""&gt;'</span><span class="keyword">.</span><span class="default">$q</span><span class="keyword">.</span><span class="string">'&lt;/span&gt;'</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
But when $q contain some regex you have some problems ... for exemple :<br />
<span class="default">&lt;?php $q </span><span class="keyword">= </span><span class="string">'('</span><span class="keyword">; </span><span class="default">?&gt;<br />
</span><br />
So you must use preg_replace to highlight correctly the text and you must create a function for escape bad regex caracters !<br />
<br />
I think that a better function can be found but this works I guess :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">regex_escape</span><span class="keyword">( </span><span class="default">$q </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/([\[\]\(\)\{\}\-\.\*\?\|\^\$])/'</span><span class="keyword">, </span><span class="string">'\$1'</span><span class="keyword">, </span><span class="default">$q</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100539""></a>
  <div class="note">
   <strong class="user">stepanic dot matija at gmail dot com</strong>
   <a href="#100539" class="date">21-Oct-2010 08:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FIX-ed problem with highlighting second 'o' OR 'a', in this string<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">highlight_string </span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$highlight_class</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return $haystack if there is no highlight color or strings given, nothing to do.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first_encode</span><span class="keyword">=</span><span class="string">'XXXXXXXXXXXXXXX'</span><span class="keyword">;&nbsp; &nbsp;&nbsp; </span><span class="comment">//ENCODE string<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$second_encode</span><span class="keyword">=</span><span class="string">'YYYYYYYYYYYYYYY'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">"/</span><span class="default">$needle</span><span class="string">+/i"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &gt;= </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] as </span><span class="default">$match</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$match</span><span class="keyword">, </span><span class="default">$first_encode</span><span class="keyword">.</span><span class="default">$match</span><span class="keyword">.</span><span class="default">$second_encode</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="default">$first_encode</span><span class="keyword">,</span><span class="default">$second_encode</span><span class="keyword">),<br />
array(</span><span class="string">'&lt;font class="'</span><span class="keyword">.</span><span class="default">$highlight_class</span><span class="keyword">.</span><span class="string">'" &gt;'</span><span class="keyword">,</span><span class="string">'&lt;/font&gt;'</span><span class="keyword">),</span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$haystack</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100078""></a>
  <div class="note">
   <strong class="user">triplepoint at gmail dot com</strong>
   <a href="#100078" class="date">23-Sep-2010 10:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding maintaining the case of the find/replace for search-highlighting purposes:<br />
<br />
if the performance hit of a regular expression isn't a big problem, there's something like:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">highlight_matches</span><span class="keyword">(</span><span class="default">$find_text</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">) {<br />
&nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/(</span><span class="default">$find_text</span><span class="string">)/i"</span><span class="keyword">, </span><span class="string">'&lt;span class="search_item"&gt;$1&lt;/span&gt;'</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91672""></a>
  <div class="note">
   <strong class="user">info at daniel-marschall dot de</strong>
   <a href="#91672" class="date">22-Jun-2009 07:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to keep the original capitalization when replacing some text (e.g. for highlighting the search-string in the the search result), you can use this code I wrote:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// <a href="http://devboard.viathinksoft.de/viewtopic.php?f=34&amp;t=771" rel="nofollow" target="_blank">http://devboard.viathinksoft.de/viewtopic.php?f=34&amp;t=771</a><br />
// Bugfix-Release #3 (June, 22th 2009)<br />
</span><span class="keyword">function </span><span class="default">ext_str_ireplace</span><span class="keyword">(</span><span class="default">$findme</span><span class="keyword">, </span><span class="default">$replacewith</span><span class="keyword">, </span><span class="default">$subject</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// Replaces $findme in $subject with $replacewith<br />
&nbsp;&nbsp; &nbsp; // Ignores the case and do keep the original capitalization by using $1 in $replacewith<br />
&nbsp;&nbsp; &nbsp; // Required: PHP 5<br />
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$rest </span><span class="keyword">= </span><span class="default">$subject</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; while (</span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">, </span><span class="default">$findme</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">, </span><span class="default">$findme</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove the wanted string from $rest and append it to $result<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rest </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">)-</span><span class="default">$pos</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove the wanted string from $rest and place it correctly into $result<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'$1'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$findme</span><span class="keyword">)), </span><span class="default">$replacewith</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rest </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$findme</span><span class="keyword">), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$rest</span><span class="keyword">)-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$findme</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// After the last match, append the rest<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">$rest</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89612""></a>
  <div class="note">
   <strong class="user">ishutko at gmail dot com</strong>
   <a href="#89612" class="date">16-Mar-2009 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For function work with cirilic<br />
<br />
setlocale (LC_ALL, 'ru_RU');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87417""></a>
  <div class="note">
   <strong class="user">sawdust</strong>
   <a href="#87417" class="date">04-Dec-2008 07:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a different approach to search result keyword highlighting that will match all keyword sub strings in a case insensitive manner and preserve case in the returned text. This solution first grabs all matches within $haystack in a case insensitive manner, and the secondly loops through each of those matched sub strings and applies a case sensitive replace in $haystack. This way each unique (in terms of case) instance of $needle is operated on individually allowing a case sensitive replace to be done in order to preserve the original case of each unique instance of $needle.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">highlightStr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$highlightColorValue</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// return $haystack if there is no highlight color or strings given, nothing to do.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$highlightColorValue</span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">|| </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">|| </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">) &lt; </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$haystack</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">"/</span><span class="default">$needle</span><span class="string">+/i"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &gt;= </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] as </span><span class="default">$match</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$match</span><span class="keyword">, </span><span class="string">'&lt;span style="background-color:'</span><span class="keyword">.</span><span class="default">$highlightColorValue</span><span class="keyword">.</span><span class="string">';"&gt;'</span><span class="keyword">.</span><span class="default">$match</span><span class="keyword">.</span><span class="string">'&lt;/span&gt;'</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$haystack</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87006""></a>
  <div class="note">
   <strong class="user">Michael dot Bond at mail dot wvu dot edu</strong>
   <a href="#87006" class="date">14-Nov-2008 06:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function will highlight search terms (Key Words in Context). <br />
<br />
The difference between this one and the ones below is that it will preserve the original case of the search term as well. So, if you search for "american" but in the original string it is "American" it will retain the capital "A" as well as the correct case for the rest of the string. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">kwic</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">,</span><span class="default">$str2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$kwicLen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$kwicArray </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pos&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$count&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$pos </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$str1</span><span class="keyword">,</span><span class="default">$pos</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$pos </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kwicArray</span><span class="keyword">[</span><span class="default">$count</span><span class="keyword">][</span><span class="string">'kwic'</span><span class="keyword">] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$pos</span><span class="keyword">,</span><span class="default">$kwicLen</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kwicArray</span><span class="keyword">[</span><span class="default">$count</span><span class="keyword">++][</span><span class="string">'pos'</span><span class="keyword">]&nbsp; = </span><span class="default">$pos</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$I</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$kwicArray</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">;</span><span class="default">$I</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$I</span><span class="keyword">--) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kwic </span><span class="keyword">= </span><span class="string">'&lt;span class="kwic"&gt;'</span><span class="keyword">.</span><span class="default">$kwicArray</span><span class="keyword">[</span><span class="default">$I</span><span class="keyword">][</span><span class="string">'kwic'</span><span class="keyword">].</span><span class="string">'&lt;/span&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$kwic</span><span class="keyword">,</span><span class="default">$kwicArray</span><span class="keyword">[</span><span class="default">$I</span><span class="keyword">][</span><span class="string">'pos'</span><span class="keyword">],</span><span class="default">$kwicLen</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">$str2</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86090""></a>
  <div class="note">
   <strong class="user">info at daniel-marschall dot de</strong>
   <a href="#86090" class="date">02-Oct-2008 10:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example for str_ireplace(). It will print "RePlaCeMe" in red color, but after this, it would be written in lower case because of the string $search.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$search&nbsp; </span><span class="keyword">= </span><span class="string">'replaceme'</span><span class="keyword">;<br />
</span><span class="default">$replace </span><span class="keyword">= </span><span class="string">'&lt;font color="#FF0000"&gt;'</span><span class="keyword">.</span><span class="default">$search</span><span class="keyword">.</span><span class="string">'&lt;/font&gt;'</span><span class="keyword">;<br />
</span><span class="default">$text&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">'Please RePlaCeMe, OK?'</span><span class="keyword">;<br />
<br />
echo </span><span class="default">str_ireplace</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Example for ext_str_ireplace(). It will print "RePlaCeMe" in red color, and will not change the capitalization:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$search&nbsp; </span><span class="keyword">= </span><span class="string">'replaceme'</span><span class="keyword">;<br />
</span><span class="default">$replace </span><span class="keyword">= </span><span class="string">'&lt;font color="#FF0000"&gt;$1&lt;/font&gt;'</span><span class="keyword">;<br />
</span><span class="default">$text&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">'Please RePlaCeMe, OK?'</span><span class="keyword">;<br />
<br />
echo </span><span class="default">ext_str_ireplace</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83644""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#83644" class="date">05-Jun-2008 12:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I modified a script from notes on the eregi_replace() function page.&nbsp; This is a highlight script that worked good for me.<br />
<br />
$text - is the text to search<br />
$words - are the words to highlight (search text)<br />
$the_place - is so that you can tell your users what "area" was searched.<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">function </span><span class="default">highlight_this</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$words</span><span class="keyword">, </span><span class="default">$the_place</span><span class="keyword">) { <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$words </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$words</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wordsArray </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">, </span><span class="default">$words</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$wordsArray </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">)) != </span><span class="default">0</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">str_ireplace</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">, </span><span class="string">"&lt;span class=\"highlight\"&gt;"</span><span class="keyword">.</span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">).</span><span class="string">"&lt;/span&gt;"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$count</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//added to show how many keywords were found<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;br&gt;&lt;div class=\"emphasis\"&gt;A search for &lt;strong&gt;" </span><span class="keyword">. </span><span class="default">$words</span><span class="keyword">. </span><span class="string">"&lt;/strong&gt; found &lt;strong&gt;" </span><span class="keyword">. </span><span class="default">$count </span><span class="keyword">. </span><span class="string">"&lt;/strong&gt; matches within the " </span><span class="keyword">. </span><span class="default">$the_place</span><span class="keyword">. </span><span class="string">".&lt;/div&gt;&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//end script modification<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$text</span><span class="keyword">;<br />
} <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81157""></a>
  <div class="note">
   <strong class="user">mvpetrovich</strong>
   <a href="#81157" class="date">15-Feb-2008 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are some minor tweaks to-n00b-at-battleofthebits-dot-org's excellent function.<br />
1) The token was set to an ASCII value 1 (which could be changed as was previously noted)<br />
2) The $c++ was not needed<br />
3) The while statement is not necessary for the final replacement<br />
4) Note that this does not allow use of arrays for search and replace terms.&nbsp; That could be implemented using loops.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'str_ireplace'</span><span class="keyword">)){<br />
&nbsp; function </span><span class="default">str_ireplace</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">,</span><span class="default">$replace</span><span class="keyword">,</span><span class="default">$subject</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$token </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$needle </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$pos</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">))!==</span><span class="default">FALSE</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">,</span><span class="default">$token</span><span class="keyword">,</span><span class="default">$pos</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$token</span><span class="keyword">,</span><span class="default">$pos</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$token</span><span class="keyword">,</span><span class="default">$replace</span><span class="keyword">,</span><span class="default">$subject</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$subject</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54425""></a>
  <div class="note">
   <strong class="user">hfuecks at nospam dot org</strong>
   <a href="#54425" class="date">04-Jul-2005 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that character case is being defined by your server's locale setting, which effects strings containing non-ASCII characters.<br />
<br />
See strtolower() - <a href="http://www.php.net/strtolower and comments - internally str_ireplace converts $search and $replace to lowercase to find matches." rel="nofollow" target="_blank">http://www.php.net/strtolower and comments - internally str_ireplace converts $search and $replace to lowercase to find matches.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51618""></a>
  <div class="note">
   <strong class="user">daevid at daevid dot com</strong>
   <a href="#51618" class="date">05-Apr-2005 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
here's a neat little function I whipped up to do HTML color coding of SQL strings. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Output the HTML debugging string in color coded glory for a sql query<br />
&nbsp;* This is very nice for being able to see many SQL queries<br />
&nbsp;* @access&nbsp; &nbsp;&nbsp; public<br />
&nbsp;* @return&nbsp; &nbsp;&nbsp; void. prints HTML color coded string of the input $query.<br />
&nbsp;* @param&nbsp; &nbsp;&nbsp; string $query The SQL query to be executed.<br />
&nbsp;* @author&nbsp; &nbsp;&nbsp; Daevid Vincent [daevid@LockdownNetworks.com]<br />
&nbsp;*&nbsp; @version&nbsp; &nbsp;&nbsp; 1.0<br />
&nbsp;* @date&nbsp; &nbsp; &nbsp; &nbsp; 04/05/05<br />
&nbsp;* @todo&nbsp; &nbsp;&nbsp; highlight SQL functions.<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">SQL_DEBUG</span><span class="keyword">( </span><span class="default">$query </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$query </span><span class="keyword">== </span><span class="string">'' </span><span class="keyword">) return </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$SQL_INT</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if( !isset(</span><span class="default">$SQL_INT</span><span class="keyword">) ) </span><span class="default">$SQL_INT </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//[dv] this has to come first or you will have goofy results later.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/['\"]([^'\"]*)['\"]/i"</span><span class="keyword">, </span><span class="string">"'&lt;FONT COLOR='#FF6600'&gt;$1&lt;/FONT&gt;'"</span><span class="keyword">, </span><span class="default">$query</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="default">str_ireplace</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'*'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'SELECT '</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'UPDATE '</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'DELETE '</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'INSERT '</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'INTO'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'VALUES'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'FROM'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'LEFT'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'JOIN'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'WHERE'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'LIMIT'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'ORDER BY'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'AND'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'OR '</span><span class="keyword">, </span><span class="comment">//[dv] note the space. otherwise you match to 'COLOR' ;-)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'DESC'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'ASC'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'ON '<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#FF6600'&gt;&lt;B&gt;*&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;SELECT&lt;/B&gt; &lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;UPDATE&lt;/B&gt; &lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;DELETE&lt;/B&gt; &lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;INSERT&lt;/B&gt; &lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;INTO&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;VALUES&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;FROM&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00CC00'&gt;&lt;B&gt;LEFT&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00CC00'&gt;&lt;B&gt;JOIN&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;WHERE&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#AA0000'&gt;&lt;B&gt;LIMIT&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00AA00'&gt;&lt;B&gt;ORDER BY&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#0000AA'&gt;&lt;B&gt;AND&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#0000AA'&gt;&lt;B&gt;OR&lt;/B&gt; &lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#0000AA'&gt;&lt;B&gt;DESC&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#0000AA'&gt;&lt;B&gt;ASC&lt;/B&gt;&lt;/FONT&gt;"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;FONT COLOR='#00DD00'&gt;&lt;B&gt;ON&lt;/B&gt; &lt;/FONT&gt;"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$query<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;FONT COLOR='#0000FF'&gt;&lt;B&gt;SQL["</span><span class="keyword">.</span><span class="default">$SQL_INT</span><span class="keyword">.</span><span class="string">"]:&lt;/B&gt; "</span><span class="keyword">.</span><span class="default">$query</span><span class="keyword">.</span><span class="string">"&lt;FONT COLOR='#FF0000'&gt;;&lt;/FONT&gt;&lt;/FONT&gt;&lt;BR&gt;\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$SQL_INT</span><span class="keyword">++;<br />
<br />
} </span><span class="comment">//SQL_DEBUG<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42811""></a>
  <div class="note">
   <strong class="user">aidan at php dot net</strong>
   <a href="#42811" class="date">30-May-2004 10:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This functionality is now implemented in the PEAR package PHP_Compat.<br />
<br />
More information about using this function without upgrading your version of PHP can be found on the below link:<br />
<br />
<a href="http://pear.php.net/package/PHP_Compat" rel="nofollow" target="_blank">http://pear.php.net/package/PHP_Compat</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.str-getcsv.html">str_getcsv</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.str-pad.html">str_pad</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
