<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Create a streams context</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stream-bucket-prepend.html">stream_bucket_prepend</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stream-context-get-default.html">stream_context_get_default</a></div>
 <div class="up"><a href="ref.stream.html">Stream Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.stream-context-create" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stream_context_create</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5)</p><p class="refpurpose"><span class="refname">stream_context_create</span> &mdash; <span class="dc-title">Create a streams context</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.stream-context-create-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><b>stream_context_create</b></span>
    ([ <span class="methodparam"><span class="type">array</span> <tt class="parameter">$options</tt></span>
   [, <span class="methodparam"><span class="type">array</span> <tt class="parameter">$params</tt></span>
  ]] )</div>

  <p class="para rdfs-comment">
   Creates and returns a stream context with any options supplied in
   <i><tt class="parameter">options</tt></i> preset.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.stream-context-create-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">options</tt></i></span>
     <dd>

      <p class="para">
       Must be an associative array of associative arrays in the format
       <i>$arr[&#039;wrapper&#039;][&#039;option&#039;] = $value</i>.
      </p>
      <p class="para">
       Default to an empty array.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">params</tt></i></span>
     <dd>

      <p class="para">
       Must be an associative array in the format
       <i>$arr[&#039;parameter&#039;] = $value</i>.
       Refer to <a href="context.params.html" class="link">context parameters</a> for
       a listing of standard stream parameters.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.stream-context-create-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   A stream context <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.stream-context-create-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.3.0</td>
       <td align="left">
        Added the optional <i><tt class="parameter">params</tt></i> argument.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.stream-context-create-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-3648">
   <p><b>Example #1 Using <span class="function"><b>stream_context_create()</b></span></b></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$opts&nbsp;</span><span style="color: #007700">=&nbsp;array(<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'http'</span><span style="color: #007700">=&gt;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'method'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"GET"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'header'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"Accept-language:&nbsp;en\r\n"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"Cookie:&nbsp;foo=bar\r\n"<br />&nbsp;&nbsp;</span><span style="color: #007700">)<br />);<br /><br /></span><span style="color: #0000BB">$context&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">(</span><span style="color: #0000BB">$opts</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Sends&nbsp;an&nbsp;http&nbsp;request&nbsp;to&nbsp;www.example.com<br />&nbsp;&nbsp;&nbsp;with&nbsp;additional&nbsp;headers&nbsp;shown&nbsp;above&nbsp;*/<br /></span><span style="color: #0000BB">$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'r'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$context</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fpassthru</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.stream-context-create-seealso">
  <h3 class="title">See Also</h3>
  <ul class="simplelist">
   <li class="member"><span class="function"><a href="function.stream-context-set-option.html" class="function" rel="rdfs-seeAlso">stream_context_set_option()</a> - Sets an option for a stream/wrapper/context</span></li>
   <li class="member">Listing of supported wrappers (<a href="wrappers.html" class="xref">Supported Protocols and Wrappers</a>)</li>
   <li class="member">Context options (<a href="context.html" class="xref">Context options and parameters</a>)</li>
  </ul>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="100559""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#100559" class="date">22-Oct-2010 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to set a custom http header on php 5.2.x, try this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// build header and set it the usual way<br />
</span><span class="default">$authenticationHeader </span><span class="keyword">= </span><span class="default">$headername </span><span class="keyword">. </span><span class="string">': ' </span><span class="keyword">. </span><span class="default">$headervalue</span><span class="keyword">;<br />
</span><span class="default">$opts </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'header'&nbsp; </span><span class="keyword">=&gt; </span><span class="default">$authenticationHeader<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">)<br />
);<br />
</span><span class="comment">// workaround for php bug where http headers don't get sent in php 5.2<br />
</span><span class="keyword">if(</span><span class="default">version_compare</span><span class="keyword">(</span><span class="default">PHP_VERSION</span><span class="keyword">, </span><span class="string">'5.3.0'</span><span class="keyword">) == -</span><span class="default">1</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'user_agent'</span><span class="keyword">, </span><span class="string">'PHP-SOAP/' </span><span class="keyword">. </span><span class="default">PHP_VERSION </span><span class="keyword">. </span><span class="string">"\r\n" </span><span class="keyword">. </span><span class="default">$authenticationHeader</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$context&nbsp; </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
<br />
</span><span class="comment">// now use context for soap call or whatever...<br />
</span><span class="default">?&gt;<br />
</span><br />
this is the only option that worked for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99353""></a>
  <div class="note">
   <strong class="user">contact (at) thepointsolution.com</strong>
   <a href="#99353" class="date">12-Aug-2010 05:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I big NOTE that i hope will help some one. Something that is not mentioned in the documentation, is that when php is compiled --with-curlwrappers,<br />
<br />
So, instead of:<br />
<br />
<span class="default">&lt;?php<br />
$opts </span><span class="keyword">= array(<br />
&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt;array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">"GET"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;</span><span class="string">"Accept-language: en\r\n" </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Cookie: foo=bar\r\n"<br />
&nbsp; </span><span class="keyword">)<br />
);<br />
<br />
</span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You would setup the header this way: <br />
<br />
<span class="default">&lt;?php<br />
$opts </span><span class="keyword">= array(<br />
&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt;array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">"GET"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;array(</span><span class="string">"Accept-language: en"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Cookie: foo=bar"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Custom-Header: value"</span><span class="keyword">)<br />
&nbsp; )<br />
);<br />
<br />
</span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This will work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92586""></a>
  <div class="note">
   <strong class="user">mathieu dot laurent at gmail dot com</strong>
   <a href="#92586" class="date">30-Jul-2009 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Connection via Proxy<br />
<br />
<span class="default">&lt;?php<br />
<br />
$opts </span><span class="keyword">= array(</span><span class="string">'http' </span><span class="keyword">=&gt; array(</span><span class="string">'proxy' </span><span class="keyword">=&gt; </span><span class="string">'tcp://127.0.0.1:8080'</span><span class="keyword">, </span><span class="string">'request_fulluri' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">));<br />
</span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'<a href="http://www.php.net" rel="nofollow" target="_blank">http://www.php.net</a>'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$data</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90927""></a>
  <div class="note">
   <strong class="user">Brian Gottier</strong>
   <a href="#90927" class="date">16-May-2009 12:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In some cases, set a header option as an array, and not a string, depending on server configuration.<br />
<br />
<span class="default">&lt;?php<br />
$opts </span><span class="keyword">= array(<br />
&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;&nbsp;&nbsp; </span><span class="string">"GET"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;&nbsp; &nbsp; array( </span><span class="string">"Cookie: foo="</span><span class="default">bar</span><span class="string">"l ),<br />
&nbsp;&nbsp;&nbsp; 'user_agent'=&gt;&nbsp; &nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT']<br />
&nbsp; )<br />
);<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90411""></a>
  <div class="note">
   <strong class="user">dresel at gmx dot at</strong>
   <a href="#90411" class="date">21-Apr-2009 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use this script to send normal data and images (you may have to change Content-Type to send other data), works fine for me :)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">do_post_request</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$postdata</span><span class="keyword">, </span><span class="default">$files </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
{ <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$boundary </span><span class="keyword">= </span><span class="string">"---------------------"</span><span class="keyword">.</span><span class="default">substr</span><span class="keyword">(</span><span class="default">md5</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">32000</span><span class="keyword">)), </span><span class="default">0</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Collect Postdata<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$postdata </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="string">"--</span><span class="default">$boundary</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="string">"Content-Disposition: form-data; name=\""</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">"\"\n\n"</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="string">"--</span><span class="default">$boundary</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Collect Filedata<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fileContents </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'tmp_name'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="string">"Content-Disposition: form-data; name=\"</span><span class="keyword">{</span><span class="default">$key</span><span class="keyword">}</span><span class="string">\"; filename=\"</span><span class="keyword">{</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]}</span><span class="string">\"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="string">"Content-Type: image/jpeg\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="string">"Content-Transfer-Encoding: binary\n\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="default">$fileContents</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">.= </span><span class="string">"--</span><span class="default">$boundary</span><span class="string">--\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$params </span><span class="keyword">= array(</span><span class="string">'http' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'POST'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'header' </span><span class="keyword">=&gt; </span><span class="string">'Content-Type: multipart/form-data; boundary='</span><span class="keyword">.</span><span class="default">$boundary</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$data<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; </span><span class="default">$ctx </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">'rb'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$ctx</span><span class="keyword">);<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; if (!</span><span class="default">$fp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Problem with </span><span class="default">$url</span><span class="string">, </span><span class="default">$php_errormsg</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp;<br />
&nbsp;&nbsp; </span><span class="default">$response </span><span class="keyword">= @</span><span class="default">stream_get_contents</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; if (</span><span class="default">$response </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Problem reading data from </span><span class="default">$url</span><span class="string">, </span><span class="default">$php_errormsg</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return </span><span class="default">$response</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//set data (in this example from post)<br />
<br />
//sample data<br />
</span><span class="default">$postdata </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">],<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'age' </span><span class="keyword">=&gt; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'age'</span><span class="keyword">],<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'sex' </span><span class="keyword">=&gt; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'sex'</span><span class="keyword">]<br />
);<br />
<br />
</span><span class="comment">//sample image<br />
</span><span class="default">$files</span><span class="keyword">[</span><span class="string">'image'</span><span class="keyword">] = </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'image'</span><span class="keyword">];<br />
<br />
</span><span class="default">do_post_request</span><span class="keyword">(</span><span class="string">"<a href="http://example.com" rel="nofollow" target="_blank">http://example.com</a>"</span><span class="keyword">, </span><span class="default">$postdata</span><span class="keyword">, </span><span class="default">$files</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89080""></a>
  <div class="note">
   <strong class="user">rlintern at gmail dot com</strong>
   <a href="#89080" class="date">20-Feb-2009 09:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found the following code worked for me for POSTing some binary data to a remote server. I am putting it here since I could not find a quick solution to this by 'googling' or looking through this documentation. <br />
<br />
Disclaimer:&nbsp; I have no idea if this a 'good' solution, since I'm new to PHP, but it may just suit your needs as it did mine.&nbsp; I am assuming bad things will happen with very large files since the entire file is read into $fileContents. <br />
<br />
I am using PHP 5.2.8.<br />
<br />
&nbsp;&nbsp; $fileHandle = fopen("someImage.jpg", "rb");<br />
&nbsp;&nbsp; $fileContents = stream_get_contents($fileHandle);<br />
&nbsp;&nbsp; fclose($fileHandle);<br />
<br />
&nbsp;&nbsp; $params = array(<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'http' =&gt; array<br />
&nbsp;&nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'method' =&gt; 'POST',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'header'=&gt;"Content-Type: multipart/form-data\r\n",<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'content' =&gt; $fileContents<br />
&nbsp;&nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; );<br />
&nbsp;&nbsp; $url = "<a href="http://somesite.somecompany.com?someParam=someValue" rel="nofollow" target="_blank">http://somesite.somecompany.com?someParam=someValue</a>";<br />
&nbsp;&nbsp; $ctx = stream_context_create($params);<br />
&nbsp;&nbsp; $fp = fopen($url, 'rb', false, $ctx);<br />
<br />
&nbsp;&nbsp; $response = stream_get_contents($fp);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75211""></a>
  <div class="note">
   <strong class="user">davep at atomicdroplet dot com</strong>
   <a href="#75211" class="date">17-May-2007 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In addition to the context options mentioned above (appendix N), lower down context options for sockets can be found in appendix P - <a href="http://www.php.net/manual/en/transports.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/transports.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74795""></a>
  <div class="note">
   <strong class="user">jrubenstein at gmail dot com</strong>
   <a href="#74795" class="date">27-Apr-2007 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Something to keep in mind when creating SSL streams (using https://):<br />
<br />
<span class="default">&lt;?php<br />
$context </span><span class="keyword">= </span><span class="default">context_create_stream</span><span class="keyword">(</span><span class="default">$context_options</span><span class="keyword">)<br />
</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'https://url'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
One would think - the proper way to create a stream options array, would be as follows: <br />
<br />
<span class="default">&lt;?php<br />
$context_options </span><span class="keyword">= array (<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'https' </span><span class="keyword">=&gt; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'POST'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"Content-Length: " </span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) . </span><span class="string">"\r\n"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$data<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
</span><span class="default">?&gt;<br />
</span><br />
THAT IS THE WRONG WAY!!!<br />
Take notice to the 3rd line: 'https' =&gt; array (<br />
<br />
The CORRECT way, is as follows:<br />
<br />
<span class="default">&lt;?php<br />
$context_options </span><span class="keyword">= array (<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'POST'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"Content-Length: " </span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) . </span><span class="string">"\r\n"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$data<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
</span><span class="default">?&gt;<br />
</span><br />
Notice, the NEW 3rd line: 'http' =&gt; array (<br />
<br />
Now - keep this in mind - I spent several hours trying to trouble shoot my issue, when I finally stumbled upon this non-documented issue.<br />
<br />
The complete code to post to a secure page is as follows:<br />
<br />
<span class="default">&lt;?php<br />
$data </span><span class="keyword">= array (</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">, </span><span class="string">'bar' </span><span class="keyword">=&gt; </span><span class="string">'baz'</span><span class="keyword">);<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
<br />
</span><span class="default">$context_options </span><span class="keyword">= array (<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'POST'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"Content-Length: " </span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) . </span><span class="string">"\r\n"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$data<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
<br />
</span><span class="default">$context </span><span class="keyword">= </span><span class="default">context_create_stream</span><span class="keyword">(</span><span class="default">$context_options</span><span class="keyword">)<br />
</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'https://url'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74431""></a>
  <div class="note">
   <strong class="user">chris dot vigelius at gmx dot net</strong>
   <a href="#74431" class="date">11-Apr-2007 05:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems that the authorization example given below by"php at charlesconsulting dot com" does NOT work with PHP 5.2.1, since the 'header' option will be simply ignored if it is not an array (but a string).<br />
<br />
The following works:<br />
$url = '<a href="http://protectedstuff.com" rel="nofollow" target="_blank">http://protectedstuff.com</a>';<br />
$auth = base64_encode('user:password');<br />
$header = array("Authorization: Basic $auth");<br />
$opts = array( 'http' =&gt; array ('method'=&gt;'GET',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'header'=&gt;$header));<br />
$ctx = stream_context_create($opts);<br />
file_get_contents($url,false,$ctx);<br />
<br />
See also <a href="http://bugs.php.net/bug.php?id=41051" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=41051</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72317""></a>
  <div class="note">
   <strong class="user">php at charlesconsulting dot com</strong>
   <a href="#72317" class="date">13-Jan-2007 07:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's an example of retrieving a page which requests a username and password using the basic authorization scheme.&nbsp; This calls the w3.org web page validator for a password protected page.<br />
//$fileurl contains page to validate<br />
$validateurl="<a href="http://validator.w3.org/check?uri=$fileurl" rel="nofollow" target="_blank">http://validator.w3.org/check?uri=$fileurl</a>";<br />
<br />
$cred = sprintf('Authorization: Basic %s',<br />
&nbsp;&nbsp;&nbsp; base64_encode('username:password') );<br />
$opts = array(<br />
&nbsp;&nbsp;&nbsp; 'http'=&gt;array(<br />
&nbsp;&nbsp;&nbsp; 'method'=&gt;'GET',<br />
&nbsp;&nbsp;&nbsp; 'header'=&gt;$cred) <br />
);<br />
$ctx = stream_context_create($opts);<br />
<br />
$validate=file_get_contents($validateurl,false,$ctx);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72017""></a>
  <div class="note">
   <strong class="user">sp0n9e at gmail dot com</strong>
   <a href="#72017" class="date">28-Dec-2006 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a very simple way to do posts easily without need of cURL or writing an http request by hand using the tcp:// wrapper.&nbsp; I like using contexts just because of their ubiquity and the lack of an optional library such as cURL (though one of the more popular libraries).<br />
<br />
<span class="default">&lt;?php<br />
<br />
$options </span><span class="keyword">= array(<br />
&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt;array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">"POST"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">"Accept-language: en\r\n"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'content'</span><span class="keyword">=&gt;</span><span class="default">http_build_query</span><span class="keyword">(array(</span><span class="string">'foo'</span><span class="keyword">=&gt;</span><span class="string">'bar'</span><span class="keyword">))<br />
));<br />
<br />
</span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">);<br />
<br />
</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'<a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">,</span><span class="default">$context</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62634""></a>
  <div class="note">
   <strong class="user">dev at zayso dot org</strong>
   <a href="#62634" class="date">05-Mar-2006 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example of a stream for reading a string passed <br />
via a context object.<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/* ----------------------------------------<br />
&nbsp;* Designed to read from a string<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">sfStreamStringRead<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">PROTOCOL </span><span class="keyword">= </span><span class="string">'stringread'</span><span class="keyword">; </span><span class="comment">/* Underscore not allowed */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$dataPos&nbsp; </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$dataBuf&nbsp; </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$dataLen&nbsp; </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">stream_open</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">, &amp;</span><span class="default">$opened_path</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/* Verify context has data */ <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$contextOptions </span><span class="keyword">= </span><span class="default">stream_context_get_options</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">context</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$contextOptions</span><span class="keyword">[</span><span class="default">self</span><span class="keyword">::</span><span class="default">PROTOCOL</span><span class="keyword">][</span><span class="string">'data'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataBuf </span><span class="keyword">= </span><span class="default">$contextOptions</span><span class="keyword">[</span><span class="default">self</span><span class="keyword">::</span><span class="default">PROTOCOL</span><span class="keyword">][</span><span class="string">'data'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataLen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataBuf</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataPos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">stream_read</span><span class="keyword">(</span><span class="default">$count</span><span class="keyword">){ <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataBuf</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataPos</span><span class="keyword">, </span><span class="default">$count</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataPos </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$ret</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">stream_eof</span><span class="keyword">(){ <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataPos </span><span class="keyword">&gt;= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataLen</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">stream_tell</span><span class="keyword">(){ <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">dataPos</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* ------------------------------------------<br />
&nbsp;&nbsp; &nbsp; * A few helper functions<br />
&nbsp;&nbsp; &nbsp; */ <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">genURL</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">PROTOCOL </span><span class="keyword">. </span><span class="string">'://'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; static function </span><span class="default">genContext</span><span class="keyword">(</span><span class="default">$dataBuf</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">stream_context_create</span><span class="keyword">(array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">PROTOCOL </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'data' </span><span class="keyword">=&gt; </span><span class="default">$dataBuf</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; static function </span><span class="default">open</span><span class="keyword">(</span><span class="default">$dataBuf</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">genURL</span><span class="keyword">(),</span><span class="string">'r'</span><span class="keyword">,</span><span class="default">FALSE</span><span class="keyword">,</span><span class="default">self</span><span class="keyword">::</span><span class="default">genContext</span><span class="keyword">(</span><span class="default">$dataBuf</span><span class="keyword">)); <br />
&nbsp;&nbsp;&nbsp; }&nbsp; <br />
}<br />
</span><span class="default">stream_wrapper_register</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">sfStreamStringRead</span><span class="keyword">::</span><span class="default">PROTOCOL</span><span class="keyword">,<br />
&nbsp;&nbsp; </span><span class="string">'sfStreamStringRead'<br />
</span><span class="keyword">);<br />
<br />
</span><span class="default">$sp </span><span class="keyword">= </span><span class="default">sfStreamStringRead</span><span class="keyword">::</span><span class="default">open</span><span class="keyword">(</span><span class="string">"Some String Data\n"</span><span class="keyword">);<br />
echo </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$sp</span><span class="keyword">);<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$sp</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; <br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59583""></a>
  <div class="note">
   <strong class="user">net_navard at yahoo dot com</strong>
   <a href="#59583" class="date">09-Dec-2005 10:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,you can create an array of parameters(what it's called a stream context),which can be transmitted each time you read or write a stream through a socket.In the below example:<br />
<br />
$opts =array('http'=&gt;arra('method'=&gt;"GET",<br />
'header'=&gt;"Accept-language:en\r\n"."Cookie: foo=bar\r\n");<br />
<br />
What you're actually doing is create a set of parameters(the protocol to be used,the request method,additional http headers and a cookie) which will be used each time you open a socket connection to request www.example.com.This saves a lot of time if you want to use these parameters (called a stream context) whenever you include them when making a request to www.example.com,instead of having to specify them over and over again.<br />
Using the previous example,say you want to create a stream context,which sends a "Content-Type" http header and utilize it when making a request to www.example.com.Take a look:<br />
<br />
$opts = array('http'=&gt;array('method'=&gt;"GET",<br />
'header'=&gt;"Content-Type: text/xml; charset=utf-8");<br />
<br />
$context = stream_context_create($opts);<br />
$fp = fopen('<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a>','r',false,$context);<br />
fpassthru($fp);<br />
fclose($fp);<br />
<br />
Now,when you make a request to www.example.com,the above http header will be included within the socket and transmitted to the server.Best of luck for you friends,Hossein</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stream-bucket-prepend.html">stream_bucket_prepend</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stream-context-get-default.html">stream_context_get_default</a></div>
 <div class="up"><a href="ref.stream.html">Stream Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
