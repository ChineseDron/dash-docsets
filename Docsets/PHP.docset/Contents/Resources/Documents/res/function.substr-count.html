<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Count the number of substring occurrences</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.substr-compare.html">substr_compare</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.substr-replace.html">substr_replace</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.substr-count" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">substr_count</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">substr_count</span> &mdash; <span class="dc-title">Count the number of substring occurrences</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.substr-count-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><b>substr_count</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$haystack</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$needle</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$offset</tt><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$length</tt></span>
  ]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>substr_count()</b></span> returns the number of times the
   <i><tt class="parameter">needle</tt></i> substring occurs in the
   <i><tt class="parameter">haystack</tt></i> string. Please note that
   <i><tt class="parameter">needle</tt></i> is case sensitive.
  </p>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    This function doesn&#039;t count overlapped substrings. See the example below!
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.substr-count-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">haystack</tt></i></span>
     <dd>

      <p class="para">
       The string to search in
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">needle</tt></i></span>
     <dd>

      <p class="para">
       The substring to search for
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">offset</tt></i></span>
     <dd>

      <p class="para">
       The offset where to start counting
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">length</tt></i></span>
     <dd>

      <p class="para">
       The maximum length after the specified offset to search for the
       substring. It outputs a warning if the offset plus the length is
       greater than the <i><tt class="parameter">haystack</tt></i> length.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.substr-count-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   This function returns an <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.substr-count-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.1.0</td>
       <td align="left">
        Added the <i><tt class="parameter">offset</tt></i> and
        the <i><tt class="parameter">length</tt></i> parameters
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.substr-count-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-4461">
    <p><b>Example #1 A <span class="function"><b>substr_count()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$text&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'This&nbsp;is&nbsp;a&nbsp;test'</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$text</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;14<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_count</span><span style="color: #007700">(</span><span style="color: #0000BB">$text</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'is'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;2<br /><br />//&nbsp;the&nbsp;string&nbsp;is&nbsp;reduced&nbsp;to&nbsp;'s&nbsp;is&nbsp;a&nbsp;test',&nbsp;so&nbsp;it&nbsp;prints&nbsp;1<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_count</span><span style="color: #007700">(</span><span style="color: #0000BB">$text</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;the&nbsp;text&nbsp;is&nbsp;reduced&nbsp;to&nbsp;'s&nbsp;i',&nbsp;so&nbsp;it&nbsp;prints&nbsp;0<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_count</span><span style="color: #007700">(</span><span style="color: #0000BB">$text</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;generates&nbsp;a&nbsp;warning&nbsp;because&nbsp;5+10&nbsp;&gt;&nbsp;14<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_count</span><span style="color: #007700">(</span><span style="color: #0000BB">$text</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #FF8000">//&nbsp;prints&nbsp;only&nbsp;1,&nbsp;because&nbsp;it&nbsp;doesn't&nbsp;count&nbsp;overlapped&nbsp;substrings<br /></span><span style="color: #0000BB">$text2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'gcdgcdgcd'</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">substr_count</span><span style="color: #007700">(</span><span style="color: #0000BB">$text2</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'gcdgcd'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.substr-count-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.count-chars.html" class="function" rel="rdfs-seeAlso">count_chars()</a> - Return information about characters used in a string</span></li>
    <li class="member"><span class="function"><a href="function.strpos.html" class="function" rel="rdfs-seeAlso">strpos()</a> - Find the position of the first occurrence of a substring in a string</span></li>
    <li class="member"><span class="function"><a href="function.substr.html" class="function" rel="rdfs-seeAlso">substr()</a> - Return part of a string</span></li>
    <li class="member"><span class="function"><a href="function.strstr.html" class="function" rel="rdfs-seeAlso">strstr()</a> - Find the first occurrence of a string</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="93170""></a>
  <div class="note">
   <strong class="user">chrisstocktonaz at gmail dot com</strong>
   <a href="#93170" class="date">26-Aug-2009 04:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In regards to anyone thinking of using code contributed by zmindster at gmail dot com<br />
<br />
Please take careful consideration of possible edge cases with that regex, in example:<br />
<br />
$url = '<a href="http://w3.host.tld/path/to/file/..../file.extension" rel="nofollow" target="_blank">http://w3.host.tld/path/to/file/..../file.extension</a>';<br />
$url = '<a href="http://w3.host.tld/path/to/file/../file.extension?malicous=...." rel="nofollow" target="_blank">http://w3.host.tld/path/to/file/../file.extension?malicous=....</a>';<br />
<br />
This would cause a infinite loop and for example be a possible entry point for a denial of service attack. A correct fix would require additional code, a quick hack would be just adding a additional check, without clarity or performance in mind:<br />
<br />
...<br />
$i = 0;<br />
while (substr_count($url, '../') &amp;&amp; ++$i &lt; strlen($url))<br />
...<br />
<br />
-Chris</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91588""></a>
  <div class="note">
   <strong class="user">jrhodes at roket-enterprises dot com</strong>
   <a href="#91588" class="date">18-Jun-2009 01:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It was suggested to use<br />
<br />
substr_count ( implode( $haystackArray ), $needle );<br />
<br />
instead of the function described previously, however this has one flaw.&nbsp; For example this array:<br />
<br />
array (<br />
&nbsp; 0 =&gt; "mystringth",<br />
&nbsp; 1 =&gt; "atislong"<br />
);<br />
<br />
If you are counting "that", the implode version will return 1, but the function previously described will return 0.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89795""></a>
  <div class="note">
   <strong class="user">zmindster at gmail dot com</strong>
   <a href="#89795" class="date">23-Mar-2009 01:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For some who seeked for an easy way to resolve URL composed of /../ like <a href="http://w3.host.tld/path/to/the/file/../../file.extension, here is a solution" rel="nofollow" target="_blank">http://w3.host.tld/path/to/the/file/../../file.extension, here is a solution</a><br />
<br />
<span class="default">&lt;?php<br />
$url </span><span class="keyword">= </span><span class="string">'<a href="http://w3.host.tld/path/to/file/../file.extension" rel="nofollow" target="_blank">http://w3.host.tld/path/to/file/../file.extension</a>'</span><span class="keyword">;<br />
<br />
while (</span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">"../"</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'#/[^/]+/\.\.#'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br />
}<br />
</span><span class="comment">//outputs '<a href="http://w3.host.tld/path/to/file.extension" rel="nofollow" target="_blank">http://w3.host.tld/path/to/file.extension</a>'<br />
</span><span class="default">?&gt;<br />
</span><br />
and seems to work perfectly!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88139""></a>
  <div class="note">
   <strong class="user">gigi at phpmycoder dot com</strong>
   <a href="#88139" class="date">12-Jan-2009 08:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
below was suggested a function for substr_count'ing an array, yet for a simpler procedure, use the following:<br />
<br />
<span class="default">&lt;?php<br />
substr_count </span><span class="keyword">( </span><span class="default">implode</span><span class="keyword">( </span><span class="default">$haystackArray </span><span class="keyword">), </span><span class="default">$needle </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84386""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#84386" class="date">11-Jul-2008 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that unlike the other substr functions, the offset value cannot be a negative value.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="default">substr_count</span><span class="keyword">(</span><span class="string">'abcdefg'</span><span class="keyword">, </span><span class="string">'efg'</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">); </span><span class="comment">// 1<br />
</span><span class="keyword">echo </span><span class="default">substr_count</span><span class="keyword">(</span><span class="string">'abcdefg'</span><span class="keyword">, </span><span class="string">'efg'</span><span class="keyword">, -</span><span class="default">3</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">); </span><span class="comment">// warning<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76644""></a>
  <div class="note">
   <strong class="user">danjr33 at gmail dot com</strong>
   <a href="#76644" class="date">24-Jul-2007 06:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I ran into trouble using this function when I moved a script from a server with PHP5 to a server with only PHP4.<br />
As the last two parameters were added with 5.1.0, I wrote a substitute function:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">substr_count5</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="default">$search</span><span class="keyword">,</span><span class="default">$offset</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="default">$offset</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">),</span><span class="default">$search</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Use it exactly as substr_count() is used in PHP5. (This will work in PHP5 as well.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74952""></a>
  <div class="note">
   <strong class="user">info at fat-fish dot co dot il</strong>
   <a href="#74952" class="date">05-May-2007 04:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a simple version for an array needle (multiply sub-strings):<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">substr_count_array</span><span class="keyword">( </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; foreach (</span><span class="default">$needle </span><span class="keyword">as </span><span class="default">$substring</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">+= </span><span class="default">substr_count</span><span class="keyword">( </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$substring</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">$count</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70742""></a>
  <div class="note">
   <strong class="user">flobi at flobi dot com</strong>
   <a href="#70742" class="date">25-Oct-2006 07:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Making this case insensitive is easy for anyone who needs this.&nbsp; Simply convert the haystack and the needle to the same case (upper or lower).<br />
<br />
substr_count(strtoupper($haystack), strtoupper($needle))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38442""></a>
  <div class="note">
   <strong class="user">XinfoX X at X XkarlX X-X XphilippX X dot X XdeX</strong>
   <a href="#38442" class="date">21-Dec-2003 01:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Yet another reference to the "cgcgcgcgcgcgc" example posted by "chris at pecoraro dot net":<br />
<br />
Your request can be fulfilled with the Perl compatible regular expressions and their lookahead and lookbehind features.<br />
<br />
The example<br />
<br />
&nbsp;$number_of_full_pattern = preg_match_all('/(cgc)/', "cgcgcgcgcgcgcg", $chunks);<br />
<br />
works like the substr_count function. The variable $number_of_full_pattern has the value 3, because the default behavior of Perl compatible regular expressions is to consume the characters of the string subject that were matched by the (sub)pattern. That is, the pointer will be moved to the end of the matched substring.<br />
But we can use the lookahead feature that disables the moving of the pointer:<br />
<br />
&nbsp;$number_of_full_pattern = preg_match_all('/(cg(?=c))/', "cgcgcgcgcgcgcg", $chunks);<br />
<br />
In this case the variable $number_of_full_pattern has the value 6.<br />
Firstly a string "cg" will be matched and the pointer will be moved to the end of this string. Then the regular expression looks ahead whether a 'c' can be matched. Despite of the occurence of the character 'c' the pointer is not moved.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.substr-compare.html">substr_compare</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.substr-replace.html">substr_replace</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
