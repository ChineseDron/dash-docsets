<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Microsoft IIS</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="install.windows.manual.html">Manual Installation Steps</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="install.windows.iis6.html">Microsoft IIS 5.1 and IIS 6.0</a></div>
 <div class="up"><a href="install.windows.html">Installation on Windows systems</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="install.windows.iis" class="sect1">
 <h2 class="title">Microsoft IIS</h2>
 <p class="para">
  This section contains PHP installation instructions specific to Microsoft Internet Information Services (IIS).
 </p>
 <ul class="itemizedlist">
  <li class="listitem">
   <span class="simpara">
    <a href="install.windows.iis6.html" class="link">Manually installing PHP on Microsoft IIS 5.1 and IIS 6.0</a>
   </span>
  </li>
  <li class="listitem">
   <span class="simpara">
    <a href="install.windows.iis7.html" class="link">Manually installing PHP on Microsoft IIS 7.0 and later</a>
   </span>
  </li>
 </ul>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="97785""></a>
  <div class="note">
   <strong class="user">mattwich at yahoo dot com</strong>
   <a href="#97785" class="date">07-May-2010 02:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was struggling with: IIS 5.1 w/ FastCGI &amp; the msi installed PHP 5.3.2.<br />
<br />
I had a simple php file (<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="string">"Hello World"</span><span class="keyword">; </span><span class="default">?&gt;</span>) and kept getting the 500 error.&nbsp; In frustration I tried opening other php files I had around and Ta-Dah!, my php file with imagejpeg() worked - because it sent a "Content-Type: image/jpeg" header.<br />
<br />
When I included a "Content-Type: text/html" header in the Hello World script, it worked. Maybe there's an IIS setting to "loosen up" on the expected input from the scripts.&nbsp; I'm just relieved to have uncovered the issue.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95439""></a>
  <div class="note">
   <strong class="user">CG</strong>
   <a href="#95439" class="date">03-Jan-2010 08:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you encounter the following error using PHP under IIS: "Warning: session_start(): open .... failed", you need to grant "read/write" permissions to the "IUSR" on the directory listed in "session.save_path" (in "php.ini"). <br />
<br />
In Vista, do the following:<br />
1. Right-click on folder defined in "session.save_path" in "php.ini" file. (ex: "C:\Windows\Temp")<br />
2. Select "Properties"<br />
3. Click "Security" tab<br />
4. Click "Edit"<br />
5. Click "Add"<br />
6. Click "Advanced"<br />
7. Click "Find Now"<br />
8. Select "IUSR"<br />
9. Click "OK"<br />
10. Click "OK".<br />
11. Under "Permissions for IUSR", ensure the following are checked:<br />
&nbsp;&nbsp;&nbsp; - Read &amp; execute<br />
&nbsp;&nbsp;&nbsp; - List folder contents<br />
&nbsp;&nbsp;&nbsp; - Read<br />
&nbsp;&nbsp;&nbsp; - Write<br />
12. Click "OK"<br />
13. Click "Yes" to change the permissions<br />
14. Click "OK"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94187""></a>
  <div class="note">
   <strong class="user">zoe</strong>
   <a href="#94187" class="date">21-Oct-2009 09:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ISAPI is not maintained anymore, the SAPI for IIS is now FastCGI.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92858""></a>
  <div class="note">
   <strong class="user">Matias</strong>
   <a href="#92858" class="date">11-Aug-2009 10:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to run PHP 5.2.10 on a IIS 7 as an ISAPI.<br />
beside adding the ISAPI file as a script you MUST change the aplication pool, with the following configuration:<br />
<br />
[managedPipelineMode] = Integrated<br />
[enable32BitAppOnWin64] = true: Enable 32 bits applications (if you have a 64bits Windows).<br />
<br />
And I have disabled .NET....<br />
<br />
This works for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91919""></a>
  <div class="note">
   <strong class="user">Rory Clerkin</strong>
   <a href="#91919" class="date">01-Jul-2009 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In the most recent release (currently 5.3.0) isapi is no longer compiled for distribution. You need to use FastCGI to get PHP to work with IIS.<br />
FastCGI is an MS development and can be gotten at the link below;<br />
<br />
<a href="http://www.iis.net/" rel="nofollow" target="_blank">http://www.iis.net/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88200""></a>
  <div class="note">
   <strong class="user">Artem Melnik</strong>
   <a href="#88200" class="date">15-Jan-2009 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You may need to specify the path to php5isapi.dll as a short DOS path when you define both the php ISAPI filter and extension mapping in server config.<br />
I was getting 404 errors when accessing the php files, after changing the paths to php isapi dll to DOS-style the problem was gone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88192""></a>
  <div class="note">
   <strong class="user">bbohl2 at yahoo dot com</strong>
   <a href="#88192" class="date">14-Jan-2009 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those running IIS on Windows 2003 x64 in 32 bit mode, the registry setting for finding php.ini must start with HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432NODE\PHP.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87123""></a>
  <div class="note">
   <strong class="user">meltir at meltir dot com</strong>
   <a href="#87123" class="date">20-Nov-2008 02:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that you also have to make sure that the permissions to the php installation directory are proper - <br />
by default they do not allow execution of php.exe and the dlls from your install dir via IIS. <br />
(i kept getting a 401.3 ACL error)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82061""></a>
  <div class="note">
   <strong class="user">frubi at frubi dot net</strong>
   <a href="#82061" class="date">26-Mar-2008 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under Win2003, you don't need to restart the services, if you only add PHP to a new website with its own application pool.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81064""></a>
  <div class="note">
   <strong class="user">bbxmail1 at job1data dot com</strong>
   <a href="#81064" class="date">12-Feb-2008 09:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i think the install steps are generally covered in the installation guideliness on this website, but this step by step guide and its explanations make the install on SBS2003 much easier to follow and implement. I spent about 3 hours searching threads and forums and not getting it all until i followed the steps at this link. <br />
<a href="http://www.peterguy.com/php/install_IIS6.html#IISConfigure" rel="nofollow" target="_blank">http://www.peterguy.com/php/install_IIS6.html#IISConfigure</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78876""></a>
  <div class="note">
   <strong class="user">shanef dot jordan at gmail dot com</strong>
   <a href="#78876" class="date">31-Oct-2007 05:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Make sure in IIS that when you set the permissions on C:\PHP that it inherits to the folders/files within that directory.&nbsp; I was doing a reinstall on a 2003/IIS 6 and whoever did the previous install took off inherit permissions.&nbsp; Fought with that for several hours!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77701""></a>
  <div class="note">
   <strong class="user">paul_lynch67 at hotmail dot com</strong>
   <a href="#77701" class="date">09-Sep-2007 12:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
<br />
I've written a manual installation guide for PHP 5.x on Windows Server 2003 and IIS 6.0 which you can find here :<br />
<br />
<a href="http://www.iisadmin.co.uk/?p=4" rel="nofollow" target="_blank">http://www.iisadmin.co.uk/?p=4</a><br />
<br />
This is the same article which used to be hosted on the IIS Resources web site. I hope some of you find it useful.<br />
<br />
Regards,<br />
<br />
Paul Lynch [IIS MVP]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76721""></a>
  <div class="note">
   <strong class="user">stevegath at gmail dot com</strong>
   <a href="#76721" class="date">27-Jul-2007 09:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a few hours of trying everything under the sun to get PHP 5.2.3 to work on Windows Small Business Server 2003 with IIS6 with ISAPI starting from the msi install of from php.net.&nbsp; I found that the install correctly used the path C:\PROGRA~1\PHP\PHP5IS~1.DLL in adding the Mapping for .php but for the Web Service Extension it used C:\Program Files\PHP\php5isapi.dll.&nbsp; When I changed this to C:\PROGRA~1\PHP\PHP5IS~1.DLL.&nbsp; It worked right away.&nbsp; Before this change I would get a 404 error when accessing php pages.&nbsp; Moral of the story is avoid spaces in all paths.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75033""></a>
  <div class="note">
   <strong class="user">jos at juffermans dot net</strong>
   <a href="#75033" class="date">09-May-2007 05:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Has anybody succeeded in running PHP4 and PHP5 simultaneously using ISAPI? It's possible as CGI since they'll both pick up their php.ini from where the php.exe (or php-cgi.exe) is. But as ISAPI they'll both read the same php.ini file which points both versions to the extension folder of 1 version (eg both PHP4 and PHP5 will use the PHP5 extensions) and thus fail...<br />
<br />
Please don't ask my WHY I want both versions, I simply have to. Don't mean to start a discussion here but would like to run both PHP4 and PHP5 as ISAPI module.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74415""></a>
  <div class="note">
   <strong class="user">carsten at enggaardblom dot dk</strong>
   <a href="#74415" class="date">10-Apr-2007 09:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Installing PHP 5.2.1 on a Windows 2K3 Server with SP1 and IIS 6.0<br />
<br />
- was about to give me the head ache of the year! It is NOT - repeat - NOT possible to use the CGI on a server but ISAPI works perfectly. The documentation mentions both - but cgi/fastcgi is definetely a no go.<br />
<br />
Using the PHP installer I used the IIS option, corrected the recommended php.ini file and added the extensions I wanted.<br />
<br />
And at this point - too - you have to restart the server to make it work, a restart of only the IIS service is not sufficient.<br />
<br />
So mark my words, use ISAPI and don't get any errors!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73930""></a>
  <div class="note">
   
   <a href="#73930" class="date">15-Mar-2007 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This one threw me for a loop; you CAN NOT put the PHP folder in Program Files if you're installing on IIS!&nbsp; I guess the space in "Program Files" throws it off, I was getting a "You must enter a valid file path" error when trying to add the PHP mapping manually.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70200""></a>
  <div class="note">
   <strong class="user">peopls at gmail dot com</strong>
   <a href="#70200" class="date">06-Oct-2006 08:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a big problem with this on my server, as I was not using IUSR I was using Network Service.<br />
Even more difficult was the fact that it was the DC on a domain which meant I got told that&nbsp; it "is not from a domain listed in the Select Location dialog box, and is therefore not valid.".<br />
The way I got around this was with the following command.<br />
C:\Documents and Settings\Administrator&gt;cacls C:\php /G "NT AUTHORITY\NETWORK SERVICE":F /E /T<br />
<br />
Please note that this gives the user NETWORK SERVICE full access to the C:\php directory, but it did solve my problem!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69468""></a>
  <div class="note">
   <strong class="user">Rex Hunt</strong>
   <a href="#69468" class="date">06-Sep-2006 06:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Found this PHP installer for IIS which uses fastcgi and apc;<br />
<br />
<a href="http://www.iis-aid.com/iis_aid_php_installer" rel="nofollow" target="_blank">http://www.iis-aid.com/iis_aid_php_installer</a><br />
<br />
You get to configure your fastcgi and apc settings during installation, and it is meant to work with IIS 5.x and 6. It even setup the web server extension in IIS 6, and seems to be working ok for me so far on a dev box. Only drawbacks are it is only available with PHP 4.4.1 using fastcgi (no isapi yet).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66768""></a>
  <div class="note">
   <strong class="user">sschefer at scheferonline dot net</strong>
   <a href="#66768" class="date">28-May-2006 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have sucessfully installed PHP 4 and 5 on every windows server version since 2000 (not NT4) and XP. It is simple but there are a couple of pre-requisites that I've never seen mentioned.<br />
<br />
1. Most of the problems folks are experiencing on the server side are .NET 2.0 induced. If you must run .NET 2.0 then you need dll's that were compiled with Visual Studio 8. The big push behind VS.8 and the Express editions is to get you off of PHP and onto C#. Keep that in mind when you develop apps.<br />
<br />
2. You can run .NET 2.0 and Visual studio on XP with PHP and IIS if you install Visual Studio first. Visual studio installs its own dedicated version of IIS that works with .NET 2.0 but will not run php. After VS is installed go ahead and install the included XP version of IIS and configure your virtual sites with PHP. If you do it the other way around, VS will incorporate itself into the xp IIS and your PHP will probably not run.<br />
<br />
3. Put the PHP ini file where windows wants it, in the (system root) "c:\windows" dir. If you do that,&nbsp; and you are using only the ISAPI dll's, you just need to change the ini file to point to the ext directory correctly and it will run fine. I usually do all the pathing recommendations and set phprc=(php directory) too. I also leave a copy of the current ini file in the php directory root just incase php forgets to consult with the OS before looking for something.<br />
<br />
Most of the problems with permissions are comming from .NET 2.0. You should never have to weaken security to get PHP to run.<br />
<br />
4. Slightly out of scope but important nonetheless. If you do not run .NET 2.0, the ordering of your extensions (ie..mysql.dll, etc.) becomes far less important. You may see a hang occasionally but its rare.<br />
<br />
Hope this helps someone.<br />
Steve</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63572""></a>
  <div class="note">
   <strong class="user">EvilPuppetMaster</strong>
   <a href="#63572" class="date">23-Mar-2006 07:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After having recently gone through a long process of trial and error installing both php4 and php5 on a single machine under IIS. I eventually did get it working so I thought I'd share what I learnt.<br />
<br />
Basically, as far as I can tell there is no way to get both versions working using the ISAPI dlls unfortunately. You can however get them working using one as ISAPI and the other as CGI. And probably both as CGI too, although I didn't try that.<br />
<br />
You'll need to know how to do a manual install of PHP anyway, see the instructions for how to do that. Make sure you follow the steps about your PATH env variable and Allowing extensions on IIS 6. Keep your php.inis in the relevant php directory and make sure they are not in your windows or system32 folders. And all that other hoopla.<br />
<br />
The crucial part is your php.ini files. The problem being that both versions will look at your PHPRC setting and get the ini file path from that. So you'll end up with both versions running off the same INI which is no good. The way around this is to use the CGI for one version and ISAPI for the other.<br />
<br />
The ISAPI dll never seems to look in it's own directory for the ini file, but the CGI exe does. You can use that quirk to your advantage by naming the INI file for the ISAPI version 'php-isapi.ini' and setting the PHPRC environment variable to that path. Then for the CGI version keep the php.ini in the same directory as php.exe.<br />
<br />
Then set your virtual server to use either the ISAPI module for one version, or the CGI module for the other version, and it should work. Test using phpinfo() to ensure each version is getting it's ini file from the correct place.<br />
<br />
Basically it seems that the ISAPI module will look in the path set in PHPRC first, and choose the php-isapi.ini file. The CGI module will look in PHPRC first too, but it upon seeing no php.ini it will then move on to search it's own directory, where it finds php.ini.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63569""></a>
  <div class="note">
   <strong class="user">Martu</strong>
   <a href="#63569" class="date">23-Mar-2006 05:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have fixed the 404 with this message found at google groups:<br />
<br />
-----------------------------------------------------------<br />
I could not get PHP pages to display in IIS 6 with Windows 2003, using the <br />
default install of the stable binaries from php.net. <br />
<br />
Here is the solution I found. <br />
<br />
The default install registers the .php extension as belonging to <br />
c:\php\php.exe.&nbsp; This is correct, but it's faster to use the ISAPI <br />
extension. <br />
<br />
To do this, <br />
1. Open the IIS Management console <br />
2. Expand the server, right click on "Web Sites" and click Properties <br />
3. Open the "ISAPI Filters" foldertab <br />
4. Click Add <br />
5. Enter PHP in the Filter Name box. <br />
6. Click Browse and then Browse to your php4isapi.dll. <br />
6. Click ok -&gt; Apply -&gt; ok <br />
<br />
... Once this is completed, your PHP scripts still won't run.&nbsp; The problem <br />
is that you have to define and enable PHP as a "Web Service Extension". <br />
<br />
To do this, <br />
1. Open the IIS Management console <br />
2. Expand the server, and expand the "Web Services Extensions" <br />
3. Click "Add a new Web services Extension" <br />
4. Enter PHP in the Extension Name box. <br />
5. In the required files box, Browse to your php directory and add <br />
php4isapi.dll. <br />
6. Click ok -&gt; Apply -&gt; ok <br />
<br />
Last but not least, You may or may not need to do the following, <br />
-Set the extensions path in the php.ini file if you are going to use any <br />
extensions , i.e.&nbsp; php_mssql.dll <br />
-I had to copy the php4isapi.dll from c:\php\isapi to c:\php, YMMV <br />
-Give the webserver user (IUSR_MACHINENAME in most cases) read and execute <br />
access to php4isapi.dll and php4ts.dll <br />
<br />
Good Luck, <br />
Ejay Hire <br />
EjayH...@hotmail.com <br />
----------------------------------------------------------</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57432""></a>
  <div class="note">
   <strong class="user">paul_noeldner at hotmail dot com</strong>
   <a href="#57432" class="date">03-Oct-2005 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PROBLEM<br />
&nbsp;&nbsp;&nbsp; PHP $DOCUMENT_ROOT was not set in IIS.&nbsp; <br />
ANALYSIS<br />
&nbsp;&nbsp;&nbsp; A Google search turned up a suggestion re using ISAPI instead of CGI.&nbsp; <br />
SOLUTION<br />
I did the fix per these suggested steps from Google search: <br />
1 Downloaded PHP5 zip<br />
2 Added ISAPI filter PHP5ISAPI.DLL named PHP<br />
3 Changed document type .php to point at the PHP5ISAPI.DLL file instead of PHP.EXE.<br />
RESULT<br />
This worked - the php pages started picking up $DOCUMENT_ROOT as expected.<br />
General suggestion: Don't waste time with CGI, use ISAPI.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57093""></a>
  <div class="note">
   <strong class="user">Jamez</strong>
   <a href="#57093" class="date">23-Sep-2005 05:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 5, IIS 5, Win XP: <br />
<br />
One thing to note: if you run phpinfo() and the 'Configuration File (php.ini) Path' points to a directory and not the actual file (ie. C:\\windows instead of C:\\windows\\php.ini) this means that it is not using your php.ini file, it is using default settings. <br />
<br />
After spending hours searching forums the only thing that got it to work for me was to create a new environment system variable called 'PHPRC' and set it to the path where your php.ini is located (ie C:\\PHP) - simply adding C:\\PHP to the system path variable didn't do it. You have to reboot after this change of course. I'm not sure why this isn't more documented as from my searching there are quite a few people who experience this problem... hope this helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56824""></a>
  <div class="note">
   <strong class="user">webwhammy.com</strong>
   <a href="#56824" class="date">15-Sep-2005 04:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After installing PHP and running an <a href="http://localhost/test.php file in my browser, I encountered a COM Surrogate error. After some testing, I found that it was a result of un-checking the Cache ISAPI applications checkbox. Consequently, make sure that the Cache ISAPI applications checkbox has a check in it. To get to the checkbox go to:" rel="nofollow" target="_blank">http://localhost/test.php file in my browser, I encountered a COM Surrogate error. After some testing, I found that it was a result of un-checking the Cache ISAPI applications checkbox. Consequently, make sure that the Cache ISAPI applications checkbox has a check in it. To get to the checkbox go to:</a><br />
<br />
Control Panel&gt;Administrative Tools&gt;Internet Information Services<br />
<br />
When you are at the IIS window in the left navigational panel go to:<br />
<br />
Local Computer&gt;Web Sites&gt;Default Web Site<br />
<br />
Right-click on your default web site and select Properties. A Properties window appears. Select the Home Directory tab. Click on the Configuration... button. A Configuration window appears. Below the Mappings tab is the Cache ISAPI applications checkbox.<br />
<br />
Again, make sure that the Cache ISAPI applications checkbox has a check in it. I hope this helps anybody else with a similar problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56583""></a>
  <div class="note">
   <strong class="user">Mac Rinehart</strong>
   <a href="#56583" class="date">07-Sep-2005 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"Click on the 'Configuration' button, and choose the Application Mappings tab. Click Add and set the Executable path to the appropriate CGI file. An example PHP 5 value is: C:\php\php-cgi.exe Supply .php as the extension. Leave 'Method exclusions' blank, and check the 'Script engine' checkbox. Now, click OK a few times."<br />
<br />
When installing PHP 5 on IIS 6.0 and Windows 2003 I encountered problems with this instruction. I&nbsp; believe the root cause is that IIS requires the "scripts and executables" execute permission to be selected if the script engine has a .exe extension. <br />
<br />
However, there may have been additional problems. Even when selecting the "scripts and executables" execute permission I continually received HTTP Header errors. The resolution was to follow the instructions for use of php5isapi.dll. The .dll extension can be run with the "scripts only" execute permission. Also remember IIS 6.0 requires that you identify Web Extensions and Allow execution of those extensions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51474""></a>
  <div class="note">
   <strong class="user">peter at peterguy dot com</strong>
   <a href="#51474" class="date">31-Mar-2005 10:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Installing PHP 5 on Windows Server 2003/IIS6<br />
<br />
It has come to my attention that the link to my PHP installation guide in my posting of 07-Feb-2005 11:49 is a Bad Link.<br />
We don't like Bad Links.<br />
<br />
Here's the correct one:<br />
<br />
<a href="http://www.peterguy.com/php/install_IIS6.html" rel="nofollow" target="_blank">http://www.peterguy.com/php/install_IIS6.html</a><br />
<br />
Enjoy!<br />
<br />
-Peter</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51018""></a>
  <div class="note">
   <strong class="user">Marat</strong>
   <a href="#51018" class="date">16-Mar-2005 01:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The correct required NTFS ACL's are:<br />
<br />
- for the folder holding your PHP files:<br />
&nbsp;&nbsp; [Read] IUSR_servername <br />
&nbsp;&nbsp; [Read] IWAM_servername<br />
<br />
-for the folder holding the PHP executables:<br />
&nbsp;&nbsp; [Read] IUSR_servername</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50347""></a>
  <div class="note">
   <strong class="user">Person who wants ISAPI version installer</strong>
   <a href="#50347" class="date">25-Feb-2005 01:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Supplementation to the previous hint<br />
<br />
The environment is Windows 2003 Server/IIS 6/PHP 5. <br />
<br />
About IIS 6 of Windows XP. <br />
<br />
&nbsp;There is no 'IISEXT.VBS'. <br />
&nbsp;It seems not to have to add it to the Web enhancing<br />
&nbsp;(It is not an accurate intelligence ).<br />
&nbsp;Moreover, when the method argument of iis6<br />
&nbsp;isapimap add is omitted, it becomes an error. <br />
&nbsp;Specify it following and specifying it. <br />
<br />
&nbsp;&nbsp; iis6isapimap add .PHP C:\PHP\php5isapi.dll GET,POST,HEAD<br />
<br />
Good Luck !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50302""></a>
  <div class="note">
   <strong class="user">Person who wants ISAPI version installer</strong>
   <a href="#50302" class="date">24-Feb-2005 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hint registered to IIS 6 as ISAPI without using GUI. <br />
(It is a machine translation from Japanese to English. )<br />
<br />
[Method of addition to Web enhancing]<br />
<br />
'IISEXT.VBS' is attached to IIS 6.<br />
<br />
&nbsp; &lt;addition example&gt;<br />
<br />
&nbsp;&nbsp;&nbsp; iisext /AddFile C:\PHP\php5isapi.dll 1 PHP 1 "PHP: Hypertext Preprocessor"<br />
<br />
&nbsp; &lt;deletion example&gt;<br />
<br />
&nbsp;&nbsp;&nbsp; iisext /RmFile&nbsp; C:\PHP\php5isapi.dll<br />
<br />
[Method of adding extension to Application Mappings]<br />
<br />
To our regret, there is no good method in the standard. :-(<br />
The source code of C# program that is registered and deleted is presented in the mapping. <br />
(It is hoped that someone writes VBScript or the JScript version)<br />
<br />
&nbsp; &lt;addition example&gt;<br />
<br />
&nbsp;&nbsp;&nbsp; iis6isapimap add .PHP C:\PHP\php5isapi.dll<br />
<br />
&nbsp;&lt; deletion example&gt;<br />
<br />
&nbsp;&nbsp;&nbsp; iis6isapimap delete .PHP<br />
<br />
C# source code<br />
(Add 'System.DirectoryServices' to the reference)<br />
------------------------------------------------------------<br />
using System;<br />
using System.Collections;<br />
using System.DirectoryServices;<br />
<br />
namespace IIS6ISAPIMAP<br />
<br />
{<br />
&nbsp;&nbsp;&nbsp; class StartClass<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static void print_man()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Console.WriteLine("IIS6ISAPIMAP [view|add|delete] &lt;.ext&gt; &lt;ISAPI DLL PATH&gt; (METHOD LIST)");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; [STAThread]<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static void Main(string[] args)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( args.GetLength(0) &lt; 1 )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print_man();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; System.DirectoryServices.DirectoryEntry dent<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; = new DirectoryEntry("IIS://localhost/W3SVC/1/root");&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ArrayList orglist<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; = new ArrayList( dent.Properties["ScriptMaps"] )&nbsp; ;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( args[0].ToLower() == "view" )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(string s in orglist)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Console.WriteLine(s);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if ( args[0].ToLower() == "add" )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( args.GetLength(0) &lt; 3 )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print_man();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ArrayList newlist = new ArrayList();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string ext = args[1];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string path = args[2];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string methods = args.GetLength(0) &lt; 4 ? "" : args[3];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string newmap = ext + "," + path + ",5," + methods;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(string s in orglist)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string [] tokn = s.Split(','); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( tokn[0].ToLower()&nbsp; != ext.ToLower() )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; newlist.Add( s );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; newlist.Add( newmap );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; dent.Properties["ScriptMaps"].Value = newlist.ToArray();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; dent.CommitChanges();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if ( args[0].ToLower() == "delete" )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( args.GetLength(0) &lt; 2 )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print_man();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ArrayList newlist = new ArrayList();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string ext = args[1];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(string s in orglist)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string [] tokn = s.Split(','); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( tokn[0].ToLower()&nbsp; != ext.ToLower() )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; newlist.Add( s );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; dent.Properties["ScriptMaps"].Value = newlist.ToArray();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; dent.CommitChanges();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print_man();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; dent.Dispose();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48794""></a>
  <div class="note">
   <strong class="user">php at  at dougdossett dot com</strong>
   <a href="#48794" class="date">06-Jan-2005 11:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had problems upgrading to 5.0.3 isapi on my IIS 6/Windows 2003 server.&nbsp; Most of the instructions I found said to give the IUSR account access to various files/folders.&nbsp; In my case I needed to give access to "Network Service" (not to be confused with just "Network").&nbsp; <br />
<br />
1. In IIS Admin, go to Application Pools<br />
2. Right click on the pool your site is running under and click properties.&nbsp; <br />
3. Go to the Identity tab and see what user is selected.&nbsp; <br />
4. Give that user permissions to your php files/directory.<br />
<br />
Don't know if this will help anyone else, but thought I'd offer in case.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46445""></a>
  <div class="note">
   <strong class="user">megawhizzz at netscape dot com</strong>
   <a href="#46445" class="date">11-Oct-2004 04:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Path references (e.g. for browscap.ini) in php.ini MUST be enclosed with double-quotes (") instead of single-quotes(') for PHP to load correctly under IIS</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45234""></a>
  <div class="note">
   <strong class="user">paul at heisholt dot net</strong>
   <a href="#45234" class="date">30-Aug-2004 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There's a bug in IIS 5.1 which may prevent you from adding an Application Extension Mapping. If the OK button remains disabled after you've entered the Executable and the Extension, try this workaround provided by Microsoft:<br />
<br />
1. Right-click the individual Web site or the Web Sites folder, and then click Properties.<br />
2. On the Home Directory tab, click Configuration.<br />
3. Under Application Configuration, click Add, and then click the Mappings tab.<br />
4. With the Add/Edit Application Extension Mapping dialog box open, click Browse to select the .exe file or the .dll file from the local path on the Web server. <br />
<br />
Note: <br />
You must type the path to a valid file in the Executable text box or the OK button remains unavailable. The easiest way to make sure that you enter a valid path is to select the file by using the Browse button.<br />
<br />
5. After the path appears in the Executable text box, click in the Executable text box to initialize the path.<br />
<br />
6. Click in the Extension space, and then type the file name extension.<br />
<br />
Note:<br />
- You must enter the period (.) in front of the extension in the Extension text box, or the OK button remains unavailable.<br />
<br />
7. When the OK button becomes active, click OK to continue.<br />
<br />
Source: <a href="http://support.microsoft.com/?id=317948" rel="nofollow" target="_blank">http://support.microsoft.com/?id=317948</a><br />
<br />
-paul-</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44693""></a>
  <div class="note">
   <strong class="user">webmaster at avalon dot de</strong>
   <a href="#44693" class="date">12-Aug-2004 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use IIS6 you have to add a new Webextension for PHP to work, otherwise you will get a "404"-Page if you try to point your browser to a "*.php" file.<br />
In order to do this you have to open the IIS-management console and open the "local computer".<br />
Under "webextensions" you will find allready a list with different extensions all being blocked by default.<br />
To get PHP to work you have to manually add a new webextension. I only have a german version of IIS in front of me so forgive me if i translate the buttons wrongly.<br />
Click on "New webextension". Enter any name you like for your new extension. Click on "Add..." and then on "Search...". If you would like to add the DLL just browse to your PHP-directory and you will find the php5ts.dll. If you search for the php-cgi.exe you have to change the filetype at the bottom to "CGI-Exe-Files". Only after changing the filetype you can see the php-cgi.exe file and choose it for the extension.<br />
If you check the checkbox at the bottom of the "New extension" Window it will allow the newly added extension to be executed. Certainly you can change the status any time you want by clicking on "Allow".<br />
Only after that procedure you will be able to get in touch with PHP-files.<br />
<br />
sincerely<br />
Juergen Sommer</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43017""></a>
  <div class="note">
   <strong class="user">venimus at mail dot com</strong>
   <a href="#43017" class="date">06-Jun-2004 07:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under IIS6 (and earlier)<br />
After all the installation, do not forget to add "index.php" as default page, under the Documents tab in the Web Site's Properties. <br />
1. Right-click Web Sites, choose Properties<br />
2. Click Documents tab<br />
3. Click Add...<br />
4. Type index.php, click Ok<br />
5. Choose "index.php" from the list and move it to the top using Move Up button.<br />
6. Make sure "Enable default content page" is checked.<br />
<br />
Ofcourse you can add other pages as default.<br />
<br />
For those that do not know what is this for: If you do not provide full URL and you have several pages in the directory which are in this list, the server will return the topmost of them. In case you wish to open other page of them, you have to provide its full URL. Putting "index.php" on top will make sure no other pages will be returned as default.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42868""></a>
  <div class="note">
   <strong class="user">jorrit at gameparty dot net</strong>
   <a href="#42868" class="date">01-Jun-2004 04:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you experience extreme high loading times, please have a look at this <a href="http://bugs.php.net/bug.php?id=28524" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=28524</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41722""></a>
  <div class="note">
   <strong class="user">tstirrat AT optusnet DOT com DT au</strong>
   <a href="#41722" class="date">20-Apr-2004 08:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am running Active Directory &amp; IIS6.0<br />
<br />
I found that after looking through the tutorial below i was still unable to get into my site (authentication popup, 401.3 error). I set my permissions for read &amp; execute for IUSR_(server) and IIS_WPG for both my document root and the php directory.. no luck.<br />
<br />
However, here's how i solved the problem. (I believe this solution is relevant to fixing the active directory issue)<br />
<br />
1. You want to give the IUSR_* and IIS_WPG read &amp; execute permission to the PHP DIRECTORY ONLY. (I managed to remove the credentials from my document root and it still works.<br />
<br />
2. Open IIS Manager and go to Application Pools, then to the pool which is relevant to your site (in my case DefaultAppPool).. on this item, right click and choose properties.<br />
<br />
3. Now navigate to the identity tab.<br />
<br />
4. My Worker process was set to Predefined: Network Service. I changed this to Configurable: IWAM_(server name) (which if you noticed is in the user group 'IIS_WPG')<br />
<br />
Note: i also changed the passwords for my IUSR_* and IWAM_* accounts to be sure they werent set to something easy by default. Its probably a good idea to do this too.<br />
<br />
Hope this solves someones frustration.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39835""></a>
  <div class="note">
   <strong class="user">giunta dot gaetano at sea-aeroportimilano dot it</strong>
   <a href="#39835" class="date">12-Feb-2004 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If some extensions (such as OCI or Turck mmcache in FastCGI mode) have trouble functioning with PHP+IIS, make sure that "Allow IIS to Control Password" is unchecked in the preferences panel for anonymous user access.<br />
<br />
For more detail on the issue, read articles 216828 and 218756 in the MS Knoweledge Base.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39816""></a>
  <div class="note">
   <strong class="user">Aaron Blew</strong>
   <a href="#39816" class="date">11-Feb-2004 12:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under IIS 6, don't forget that you have to add all the PHP modules you'd like to run to the PHP Web Service Extension part under the IIS management console.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="34928""></a>
  <div class="note">
   <strong class="user">webmaster at riachao dot com</strong>
   <a href="#34928" class="date">12-Aug-2003 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In the installation with IIS 6.0, after you add the isapi extension, you need to allow the extension in the Web Services Extensions, or you 'll get a 404 error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31143""></a>
  <div class="note">
   <strong class="user">nbrookins at cbwstores dot com</strong>
   <a href="#31143" class="date">10-Apr-2003 09:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Windows Server 2003 (formerly .net server) with IIS 6 (final RTM - build 3790)<br />
<br />
&nbsp;I got PHP working by using one of the tips above (thanks!).&nbsp; <br />
<br />
I noted however, that I did not need to 'allow unknown Isapi applications' , and I was able to keep the configuration at 'Scripts Only' instead of 'Scripts and Executables'&nbsp; - both settings are potentially more secure this way.<br />
<br />
The only configuration that is different from how I normally configure PHP on IIS 5 is the addition of PHP as a Web Service Extension.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26528""></a>
  <div class="note">
   <strong class="user">jdogg00 at msn dot com</strong>
   <a href="#26528" class="date">03-Nov-2002 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a quick fyi, to get PHP installed on .Net Server w/ IIS 6 you have to use the IIS manager to enable support for different web service extentions. CGI ,ASP, ISAPI are all prohibited by default. In IIS manager click on the Web Service Extentions Folder there's options to add a new extention , prohibit all extentions etc. I chose add new extention ,in the dialog box I named it PHP , click add , in the next dialog browse to path of 'php4isapi.dll' hit ok then mark checkbox "Set extention status Allowed"&nbsp; hit ok and all is good. This was done after I followed the install.txt for IIS 4 or newer .</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="10815""></a>
  <div class="note">
   <strong class="user">greg at wfrmls dot com</strong>
   <a href="#10815" class="date">22-Jan-2001 09:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using WindowsNT 4.0 and IIS, the WWW home directory needs to have Read AND Execute access rights.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="install.windows.manual.html">Manual Installation Steps</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="install.windows.iis6.html">Microsoft IIS 5.1 and IIS 6.0</a></div>
 <div class="up"><a href="install.windows.html">Installation on Windows systems</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
