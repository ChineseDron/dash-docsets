<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Increment item's value</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="memcache.getversion.html">Memcache::getVersion</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="memcache.pconnect.html">Memcache::pconnect</a></div>
 <div class="up"><a href="class.memcache.html">Memcache</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="memcache.increment" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Memcache::increment</h1>
  <p class="verinfo">(PECL memcache &gt;= 0.2.0)</p><p class="refpurpose"><span class="refname">Memcache::increment</span> &mdash; <span class="dc-title">Increment item&#039;s value</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-memcache.increment-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><b>Memcache::increment</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$key</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$value</tt><span class="initializer"> = 1</span></span>
  ] )</div>


  <p class="para rdfs-comment">
   <span class="function"><b>Memcache::increment()</b></span> increments value of an item by
   the specified <i><tt class="parameter">value</tt></i>. If item specified by
   <i><tt class="parameter">key</tt></i> was not numeric and cannot be converted to a
   number, it will change its value to <i><tt class="parameter">value</tt></i>.
   <span class="function"><b>Memcache::increment()</b></span> <em class="emphasis">does not</em>
   create an item if it doesn&#039;t already exist.
   <blockquote class="note"><p><b class="note">Note</b>: 
    <p class="para">
     Do not use <span class="function"><b>Memcache::increment()</b></span> with items that have been  
     stored compressed because subsequent calls to 
     <span class="function"><a href="memcache.get.html" class="function">Memcache::get()</a></span> will fail.
    </p>
   </p></blockquote>
   Also you can use <span class="function"><b>memcache_increment()</b></span> function.
  </p>

 </div>


 <div class="refsect1 parameters" id="refsect1-memcache.increment-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">key</tt></i></span>
     <dd>

      <p class="para">
       Key of the item to increment.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">value</tt></i></span>
     <dd>

      <p class="para">
       Increment the item by <i><tt class="parameter">value</tt></i>.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-memcache.increment-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns new items value on success  or <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-memcache.increment-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-3983">
    <p><b>Example #1 <span class="function"><b>Memcache::increment()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">/*&nbsp;procedural&nbsp;API&nbsp;*/<br /></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">/*&nbsp;increment&nbsp;counter&nbsp;by&nbsp;2&nbsp;*/<br /></span><span style="color: #0000BB">$current_value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_increment</span><span style="color: #007700">(</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'counter'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;OO&nbsp;API&nbsp;*/<br /></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Memcache</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">/*&nbsp;increment&nbsp;counter&nbsp;by&nbsp;3&nbsp;*/<br /></span><span style="color: #0000BB">$current_value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">increment</span><span style="color: #007700">(</span><span style="color: #DD0000">'counter'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-memcache.increment-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="memcache.decrement.html" class="function" rel="rdfs-seeAlso">Memcache::decrement()</a> - Decrement item's value</span></li>
    <li class="member"><span class="function"><a href="memcache.replace.html" class="function" rel="rdfs-seeAlso">Memcache::replace()</a> - Replace value of the existing item</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104303""></a>
  <div class="note">
   <strong class="user">perroazul64 at gmail dot com</strong>
   <a href="#104303" class="date">07-Jun-2011 10:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When the key doesn't exist it may return either bool(false) or int(0) (I get different return values on different servers), so be careful if you check for something like ($memcache-&gt;increment($key) === false).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91892""></a>
  <div class="note">
   <strong class="user">ian at blip dot fm</strong>
   <a href="#91892" class="date">30-Jun-2009 04:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful to use Memcache::decrement() and never Memcache::increment() with a negative value.<br />
<br />
The check that prevents Memcache::decrement() from going negative is not in place with Memcache::increment(), so you can end up with a garbage integer on the order of 18 quintillion stored in place of the expected value.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90864""></a>
  <div class="note">
   <strong class="user">jay dot paroline at escapemg dot com</strong>
   <a href="#90864" class="date">13-May-2009 06:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instead of checking the value before incrementing, you can simply ADD it instead before incrementing each time. If it's already there, your ADD is ignored, and if it's not there, it's set.<br />
<br />
If you add($memcacheKey, 0) and then increment($memcacheKey, 1) in that order, you avoid all possible race conditions. If two threads are running this code concurrently, you will always end up with your value being 2 no matter which order the threads execute in.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90863""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#90863" class="date">13-May-2009 06:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note:<br />
If the key does not exist, memcache does NOT return false (as you might expect) but 0.<br />
You won't get any hint that the key did not exist and still does not exist and that nothing was incremented.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53877""></a>
  <div class="note">
   
   <a href="#53877" class="date">15-Jun-2005 12:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if no variable exists, even if you specify an increment value, the result will be null.<br />
<br />
if you're using this for a mutex, chk if its null, and if so, then ADD the variable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="memcache.getversion.html">Memcache::getVersion</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="memcache.pconnect.html">Memcache::pconnect</a></div>
 <div class="up"><a href="class.memcache.html">Memcache</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
