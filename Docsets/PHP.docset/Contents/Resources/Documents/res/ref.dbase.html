<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>dBase Functions</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="dbase.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.dbase-add-record.html">dbase_add_record</a></div>
 <div class="up"><a href="book.dbase.html">dBase</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.dbase" class="reference">
  <h1 class="title">dBase Functions</h1>

  <div class="partintro">
   <div class="section" id="dbase.examples.note">
    <h2 class="title">Examples</h2>
    <p class="para">
     Many examples in this reference require a dBase database. We will use 
     <var class="filename">/tmp/test.dbf</var> that will be created in the example of
     <span class="function"><a href="function.dbase-create.html" class="function">dbase_create()</a></span>.
    </p>
   </div>
   
  </div>











































































 <h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.dbase-add-record.html">dbase_add_record</a> â€” Adds a record to a database</li><li><a href="function.dbase-close.html">dbase_close</a> â€” Closes a database</li><li><a href="function.dbase-create.html">dbase_create</a> â€” Creates a database</li><li><a href="function.dbase-delete-record.html">dbase_delete_record</a> â€” Deletes a record from a database</li><li><a href="function.dbase-get-header-info.html">dbase_get_header_info</a> â€” Gets the header info of a database</li><li><a href="function.dbase-get-record-with-names.html">dbase_get_record_with_names</a> â€” Gets a record from a database as an associative array</li><li><a href="function.dbase-get-record.html">dbase_get_record</a> â€” Gets a record from a database as an indexed array</li><li><a href="function.dbase-numfields.html">dbase_numfields</a> â€” Gets the number of fields of a database</li><li><a href="function.dbase-numrecords.html">dbase_numrecords</a> â€” Gets the number of records in a database</li><li><a href="function.dbase-open.html">dbase_open</a> â€” Opens a database</li><li><a href="function.dbase-pack.html">dbase_pack</a> â€” Packs a database</li><li><a href="function.dbase-replace-record.html">dbase_replace_record</a> â€” Replaces a record in a database</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="88900""></a>
  <div class="note">
   <strong class="user">bi.idan [at] gmail.com</strong>
   <a href="#88900" class="date">12-Feb-2009 07:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
some of you contacted me about memo fields and my script, so i'll just post my answers on the common question here.<br />
<br />
(note: this is not an adv for any program, only what i used for myself, and it's free)<br />
<br />
so, there are 2 options if you want to create/read memo fields:<br />
<br />
1. use a library for java/c++/c# to build a bridge between php and dbf file. i've used dbf2java. althougth it's not near complete as my other option, it's a good start. (<a href="http://code.google.com/p/dbf2java-library/" rel="nofollow" target="_blank">http://code.google.com/p/dbf2java-library/</a>)<br />
<br />
2. use an external program with pipes to grab the output. i used cdbflite, (<a href="http://www.whitetown.com/cdbflite/" rel="nofollow" target="_blank">http://www.whitetown.com/cdbflite/</a>). it's free, and pretty much gives you everything you need to handle those dbf files. i'm not sure about big databases and it seems you need to register/buy it, but it's again, a start.<br />
<br />
hope it helps some of you who needs to handle those database files,<br />
<br />
Good luck,<br />
idan</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82405""></a>
  <div class="note">
   <strong class="user">kuthullu at webmails dot com</strong>
   <a href="#82405" class="date">09-Apr-2008 07:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For all those of you who wants to DBF-&gt;SQL, here's half of a hour worth of work.<br />
It's pretty simple, outputs a CREATE TABLE and lots of INSERTs.<br />
The output is HTML, as I use w$ndows here at work and prefer to just see results in opera.<br />
You SHOULD verify the created data, add some CREATE KEYs, NOT NULLs or whatever you like.<br />
<br />
<span class="default">&lt;?php<br />
$file_name </span><span class="keyword">= </span><span class="string">"mfiscal/dados22/APISS110.D00"</span><span class="keyword">;<br />
</span><span class="default">$table </span><span class="keyword">= </span><span class="string">"dbf_apiss"</span><span class="keyword">;<br />
<br />
</span><span class="default">$dbf </span><span class="keyword">= @</span><span class="default">dbase_open</span><span class="keyword">(</span><span class="default">$file_name</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">) or die(</span><span class="string">"Error opening </span><span class="default">$file_name</span><span class="string">"</span><span class="keyword">);<br />
</span><span class="default">$fields </span><span class="keyword">= </span><span class="default">dbase_get_header_info</span><span class="keyword">(</span><span class="default">$dbf</span><span class="keyword">);<br />
<br />
</span><span class="comment">/* Just show a table with header information */<br />
</span><span class="keyword">echo </span><span class="string">"&lt;table cellspacing=0&gt;&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;<br />
&lt;th&gt;Length&lt;/th&gt;&lt;th&gt;Precision&lt;/th&gt;&lt;th&gt;Format&lt;/th&gt;&lt;th&gt;Offset&lt;/th&gt;&lt;/tr&gt;"</span><span class="keyword">;<br />
foreach(</span><span class="default">$fields </span><span class="keyword">as </span><span class="default">$field</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'length'</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'precision'</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'format'</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'offset'</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/tr&gt;"</span><span class="keyword">;<br />
}<br />
echo </span><span class="string">"&lt;/table&gt;&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="comment">/* Here begins the SQL code part */<br />
</span><span class="keyword">echo </span><span class="string">"CREATE TABLE </span><span class="default">$table</span><span class="string"> (&lt;BR&gt;"</span><span class="keyword">;<br />
</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
</span><span class="default">$fields_num </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
foreach(</span><span class="default">$fields </span><span class="keyword">as </span><span class="default">$field</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$x</span><span class="keyword">++ != </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">",&lt;BR&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; switch(</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">])<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'character' </span><span class="keyword">: </span><span class="default">$type </span><span class="keyword">= </span><span class="string">'CHAR'</span><span class="keyword">; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">$field</span><span class="keyword">[</span><span class="string">'length'</span><span class="keyword">] &gt; </span><span class="default">1 </span><span class="keyword">? </span><span class="string">"(</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'length'</span><span class="keyword">]}</span><span class="string">)" </span><span class="keyword">: </span><span class="string">""</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'number' </span><span class="keyword">: </span><span class="default">$type </span><span class="keyword">= </span><span class="string">'NUMERIC'</span><span class="keyword">; </span><span class="default">$length </span><span class="keyword">= </span><span class="string">"(</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'length'</span><span class="keyword">]}</span><span class="string">" </span><span class="keyword">. (</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'precision'</span><span class="keyword">] &gt; </span><span class="default">0 </span><span class="keyword">? </span><span class="string">", </span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'precision'</span><span class="keyword">]}</span><span class="string">)"</span><span class="keyword">: </span><span class="string">")"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
</span><span class="comment">//&nbsp; &nbsp; &nbsp; &nbsp; case '' : $type = ''; break;<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fields_num</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="keyword">{</span><span class="default">$field</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]}</span><span class="string"> </span><span class="default">$type$length</span><span class="string">"</span><span class="keyword">;<br />
}<br />
echo </span><span class="string">");&lt;BR&gt;&lt;BR&gt;BEGIN;&lt;BR&gt;"</span><span class="keyword">;<br />
</span><span class="default">$records </span><span class="keyword">= @</span><span class="default">dbase_numrecords</span><span class="keyword">(</span><span class="default">$dbf</span><span class="keyword">) or die(</span><span class="string">"Error reading DBF's number of fields"</span><span class="keyword">);<br />
for(</span><span class="default">$x </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt;= </span><span class="default">$records</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$record </span><span class="keyword">= </span><span class="default">dbase_get_record</span><span class="keyword">(</span><span class="default">$dbf</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"INSERT INTO </span><span class="default">$table</span><span class="string"> VALUES ("</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$record </span><span class="keyword">as </span><span class="default">$field</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$f </span><span class="keyword">!= </span><span class="default">0</span><span class="keyword">) echo </span><span class="string">", "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">, </span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">][</span><span class="string">'length'</span><span class="keyword">]), </span><span class="default">$field</span><span class="keyword">) != </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">][</span><span class="string">'type'</span><span class="keyword">] == </span><span class="string">'character'</span><span class="keyword">) echo </span><span class="string">"'"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$field</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">][</span><span class="string">'type'</span><span class="keyword">] == </span><span class="string">'character'</span><span class="keyword">) echo </span><span class="string">"'"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"NULL"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(++</span><span class="default">$f </span><span class="keyword">&gt;= </span><span class="default">$fields_num</span><span class="keyword">) break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">");&lt;BR&gt;"</span><span class="keyword">;<br />
}<br />
echo </span><span class="string">"COMMIT;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74547""></a>
  <div class="note">
   <strong class="user">bi.idan AT gmail.com</strong>
   <a href="#74547" class="date">16-Apr-2007 04:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I know lots of you dosent really use dbase, but i've builded a class to help the one how dose.<br />
(sorry for bad english)<br />
<br />
- dbase.php<br />
<br />
<span class="default">&lt;?php<br />
<br />
set_time_limit </span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="comment">// site_path defined by parent<br />
</span><span class="keyword">require_once (</span><span class="default">SITE_PATH</span><span class="keyword">. </span><span class="string">'/server/php/libs/dbase/handler.php'</span><span class="keyword">); <br />
<br />
</span><span class="comment">/* DBase (dbf)<br />
&nbsp;*&nbsp; &nbsp; manage dbf files, exports and search functionality<br />
&nbsp;*&nbsp; &nbsp; with buildin optimizers for fast performance<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">class </span><span class="default">DBase<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$handler </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$searchopt </span><span class="keyword">= array (); </span><span class="comment">// Search optimizer<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">unload </span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">handler </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset (</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">handler</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct </span><span class="keyword">(</span><span class="default">$file </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">load </span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct </span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">unload </span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">load </span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$resource </span><span class="keyword">= </span><span class="default">dbase_open </span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">handler </span><span class="keyword">= new </span><span class="default">DBase_Handler </span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">handler</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* Search<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp; search for string inside header<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp; returns record number<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; false returned if not found or error occurred<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp; limit_results gets int or false, limit_results equels one will limit the<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; search results for one result only, false for no limit<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">search </span><span class="keyword">(</span><span class="default">$headerText</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$limit_results </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$handler </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$handler </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$handler </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">handler</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">searchopt </span><span class="keyword">[</span><span class="default">$headerText</span><span class="keyword">][</span><span class="default">$string</span><span class="keyword">])<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">searchopt </span><span class="keyword">[</span><span class="default">$headerText</span><span class="keyword">][</span><span class="default">$string</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">$handler</span><span class="keyword">-&gt; </span><span class="default">getSize </span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( ( </span><span class="default">$headerNumber </span><span class="keyword">= </span><span class="default">$handler</span><span class="keyword">-&gt; </span><span class="default">getHeaderNumber </span><span class="keyword">(</span><span class="default">$headerText</span><span class="keyword">) ) !== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results </span><span class="keyword">= array ();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$size</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$record </span><span class="keyword">= </span><span class="default">$handler</span><span class="keyword">-&gt; </span><span class="default">getRecord </span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">); </span><span class="comment">// Disabled optimizer to prevent memory overflow<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">trim </span><span class="keyword">(</span><span class="default">$record </span><span class="keyword">[</span><span class="default">$headerNumber</span><span class="keyword">]) == </span><span class="default">$string</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results</span><span class="keyword">[] = </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( (</span><span class="default">$limit_results </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) &amp;&amp; (</span><span class="default">sizeof </span><span class="keyword">(</span><span class="default">$results</span><span class="keyword">) == </span><span class="default">$limit_results</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">sizeof </span><span class="keyword">(</span><span class="default">$results</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">searchopt </span><span class="keyword">[</span><span class="default">$headerText</span><span class="keyword">][</span><span class="default">$string</span><span class="keyword">] = </span><span class="default">$results</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">search </span><span class="keyword">(</span><span class="default">$headerText</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$handler</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
- dbase_handler.php<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/* DBase Handler (dbf)<br />
&nbsp;*&nbsp; &nbsp; handles dbase resource<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">class </span><span class="default">DBase_Handler<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$resource</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$size</span><span class="keyword">; </span><span class="comment">// Records Count<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private </span><span class="default">$header </span><span class="keyword">= array ();<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$dataopt </span><span class="keyword">= array (); </span><span class="comment">// Data optimizer<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">setHeader </span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">header </span><span class="keyword">= </span><span class="default">dbase_get_header_info </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">resource</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct </span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">resource </span><span class="keyword">= </span><span class="default">$resource</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">setHeader </span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">size </span><span class="keyword">= </span><span class="default">dbase_numrecords </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">resource</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct </span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">dbase_close </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">resource</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getRecord </span><span class="keyword">(</span><span class="default">$record_number</span><span class="keyword">, </span><span class="default">$dataopt </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$record_number </span><span class="keyword">&gt; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">size</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">dataopt </span><span class="keyword">[</span><span class="default">$record_number</span><span class="keyword">])<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">dataopt </span><span class="keyword">[</span><span class="default">$record_number</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$record </span><span class="keyword">= </span><span class="default">dbase_get_record </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">resource</span><span class="keyword">, </span><span class="default">$record_number</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$dataopt </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) </span><span class="comment">// Data saving optimizer<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">dataopt </span><span class="keyword">[</span><span class="default">$record_number</span><span class="keyword">] = </span><span class="default">$record</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">getRecord </span><span class="keyword">(</span><span class="default">$record_number</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$record</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getHeaderNumber </span><span class="keyword">(</span><span class="default">$headerText</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">header </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$header</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$header </span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] == </span><span class="default">$headerText</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$index</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getHeader </span><span class="keyword">(</span><span class="default">$headerNumber</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$headerNumber </span><span class="keyword">&lt;= </span><span class="default">sizeof </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">header</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">header </span><span class="keyword">[</span><span class="default">$headerNumber</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getSize </span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt; </span><span class="default">size</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42220""></a>
  <div class="note">
   <strong class="user">Hadi Rusiah / deegos at yahoo dot com</strong>
   <a href="#42220" class="date">08-May-2004 10:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using PHP &lt; 5, you can use this function to retrieve dbf header<br />
<br />
&lt;?<br />
function get_dbf_header($dbfname) {<br />
&nbsp;&nbsp; $fdbf = fopen($dbfname,'r');<br />
<br />
&nbsp;&nbsp; $dbfhdrarr = array();<br />
&nbsp;&nbsp; $buff32 = array();<br />
&nbsp;&nbsp; $i = 1;<br />
&nbsp;&nbsp; $goon = true;<br />
<br />
&nbsp;&nbsp; while ($goon) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (!feof($fdbf)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $buff32 = fread($fdbf,32);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if ($i &gt; 1) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (substr($buff32,0,1) == chr(13)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $goon = false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $pos = strpos(substr($buff32,0,10),chr(0));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $pos = ($pos == 0?10:$pos);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fieldname = substr($buff32,0,$pos);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fieldtype = substr($buff32,11,1);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fieldlen = ord(substr($buff32,16,1));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fielddec = ord(substr($buff32,17,1));<br />
<br />
array_push($dbfhdrarr, array($fieldname,$fieldtype,$fieldlen,$fielddec));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $goon = false;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; fclose($fdbf);<br />
&nbsp;&nbsp; return($dbfhdrarr);<br />
}<br />
<br />
$arr = get_dbf_header('/data/file.dbf');<br />
print_r($arr);<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="dbase.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.dbase-add-record.html">dbase_add_record</a></div>
 <div class="up"><a href="book.dbase.html">dBase</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
