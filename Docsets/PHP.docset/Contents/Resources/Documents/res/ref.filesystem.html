<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Filesystem Functions</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="filesystem.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.basename.html">basename</a></div>
 <div class="up"><a href="book.filesystem.html">Filesystem</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.filesystem" class="reference">
 <h1 class="title">Filesystem Functions</h1>

 <div class="partintro">
  <h1 class="title">See Also</h1>
  <p class="simpara">
   For related functions, see also the <a href="ref.dir.html" class="link">Directory</a>
   and <a href="ref.exec.html" class="link">Program Execution</a> sections.
  </p>
  <p class="simpara">
   For a list and explanation of the various URL wrappers that can be used
   as remote files, see also <a href="wrappers.html" class="xref">Supported Protocols and Wrappers</a>.
  </p>
 </div>











































































































































































































































































































































































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.basename.html">basename</a> â€” Returns trailing name component of path</li><li><a href="function.chgrp.html">chgrp</a> â€” Changes file group</li><li><a href="function.chmod.html">chmod</a> â€” Changes file mode</li><li><a href="function.chown.html">chown</a> â€” Changes file owner</li><li><a href="function.clearstatcache.html">clearstatcache</a> â€” Clears file status cache</li><li><a href="function.copy.html">copy</a> â€” Copies file</li><li><a href="function.delete.html">delete</a> â€” See unlink or unset</li><li><a href="function.dirname.html">dirname</a> â€” Returns parent directory's path</li><li><a href="function.disk-free-space.html">disk_free_space</a> â€” Returns available space on filesystem or disk partition</li><li><a href="function.disk-total-space.html">disk_total_space</a> â€” Returns the total size of a filesystem or disk partition</li><li><a href="function.diskfreespace.html">diskfreespace</a> â€” Alias of disk_free_space</li><li><a href="function.fclose.html">fclose</a> â€” Closes an open file pointer</li><li><a href="function.feof.html">feof</a> â€” Tests for end-of-file on a file pointer</li><li><a href="function.fflush.html">fflush</a> â€” Flushes the output to a file</li><li><a href="function.fgetc.html">fgetc</a> â€” Gets character from file pointer</li><li><a href="function.fgetcsv.html">fgetcsv</a> â€” Gets line from file pointer and parse for CSV fields</li><li><a href="function.fgets.html">fgets</a> â€” Gets line from file pointer</li><li><a href="function.fgetss.html">fgetss</a> â€” Gets line from file pointer and strip HTML tags</li><li><a href="function.file-exists.html">file_exists</a> â€” Checks whether a file or directory exists</li><li><a href="function.file-get-contents.html">file_get_contents</a> â€” Reads entire file into a string</li><li><a href="function.file-put-contents.html">file_put_contents</a> â€” Write a string to a file</li><li><a href="function.file.html">file</a> â€” Reads entire file into an array</li><li><a href="function.fileatime.html">fileatime</a> â€” Gets last access time of file</li><li><a href="function.filectime.html">filectime</a> â€” Gets inode change time of file</li><li><a href="function.filegroup.html">filegroup</a> â€” Gets file group</li><li><a href="function.fileinode.html">fileinode</a> â€” Gets file inode</li><li><a href="function.filemtime.html">filemtime</a> â€” Gets file modification time</li><li><a href="function.fileowner.html">fileowner</a> â€” Gets file owner</li><li><a href="function.fileperms.html">fileperms</a> â€” Gets file permissions</li><li><a href="function.filesize.html">filesize</a> â€” Gets file size</li><li><a href="function.filetype.html">filetype</a> â€” Gets file type</li><li><a href="function.flock.html">flock</a> â€” Portable advisory file locking</li><li><a href="function.fnmatch.html">fnmatch</a> â€” Match filename against a pattern</li><li><a href="function.fopen.html">fopen</a> â€” Opens file or URL</li><li><a href="function.fpassthru.html">fpassthru</a> â€” Output all remaining data on a file pointer</li><li><a href="function.fputcsv.html">fputcsv</a> â€” Format line as CSV and write to file pointer</li><li><a href="function.fputs.html">fputs</a> â€” Alias of fwrite</li><li><a href="function.fread.html">fread</a> â€” Binary-safe file read</li><li><a href="function.fscanf.html">fscanf</a> â€” Parses input from a file according to a format</li><li><a href="function.fseek.html">fseek</a> â€” Seeks on a file pointer</li><li><a href="function.fstat.html">fstat</a> â€” Gets information about a file using an open file pointer</li><li><a href="function.ftell.html">ftell</a> â€” Returns the current position of the file read/write pointer</li><li><a href="function.ftruncate.html">ftruncate</a> â€” Truncates a file to a given length</li><li><a href="function.fwrite.html">fwrite</a> â€” Binary-safe file write</li><li><a href="function.glob.html">glob</a> â€” Find pathnames matching a pattern</li><li><a href="function.is-dir.html">is_dir</a> â€” Tells whether the filename is a directory</li><li><a href="function.is-executable.html">is_executable</a> â€” Tells whether the filename is executable</li><li><a href="function.is-file.html">is_file</a> â€” Tells whether the filename is a regular file</li><li><a href="function.is-link.html">is_link</a> â€” Tells whether the filename is a symbolic link</li><li><a href="function.is-readable.html">is_readable</a> â€” Tells whether a file exists and is readable</li><li><a href="function.is-uploaded-file.html">is_uploaded_file</a> â€” Tells whether the file was uploaded via HTTP POST</li><li><a href="function.is-writable.html">is_writable</a> â€” Tells whether the filename is writable</li><li><a href="function.is-writeable.html">is_writeable</a> â€” Alias of is_writable</li><li><a href="function.lchgrp.html">lchgrp</a> â€” Changes group ownership of symlink</li><li><a href="function.lchown.html">lchown</a> â€” Changes user ownership of symlink</li><li><a href="function.link.html">link</a> â€” Create a hard link</li><li><a href="function.linkinfo.html">linkinfo</a> â€” Gets information about a link</li><li><a href="function.lstat.html">lstat</a> â€” Gives information about a file or symbolic link</li><li><a href="function.mkdir.html">mkdir</a> â€” Makes directory</li><li><a href="function.move-uploaded-file.html">move_uploaded_file</a> â€” Moves an uploaded file to a new location</li><li><a href="function.parse-ini-file.html">parse_ini_file</a> â€” Parse a configuration file</li><li><a href="function.parse-ini-string.html">parse_ini_string</a> â€” Parse a configuration string</li><li><a href="function.pathinfo.html">pathinfo</a> â€” Returns information about a file path</li><li><a href="function.pclose.html">pclose</a> â€” Closes process file pointer</li><li><a href="function.popen.html">popen</a> â€” Opens process file pointer</li><li><a href="function.readfile.html">readfile</a> â€” Outputs a file</li><li><a href="function.readlink.html">readlink</a> â€” Returns the target of a symbolic link</li><li><a href="function.realpath-cache-get.html">realpath_cache_get</a> â€” Get realpath cache entries</li><li><a href="function.realpath-cache-size.html">realpath_cache_size</a> â€” Get realpath cache size</li><li><a href="function.realpath.html">realpath</a> â€” Returns canonicalized absolute pathname</li><li><a href="function.rename.html">rename</a> â€” Renames a file or directory</li><li><a href="function.rewind.html">rewind</a> â€” Rewind the position of a file pointer</li><li><a href="function.rmdir.html">rmdir</a> â€” Removes directory</li><li><a href="function.set-file-buffer.html">set_file_buffer</a> â€” Alias of stream_set_write_buffer</li><li><a href="function.stat.html">stat</a> â€” Gives information about a file</li><li><a href="function.symlink.html">symlink</a> â€” Creates a symbolic link</li><li><a href="function.tempnam.html">tempnam</a> â€” Create file with unique file name</li><li><a href="function.tmpfile.html">tmpfile</a> â€” Creates a temporary file</li><li><a href="function.touch.html">touch</a> â€” Sets access and modification time of file</li><li><a href="function.umask.html">umask</a> â€” Changes the current umask</li><li><a href="function.unlink.html">unlink</a> â€” Deletes a file</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="91075""></a>
  <div class="note">
   <strong class="user">drapeko.com</strong>
   <a href="#91075" class="date">23-May-2009 06:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You have an array of directories (straightforward list of directories):<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; $array </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko/var'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko/var/y'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/var/libexec'<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; );<br />
</span><span class="default">?&gt;<br />
</span><br />
And you would like to transform this array to hierarchy of directories:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;$array </span><span class="keyword">= array (<br />
&nbsp;&nbsp; &nbsp; </span><span class="string">'home' </span><span class="keyword">=&gt; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'drapeko' </span><span class="keyword">=&gt; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'var' </span><span class="keyword">=&gt; array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'y' </span><span class="keyword">=&gt; array()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; )<br />
&nbsp;&nbsp; &nbsp; ),<br />
&nbsp;&nbsp; &nbsp; </span><span class="string">'var' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'libexec' </span><span class="keyword">=&gt; array()<br />
&nbsp;&nbsp; &nbsp; )<br />
&nbsp;);<br />
</span><span class="default">?&gt;<br />
</span><br />
How can you do it?<br />
<br />
First of all the below function will help us.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* This function converts real filesystem path to the string array representation.<br />
&nbsp;*<br />
&nbsp;* for example,<br />
&nbsp;* '/home/drapeko/var/y&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; will be converted to&nbsp; &nbsp; $result_array['home']['drapeko']['var']['y']<br />
&nbsp;* '/home/drapeko/var/y/file.txt&nbsp;&nbsp; will be converted to&nbsp; &nbsp; &nbsp;&nbsp; $result_array['home']['drapeko']['var']['y']<br />
&nbsp;*<br />
&nbsp;* @param $path&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; realpath of the directory<br />
&nbsp;* @return string&nbsp; &nbsp; &nbsp; &nbsp; string array representation of the path<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">pathToArrayStr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// TODO constants/configs?<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">':/'</span><span class="keyword">, </span><span class="string">':\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">), </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// if the first or last symbol is '/' delete it (e.g. for linux)<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">"/^\//"</span><span class="keyword">, </span><span class="string">"/\/$/"</span><span class="keyword">), </span><span class="string">''</span><span class="keyword">, </span><span class="default">$res_path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// create string<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="string">'[\''</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\'][\''</span><span class="keyword">, </span><span class="default">$res_path</span><span class="keyword">).</span><span class="string">'\']'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">$res_path</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It simply converts the real path of the file to array string representation.<br />
<br />
How can you use this function? I know it looks like a little confusing. But it's quite simple. Consider the example below:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;$result </span><span class="keyword">= array();<br />
&nbsp;</span><span class="default">$check </span><span class="keyword">= array();<br />
&nbsp;foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">pathToArrayStr</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, </span><span class="string">'result'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; foreach(</span><span class="default">$check </span><span class="keyword">as </span><span class="default">$ck</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$ck</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$check</span><span class="keyword">[] = </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; eval(</span><span class="string">'$result'</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">.</span><span class="string">' = array();'</span><span class="keyword">);<br />
&nbsp;}<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Heh, how do you find it? This approach has helped me very much. I hope you will find it useful. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73954""></a>
  <div class="note">
   <strong class="user">Christian</strong>
   <a href="#73954" class="date">17-Mar-2007 09:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just learned that, to specify file names in a portable manner, you DON'T need 'DIRECTORY_SEPARATOR' - just use '/'. This really surprised and shocked me, as until now I typed about a zillion times 'DIRECTORY_SEPARATOR' to stay platform independent - unnecessary. Don't make the same mistake.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50360""></a>
  <div class="note">
   <strong class="user">tunnelareaten at gmail dot com</strong>
   <a href="#50360" class="date">25-Feb-2005 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made this function to search and/or display files by extension or for a string occurance in the filename. Any comments or enhancements are welcome offcourse. I'll update this function soon.<br />
<br />
usage: list_files([string], [string], [int 1 | 0], [int 1 | 0]);<br />
<br />
search for extension: list_files([string], [string], [0], [int 1 | 0]);<br />
returns array: $myArray = list_files([string], [string], [0], [0]);<br />
echo result: list_files([string], [string], [0], [1]);<br />
<br />
search for string occurance: list_files([string], [string], [1], [int 1 | 0]);<br />
returns array: $myArray = list_files([string], [string], [1], [0]);<br />
echo result: list_files([string], [string], [1], [1]);<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">list_files</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, </span><span class="default">$stringSearch</span><span class="keyword">, </span><span class="default">$searchHandler</span><span class="keyword">, </span><span class="default">$outputHandler</span><span class="keyword">) {<br />
&nbsp;</span><span class="default">$errorHandler </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;</span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp;if (! </span><span class="default">$directoryHandler </span><span class="keyword">= @</span><span class="default">opendir </span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">)) {<br />
&nbsp; echo (</span><span class="string">"&lt;pre&gt;\nerror: directory \"</span><span class="default">$directory</span><span class="string">\" doesn't exist!\n&lt;/pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;return </span><span class="default">$errorHandler </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;}<br />
&nbsp;if (</span><span class="default">$searchHandler </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$fileName </span><span class="keyword">= @</span><span class="default">readdir </span><span class="keyword">(</span><span class="default">$directoryHandler</span><span class="keyword">))) {<br />
&nbsp;&nbsp; if(@</span><span class="default">substr </span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, - @</span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$stringSearch</span><span class="keyword">)) === </span><span class="default">$stringSearch</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">array_push </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$fileName</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;if (</span><span class="default">$searchHandler </span><span class="keyword">=== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; while(</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$fileName </span><span class="keyword">= @</span><span class="default">readdir </span><span class="keyword">(</span><span class="default">$directoryHandler</span><span class="keyword">))) {<br />
&nbsp;&nbsp; if(@</span><span class="default">substr_count </span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="default">$stringSearch</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">array_push </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$fileName</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;if ((</span><span class="default">$errorHandler </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) &amp;&amp;&nbsp; (@</span><span class="default">count </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">)) {<br />
&nbsp; echo (</span><span class="string">"&lt;pre&gt;\nerror: no filetype \"</span><span class="default">$fileExtension</span><span class="string">\" found!\n&lt;/pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;}<br />
&nbsp;else {<br />
&nbsp; </span><span class="default">sort </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp; if (</span><span class="default">$outputHandler </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; if (</span><span class="default">$outputHandler </span><span class="keyword">=== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; echo (</span><span class="string">"&lt;pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp; echo (</span><span class="string">"&lt;/pre&gt;\n"</span><span class="keyword">); <br />
&nbsp; }<br />
&nbsp;}<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38611""></a>
  <div class="note">
   <strong class="user">http://iubito.free.fr</strong>
   <a href="#38611" class="date">30-Dec-2003 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function I wrote to get the relative path between 2 files or directory.<br />
<br />
We suppose that paths are wrotten in Unix format (/ instead of windows \\)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Return the relative path between two paths / Retourne le chemin relatif entre 2 chemins<br />
&nbsp;*<br />
&nbsp;* If $path2 is empty, get the current directory (getcwd).<br />
&nbsp;* @return string<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">relativePath</span><span class="keyword">(</span><span class="default">$path1</span><span class="keyword">, </span><span class="default">$path2</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$path2 </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path2 </span><span class="keyword">= </span><span class="default">$path1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path1 </span><span class="keyword">= </span><span class="default">getcwd</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Remove starting, ending, and double / in paths<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path1 </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$path1</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path2 </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$path2</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$path1</span><span class="keyword">, </span><span class="string">'//'</span><span class="keyword">)) </span><span class="default">$path1 </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'//'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$path2</span><span class="keyword">, </span><span class="string">'//'</span><span class="keyword">)) </span><span class="default">$path2 </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'//'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//create arrays<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr1 </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$arr1 </span><span class="keyword">== array(</span><span class="string">''</span><span class="keyword">)) </span><span class="default">$arr1 </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr2 </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$arr2 </span><span class="keyword">== array(</span><span class="string">''</span><span class="keyword">)) </span><span class="default">$arr2 </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size1 </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size2 </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arr2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//now the hard part :-p<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">min</span><span class="keyword">(</span><span class="default">$size1</span><span class="keyword">,</span><span class="default">$size2</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$arr1</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] == </span><span class="default">$arr2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$path </span><span class="keyword">= </span><span class="string">'../'</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">.</span><span class="default">$arr2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$size1 </span><span class="keyword">&gt; </span><span class="default">$size2</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$size2</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$size1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="string">'../'</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else if (</span><span class="default">$size2 </span><span class="keyword">&gt; </span><span class="default">$size1</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$size1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$size2</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="default">$arr2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">'/'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$path</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Enjoy ! :-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35196""></a>
  <div class="note">
   <strong class="user">Gregor Mosheh</strong>
   <a href="#35196" class="date">22-Aug-2003 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function searches a directory and returns an array of all files whose filename matches the specified regular expression. It's similar in concept to the Unix find program.<br />
<br />
&nbsp;function findfile($location='',$fileregex='') {<br />
&nbsp;&nbsp;&nbsp; if (!$location or !is_dir($location) or !$fileregex) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return false;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;<br />
&nbsp;&nbsp;&nbsp; $matchedfiles = array();<br />
&nbsp;<br />
&nbsp;&nbsp;&nbsp; $all = opendir($location);<br />
&nbsp;&nbsp;&nbsp; while ($file = readdir($all)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (is_dir($location.'/'.$file) and $file &lt;&gt; ".." and $file &lt;&gt; ".") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $subdir_matches = findfile($location.'/'.$file,$fileregex);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $matchedfiles = array_merge($matchedfiles,$subdir_matches);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset($file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; elseif (!is_dir($location.'/'.$file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (preg_match($fileregex,$file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array_push($matchedfiles,$location.'/'.$file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; closedir($all);<br />
&nbsp;&nbsp;&nbsp; unset($all);<br />
&nbsp;&nbsp;&nbsp; return $matchedfiles;<br />
&nbsp;}<br />
<br />
$htmlfiles = findfile('/some/dir','/\.(htm|html)$/');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="34144""></a>
  <div class="note">
   <strong class="user">Gregor Mosheh</strong>
   <a href="#34144" class="date">16-Jul-2003 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed a function to find disk usage for a directory and its subs, so here it is. It's kinda like the Unix du program, except it returns the usage in bytes, not blocks.<br />
<br />
function du($location) {<br />
&nbsp;&nbsp; if (!$location or !is_dir($location)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return 0;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; $total = 0;<br />
<br />
&nbsp;&nbsp; $all = opendir($location);<br />
&nbsp;&nbsp; while ($file = readdir($all)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (is_dir($location.'/'.$file) and $file &lt;&gt; ".." and $file &lt;&gt; ".") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $total += du($location.'/'.$file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; unset($file);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; elseif (!is_dir($location.'/'.$file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $stats = stat($location.'/'.$file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $total += $stats['size'];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; unset($file);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; closedir($all);<br />
&nbsp;&nbsp; unset($all);<br />
&nbsp;&nbsp; return $total;<br />
}<br />
<br />
print du('/some/directory');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33674""></a>
  <div class="note">
   <strong class="user">l_domenech at yahoo dot ca</strong>
   <a href="#33674" class="date">03-Jul-2003 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In the code samples of the user-contributed notes, you'll find functions that sometimes need a slash at the end of a folder path and sometimes don't.<br />
<br />
Here's a little function to append a slash at the end of a path if there isn't one already.<br />
<br />
function append_slash_if_none($string)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if (ereg ("/$", $string))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $string;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ereg_replace("$", "/", $string);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
(Replace with a backslash if you're on Windows...)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32089""></a>
  <div class="note">
   <strong class="user">mitra at mitra dot biz</strong>
   <a href="#32089" class="date">15-May-2003 10:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Pollard@php.net contributed this in response to a question on setting these variables ...<br />
This option *IS* settable within your PHP scripts.<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; ini_set</span><span class="keyword">(</span><span class="string">'auto_detect_line_endings'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$contents </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">'unknowntype.txt'</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'auto_detect_line_endings'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$content2 </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">'unixfile.txt'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Note, with PHP 4.3 anytime Mac files are read using fgets or file you'll need to auto_detect_line_endings since \n is otherwise assumed.&nbsp; However, with PHP 5.0, stream_get_line() will allow you to specify what line ending character to read up to.<br />
<br />
\\ Read a line from a MAC file<br />
stream_get_line($fp, 4096, "\r"); <br />
<br />
\\ Read a line from a UNIX file<br />
stream_get_line($fp, 4096, "\n"); <br />
<br />
\\ Read a line from a DOS file<br />
stream_get_line($fp, 4096, "\r\n"); <br />
<br />
\\ Read a line up to any filesystem line ending<br />
ini_set('auto_detect_line_endings', true); fgets($fp); <br />
<br />
\\ You can also make up your own line ending characters:<br />
\\ Read up to the first instance of ":"<br />
stream_get_line($fp, 4096, ":");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30924""></a>
  <div class="note">
   <strong class="user">regis at webstuff dot com dot br</strong>
   <a href="#30924" class="date">03-Apr-2003 07:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a useful function if you're having trouble writing raw bytes into a file. <br />
<br />
It receives an integer and returns an array containing the ASCII values of the bytes on each index of the array.<br />
<br />
function int2bytes($number){<br />
&nbsp; $byte = $number;<br />
&nbsp; $i=0;<br />
&nbsp; do{<br />
&nbsp;&nbsp;&nbsp; $dec_tmp = $byte;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $byte = bcdiv($byte,256,0);<br />
&nbsp;&nbsp;&nbsp; $resto = $dec_tmp - (256 * $byte);<br />
&nbsp;&nbsp;&nbsp; $return[] = $resto;<br />
&nbsp; } while($byte &gt;= 256);<br />
&nbsp; if($byte) $return[] = $byte;<br />
&nbsp; return array_reverse($return);<br />
}<br />
<br />
Example:<br />
<br />
$arr = int2bytes(75832);<br />
<br />
$arr will contain the following values:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; 40<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; 56<br />
)<br />
<br />
Now, to write this data to the file, just use a fputs() with chr(), just like this:<br />
<br />
fputs($fp,chr($arr[0]).chr($arr[1]).chr($arr[2]))<br />
<br />
-- Regis</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30152""></a>
  <div class="note">
   <strong class="user">jdhurn at uberidx dot com</strong>
   <a href="#30152" class="date">08-Mar-2003 07:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a function I use to determine if a file contains Binary information. I use this for my search engine so that it doesn't try to index files like .zip or .mp3 or any other file that doesn't contain readable information. It makes use of the Character Type Extension if it's loaded, if it's not then it uses Regular Expressions.<br />
<br />
function is_binary($link)<br />
{<br />
&nbsp;&nbsp; &nbsp; $tmpStr&nbsp; = '';<br />
&nbsp;&nbsp; &nbsp; @$fp&nbsp; &nbsp;&nbsp; = fopen($link, 'rb');<br />
&nbsp;&nbsp; &nbsp; @$tmpStr = fread($fp, 256);<br />
&nbsp;&nbsp; &nbsp; @fclose($fp);<br />
<br />
&nbsp;&nbsp; &nbsp; if($tmpStr != '')<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpStr = str_replace(chr(10), '', $tmpStr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpStr = str_replace(chr(13), '', $tmpStr);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpInt = 0;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for($i =0; $i &lt; strlen($tmpStr); $i++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( extension_loaded('ctype') )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !ctype_print($tmpStr[$i]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpInt++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( !eregi("[[:print:]]+", $tmpStr[$i]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpInt++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($tmpInt &gt; 5)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(0);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(1);<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(0);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="filesystem.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.basename.html">basename</a></div>
 <div class="up"><a href="book.filesystem.html">Filesystem</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
