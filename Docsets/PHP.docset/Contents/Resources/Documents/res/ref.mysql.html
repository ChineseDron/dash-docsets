<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>MySQL Functions</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mysql.examples-basic.html">MySQL extension overview example</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.mysql-affected-rows.html">mysql_affected_rows</a></div>
 <div class="up"><a href="book.mysql.html">Mysql</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.mysql" class="reference">
  <h1 class="title">MySQL Functions</h1>

  <div class="partintro">
   <div class="section" id="mysql.notes">
   <h2 class="title">Notes</h2>
    <blockquote class="note"><p><b class="note">Note</b>: 
     <p class="para">
      Most MySQL functions accept <i><tt class="parameter">link_identifier</tt></i> as
      the last optional parameter. If it is not provided, last opened
      connection is used. If it doesn&#039;t exist, connection is tried to
      establish with default parameters defined in <var class="filename">php.ini</var>. If it is not
      successful, functions return <b><tt>FALSE</tt></b>.
     </p>
    </p></blockquote>
   </div>
  </div>



































































































































































































































































































 <h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.mysql-affected-rows.html">mysql_affected_rows</a> â€” Get number of affected rows in previous MySQL operation</li><li><a href="function.mysql-client-encoding.html">mysql_client_encoding</a> â€” Returns the name of the character set</li><li><a href="function.mysql-close.html">mysql_close</a> â€” Close MySQL connection</li><li><a href="function.mysql-connect.html">mysql_connect</a> â€” Open a connection to a MySQL Server</li><li><a href="function.mysql-create-db.html">mysql_create_db</a> â€” Create a MySQL database</li><li><a href="function.mysql-data-seek.html">mysql_data_seek</a> â€” Move internal result pointer</li><li><a href="function.mysql-db-name.html">mysql_db_name</a> â€” Retrieves database name from the call to mysql_list_dbs</li><li><a href="function.mysql-db-query.html">mysql_db_query</a> â€” Selects a database and executes a query on it</li><li><a href="function.mysql-drop-db.html">mysql_drop_db</a> â€” Drop (delete) a MySQL database</li><li><a href="function.mysql-errno.html">mysql_errno</a> â€” Returns the numerical value of the error message from previous MySQL operation</li><li><a href="function.mysql-error.html">mysql_error</a> â€” Returns the text of the error message from previous MySQL operation</li><li><a href="function.mysql-escape-string.html">mysql_escape_string</a> â€” Escapes a string for use in a mysql_query</li><li><a href="function.mysql-fetch-array.html">mysql_fetch_array</a> â€” Fetch a result row as an associative array, a numeric array, or both</li><li><a href="function.mysql-fetch-assoc.html">mysql_fetch_assoc</a> â€” Fetch a result row as an associative array</li><li><a href="function.mysql-fetch-field.html">mysql_fetch_field</a> â€” Get column information from a result and return as an object</li><li><a href="function.mysql-fetch-lengths.html">mysql_fetch_lengths</a> â€” Get the length of each output in a result</li><li><a href="function.mysql-fetch-object.html">mysql_fetch_object</a> â€” Fetch a result row as an object</li><li><a href="function.mysql-fetch-row.html">mysql_fetch_row</a> â€” Get a result row as an enumerated array</li><li><a href="function.mysql-field-flags.html">mysql_field_flags</a> â€” Get the flags associated with the specified field in a result</li><li><a href="function.mysql-field-len.html">mysql_field_len</a> â€” Returns the length of the specified field</li><li><a href="function.mysql-field-name.html">mysql_field_name</a> â€” Get the name of the specified field in a result</li><li><a href="function.mysql-field-seek.html">mysql_field_seek</a> â€” Set result pointer to a specified field offset</li><li><a href="function.mysql-field-table.html">mysql_field_table</a> â€” Get name of the table the specified field is in</li><li><a href="function.mysql-field-type.html">mysql_field_type</a> â€” Get the type of the specified field in a result</li><li><a href="function.mysql-free-result.html">mysql_free_result</a> â€” Free result memory</li><li><a href="function.mysql-get-client-info.html">mysql_get_client_info</a> â€” Get MySQL client info</li><li><a href="function.mysql-get-host-info.html">mysql_get_host_info</a> â€” Get MySQL host info</li><li><a href="function.mysql-get-proto-info.html">mysql_get_proto_info</a> â€” Get MySQL protocol info</li><li><a href="function.mysql-get-server-info.html">mysql_get_server_info</a> â€” Get MySQL server info</li><li><a href="function.mysql-info.html">mysql_info</a> â€” Get information about the most recent query</li><li><a href="function.mysql-insert-id.html">mysql_insert_id</a> â€” Get the ID generated in the last query</li><li><a href="function.mysql-list-dbs.html">mysql_list_dbs</a> â€” List databases available on a MySQL server</li><li><a href="function.mysql-list-fields.html">mysql_list_fields</a> â€” List MySQL table fields</li><li><a href="function.mysql-list-processes.html">mysql_list_processes</a> â€” List MySQL processes</li><li><a href="function.mysql-list-tables.html">mysql_list_tables</a> â€” List tables in a MySQL database</li><li><a href="function.mysql-num-fields.html">mysql_num_fields</a> â€” Get number of fields in result</li><li><a href="function.mysql-num-rows.html">mysql_num_rows</a> â€” Get number of rows in result</li><li><a href="function.mysql-pconnect.html">mysql_pconnect</a> â€” Open a persistent connection to a MySQL server</li><li><a href="function.mysql-ping.html">mysql_ping</a> â€” Ping a server connection or reconnect if there is no connection</li><li><a href="function.mysql-query.html">mysql_query</a> â€” Send a MySQL query</li><li><a href="function.mysql-real-escape-string.html">mysql_real_escape_string</a> â€” Escapes special characters in a string for use in an SQL statement</li><li><a href="function.mysql-result.html">mysql_result</a> â€” Get result data</li><li><a href="function.mysql-select-db.html">mysql_select_db</a> â€” Select a MySQL database</li><li><a href="function.mysql-set-charset.html">mysql_set_charset</a> â€” Sets the client character set</li><li><a href="function.mysql-stat.html">mysql_stat</a> â€” Get current system status</li><li><a href="function.mysql-tablename.html">mysql_tablename</a> â€” Get table name of field</li><li><a href="function.mysql-thread-id.html">mysql_thread_id</a> â€” Return the current thread ID</li><li><a href="function.mysql-unbuffered-query.html">mysql_unbuffered_query</a> â€” Send an SQL query to MySQL without fetching and buffering the result rows.</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="100626""></a>
  <div class="note">
   <strong class="user">Vladimir Kosmala</strong>
   <a href="#100626" class="date">27-Oct-2010 07:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here a mysql helper containing the main functions of the mysql extension. It's easy to understand for a beginner and quite useful because queries are secure. It understands what you want, just write your sql query. I called it mysql_magic.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Examples<br />
</span><span class="default">$nb_affected </span><span class="keyword">= </span><span class="default">mysql_magic</span><span class="keyword">(</span><span class="string">'delete from users'</span><span class="keyword">);<br />
</span><span class="default">$nb </span><span class="keyword">= </span><span class="default">mysql_magic</span><span class="keyword">(</span><span class="string">'select count(*) from users'</span><span class="keyword">);<br />
</span><span class="default">$one_row </span><span class="keyword">= </span><span class="default">mysql_magic</span><span class="keyword">(</span><span class="string">'select * from users limit 1'</span><span class="keyword">);<br />
</span><span class="default">$all_rows </span><span class="keyword">= </span><span class="default">mysql_magic</span><span class="keyword">(</span><span class="string">'select * from users where name = ?'</span><span class="keyword">, </span><span class="string">'John'</span><span class="keyword">);<br />
</span><span class="default">$id </span><span class="keyword">= </span><span class="default">mysql_magic</span><span class="keyword">(</span><span class="string">'insert into users(name,rank) values(?,?)'</span><span class="keyword">, </span><span class="string">'Vincent'</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Usage: mysql_magic($query [, $arg...]);<br />
</span><span class="keyword">function </span><span class="default">mysql_magic</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$dblink</span><span class="keyword">, </span><span class="default">$sqlhost</span><span class="keyword">, </span><span class="default">$sqluser</span><span class="keyword">, </span><span class="default">$sqlpass</span><span class="keyword">, </span><span class="default">$sqlbase</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$narg </span><span class="keyword">= </span><span class="default">func_num_args</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$dblink</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dblink </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">( </span><span class="default">$sqlhost</span><span class="keyword">, </span><span class="default">$sqluser</span><span class="keyword">, </span><span class="default">$sqlpass </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_select_db</span><span class="keyword">( </span><span class="default">$sqlbase</span><span class="keyword">, </span><span class="default">$dblink </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$req_sql </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$req_args </span><span class="keyword">= </span><span class="default">$args</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$req_query </span><span class="keyword">= </span><span class="default">mysql_bind</span><span class="keyword">(</span><span class="default">$req_sql</span><span class="keyword">, </span><span class="default">$req_args</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$req_result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$req_query</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$req_result</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">startsWith</span><span class="keyword">(</span><span class="default">$req_sql</span><span class="keyword">, </span><span class="string">'delete'</span><span class="keyword">) || </span><span class="default">startsWith</span><span class="keyword">(</span><span class="default">$req_sql</span><span class="keyword">, </span><span class="string">'update'</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mysql_affected_rows</span><span class="keyword">(); </span><span class="comment">// -1 || N<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else if (</span><span class="default">startsWith</span><span class="keyword">(</span><span class="default">$req_sql</span><span class="keyword">, </span><span class="string">'insert'</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mysql_insert_id</span><span class="keyword">(); </span><span class="comment">// ID || 0 || FALSE<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else if (</span><span class="default">endsWith</span><span class="keyword">(</span><span class="default">$req_sql</span><span class="keyword">, </span><span class="string">'limit 1'</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$req_result</span><span class="keyword">); </span><span class="comment">// [] || FALSE<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else if (</span><span class="default">startsWith</span><span class="keyword">(</span><span class="default">$req_sql</span><span class="keyword">, </span><span class="string">'select count(*)'</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">(</span><span class="default">$req_result</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$line</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]; </span><span class="comment">// N<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mysql_fetch_all</span><span class="keyword">(</span><span class="default">$req_result</span><span class="keyword">); </span><span class="comment">// [][]<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
function </span><span class="default">mysql_bind</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">=array())<br />
{<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$values </span><span class="keyword">as &amp;</span><span class="default">$value</span><span class="keyword">) </span><span class="default">$value </span><span class="keyword">= </span><span class="default">mysql_real_escape_string</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="default">vsprintf</span><span class="keyword">( </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'?'</span><span class="keyword">, </span><span class="string">"'%s'"</span><span class="keyword">, </span><span class="default">$sql</span><span class="keyword">), </span><span class="default">$values</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$sql</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">mysql_fetch_all</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$resultArray </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; while((</span><span class="default">$resultArray</span><span class="keyword">[] = </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) || </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$resultArray</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$resultArray</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">startsWith</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,</span><span class="default">$case</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$case</span><span class="keyword">){return (</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">)),</span><span class="default">$needle</span><span class="keyword">)===</span><span class="default">0</span><span class="keyword">);}<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">strcasecmp</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">)),</span><span class="default">$needle</span><span class="keyword">)===</span><span class="default">0</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">endsWith</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,</span><span class="default">$case</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$case</span><span class="keyword">){return (</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">) - </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">)),</span><span class="default">$needle</span><span class="keyword">)===</span><span class="default">0</span><span class="keyword">);}<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">strcasecmp</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">) - </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">)),</span><span class="default">$needle</span><span class="keyword">)===</span><span class="default">0</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Don't forget to set $sqlhost, $sqluser, $sqlpass and $sqlbase.<br />
<br />
With help of :<br />
mysql_bind : <a href="http://php.net/manual/en/function.mysql-real-escape-string.php#96391" rel="nofollow" target="_blank">http://php.net/manual/en/function.mysql-real-escape-string.php#96391</a><br />
mysql_fetch_all : <a href="http://php.net/manual/en/function.mysql-fetch-assoc.php#90030" rel="nofollow" target="_blank">http://php.net/manual/en/function.mysql-fetch-assoc.php#90030</a><br />
<br />
trigger_error may be enhanced with this tip : <a href="http://php.net/manual/en/function.trigger-error.php#98910" rel="nofollow" target="_blank">http://php.net/manual/en/function.trigger-error.php#98910</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91197""></a>
  <div class="note">
   <strong class="user">Chris Parsons</strong>
   <a href="#91197" class="date">29-May-2009 08:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function for preventing a MySQL query timeout.<br />
<br />
Add a temporary table to the database:<br />
<br />
CREATE TABLE `temp_table` (<br />
&nbsp;&nbsp;&nbsp; `ID` DOUBLE ,<br />
&nbsp;&nbsp;&nbsp; `temp` BLOB <br />
); <br />
<br />
Call this function in every iteration of any long loops in your code (it will only be run at a maximum once every 15 seconds, regardless of how often the function is called):<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//insert and delete something from the temp_table table to prevent a timeout<br />
</span><span class="keyword">function </span><span class="default">preventMySQLTimeout</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$timeoutCounter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">time</span><span class="keyword">() - </span><span class="default">$timeoutCounter </span><span class="keyword">&gt; </span><span class="default">15</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//perform 3 types of operations to keep the connection from timing out! :-)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"SELECT * FROM temp_table"</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">//SELECT<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"DELETE FROM temp_table"</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">//DELETE<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"INSERT INTO temp_table (temp) VALUES ('" </span><span class="keyword">. </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">200000</span><span class="keyword">) . </span><span class="string">"')"</span><span class="keyword">); </span><span class="comment">//INSERT<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$timeoutCounter </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"\n&lt;br&gt;preventMySQLTimeout() ATTEMPT\n&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
MySQL has multiple timeout counters, one for inserts, and one for deletes, and I could not find a way to extend them in PHP.&nbsp; Please note that this is a different issue entirely than the 'connect' timeout.&nbsp; Every 15 seconds, this function will insert, select, and delete a row from the temporary table, thus preventing a query timeout.<br />
<br />
Good Luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83255""></a>
  <div class="note">
   <strong class="user">joachimb at gmail dot com</strong>
   <a href="#83255" class="date">16-May-2008 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Lazy Man's Logging:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">/// Creates a table called $table as (id, when, message) if none such exists, and inserts a row with $message in it.<br />
&nbsp; /// If no connection details are given, it uses the current database connection. Same goes for $database and $when.<br />
&nbsp; ///<br />
&nbsp; /// @returns TRUE on success or FALSE on failure.<br />
&nbsp; ///<br />
&nbsp; /// @example mysql_put_contents("orders", "I CAN HAZ CHEEZBURGER?", "mysite", NULL, "127.0.0.1:3306", "mysite_user", "secret") or die(mysql_error());<br />
&nbsp; /// @example mysql_put_contents("guestbook", "Longcat says: I'm loooooooooooong") or die("Errorz!");<br />
&nbsp; </span><span class="keyword">function </span><span class="default">mysql_put_contents</span><span class="keyword">(</span><span class="default">$table</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">, </span><span class="default">$database </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$when </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$host </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$user </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$pass </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$host</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">$database</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="default">$database</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$qry </span><span class="keyword">= </span><span class="string">"CREATE TABLE IF NOT EXISTS `</span><span class="default">$table</span><span class="string">` (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; `when` TIMESTAMP DEFAULT NOW(),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; `message` TEXT NOT NULL<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$qry</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$result </span><span class="keyword">=== </span><span class="default">FALSE</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$qry </span><span class="keyword">= </span><span class="string">"INSERT INTO `</span><span class="default">$table</span><span class="string">` VALUES(NULL, "</span><span class="keyword">.(</span><span class="default">$when </span><span class="keyword">? </span><span class="default">$when </span><span class="keyword">: </span><span class="string">'NULL'</span><span class="keyword">).</span><span class="string">", '"</span><span class="keyword">.</span><span class="default">mysql_real_escape_string</span><span class="keyword">(</span><span class="default">$message</span><span class="keyword">).</span><span class="string">"');"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$qry</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$result </span><span class="keyword">=== </span><span class="default">FALSE</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80870""></a>
  <div class="note">
   <strong class="user">dhirendrak at yahoo dot com</strong>
   <a href="#80870" class="date">04-Feb-2008 11:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment"># Created by dhirendra can be reached at dhirendrak at yahoo dot com<br />
# This script is created to check the data difference between two tables<br />
# when the structure of both tables are same.<br />
# Limitation : <br />
# 1) Structure of both tables should be same.<br />
# 2) Name of both table should be different but if same than obviously <br />
# second table should be if different database.<br />
# 3) If use two database than both database permission should be same <br />
# as i am using aliases to get the information.<br />
#<br />
# USES::<br />
# 1) This may be useful when you did some changes in your existing <br />
# script and you expect the certain output. So with the help of this <br />
#&nbsp; &nbsp; function you may compare the impact due to your changes in script.<br />
#<br />
#&nbsp; <br />
<br />
</span><span class="default">$host</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># host name or ip address <br />
</span><span class="default">$user</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># database user name<br />
</span><span class="default">$pass</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment"># database password<br />
</span><span class="default">$database</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># dateabase name with which you want to connect<br />
<br />
# get connection with mysql<br />
</span><span class="default">$dblink </span><span class="keyword">= @</span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">,</span><span class="default">$user</span><span class="keyword">,</span><span class="default">$pass</span><span class="keyword">);<br />
<br />
</span><span class="comment"># select and open database<br />
</span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="default">$database</span><span class="keyword">,</span><span class="default">$dblink</span><span class="keyword">);<br />
<br />
</span><span class="default">$db1</span><span class="keyword">=</span><span class="string">"&lt; your db1 &gt;"</span><span class="keyword">; </span><span class="comment">// first database<br />
// second database if database are same for both tables than use the same as db1<br />
</span><span class="default">$db2</span><span class="keyword">=</span><span class="string">"&lt; your db2 &gt;"</span><span class="keyword">; <br />
</span><span class="default">$table1</span><span class="keyword">=</span><span class="string">"&lt; your table1 &gt;"</span><span class="keyword">; </span><span class="comment">// first table<br />
// second table if database is same for both tables than table name <br />
# must be different but fields name are same and order of the fields are same.<br />
<br />
</span><span class="default">$table2</span><span class="keyword">=</span><span class="string">"&lt; your table2 &gt;"</span><span class="keyword">; <br />
<br />
</span><span class="comment">// function starts here <br />
</span><span class="keyword">function </span><span class="default">table_data_difference</span><span class="keyword">(</span><span class="default">$first</span><span class="keyword">,</span><span class="default">$second</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$dblink</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sql1 </span><span class="keyword">= </span><span class="string">"SHOW FIELDS FROM </span><span class="default">$first</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql1</span><span class="keyword">,</span><span class="default">$dblink</span><span class="keyword">) or die(</span><span class="string">"Having error in execution 1 =="</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">());<br />
<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_object</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$from_fields</span><span class="keyword">[]=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Field</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sql</span><span class="keyword">=</span><span class="string">"select * from </span><span class="default">$first</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res</span><span class="keyword">=</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">,</span><span class="default">$dblink</span><span class="keyword">) or die(</span><span class="string">"Having error in execution 2=="</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$j</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$row</span><span class="keyword">=</span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$from_fields</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql_next</span><span class="keyword">=</span><span class="string">"select </span><span class="default">$second</span><span class="string">.* from </span><span class="default">$second</span><span class="string"> where"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$num</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql_next</span><span class="keyword">=</span><span class="default">$sql_next</span><span class="keyword">.</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$second</span><span class="keyword">.</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$from_fields</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">"='"</span><span class="keyword">.</span><span class="default">$row</span><span class="keyword">[</span><span class="default">$from_fields</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]].</span><span class="string">"' and "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql_next</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$sql_next</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sql_next</span><span class="keyword">)-</span><span class="default">5</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res_next</span><span class="keyword">=</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql_next</span><span class="keyword">,</span><span class="default">$dblink</span><span class="keyword">) or die(</span><span class="string">"Having error in execution 3=="</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num1</span><span class="keyword">=</span><span class="default">mysql_num_rows</span><span class="keyword">(</span><span class="default">$res_next</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$num1</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$from_fields</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val</span><span class="keyword">=</span><span class="default">$val</span><span class="keyword">.</span><span class="string">"&lt;br&gt;"</span><span class="keyword">.</span><span class="default">$from_fields</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">"="</span><span class="keyword">.</span><span class="default">$row</span><span class="keyword">[</span><span class="default">$from_fields</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Display the record which are not matched.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;br&gt;\n"</span><span class="keyword">.</span><span class="default">$j</span><span class="keyword">.</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br&gt;-----------------------------------------------------"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$j</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="default">$first</span><span class="keyword">=</span><span class="default">$db1</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$table1</span><span class="keyword">;<br />
</span><span class="default">$second</span><span class="keyword">=</span><span class="default">$db2</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$table2</span><span class="keyword">;<br />
<br />
</span><span class="default">table_data_difference</span><span class="keyword">(</span><span class="default">$first</span><span class="keyword">,</span><span class="default">$second</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79260""></a>
  <div class="note">
   <strong class="user">matiyahoo-publico at yhoo dot com dot ar</strong>
   <a href="#79260" class="date">17-Nov-2007 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
David:<br />
<br />
In this line:<br />
<br />
$query = "SELECT username FROM users WHERE username REGEXP '$username[0-9*]'";<br />
<br />
PHP may read $username[, *including* the open square bracket, and may think you are trying to get into an array.<br />
<br />
You should use this instead:<br />
<br />
$query = "SELECT username FROM users WHERE username REGEXP '${username}[0-9*]'";<br />
<br />
Or maybe this:<br />
<br />
$query = "SELECT username FROM users WHERE username REGEXP '$username" . "[0-9*]'";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79082""></a>
  <div class="note">
   <strong class="user">david at kiwi dot com</strong>
   <a href="#79082" class="date">09-Nov-2007 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am wanting to increment usernames which are to be alphabetic characters A-Z or a-z and if someone uses "abc" it will automatically be given "abc1" and the next applicant to apply for that same username will automatically be given "abc2", the next "abc3" and so on. If I enter the following into MySQL;<br />
<br />
SELECT username FROM users WHERE username REGEXP 'abc[0-9*]';<br />
<br />
the result is<br />
<br />
abc1<br />
abc2<br />
abc3<br />
<br />
I have been given the following script from another forum but it does not work;<br />
<br />
<span class="default">&lt;?php <br />
$username </span><span class="keyword">= </span><span class="string">'abc'</span><span class="keyword">; <br />
</span><span class="default">$query </span><span class="keyword">= </span><span class="string">"SELECT username FROM users WHERE username LIKE '</span><span class="default">$username</span><span class="string">%'"</span><span class="keyword">; <br />
</span><span class="default">$res </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">); <br />
while(</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)) { <br />
&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">]); <br />
&nbsp;&nbsp; if (</span><span class="default">$old_n</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">!=</span><span class="default">$n</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$new_user </span><span class="keyword">= </span><span class="default">$username </span><span class="keyword">. (</span><span class="default">$old_n</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp;&nbsp; break; <br />
&nbsp;&nbsp; } <br />
} <br />
</span><span class="default">?&gt;</span> <br />
<br />
In addition to the script not working the "LIKE" function would not be suitable because if a username was applied as "blue" it would pick up usernames "blue1" and "bluebird1" therefore it appears as if "REGEXP '$username[0-9*]' is the only or correct option.<br />
<br />
I have tried the REGEXP option in association with the balance of the code but it appears as if PHP will not interact with the "[" and "]" in the following;<br />
<br />
$query = "SELECT username FROM users WHERE username REGEXP '$username[0-9*]'";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79021""></a>
  <div class="note">
   <strong class="user">SID TRIVEDI</strong>
   <a href="#79021" class="date">07-Nov-2007 04:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
MySQL (Community) Server Installation on 32-bit Windows XP running Apache<br />
<br />
On Windows, the recommended way to run MySQL is to install it as a Windows service, whereby MySQL starts and stops automatically when Windows starts and stops. A MySQL server installed as a service can also be controlled from the command line commands, or with the graphical Services utility like phpMyAdmin.<br />
<br />
PHP ---&gt; MySQL CONNECTORS (php_mysql.dll and php_mysqli.dll as extensions)<br />
MySQL provides the mysql and mysqli extensions for the Windows operating system on <a href="http://dev.mysql.com/downloads/connector/php/ for MySQL version 4.1.16 and higher, MySQL 5.0.18, and MySQL 5.1. As with enabling any PHP extension in php.ini (such as php_mysql.dll" rel="nofollow" target="_blank">http://dev.mysql.com/downloads/connector/php/ for MySQL version 4.1.16 and higher, MySQL 5.0.18, and MySQL 5.1. As with enabling any PHP extension in php.ini (such as php_mysql.dll</a>), the PHP directive extension_dir should be set to the directory where the PHP extensions are located.<br />
<br />
MySQL is no longer enabled by default, so the php_mysql.dll DLL must be enabled inside of php.ini. Also, PHP needs access to the MySQL client library. A file named libmysql.dll is included in the Windows PHP distribution and in order for PHP to talk to MySQL this file needs to be available to the Windows systems PATH.<br />
<br />
Following PHP Script is useful to test PHP connection with MySQL.<br />
*/<br />
<br />
//$connect = mysql_connect("Your Host Name", "MySQL root directory", 'MySQL password, if any');<br />
//$connect = mysql_connect("Host Name or Address - 127.0.0.1", "root", 'password');<br />
</span><span class="default">$connect </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">, </span><span class="string">"root"</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">);<br />
if (</span><span class="default">$connect</span><span class="keyword">){<br />
echo </span><span class="string">"Congratulations!\n&lt;br&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"Successfully connected to MySQL database server.\n&lt;br&gt;"</span><span class="keyword">;<br />
}else{<br />
</span><span class="default">$error </span><span class="keyword">= </span><span class="default">mysql_error</span><span class="keyword">();<br />
echo </span><span class="string">"Could not connect to the database. Error = </span><span class="default">$error</span><span class="string">.\n&lt;br&gt;"</span><span class="keyword">;<br />
exit();<br />
}<br />
<br />
</span><span class="comment">// Closing connection<br />
</span><span class="default">$close </span><span class="keyword">= </span><span class="default">mysql_close</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">);<br />
if (</span><span class="default">$close</span><span class="keyword">){<br />
echo </span><span class="string">"\n&lt;br&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"Now closing the connection...\n&lt;br&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"MySQL connection closed successfully as well.\n&lt;br&gt;"</span><span class="keyword">;<br />
}else{<br />
echo </span><span class="string">"There's a problem in closing MySQL connection.\n&lt;br&gt;"</span><span class="keyword">;<br />
}<br />
exit();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78486""></a>
  <div class="note">
   <strong class="user">rad14701 at yahoo dot com</strong>
   <a href="#78486" class="date">14-Oct-2007 12:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@Amanda 12-Oct-2007 09:58<br />
<br />
I almost had to ask myself if this was a real question... If the MySQL server rejects the connection attempt then, yes, MySQL would be able to send back an error to PHP... And if PHP can't access the target MySQL server at all then it is also smart enough to issue the appropriate error all by itself...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78467""></a>
  <div class="note">
   <strong class="user">arnold_dba</strong>
   <a href="#78467" class="date">13-Oct-2007 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Also, to secure MySQL data and to be able to comply with PCI standards, you should encrypt the data. There are many ways to do it. For hackers, you can use dm-crypt (www.saout.de/misc/dm-crypt) tool. It is basically used to encrypt the whole partition. If you want a sophisticated solution go with Security-GENERAL for MySQL from packet general (www.packetgeneral.com)<br />
On windows, you can use disk encryption feature provided by windows itself or tool like trucrypt (www.truecrypt.org)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77528""></a>
  <div class="note">
   <strong class="user">DuiMDog</strong>
   <a href="#77528" class="date">02-Sep-2007 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On 11-Apr-2007 admin at mihalism dot com posted an 'easy to use MySql-class'.<br />
In my opinion there is a bug in the get_affected_rows-function. It refers to query-id, but&nbsp; it should refer to connect-id instead.<br />
<br />
The corrected function should be:<br />
&nbsp;&nbsp;&nbsp; function get_affected_rows($connect_id = ""){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($connect_id == NULL){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $return = mysql_affected_rows($this-&gt;connect_id);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $return = mysql_affected_rows($connect_id);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!$return){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;error();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $return;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75761""></a>
  <div class="note">
   <strong class="user">atk2 at hotmail dot com</strong>
   <a href="#75761" class="date">14-Jun-2007 08:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After finally getting IIS, PHP, and MySQL on a new Windows XP machine, I decided to write the steps I took so you can see how it was done: <a href="http://www.atksolutions.com/articles/install_php_mysql_iis.html" rel="nofollow" target="_blank">http://www.atksolutions.com/articles/install_php_mysql_iis.html</a><br />
<br />
Hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74532""></a>
  <div class="note">
   <strong class="user">tomasz dot rup at gmail dot com</strong>
   <a href="#74532" class="date">16-Apr-2007 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Correct algorithm to generate MySQL password hash is:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mysql_password</span><span class="keyword">(</span><span class="default">$passStr</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr</span><span class="keyword">=</span><span class="default">0x50305735</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr2</span><span class="keyword">=</span><span class="default">0x12345671</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$add</span><span class="keyword">=</span><span class="default">7</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$charArr </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"//"</span><span class="keyword">, </span><span class="default">$passStr</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$charArr </span><span class="keyword">as </span><span class="default">$char</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$char </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">) || (</span><span class="default">$char </span><span class="keyword">== </span><span class="string">' '</span><span class="keyword">) || (</span><span class="default">$char </span><span class="keyword">== </span><span class="string">'\t'</span><span class="keyword">)) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$charVal </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">^= (((</span><span class="default">$nr </span><span class="keyword">&amp; </span><span class="default">63</span><span class="keyword">) + </span><span class="default">$add</span><span class="keyword">) * </span><span class="default">$charVal</span><span class="keyword">) + (</span><span class="default">$nr </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">&amp;= </span><span class="default">0x7fffffff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr2 </span><span class="keyword">+= (</span><span class="default">$nr2 </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">) ^ </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr2 </span><span class="keyword">&amp;= </span><span class="default">0x7fffffff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$add </span><span class="keyword">+= </span><span class="default">$charVal</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%08x%08x"</span><span class="keyword">, </span><span class="default">$nr</span><span class="keyword">, </span><span class="default">$nr2</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74505""></a>
  <div class="note">
   <strong class="user">Nobody Special</strong>
   <a href="#74505" class="date">14-Apr-2007 11:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This PHP5-only class is used so that $db isn't passed. Kudos to arjen at queek dot nl for example.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">SQL </span><span class="keyword">{<br />
&nbsp;private </span><span class="default">$db</span><span class="keyword">;<br />
&nbsp;public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">=</span><span class="string">"localhost"</span><span class="keyword">,</span><span class="default">$user</span><span class="keyword">=</span><span class="string">"root"</span><span class="keyword">,</span><span class="default">$pass</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">,</span><span class="default">$db</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">db </span><span class="keyword">= @</span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">);<br />
&nbsp; if(!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">db</span><span class="keyword">) die(@</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp; if(</span><span class="default">$db </span><span class="keyword">!= </span><span class="string">""</span><span class="keyword">) </span><span class="default">$dbs </span><span class="keyword">= @</span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">);<br />
&nbsp; if(!</span><span class="default">$dbs</span><span class="keyword">) die(@</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;}<br />
&nbsp;public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp; @</span><span class="default">mysql_close</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">);<br />
&nbsp;}<br />
&nbsp;public function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$function</span><span class="keyword">, </span><span class="default">$arguments</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$arguments</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">db</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="string">"mysql_"</span><span class="keyword">.</span><span class="default">$function</span><span class="keyword">, </span><span class="default">$arguments</span><span class="keyword">);<br />
&nbsp; if(!</span><span class="default">$return</span><span class="keyword">) die(@</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;}<br />
}<br />
<br />
</span><span class="default">$db </span><span class="keyword">= new </span><span class="default">SQL</span><span class="keyword">();<br />
</span><span class="default">$query </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SELECT * FROM this_table WHERE my_variable='1'"</span><span class="keyword">);<br />
</span><span class="default">$fetch </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">fetch_array</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$fetch</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74482""></a>
  <div class="note">
   <strong class="user">mega-squall at caramail dot com</strong>
   <a href="#74482" class="date">13-Apr-2007 02:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Windows users, please note:<br />
<br />
If apache is installed as a service, and you change PATH variable so it can reach libmysql.dll, you will need to reboot your machine in order to have changes applied.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74437""></a>
  <div class="note">
   <strong class="user">admin at mihalism dot com</strong>
   <a href="#74437" class="date">11-Apr-2007 07:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Heres a easy to use MySQL class for any website<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">mysql_db</span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">sql_connect</span><span class="keyword">(</span><span class="default">$sqlserver</span><span class="keyword">, </span><span class="default">$sqluser</span><span class="keyword">, </span><span class="default">$sqlpassword</span><span class="keyword">, </span><span class="default">$database</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect_id </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="default">$sqlserver</span><span class="keyword">, </span><span class="default">$sqluser</span><span class="keyword">, </span><span class="default">$sqlpassword</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect_id</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="default">$database</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect_id</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">error</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">mysql_error</span><span class="keyword">() != </span><span class="string">''</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;b&gt;MySQL Error&lt;/b&gt;: '</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">().</span><span class="string">'&lt;br/&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$query </span><span class="keyword">!= </span><span class="default">NULL</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect_id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_result</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_result</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'&lt;b&gt;MySQL Error&lt;/b&gt;: Empty Query!'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_num_rows</span><span class="keyword">(</span><span class="default">$query_id </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$query_id </span><span class="keyword">== </span><span class="default">NULL</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">mysql_num_rows</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_result</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">mysql_num_rows</span><span class="keyword">(</span><span class="default">$query_id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$return</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">fetch_row</span><span class="keyword">(</span><span class="default">$query_id </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$query_id </span><span class="keyword">== </span><span class="default">NULL</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_result</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$query_id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$return</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_affected_rows</span><span class="keyword">(</span><span class="default">$query_id </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$query_id </span><span class="keyword">== </span><span class="default">NULL</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">mysql_affected_rows</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_result</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">mysql_affected_rows</span><span class="keyword">(</span><span class="default">$query_id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$return</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">sql_close</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect_id</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mysql_close</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect_id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//+======================================================+&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* Example */<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$DB </span><span class="keyword">= new </span><span class="default">mysql_db</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$DB</span><span class="keyword">-&gt;</span><span class="default">sql_connect</span><span class="keyword">(</span><span class="string">'sql_host'</span><span class="keyword">, </span><span class="string">'sql_user'</span><span class="keyword">, </span><span class="string">'sql_password'</span><span class="keyword">, </span><span class="string">'sql_database_name'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$DB</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SELECT * FROM `members`"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$DB</span><span class="keyword">-&gt;</span><span class="default">sql_close</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72632""></a>
  <div class="note">
   
   <a href="#72632" class="date">26-Jan-2007 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note, that the sql.safe_mode configuration setting does effect all mysql_* functions. This has nothing to to with the php safe mode, check the [SQL] section in php.ini.<br />
<br />
I found out, that if you set sql.safe_mode = On, mysql_connect will ignore provided username and passwort and makes use of the script owner instead (checked on debian).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71411""></a>
  <div class="note">
   <strong class="user">ravenal at uniphix dot com</strong>
   <a href="#71411" class="date">27-Nov-2006 02:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was working with a friend of mine and he happened wanted to sort data based on the column names, well this function will basically sort the Field Names in ABC order and then from there on it'll add the data based on the field names assigned to...<br />
<br />
You can use this to create easily forms and exclude what you don't want to be as entered data or sort it based on what order you want... <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;* By Benjamin Willard (c) 2006<br />
&nbsp;*<br />
&nbsp;* Sorts a Field by the Column Name (in ABC Order) <br />
&nbsp;*<br />
&nbsp;* @param string&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; : Table Name of where to Display the Values<br />
&nbsp;* @param integer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; : Database Link<br />
&nbsp;* (Optional) @param array&nbsp; &nbsp;&nbsp; : This will sort whatever you wish to be displayed on the top of the list<br />
&nbsp;* (Optional) @param array&nbsp; &nbsp;&nbsp; : This will exclude what you do not want displayed<br />
&nbsp;*<br />
&nbsp;* return @param array&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; : Returns an Array of the Column Data <br />
&nbsp;* [Usage]<br />
&nbsp;* mysql_sort_field_column( string tablename, int database_link [, array sortfirst, array exclude] )<br />
&nbsp;* [Example]<br />
&nbsp;* $array = mysql_sort_field_column( "test", $c, array( "id", "name" ), array( "password" ) );<br />
&nbsp;*<br />
&nbsp;* [Output]<br />
&nbsp;*&nbsp; &nbsp; Array<br />
&nbsp;*&nbsp; &nbsp; ( <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; id <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [Field] =&gt; id<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; int(11)<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [Type] =&gt; int(11)<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [2] =&gt; <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [Null] =&gt; <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [3] =&gt; PRI<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [Key] =&gt; PRI<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [4] =&gt; <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [Default] =&gt; <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [5] =&gt; auto_increment<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [Extra] =&gt; auto_increment<br />
&nbsp;*&nbsp; &nbsp; )<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; [id] =&gt; 1;<br />
&nbsp;*<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">mysql_sort_field_column</span><span class="keyword">( </span><span class="default">$tablename</span><span class="keyword">, </span><span class="default">$link</span><span class="keyword">, </span><span class="default">$sortfirst </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$exclude </span><span class="keyword">= </span><span class="string">'' </span><span class="keyword">)<br />
{&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$show</span><span class="keyword">=</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"SHOW COLUMNS FROM </span><span class="default">$tablename</span><span class="string">"</span><span class="keyword">, </span><span class="default">$link</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">=array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; while( </span><span class="default">$fetch </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$show </span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$fetch</span><span class="keyword">[</span><span class="string">'Field'</span><span class="keyword">]] = </span><span class="default">$fetch</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ksort</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$sortfirst </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$sortfirst</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newarray </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$sortfirst </span><span class="keyword">AS </span><span class="default">$i2 </span><span class="keyword">=&gt; </span><span class="default">$v </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newarray</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">] = </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$array </span><span class="keyword">AS </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$val2 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$index</span><span class="keyword">, </span><span class="default">$sortfirst </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newarray</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] = </span><span class="default">$val2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">$newarray</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$exclude </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$exclude</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$array </span><span class="keyword">AS </span><span class="default">$index2 </span><span class="keyword">=&gt; </span><span class="default">$val2 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">in_array</span><span class="keyword">( </span><span class="default">$index2</span><span class="keyword">, </span><span class="default">$exclude </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[</span><span class="default">$index2</span><span class="keyword">] = </span><span class="default">$val2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">$out</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70526""></a>
  <div class="note">
   <strong class="user">mdhafen at x.washk12.org</strong>
   <a href="#70526" class="date">19-Oct-2006 11:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to martijn at elicit dot nl<br />
<br />
Actually it is possible as a query, even with an auto_increment key field.&nbsp; Like so...<br />
<br />
INSERT<br />
&nbsp; INTO<br />
&nbsp;&nbsp; tablename<br />
&nbsp;&nbsp; ( list, of, ALL, similar, columns ) <br />
( SELECT<br />
&nbsp; *<br />
FROM<br />
&nbsp; tablename<br />
WHERE<br />
&nbsp; somefield = 'somevalue' )<br />
<br />
That should work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69256""></a>
  <div class="note">
   <strong class="user">martijn at elicit dot nl</strong>
   <a href="#69256" class="date">29-Aug-2006 12:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Keeping history records usually requires you to duplicate rows. With standard MySQL syntax you can create a query like this:<br />
<br />
INSERT<br />
&nbsp; INTO<br />
&nbsp;&nbsp;&nbsp; tablename<br />
SELECT<br />
&nbsp; *<br />
FROM<br />
&nbsp; tablename<br />
WHERE<br />
&nbsp; somefield = 'somevalue'<br />
<br />
The problem is that this won't work if you are using an auto_numbering key id field. There is no way to do this with standard MySQL syntax and I haven't been able to find a standard php function as well. So here's the function I wrote for that very purpose:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// function to create a duplicate record in a table with 1 auto_increment id.<br />
</span><span class="keyword">function </span><span class="default">mysql_duplicate_record</span><span class="keyword">(</span><span class="default">$table</span><span class="keyword">, </span><span class="default">$id_field</span><span class="keyword">, </span><span class="default">$id</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// load original record into array<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="string">'SELECT * FROM ' </span><span class="keyword">. </span><span class="default">$table </span><span class="keyword">. </span><span class="string">' WHERE ' </span><span class="keyword">. </span><span class="default">$id_field </span><span class="keyword">. </span><span class="string">' = ' </span><span class="keyword">. </span><span class="default">$id </span><span class="keyword">. </span><span class="string">' LIMIT 1;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">( </span><span class="default">$query </span><span class="keyword">) or die(</span><span class="string">'Error, query failed. ' </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ar </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">( </span><span class="default">$r</span><span class="keyword">, </span><span class="default">MYSQL_ASSOC </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// insert new record and get new auto_increment id<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_query </span><span class="keyword">(</span><span class="string">'LOCK TABLES ' </span><span class="keyword">. </span><span class="default">$table </span><span class="keyword">. </span><span class="string">' WRITE;'</span><span class="keyword">) or die(</span><span class="string">'Error, query failed. ' </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_query </span><span class="keyword">(</span><span class="string">'INSERT INTO ' </span><span class="keyword">. </span><span class="default">$table </span><span class="keyword">. </span><span class="string">' ( `' </span><span class="keyword">. </span><span class="default">$id_field </span><span class="keyword">. </span><span class="string">'` ) VALUES ( NULL );'</span><span class="keyword">) or die(</span><span class="string">'Error, query failed. ' </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$id </span><span class="keyword">= </span><span class="default">mysql_insert_id</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_query </span><span class="keyword">(</span><span class="string">'UNLOCK TABLES;'</span><span class="keyword">) or die(</span><span class="string">'Error, query failed. ' </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// update new record with values from previous record<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="string">'UPDATE ' </span><span class="keyword">. </span><span class="default">$table </span><span class="keyword">. </span><span class="string">' SET '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$value </span><span class="keyword">= </span><span class="default">current</span><span class="keyword">(</span><span class="default">$ar</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">key</span><span class="keyword">(</span><span class="default">$ar</span><span class="keyword">) != </span><span class="default">$id_field</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">.= </span><span class="string">'`'</span><span class="keyword">.</span><span class="default">key</span><span class="keyword">(</span><span class="default">$ar</span><span class="keyword">).</span><span class="string">'` = "'</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'", '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">next</span><span class="keyword">(</span><span class="default">$ar</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">).</span><span class="string">' '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">.= </span><span class="string">'WHERE ' </span><span class="keyword">. </span><span class="default">$id_field </span><span class="keyword">. </span><span class="string">' = "' </span><span class="keyword">. </span><span class="default">$id </span><span class="keyword">. </span><span class="string">'" LIMIT 1;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">) or die(</span><span class="string">'Error, query failed. ' </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// return the new id<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$id</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68864""></a>
  <div class="note">
   <strong class="user">davesteinb at yahoo dot com</strong>
   <a href="#68864" class="date">13-Aug-2006 03:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made this function to reduce DB calls. You can store Mysql results in a session var and sort the results on any column. Might work nice in an AJAX app.<br />
<br />
&lt;?<br />
<br />
function mysql_sort($results, $sort_field, $dir="ASC") {<br />
&nbsp;&nbsp;&nbsp; $temp_array = array();<br />
&nbsp;&nbsp;&nbsp; $i=0;<br />
&nbsp;&nbsp;&nbsp; foreach ($results as $res) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $temp_array[$i] = $res[$sort_field];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ($dir=="ASC") {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; asort($temp_array);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; arsort($temp_array);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $new_results = array();<br />
&nbsp;&nbsp;&nbsp; $i=0;<br />
&nbsp;&nbsp;&nbsp; foreach($temp_array as $k =&gt; $v) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $new_results[$i] = $results[$k];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; ksort($new_results);<br />
&nbsp;&nbsp;&nbsp; return $new_results;<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
//use<br />
if (count($_SESSION["res"])==0) {<br />
&nbsp;&nbsp;&nbsp; $_SESSION["res"] = [GET DATABASE RESULTS HOWEVER YOU MAY]<br />
}<br />
<br />
$_SESSION["res"] = mysql_sort($_SESSION["res"], $_REQUEST["sort"], $_REQUEST["dir"]);<br />
<br />
?&gt;<br />
&lt;table&gt;<br />
&lt;tr&gt;<br />
&nbsp; &lt;td&gt;&lt;a href="page.php?sort=f_name&amp;dir=&lt;? echo ($_REQUEST["dir"]=="ASC") ? "DESC":"ASC"; ?&gt;"&gt;First&lt;/a&gt;&lt;/td&gt;<br />
&nbsp; &lt;td&gt;&lt;a href="page.php?sort=l_name&amp;dir=&lt;? echo ($_REQUEST["dir"]=="ASC") ? "DESC":"ASC"; ?&gt;"&gt;Last&lt;/a&gt;&lt;/td&gt;<br />
&lt;/tr&gt;<br />
<br />
&lt;? foreach ($_SESSION["res"] as $r) {?&gt;<br />
&lt;tr&gt;<br />
&nbsp; &lt;td&gt;&lt;?=$r["f_name"]?&gt;&lt;/td&gt;<br />
&nbsp; &lt;td&gt;&lt;?=$r["l_name"]?&gt;&lt;/td&gt;<br />
&lt;/tr&gt;<br />
&lt;? } ?&gt;<br />
&lt;/table&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68260""></a>
  <div class="note">
   <strong class="user">richard at NOSPAM dot dimax dot com</strong>
   <a href="#68260" class="date">19-Jul-2006 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to Conrad Decker's post below:&nbsp; <br />
<br />
If your tables contain foreign key constraints you will not be able to properly restore from a datafile created by mysqldump.<br />
<br />
mysqldump dumps table data in alphabetical order, not in the logical order required by the foreign key constraints.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68006""></a>
  <div class="note">
   <strong class="user">vbolshov at rbc dot ru</strong>
   <a href="#68006" class="date">09-Jul-2006 11:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have recently ran into a problem with configuring php extensions related to mysql (namely, mysql and pdo_mysql). Later I've discovered that it wasn't a PHP problem but that of MySQL - libmysqlclient doesn't ship with binary downloads. I've built MySQL from sources and both extensions then compiled successfully.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66476""></a>
  <div class="note">
   <strong class="user">Conrad Decker</strong>
   <a href="#66476" class="date">23-May-2006 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In regards to the previous post...you should actually be able to pipe a mysql dump directly back into mysql.<br />
<br />
From the command line something like<br />
mysql -u username -p databasename &lt; mysqldumpfilename<br />
should rebuild the database. <br />
<br />
There are some additional options one can use, and I believe mysqldump from different versions of mysql may not be completely compatible.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65478""></a>
  <div class="note">
   <strong class="user">sb at stephenbrooks dot org</strong>
   <a href="#65478" class="date">01-May-2006 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm in the process of changing web hosts and my previous host provided a "dump" of the database in the form of a sequence of SQL requests that (I assume) have to be executed in order to rebuild the database on another system.&nbsp; It was generated using "MySQL dump 9.11".&nbsp; Queries are finished by a semicolon and linefeed, while comment-lines begin with a double hyphen.&nbsp; The script below opens a connection to an SQL server and loads a dump file $file of this format into the database $dest_db.<br />
<br />
function load_db_dump($file,$sqlserver,$user,$pass,$dest_db)<br />
{<br />
&nbsp; $sql=mysql_connect($sqlserver,$user,$pass);<br />
&nbsp; mysql_select_db($dest_db);<br />
&nbsp; $a=file($file);<br />
&nbsp; foreach ($a as $n =&gt; $l) if (substr($l,0,2)=='--') unset($a[$n]);<br />
&nbsp; $a=explode(";\n",implode("\n",$a));<br />
&nbsp; unset($a[count($a)-1]);<br />
&nbsp; foreach ($a as $q) if ($q) <br />
&nbsp;&nbsp;&nbsp; if (!mysql_query($q)) {echo "Fail on '$q'"; mysql_close($sql); return 0;}<br />
&nbsp; mysql_close($sql);<br />
&nbsp; return 1;<br />
}<br />
<br />
This may not be watertight if the ";\n" sequence appears inside queries, but I hope it helps others who are in posession of such dumps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64696""></a>
  <div class="note">
   <strong class="user">caladorn at ugcs dot caltech dot edu</strong>
   <a href="#64696" class="date">19-Apr-2006 12:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After configuring php.ini as outlined above (set the extension_dir variable and uncomment the appropriate mysql library) I kept receiving the following error on every Apache restart:<br />
<br />
PHP Startup: Unable to load dynamic library './ext\\php_mysql.dll'<br />
<br />
After trawling the web, most suggestions seemed to center on copying the libmysql.dll from the php install directory to c:\windows\system32.&nbsp; While this can work, it can also complicate future upgrades, since you'll always have to copy the new libmysql.dll to insure proper operation.<br />
<br />
Instead, if you run a search for "libmysql.dll", you'll likely find several versions in various directories.&nbsp; After removing the older (smaller) versions from the other directories in my PATH, (c:\windows, c:\windows\system32) - and making sure the php install directory was in the PATH, apache/php was able to successfully locate the correct DLL and start without errors.<br />
<br />
Hopefully someone will find this helpful.&nbsp; ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63912""></a>
  <div class="note">
   <strong class="user">Nathan Brizzee</strong>
   <a href="#63912" class="date">03-Apr-2006 10:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
For all those who may still be struggling to get PHP to work with Windows and IIS, I finally found something that works.<br />
<br />
If you are getting the error message that function mysql_connect could not be found and you're sure you enabled php_mysql in php.ini this is what finally solved my problem.<br />
<br />
The post from mmw_canada at yahoo dot com on 10-Jul-2005 06:15 pointed me in the right direction.&nbsp; Thanks mmw_canada!<br />
<br />
1.) If you are connected to your Windows box via Remote Desktop, there is a switch to Remote Desktop that will connect you to the console session.&nbsp; This is important because when IIS starts up, it's error messages go to the console.&nbsp; If you are sitting at the physical machine, you can ignore this step.<br />
<br />
Here is the command<br />
mstsc -v:10.192.186.xxx&nbsp; /F -console<br />
<br />
For a more complete list of supported commands, type this at a dos command window:<br />
mstsc /?<br />
<br />
2.) Add a registry entry that tells PHP where to find its php.ini file.&nbsp; Copy the following text and paste it in a text file.&nbsp; Rename the text file to something like phpini.reg and double-click it to add it to your registry.<br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_LOCAL_MACHINE\\SOFTWARE\\PHP]<br />
"IniFilePath"="C:\\\\PHP"<br />
<br />
2.) Add c:\\php; (or wherever you unzipped PHP to) to your environment variable "Path".&nbsp; Here is the important part that caused me hours and hours of grief.&nbsp; When adding c:\\php; to the PATH environment variable, make SURE you add it BEFORE the path to CVSNT or MYSQL.&nbsp; PHP, CVSNT, and MYSQL all have a file called libmysql.dll.&nbsp; Search order is important for PHP to find its file libmysql.dll first.&nbsp; PHP must come first in the search path.&nbsp; Otherwise you will get an error from the DLL on the console screen when IIS starts up saying it can't find the specified function call.<br />
<br />
To see the order of your environment variables, open up a dos window and type "set" and press enter.&nbsp; Look at what Path is equal to.&nbsp; c:\\php; better come before cvsnt and mysql or it will never work properly.<br />
<br />
Hope this helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63834""></a>
  <div class="note">
   <strong class="user">brjann at gmail dot com</strong>
   <a href="#63834" class="date">01-Apr-2006 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After tearing my eyes out in frustration, I've finally found a way to enable extensions that always works for me. It's pretty straightforward.<br />
<br />
1. Download the latest zip-version of PHP. <br />
2. Delete (or backup) the contents of your PHP folder (usually c:\php). (remember to save any ext's not included in the zip)<br />
3. Copy everything in the zip-file into your PHP folder<br />
4. Be sure that extension_dir is set to "./ext" in php.ini<br />
5. Enable whichever extensions you want to use in php.ini<br />
<br />
I guess that deleting everything is quite unnecessary, the important thing is that the php.exe and extensions in the same zip are of compatible versions. I've never found any need to change the PATH environment variable.<br />
<br />
Hope it helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63197""></a>
  <div class="note">
   <strong class="user">yp</strong>
   <a href="#63197" class="date">15-Mar-2006 02:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
when using Fedora Core linux Mysql rpm installation.<br />
Configure as following to load the mysql header files.<br />
./configure --with-mysql=/usr/<br />
Remember to do make clean to remove old configurations before compile</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62013""></a>
  <div class="note">
   <strong class="user">php comments of fuzzyworm co., uk</strong>
   <a href="#62013" class="date">17-Feb-2006 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to get PHP working nicely with MySQL, even with Apache, under Windows based systems, try XAMPP, from Apache Friends. It saves messing about with config files, which is the only major problem with trying to get the three to work together under windows.<br />
<br />
<a href="http://www.apachefriends.org/en/xampp-windows.html" rel="nofollow" target="_blank">http://www.apachefriends.org/en/xampp-windows.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61874""></a>
  <div class="note">
   <strong class="user">sabin at sabin dot com dot np</strong>
   <a href="#61874" class="date">14-Feb-2006 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
php_mysql.dll and libmysql.dll for windows systems can be downloaded from <a href="http://dev.mysql.com/downloads/connector/php/" rel="nofollow" target="_blank">http://dev.mysql.com/downloads/connector/php/</a><br />
<br />
It can be useful to those who are using the PHP Windows installer, which does not have any external extensions included.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61451""></a>
  <div class="note">
   <strong class="user">elliotthird at tiscali dot co dot uk</strong>
   <a href="#61451" class="date">03-Feb-2006 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Oops! Don't use that one, use this:<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">class </span><span class="default">database </span><span class="keyword">{<br />
&nbsp;&nbsp; function </span><span class="default">database</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">, </span><span class="default">$database</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; if (!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection </span><span class="keyword">|| !</span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="default">$database</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; function </span><span class="default">query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">$type </span><span class="keyword">= </span><span class="default">MYSQL_BOTH</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$return</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; </span><span class="comment">/* Change this to reflect your database setup */<br />
&nbsp; </span><span class="default">$database </span><span class="keyword">= new </span><span class="default">database</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="string">'root'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'forum'</span><span class="keyword">);<br />
&nbsp; if (!</span><span class="default">$database</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; exit(</span><span class="string">'Could not connect to the database!'</span><span class="keyword">);<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59942""></a>
  <div class="note">
   <strong class="user">jeremy hepler</strong>
   <a href="#59942" class="date">20-Dec-2005 12:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you on an OS that has older mysql libs and want to properly authenticate to the modern mysql versions, without the OLD_PASSWORD hack; compile php with where you have installed the latest mysql binary package: <br />
<br />
./configure --with-mysql=/usr/local/mysql<br />
<br />
if you have mysql installed on seperate server, just drop it into the target directory on what ever machine you are compiling it on.<br />
<br />
Be sure to "make clean" before building or it may look in the previous place.<br />
<br />
Use the output of mysql_get_client_info(); to test before and after.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59793""></a>
  <div class="note">
   <strong class="user">Joe Greklek</strong>
   <a href="#59793" class="date">15-Dec-2005 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've seen alot of newbies getting frustrated over the extenstions not being installed initially, so heres a quick tut for Windows.<br />
<br />
It's ok to use the php5 installer. Just be sure to also grab the .zip or "manual" version of php5.<br />
<br />
Install it like any other app. It's pretty straight forward. Don't forget to set the securities mentioned in the last message box at the end of the install. Next, If you installed php to c:\php then you will need to add this to your PATH environment variable. This is a very important step.<br />
<br />
Now open up the .zip manual version of php5 and extract the ext folder, and "libmysql.dll" to "c:\php\". <br />
<br />
You *MUST* set your security permissions on libmysql.dll and the ext folder to READ/READ&amp;EXECUTE for IUSR_"MACHINE_NAME". like my machine is called master&lt;acct = IUSR_MASTER&gt;. If you don't do this you will recieve an ******.dll - Access Denied. type message.<br />
<br />
Next edit your php.ini file usually located in c:\windows\.<br />
Find the line for&nbsp; &nbsp; extension_dir&nbsp; &nbsp; variable and make it say <br />
extension_dir = "c:\php\ext\"<br />
<br />
Then scroll down a little bit and find the lines that say <br />
;extension=php_mbstring.dll<br />
;extension=php_bz2.dll<br />
;extension=php_curl.dll<br />
;extension=php_dba.dll<br />
;extension=php_dbase.dll<br />
;extension=php_exif.dll<br />
;extension=php_fdf.dll<br />
;extension=php_filepro.dll<br />
;extension=php_gd2.dll<br />
;extension=php_gettext.dll<br />
;extension=php_ifx.dll<br />
<br />
just remove the semicolin for each extension you would like loaded. Such as <br />
extention=php_mysql.dll<br />
and so on.<br />
<br />
Now just reboot and all should be well. Query away. you basically only need to reboot to update the PATH environment variable. Hope this helps at least 1 person.:)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58415""></a>
  <div class="note">
   <strong class="user">phil at pelanne dot com</strong>
   <a href="#58415" class="date">03-Nov-2005 07:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are experiencing extremely slow connections to MySQL from PHP from a Windows 2003 Server it may well not be PHP or IIS - try loading mysql in in 'skip-name-resolve'-Mode.&nbsp; <br />
<br />
It may mean the difference between a 10 second load time and a split second load time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57013""></a>
  <div class="note">
   <strong class="user">Jonathon Hibbard</strong>
   <a href="#57013" class="date">21-Sep-2005 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a small function I wrote to handle queries on a table.<br />
It can query a table, order and sort, and supports inner joins.<br />
<br />
This function also returns the result as a single row or all rows.<br />
<br />
Enjoy : <br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * Selects Fields from a database/table.&nbsp; <br />
&nbsp;&nbsp; * Also supports INNER JOINS, GROUP BY, ORDER BY.<br />
&nbsp;&nbsp; *<br />
&nbsp;&nbsp; * @Author : Jonathon Hibbard<br />
&nbsp;&nbsp; *<br />
&nbsp;&nbsp; * @param string $db_name&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Name of Database<br />
&nbsp;&nbsp; * @param string $table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Name of Table<br />
&nbsp;&nbsp; * @param array $fields&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Field Names we want to select<br />
&nbsp;&nbsp; * @param array $inner&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Fields to be INNER JOINED<br />
&nbsp;&nbsp; * @param array $where&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //WHERE fields.<br />
&nbsp;&nbsp; * @param string $group_by&nbsp; &nbsp; &nbsp; &nbsp; //Field to group by.<br />
&nbsp;&nbsp; * @param string $order_by&nbsp; &nbsp; &nbsp; &nbsp; //Field to order by<br />
&nbsp;&nbsp; * @param string $asc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Asc or Desc order<br />
&nbsp;&nbsp; * @param string $return_array&nbsp; &nbsp; //Defines $rst as an array or single row <br />
&nbsp;&nbsp; * @return $rst&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Returns the result<br />
&nbsp;&nbsp; *<br />
&nbsp;&nbsp; * @example : (1) getFields('mytool','master',<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'array('master.master_id','master.fname_id'));<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (2) getFields('mytool','master',<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'array('master.master_id','master.fname_id',<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'fname.fname'), array(0=&gt;array('mytool',<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'fname','master','fname_id',)),<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'master.default_value &lt;&gt; "", false);<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (3) getFields('mytool','master','master.master_id',NULL,<br />
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'master.fname_id = "3",NULL,NULL,NULL,false);<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">function </span><span class="default">getFields</span><span class="keyword">(</span><span class="default">$db_name</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">,</span><span class="default">$table</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">,</span><span class="default">$fields</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">,</span><span class="default">$inner</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$where</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">,</span><span class="default">$group_by</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">,</span><span class="default">$order_by</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">,</span><span class="default">$asc</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$return_array</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$C_NAME </span><span class="keyword">= </span><span class="default">__CLASS__</span><span class="keyword">.</span><span class="string">"::"</span><span class="keyword">.</span><span class="default">__FUNCTION__</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"SELECT "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$fields</span><span class="keyword">) ? </span><span class="default">$sql </span><span class="keyword">.= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">,</span><span class="default">$fields</span><span class="keyword">) : </span><span class="default">$sql </span><span class="keyword">.= </span><span class="default">$fields</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" FROM "</span><span class="keyword">.</span><span class="default">$db_name</span><span class="keyword">.</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$table</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(!empty(</span><span class="default">$inner</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$total_inners </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$inner</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$total_inners</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" INNER JOIN "</span><span class="keyword">.</span><span class="default">$inner</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$inner</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">].</span><span class="string">" <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ON "</span><span class="keyword">.</span><span class="default">$inner</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">].</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$inner</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">].</span><span class="string">" = <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "</span><span class="keyword">.</span><span class="default">$inner</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">].</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$inner</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(!empty(</span><span class="default">$where</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$where</span><span class="keyword">) ? </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" WHERE "</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">' AND '</span><span class="keyword">,</span><span class="default">$where</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : die(</span><span class="string">"Fatal Error : Variable must be an array.&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Variable type is : "</span><span class="keyword">.</span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$where</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; !empty(</span><span class="default">$group_by</span><span class="keyword">) ? </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" GROUP BY "</span><span class="keyword">.</span><span class="default">$group_by </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; !empty(</span><span class="default">$order_by</span><span class="keyword">) ? </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" ORDER BY "</span><span class="keyword">.</span><span class="default">$order_by </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; !empty(</span><span class="default">$asc</span><span class="keyword">)&nbsp; &nbsp; &nbsp; ? </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" "</span><span class="keyword">.</span><span class="default">$asc </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">.= </span><span class="string">" # Query resides in "</span><span class="keyword">.</span><span class="default">__FILE__</span><span class="keyword">.</span><span class="string">"-&gt;"</span><span class="keyword">.</span><span class="default">$C_NAME</span><span class="keyword">.</span><span class="string">"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; on line "</span><span class="keyword">.</span><span class="default">__LINE__</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$return_array </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$rst </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or die(</span><span class="string">"An Error Has Occurred!<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \n MySQL Error Reports : "</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">().</span><span class="string">"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \n The Error Occured in "</span><span class="keyword">.</span><span class="default">__FILE__</span><span class="keyword">.</span><span class="string">" -&gt; "</span><span class="keyword">.</span><span class="default">$C_NAME</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; while(</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$rst</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rowRst</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">[</span><span class="default">$fields</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$rst </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or die(</span><span class="string">"An Error Has Occurred! <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \n MySQL Error Reports : "</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">().</span><span class="string">" <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \n The Error Occured in "</span><span class="keyword">.</span><span class="default">__FILE__</span><span class="keyword">.</span><span class="string">" -&gt; "</span><span class="keyword">.</span><span class="default">$C_NAME</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$rowRst </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$rst</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$rowRst</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56927""></a>
  <div class="note">
   <strong class="user">nick smith</strong>
   <a href="#56927" class="date">19-Sep-2005 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i'm fairly new to this but have just managed to set up (on windows xp) apache 2.0.54 with php 5.0.4 and mySQL 4.1.13, also phpMyAdmin 2.6.4 having had exactly the problems reported by so many others. i wasnt actually aware of mySQL not being loaded in php until i tried to use phpmyadmin and it told me to check my php/mysql configuration.<br />
<br />
basically i just did everything that is mentioned by others (setting extension_dir to c:\php\ext ( not c:\php\ext\ ), uncommenting extension=php_mysql.dll from php.ini and putting c:\php into my PATH) but i was still getting the infuriating message when trying to start apache that php_mysql.dll could not be found. <br />
<br />
i restarted my machine and it worked! It seems i had to restart windows after editing my PATH. i didnt bother restarting until it was the last resort because on xp i have NEVER had to do this before - changes to System Variables always took effect immediately. I could understand this on, say, windows 98 where you put the addition to your PATH into your autoexec.bat but why i had to do this with xp is a mystery.<br />
<br />
Anyway, give it a go, it might save you tearing out prescious hair!<br />
<br />
N.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56389""></a>
  <div class="note">
   <strong class="user">avis_del at yahoo dot com</strong>
   <a href="#56389" class="date">01-Sep-2005 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I aggree with j at jonathany.com<br />
<br />
PHP 5.04 to MySQL,<br />
php_mysql.dll will not found on windows installer (.msi)<br />
just extract from .zip file (can download).<br />
It works.<br />
<br />
1. cgi.force_redirect = 0<br />
2. extension_dir = "c:\php\ext"<br />
3. extension=php_mysql.dll<br />
<br />
untill on phpinfo.php show<br />
<br />
MySQL Support enabled <br />
Active Persistent Links&nbsp; 0&nbsp; <br />
Active Links&nbsp; 0&nbsp; <br />
Client API version&nbsp; 4.1.12</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56166""></a>
  <div class="note">
   <strong class="user">claude(at)claude(dot)nl</strong>
   <a href="#56166" class="date">25-Aug-2005 07:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A note on resources<br />
<br />
When a resource (e.g. a link identifier) runs out of scope, it is deleted and the associated computer resources (e.g. the tcp link to the database) will be terminated as well. So far so good!<br />
However, in the following code the tcp mysql link persists until the end of execution:<br />
<span class="default">&lt;?php<br />
$conn </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'hostname'</span><span class="keyword">, </span><span class="string">'username'</span><span class="keyword">,</span><span class="string">'password'</span><span class="keyword">);<br />
</span><span class="default">$conn </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">sleep </span><span class="keyword">(</span><span class="default">30</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>This is because the internally the link-identifier is being saved, so that subsequent mysql functions will work. There seems to be no way to delete this internal reference.<br />
If you were, however, to open 2 connections, the oldest one will be deleted automatically (so the connection to hostname will terminate at the $conn=null statement, the connection to hostname2 will exist till the end of the script).<br />
<span class="default">&lt;?php<br />
$conn </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'hostname'</span><span class="keyword">, </span><span class="string">'username'</span><span class="keyword">,</span><span class="string">'password'</span><span class="keyword">);<br />
</span><span class="default">$conn2 </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'hostname2'</span><span class="keyword">, </span><span class="string">'username'</span><span class="keyword">,</span><span class="string">'password'</span><span class="keyword">);<br />
</span><span class="default">$conn </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$conn2 </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">sleep </span><span class="keyword">(</span><span class="default">30</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55489""></a>
  <div class="note">
   <strong class="user">arjen at mysql dot com</strong>
   <a href="#55489" class="date">04-Aug-2005 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
John Coggeshall wrote a PHP5 ext/mysqli compatibility script for applications that still use the old ext/mysql functions. This prevents the hassle of trying to have both the mysql and mysqli extensions loaded in PHP5, which can be tricky.<br />
<br />
The script is at:<br />
<a href="http://www.coggeshall.org/oss/mysql2i/" rel="nofollow" target="_blank">http://www.coggeshall.org/oss/mysql2i/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54941""></a>
  <div class="note">
   <strong class="user">allan666 at NOSPAM dot gmail dot com</strong>
   <a href="#54941" class="date">20-Jul-2005 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's Note: In MySQL v5.0+, you can use the INFORMATION_SCHEMA tables to retrieve information on tables, views, databases and so on. --zak@php.net]<br />
<br />
Here is a small function to parse a mysql creation table DDL. The function takes a string with the SQL code to create a table and returns the table name, table fields, table key fields and fields type, all in arrays (except by the name, obviously). The function requires that the primary key be named "id" and the foreign keys named "id...". All foreign key types are suposed to be int (or its variations, bigint, etc...). All those restrictions are easily modified to others needs.<br />
<br />
Here is a example of a DDL code.<br />
<br />
CREATE TABLE `telefones` (<br />
&nbsp; `id` int(11) NOT NULL auto_increment,<br />
&nbsp; `id_tipo_telefone` int(11) NOT NULL default '0',<br />
&nbsp; `numero` varchar(15) NOT NULL default '',<br />
&nbsp; `id_pessoa` int(11) NOT NULL default '0',<br />
&nbsp; PRIMARY KEY&nbsp; (`id`),<br />
&nbsp; KEY `id_tipo_telefone` (`id_tipo_telefone`),<br />
&nbsp; KEY `id_pessoa` (`id_pessoa`),<br />
&nbsp; CONSTRAINT `0_775` FOREIGN KEY (`id_tipo_telefone`) REFERENCES `tipos_telefone` (`id`),<br />
&nbsp; CONSTRAINT `0_776` FOREIGN KEY (`id_pessoa`) REFERENCES `pessoas` (`id`)<br />
) TYPE=InnoDB<br />
<br />
that returns<br />
<br />
$tbname = "telefones"<br />
$fields = array("numero");<br />
$kfields = array("id_tipo_telefone","id_pessoa");<br />
$tipos = array("varchar");<br />
<br />
Hope it helps...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parseQuery</span><span class="keyword">(</span><span class="default">$Q</span><span class="keyword">, &amp;</span><span class="default">$tbname</span><span class="keyword">, &amp;</span><span class="default">$fields</span><span class="keyword">, &amp;</span><span class="default">$kfields</span><span class="keyword">, &amp;</span><span class="default">$tipos</span><span class="keyword">) {<br />
<br />
</span><span class="comment">/** rules to a corect parse:<br />
&nbsp;*<br />
&nbsp;*&nbsp; &nbsp;&nbsp; 1 - primary key must be named "id"<br />
&nbsp;*&nbsp; &nbsp;&nbsp; 2 - foreign key must be named "id..." eg.: id_field<br />
&nbsp;*&nbsp; &nbsp;&nbsp; 3 - lowercase is recomended<br />
&nbsp;*/<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Q </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">),</span><span class="default">chr</span><span class="keyword">(</span><span class="default">13</span><span class="keyword">)),</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$Q</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Q </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">"'"</span><span class="keyword">,</span><span class="string">"`"</span><span class="keyword">),</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$Q</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/([^(]*)\((.*)\)(.*)/"</span><span class="keyword">,</span><span class="default">$Q</span><span class="keyword">,</span><span class="default">$A</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$part1 </span><span class="keyword">= </span><span class="default">$A</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$part2 </span><span class="keyword">= </span><span class="default">$A</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$part3 </span><span class="keyword">= </span><span class="default">$A</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/(.*) ([a-zA-Z_]+)/"</span><span class="keyword">,</span><span class="default">$part1</span><span class="keyword">,</span><span class="default">$A</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tbname </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$A</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$temp </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="default">$part2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$temp </span><span class="keyword">as </span><span class="default">$t</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/ *([a-zA-Z_]+) +([a-zA-Z_]+)(.*)/"</span><span class="keyword">,</span><span class="default">$t</span><span class="keyword">,</span><span class="default">$A</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pcampo </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$A</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ptipo </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$A</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/</span><span class="default">$pcampo</span><span class="string">/"</span><span class="keyword">,</span><span class="string">"primary key constraint id unique foreign"</span><span class="keyword">) )&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( (</span><span class="default">$pcampo</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] == </span><span class="string">"i"</span><span class="keyword">) &amp;&amp; (</span><span class="default">$pcampo</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] == </span><span class="string">"d"</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kfields</span><span class="keyword">[] = </span><span class="default">$pcampo</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fields</span><span class="keyword">[] = </span><span class="default">$pcampo</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tipos</span><span class="keyword">[] = </span><span class="default">$ptipo</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54637""></a>
  <div class="note">
   <strong class="user">mmw_canada at yahoo dot com</strong>
   <a href="#54637" class="date">10-Jul-2005 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I Quote:<br />
<br />
"Note: If when starting the web server an error similar to the following occurs: "Unable to load dynamic library './php_mysql.dll'", this is because php_mysql.dll and/or libmysql.dll cannot be found by the system."<br />
<br />
Actully, the file may have been found, it is just the wrong version.<br />
<br />
The "libmysql.dll" is packaged and sent with a number of applications and it can end up in different place on your computer.&nbsp; The file may even be completely different, so just replacing it may cause problems with the other applications.<br />
<br />
I searched for the this file and found that I had a number of different versions on my machine at once.&nbsp; PHP was trying to use the WRONG ONE. <br />
<br />
Maybe the name should be changed in later versions so that it doesn't encourage people to commit suicide or pull their hair out.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54528""></a>
  <div class="note">
   <strong class="user">bahatest at ifrance dot com</strong>
   <a href="#54528" class="date">06-Jul-2005 10:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
/*<br />
* before mysql 4.1, timestamp have a defined size, but after 4.1, timestamp is equal to... datetime<br />
* so, conversion is automatic when you import your dump in new mysql version, but your script cannot echo dates like before.<br />
* this function took one date on DATETIME format, a size of old timestamp format and return the date in old timestamp format before 4.1<br />
* Note : if $date is in TIMESTAMP format, the function return it unaltered. So we can patch our php code before migrate to 4.1<br />
* @param $date a date in DATETIME format, or TIMESTAMP format after mysql 4.1<br />
* @param $size a size of old TIMESTAMP format (14,12,10,8,6,4 or 2)<br />
* @return the date in old TIMESTAMP format<br />
*/<br />
function mysql_convert_timestamp_to_previous_usage($date, $size) {<br />
&nbsp;&nbsp;&nbsp; $tab=split('[- :]', $date);<br />
&nbsp;&nbsp;&nbsp; if (sizeof($tab) != 6) return $date;<br />
&nbsp;&nbsp;&nbsp; if (($size!= 8) &amp;&amp; ($size!= 14)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $tab[0]=substr($tab[0], -2);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for ($i = 12; $i&gt;$size; $i-=2) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($tab[sizeof($tab)-1]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ($size== 8) unset($tab[sizeof($tab)-1]);<br />
&nbsp;&nbsp;&nbsp; return implode("", $tab);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54414""></a>
  <div class="note">
   <strong class="user">jimmy dot a dot gunawan at gmail dot com</strong>
   <a href="#54414" class="date">03-Jul-2005 12:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I almost desperately connect my apache 2.0.54 winversion to PHP 5.0.4 and MYSQL 4.1.12 under windows, since there are lack of any accurate information to setup them properly.<br />
If you got any error message said: "Call to undefined function mysql_connect()", here is the right tips.<br />
<br />
Apache installed in c:\apache\apachegroup<br />
PHP installed in c:\php<br />
Mysql installed in c:\mysql<br />
<br />
1. Find and add c:\apache\apachegroup\conf\httpd.conf<br />
&nbsp;&nbsp;&nbsp; with:<br />
&nbsp;&nbsp; &nbsp;&nbsp; ScriptAlias /php/ "c:/php/"<br />
&nbsp;&nbsp; &nbsp;&nbsp; AddType application/x-httpd-php .php<br />
&nbsp;&nbsp; &nbsp;&nbsp; Action application/x-httpd-php "/php/php-cgi.exe"<br />
2. Go to php directory c:\php then rename php.ini-dist to php.ini <br />
&nbsp;&nbsp;&nbsp; (or make a new php.ini based on old php.ini file),<br />
&nbsp;&nbsp;&nbsp; make sure we set the right extension:<br />
&nbsp;&nbsp; &nbsp; &nbsp; extension_dir = "c:\php\ext" <br />
&nbsp;&nbsp; &nbsp; &nbsp; extension=php_mysql.dll<br />
<br />
If you setup an php script that call function php_info();<br />
and you can find table:<br />
MySQL Support enabled <br />
Active Persistent Links&nbsp; 0&nbsp; <br />
Active Links&nbsp; 0&nbsp; <br />
Client API version&nbsp; 4.1.7<br />
<br />
that mean the mysql.dll properly attached to suppport the php, happy SQL-ing</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53527""></a>
  <div class="note">
   <strong class="user">Microsoul V3</strong>
   <a href="#53527" class="date">04-Jun-2005 03:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use IIS 6, PHP 5.04, Windows Server 2003 and MySQL 4.1.11. and here is what I was able to figure out.<br />
To get MySQL and PHP to talk to each other, in the php.cfg, dont forget to turn on the tag<br />
cgi.force_redirect = 0, and make sure you set it at 0 (it is default at 1. just delete the semi-colon from in front of it to activate it in the code) Then the phpinfo will say its reading the cfg from your PHP install directory instead of your WINDOWS root. Then your phpinfo will show the MySQL entry that some people may be having a hard time with. No registry settings or copying of anything is needed. Also follow the rest of the excellent help from the user comments. Here's what I did, to make it simple:<br />
I made a folder in the folder tree just above program files (explore your computer) and named it PHP. I extracted the .zip php version into it (not the auto install version). I edited the php.ini-recommended, renamed it to just php, added my sql username, database name, etc.( you really gotta look closely at the cfg file and make sure you dont overlook something). Turned on the extension=php_mysql.dll (just delete the semi-colon thats in front of it). Added the php folder to the PATH (instructions on how to do this are pretty simple, and documented above). I also made the ext folder available to the PATH, but Im not sure if it's really necessary. The user comments are what really helped me, so I thought I would return the favor, and try to expand on this topic a little bit.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53330""></a>
  <div class="note">
   <strong class="user">noel at nettensity dot com</strong>
   <a href="#53330" class="date">28-May-2005 11:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
More On Windows 2003 Server / IIS 6.0:<br />
<br />
It might (probably) be necessary to add both the path to PHP and the path to the extensions dir to your environmental variables.<br />
<br />
To do this:<br />
1) Right-Click on 'My Computer'<br />
2) Select 'Properties'<br />
3) Click the 'Advanced' tab<br />
4) At the bottom of this dialog box, click the 'Environmental Variables' button<br />
5) In the frame titled 'System Variables', scroll-down until you find 'Path'<br />
6)Add your path to PHP and your path to the extensions folder i.e. c:\php;c:\php\ext. Make sure all the paths are seperated by semi-colons, and make sure not to erase any of the other paths already in there.<br />
<br />
I meant to include this in my note below, apologies for any confusion.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53329""></a>
  <div class="note">
   <strong class="user">noel at nettensity dot com</strong>
   <a href="#53329" class="date">28-May-2005 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Enabling MySQL with Windows Server 2003/IIS 6.0:<br />
Find your php.ini file first, check phpinfo() to see where php is currently looking for php.ini. (i.e. Using the Windows installer for PHP 5.0.4, the php.ini file was placed in the C:\Windows dir.) I recommend, however, that you don't use the installer - go with full manual install.<br />
<br />
Set the following in php.ini:<br />
display_errors = on<br />
error_reporting = E_ALL<br />
This will make sure that you'll see any errors that arise during configuration. MAKE SURE TO CORRECT THESE WHEN YOU ARE DONE PLAYING WITH PHP.INI! Do not leave these settings like this on a production machine.<br />
<br />
In php.ini set the following:<br />
extension_dir = "pathtoextensions (ususally [yourpathtophp]\ext)"<br />
extension=php_mysql.dll (make sure this is un-commented if its already in your php.ini)<br />
<br />
In IIS, open Web Service Extensions, click "Add a new Web service extension..."<br />
Type-in PHP for the extension name<br />
Under required files:<br />
Add&nbsp; [yourpathtophp]\php5isapi.dll<br />
Add&nbsp; [yourpathtophp]\php5ts.dll<br />
Click 'Apply' then click 'OK'<br />
<br />
Create web sites like you normally would, but make sure they have executable permissions, not just script access. Under the "Home Directory" tab, click 'Configuration'. Scroll down the list at the top and see if you can find PHP. If you do, make sure the path to the executable for PHP is correct. If you don't find PHP in the list, click 'Add...', then browse to the correct executable, [yourpathtophp]\php5isapi.dll, and click OK. In the extension field, enter 'PHP'. Verbs should already be set to 'All verbs', leave it like that.<br />
<br />
Create a test page with this code:<br />
&lt;? echo(phpinfo()); ?&gt;<br />
call it test.php, and place this file into the web site you just created. Browse to the page, with firefox preferably ;), and make sure that you have a MySql section with some MySql info in there. If not, then your paths are possibly screwed up, or you're still not editing the correct php.ini (again, look at the location that phpinfo() shows you, and just edit it there if you have to, then move it afterwards and re-config).<br />
<br />
Hope this helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53049""></a>
  <div class="note">
   <strong class="user">disappear dot nz at gmail dot com</strong>
   <a href="#53049" class="date">21-May-2005 09:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
<br />
this is a small OOP script to provide an easy connction to the mysql db and to get associative / logical / both arrays.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">mysql_array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct </span><span class="keyword">( </span><span class="default">$s_host </span><span class="keyword">, </span><span class="default">$s_user </span><span class="keyword">, </span><span class="default">$s_pass </span><span class="keyword">, </span><span class="default">$s_db </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">r_conn </span><span class="keyword">= </span><span class="default">mysql_connect </span><span class="keyword">( </span><span class="default">$s_host </span><span class="keyword">, </span><span class="default">$s_user </span><span class="keyword">, </span><span class="default">$s_pass </span><span class="keyword">) or die ( </span><span class="default">mysql_error </span><span class="keyword">( ) ) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_select_db </span><span class="keyword">( </span><span class="default">$s_db </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private function </span><span class="default">array_make </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">, </span><span class="default">$i_type </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r_rs </span><span class="keyword">= </span><span class="default">mysql_query </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">, </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">r_conn </span><span class="keyword">) or die ( </span><span class="default">mysql_error </span><span class="keyword">( ) ) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ( </span><span class="default">$a_col </span><span class="keyword">= </span><span class="default">mysql_fetch_array </span><span class="keyword">( </span><span class="default">$r_rs </span><span class="keyword">, </span><span class="default">$i_type </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a_rs </span><span class="keyword">[ ] = </span><span class="default">$a_col </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_free_result </span><span class="keyword">( </span><span class="default">$r_rs </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$a_rs </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">array_logic </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a_rs </span><span class="keyword">= </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">array_make </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">, </span><span class="default">MYSQL_NUM </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$a_rs </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">array_assoc </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a_rs </span><span class="keyword">= </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">array_make </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">, </span><span class="default">MYSQL_ASSOC </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$a_rs </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">array_both </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a_rs </span><span class="keyword">= </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">array_make </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">, </span><span class="default">MYSQL_BOTH </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$a_rs </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$o_mysql </span><span class="keyword">= new </span><span class="default">mysql_array </span><span class="keyword">( </span><span class="string">'localhost' </span><span class="keyword">, </span><span class="string">'user' </span><span class="keyword">, </span><span class="string">'pass' </span><span class="keyword">, </span><span class="string">'db' </span><span class="keyword">) ;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$s_sql </span><span class="keyword">= </span><span class="string">"SHOW TABLES" </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a_rs </span><span class="keyword">= </span><span class="default">$o_mysql </span><span class="keyword">-&gt; </span><span class="default">array_assoc </span><span class="keyword">( </span><span class="default">$s_sql </span><span class="keyword">) ;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;pre&gt;' </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">( </span><span class="default">$a_rs </span><span class="keyword">) ;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52858""></a>
  <div class="note">
   <strong class="user">medic at setiherbipolis dot de</strong>
   <a href="#52858" class="date">15-May-2005 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Client does not support authentication protocol requested by server; consider upgrading MySQL client<br />
<br />
means that you're using an old version of MySQL Client ( possibly not mysqli)<br />
<br />
Authentication protocol for MySQL has changed with version 4.1.<br />
<br />
To get a hint at which mysql-client version you're using try phpinfo();</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50659""></a>
  <div class="note">
   
   <a href="#50659" class="date">05-Mar-2005 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are installing PHP5 on Windows 2003 server (AKA Win 2k3) and need MySQL to work using the either the php_mysql.dll or php_mysqli.dll or both of them at the same time, and MySQl isn't showing up in phpinfo, then your php.ini is probably not loading.&nbsp; In the direction in the PHP 5 zip file, they will tell you to add your PHP install directory to your windows path.&nbsp; This should tell php where to load its php.ini from but it doesn't.&nbsp; If you want to get this to work, you don't have to copy any DLL's anywhere like everyone suggests.&nbsp; All you have to do is add the folling regsitry key to windows:<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\PHP]<br />
"IniFilePath"="C:\\PHP"<br />
<br />
simply copy the above 2 lines of code into a text file and save the file as php_ini_path.reg<br />
<br />
After you save the file it will look like a registry file.&nbsp; Simply double click on it. <br />
<br />
It will make it so PHP will look for your php.ini in C:\PHP.&nbsp; I would assume you can edit this if you install php into a different location, but I haven't tried that.<br />
<br />
After running the reg file, make sure your php.ini is in your PHP dir and make sure all the appropriate things are set.&nbsp; This should get you up and running.&nbsp; Make sure you also follow all the steps on how to make it work in IIS.&nbsp; This is just an addition to the direction.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50569""></a>
  <div class="note">
   <strong class="user">Protik Mukherjee</strong>
   <a href="#50569" class="date">03-Mar-2005 09:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Fedora mysql problems!!<br />
In Fedora 3 the php mysql module does not come with the default installation. To install it use $&gt;yum install php_mysql<br />
If u dont do this you will get errors with mysql functions like mysql_connect()<br />
<br />
Hope this helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48434""></a>
  <div class="note">
   <strong class="user">tumaine no at spam verizon net</strong>
   <a href="#48434" class="date">23-Dec-2004 08:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a hard time with upgrading to php version 5.2.0 in Windows XP Pro since mySQL queries all of a sudden stopped working and led to blank pages on my site.&nbsp; I spent a good half day searching google trying to figure out this problem, and didn't quite know how compiling PHP would help me.&nbsp; It is not necessary.&nbsp; Set up PHP manually with the ZIP folder download.&nbsp; <br />
<br />
This is a good link to read and wish I found it earlier:<br />
<br />
<a href="http://www.zend.com/manual/install.windows.extensions.php" rel="nofollow" target="_blank">http://www.zend.com/manual/install.windows.extensions.php</a><br />
<br />
If you are getting an error popup about not being able to load some mysql.dll when starting apache, you need to change this in your php.ini file:<br />
<br />
extension_dir = "./" to something like "c:\php\ext"<br />
&nbsp;<br />
Also what I was doing wrong was that I forgot to uncomment the following line in my php.ini file:<br />
<br />
extension=php_mysql.dll<br />
<br />
Restart apache, and everything should work.<br />
<br />
Thought that I could save someone time and frustration when upgrading, since versions 5+ do not include mySQL support by default as earlier versions apparently do.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48092""></a>
  <div class="note">
   <strong class="user">jon at mysql dot com</strong>
   <a href="#48092" class="date">11-Dec-2004 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re Pat's note: You can add the --old-passwords option in the [mysqld] section of your MySQL my.cnf or my.ini configuration file. This option will force the MySQL server&nbsp; to use the old-style password hashing for all connections. This is not really recommended, as it's less secure, but will allow you to use existing accounts without resetting the passwords.<br />
<br />
Of course, as already mentioned, you can use the MySQL OLD_PASSWORD() function instead to handle this issue on an account-by-account basis.<br />
<br />
The optimal solution when migrating to MySQL 4.1+ from a previous version is to upgrade to PHP 5 (if you're not using it already) and rewrite any code accessing MySQL using the mysqli extension, which is more secure and provides a much better API.<br />
<br />
For more information, see the MySQL Manual: <a href="http://dev.mysql.com/doc/mysql/en/Application_password_use.html" rel="nofollow" target="_blank">http://dev.mysql.com/doc/mysql/en/Application_password_use.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47518""></a>
  <div class="note">
   <strong class="user">lkujala at uniserve dot com</strong>
   <a href="#47518" class="date">18-Nov-2004 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PROBLEM:<br />
Error Message: the specified module could not be found. <br />
When trying to load a php_mysql.dll / php_mysqli.dll / php_mssql.dll extension on a Windows platform.<br />
<br />
CAUSE:<br />
The standard windows installer package is rather incomplete; it does not include any of the DLL's needed for the optional extensions. In order to use any extension you need to install the FULL zip distribution (unless you like fooling around with dll hell), not just the php_*.dll extensions. You might as well include ALL of the DLL's since the dependencies as documented are wrong (i.e. you need more than libmysql.dll for the php_mysql.dll to load).<br />
<br />
I did find the standard windows installer useful for the inital setup though.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46478""></a>
  <div class="note">
   <strong class="user">nleippe at integr8ted dot com</strong>
   <a href="#46478" class="date">12-Oct-2004 03:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
trace_mode breaks SQL_CALC_FOUND_ROWS.<br />
This is because it emits an EXPLAIN &lt;query&gt; before sending the &lt;query&gt; by itself, thus the subsequent SELECT FOUND_ROWS() is no longer the next consecutive query, and the result is zero.<br />
This was true for me for at least MySQL 4.0.21 and 4.1.5gamma.<br />
(PHP 4.3.9)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45618""></a>
  <div class="note">
   <strong class="user">Melvin Nava: e-4(at)venezolano.web.ve</strong>
   <a href="#45618" class="date">13-Sep-2004 12:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To count page hits, just put next code in a text file and include it in every one of your pages. It will log even different querystrings as different pages. (a MySQL database and table is needed first)<br />
<br />
This can be a pretty good example of what you can do with PHP and MySQL. I made this script to log and show all hits in: <a href="http://www.venezolano.web.ve/" rel="nofollow" target="_blank">http://www.venezolano.web.ve/</a><br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/************************<br />
This needs a MySQL table you can create with this:<br />
<br />
CREATE TABLE `stats_pagecounter` (<br />
&nbsp; `id` int(25) NOT NULL auto_increment,<br />
&nbsp; `page_name` varchar(255) NOT NULL default '',<br />
&nbsp; `page_hits` int(25) NOT NULL default '0',<br />
&nbsp; PRIMARY KEY&nbsp; (`id`)<br />
) TYPE=MyISAM; <br />
<br />
**************************<br />
COUNTING STARTS<br />
*************************/<br />
</span><span class="keyword">function </span><span class="default">page_count</span><span class="keyword">(</span><span class="default">$page</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c_link&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="string">'username'</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; or die(</span><span class="string">'counter CONNECT error: '</span><span class="keyword">.</span><span class="default">mysql_errno</span><span class="keyword">().</span><span class="string">', '</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">'database_name'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c_query&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"SELECT * FROM stats_pagecounter<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; WHERE (page_name = '</span><span class="default">$page</span><span class="string">')"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c_result&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$c_query</span><span class="keyword">, </span><span class="default">$c_link</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; or die(</span><span class="string">'counter SELECT error: '</span><span class="keyword">.</span><span class="default">mysql_errno</span><span class="keyword">().</span><span class="string">', '</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">mysql_num_rows</span><span class="keyword">(</span><span class="default">$c_result</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$row</span><span class="keyword">=</span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$c_result</span><span class="keyword">,</span><span class="default">MYSQL_ASSOC</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pcounter </span><span class="keyword">= </span><span class="default">$row</span><span class="keyword">[</span><span class="string">'page_hits'</span><span class="keyword">]+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c_update </span><span class="keyword">= </span><span class="string">"UPDATE stats_pagecounter <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; SET page_hits = '</span><span class="default">$pcounter</span><span class="string">' WHERE page_name = '</span><span class="default">$page</span><span class="string">'"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c_hit </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$c_update</span><span class="keyword">, </span><span class="default">$c_link</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; or die(</span><span class="string">'counter UPDATE error: '</span><span class="keyword">.</span><span class="default">mysql_errno</span><span class="keyword">().</span><span class="string">', '</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c_insert </span><span class="keyword">= </span><span class="string">"INSERT INTO stats_pagecounter<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; VALUES ( '0', '</span><span class="default">$page</span><span class="string">', '1')"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c_page </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$c_insert</span><span class="keyword">, </span><span class="default">$c_link</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; or die(</span><span class="string">'counter INSERT error: '</span><span class="keyword">.</span><span class="default">mysql_errno</span><span class="keyword">().</span><span class="string">', '</span><span class="keyword">.</span><span class="default">mysql_error</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pcounter </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_free_result</span><span class="keyword">(</span><span class="default">$c_result</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_close</span><span class="keyword">(</span><span class="default">$c_link</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$pcounter</span><span class="keyword">;<br />
}<br />
</span><span class="default">$phpself_url </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SERVER_NAME'</span><span class="keyword">].<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">].</span><span class="string">'?'</span><span class="keyword">.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'QUERY_STRING'</span><span class="keyword">];<br />
</span><span class="default">$page_hits </span><span class="keyword">= </span><span class="default">page_count</span><span class="keyword">(</span><span class="default">$phpself_url</span><span class="keyword">);<br />
</span><span class="comment">/************************<br />
COUNTING ENDS<br />
*************************/<br />
<br />
/************************<br />
Put next line in a page to show his page hits<br />
(If you want to)<br />
************************/<br />
</span><span class="keyword">echo </span><span class="default">$page_hits</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44750""></a>
  <div class="note">
   <strong class="user">aidan at php dot net</strong>
   <a href="#44750" class="date">15-Aug-2004 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to replicate the output of `mysql --html`, printing your results in a HTML table, see this function:<br />
<br />
<a href="http://aidanlister.com/repos/v/function.mysql_draw_table.php" rel="nofollow" target="_blank">http://aidanlister.com/repos/v/function.mysql_draw_table.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42726""></a>
  <div class="note">
   <strong class="user">irn-bru at gmx dot de</strong>
   <a href="#42726" class="date">27-May-2004 05:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note, that the sql.safe_mode configuration setting does effect all mysql_* functions. This has nothing to to with the php safe mode, check the [SQL] section in php.ini.<br />
<br />
I found out, that if you set sql.safe_mode = On, mysql_connect will ignore provided username and passwort and makes use of the script owner instead (checked on debian).<br />
<br />
Brian</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39276""></a>
  <div class="note">
   <strong class="user">Pat</strong>
   <a href="#39276" class="date">22-Jan-2004 03:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor Note:<br />
The password hashing was updated in MySQL 4.1, you must use the MySQLi extension with MySQL 4.1+ (or use the following method to allow<br />
pre 4.1 clients to connect).]<br />
<br />
MySQL 5.0 has a new password system, and PHP cannot connect to it because it cannot send a correct password.&nbsp; You must use the MySQL command OLD_PASSWORD() when adding a user to the database, or PHP cannot connect as of the library that comes with PHP 5.0Beta3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33271""></a>
  <div class="note">
   <strong class="user">gyohng at netscape dot net</strong>
   <a href="#33271" class="date">20-Jun-2003 10:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following page contains a complete easy to read tutorial of MySQL programming with PHP.<br />
<br />
<a href="http://www.yohng.com/phpm/" rel="nofollow" target="_blank">http://www.yohng.com/phpm/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30347""></a>
  <div class="note">
   <strong class="user">soren at byu dot edu</strong>
   <a href="#30347" class="date">14-Mar-2003 01:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Let's say that you want to generate a MySQL password hash from a plain text password.&nbsp; Normally, you would just submit the MySQL query "SELECT PASSWORD('password')", but if for some reason you can't access to MySQL database directly, then you can use the following function (translated right out of the MySQL source code):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mysql_password</span><span class="keyword">(</span><span class="default">$passStr</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr</span><span class="keyword">=</span><span class="default">0x50305735</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr2</span><span class="keyword">=</span><span class="default">0x12345671</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$add</span><span class="keyword">=</span><span class="default">7</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$charArr </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"//"</span><span class="keyword">, </span><span class="default">$passStr</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$charArr </span><span class="keyword">as </span><span class="default">$char</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$char </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">) || (</span><span class="default">$char </span><span class="keyword">== </span><span class="string">' '</span><span class="keyword">) || (</span><span class="default">$char </span><span class="keyword">== </span><span class="string">'\t'</span><span class="keyword">)) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$charVal </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">^= (((</span><span class="default">$nr </span><span class="keyword">&amp; </span><span class="default">63</span><span class="keyword">) + </span><span class="default">$add</span><span class="keyword">) * </span><span class="default">$charVal</span><span class="keyword">) + (</span><span class="default">$nr </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr2 </span><span class="keyword">+= (</span><span class="default">$nr2 </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">) ^ </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$add </span><span class="keyword">+= </span><span class="default">$charVal</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%08x%08x"</span><span class="keyword">, (</span><span class="default">$nr </span><span class="keyword">&amp; </span><span class="default">0x7fffffff</span><span class="keyword">), (</span><span class="default">$nr2 </span><span class="keyword">&amp; </span><span class="default">0x7fffffff</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
example:<br />
<br />
&lt;? print mysql_password("hello"); ?&gt;<br />
<br />
outputs:<br />
<br />
70de51425df9d787<br />
<br />
Which is the same result you get if you do "SELECT PASSWORD('hello')" directly in MySQL.&nbsp; Hopefully you'll never be in a situation where you have to use this, but if you need it (like I did), it's here.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29692""></a>
  <div class="note">
   <strong class="user">past at sbox dot tugraz dot at</strong>
   <a href="#29692" class="date">21-Feb-2003 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As MySQL docs say, RAND() is not very usefull for generation of randomized result orders.<br />
<br />
But this worked for me on Linux, however: <br />
Somewhere before:<br />
mt_srand((double)microtime()*1000000);<br />
&nbsp;<br />
"SELECT *, " RAND(".mt_rand(0,86622340).")*10000%100 AS randomvalue ORDER BY randomvalue"<br />
<br />
The upper value for mt_rand() has to be Quite Big to see any effect on MySQL's RAND(). The exact number shouldn't be significant. Note the multiplication and modulo; MySQL seems to count steadily upwards when generating random numbers, so we take some numbers from between.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27029""></a>
  <div class="note">
   <strong class="user">mijnpc at xs4all dot nl</strong>
   <a href="#27029" class="date">20-Nov-2002 02:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have a Windows machine running a webserver with PHP you don't need to install MySQL server to locally test scripts, if you are granted to establish a Secure Telnet connection (port 22) to the remote webserver.<br />
<br />
To do this you need a Secure Telnet client, which supports port-forwarding.<br />
Before you establish a connection, define the port-forward.<br />
Forward local port 3306 to [name or ip of remote server]:3306<br />
Make sure that local ports accept connections from other hosts<br />
Save this session<br />
<br />
Connect to remote server with username and password<br />
Minimize the shell and that's it...<br />
<br />
You can use the same username (and password) as if you were working on the remote server !<br />
E.g. : $link = mysql_connect("localhost", "root", "") or die("no way jose");<br />
<br />
You may get a shell-timeout after xx minutes depending on your remote server, just reconnect or press enter in the shell once in a while...<br />
<br />
An example of a superb freeware Secure Telnet client is Putty : Putty : <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/" rel="nofollow" target="_blank">http://www.chiark.greenend.org.uk/~sgtatham/putty/</a><br />
<br />
This 'discovery' really has saved me a lot of time because I don't have to upload the scripts to the remote server time and time again, pressing [save] is enough, heh (-:</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="21019""></a>
  <div class="note">
   <strong class="user">jeyoung at priscimon dot com</strong>
   <a href="#21019" class="date">25-Apr-2002 09:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Ed. Note:<br />
This may be due to the fact that subsequent calls to mysql_connect with the same parameters return the same resource id for the connection, so in reality it is using the same connection.&nbsp; In order to force a new link, you must specify the new_link parameter in mysql_connect.]<br />
<br />
MySQL transactions<br />
<br />
MySQL supports transactions on tables that are of type InnoDB. I have noticed a behaviour which is puzzling me when using transactions.<br />
<br />
If I establish two connections within the same PHP page, start a transaction in the first connection and execute an INSERT query in the second one, and rollback the transaction in the first connection, the INSERT query in the second connection is also rolled-back. <br />
<br />
I am assuming that a MySQL transaction is not bound by the connection within which it is set up, but rather by the PHP process that sets it up.<br />
<br />
This is a very useful "mis-feature" (bug?) because it allows you to create something like this:<br />
<br />
class Transaction {<br />
&nbsp; var $dbh;<br />
<br />
&nbsp; function Transaction($host, $username, $password) {<br />
&nbsp;&nbsp;&nbsp; $this-&gt;dbh = mysql_connect($host, $username, $password);<br />
&nbsp; }<br />
<br />
&nbsp; function _Transaction() {<br />
&nbsp;&nbsp; &nbsp; mysql_disconnect($this-&gt;dbh);<br />
&nbsp; }<br />
<br />
&nbsp; function begin() {<br />
&nbsp;&nbsp;&nbsp; mysql_query("BEGIN", $this-&gt;dbh);<br />
&nbsp; }<br />
<br />
&nbsp; function rollback() {<br />
&nbsp;&nbsp; &nbsp; mysql_query("ROLLBACK", $this-&gt;dbh);<br />
&nbsp; }<br />
<br />
&nbsp; function commit() {<br />
&nbsp;&nbsp;&nbsp; mysql_query("COMMIT", $this-&gt;dbh);<br />
&nbsp; }<br />
}<br />
<br />
which you could use to wrap around transactional statements like this:<br />
<br />
$tx =&amp; new Transaction("localhost", "username", "password");<br />
$tx-&gt;begin();<br />
$dbh = mysql_connect("localhost", "username", "password");<br />
$result = mysql_query("INSERT ...");<br />
if (!$result) {<br />
&nbsp; $tx-&gt;rollback();<br />
} else {<br />
&nbsp; $tx-&gt;commit();<br />
}<br />
mysql_disconnect($dbh);<br />
unset($tx);<br />
<br />
The benefit of such a Transaction class is that it is generic and can wrap around any of your MySQL statements.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="16925""></a>
  <div class="note">
   <strong class="user">nospam at nospam dot nos</strong>
   <a href="#16925" class="date">19-Nov-2001 09:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ever wanted to know the date a table was last updated? use this:<br />
<br />
$info = mysql_fetch_array(mysql_query("show table status from databasename like 'tablename'"));<br />
echo $info["Update_time"];</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15667""></a>
  <div class="note">
   <strong class="user">skelley at diff dot nl</strong>
   <a href="#15667" class="date">25-Sep-2001 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi, here's a nice little trick to select records in random order from a table in a MySQL database prior to version 3.23<br />
<br />
SELECT *, (ItemID/ItemID)*RAND() AS MyRandom FROM Items ORDER BY MyRandom<br />
<br />
[Editors note: And just "SELECT * FROM foo ORDER BY RAND()" after 3.23]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14386""></a>
  <div class="note">
   <strong class="user">mbabcock-php at fibrespeed dot net</strong>
   <a href="#14386" class="date">28-Jul-2001 07:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since there aren't functions to start and end/rollback transactions, you'll have to use mysql_query("BEGIN"), mysql_query("COMMIT") and mysql_query("ROLLBACK").&nbsp; These will only work properly on tables that support transactions.&nbsp; You may also wish to roll your own mysql_begin (etc) functions that run the above queries for you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14232""></a>
  <div class="note">
   <strong class="user">philip at cornado dot com</strong>
   <a href="#14232" class="date">23-Jul-2001 12:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're new to this, you really should learn basic SQL before moving on.&nbsp; PHP != SQL. Here's are a few good basic SQL tutorials:<br />
<br />
&nbsp; * <a href="http://www.sqlcourse.com/" rel="nofollow" target="_blank">http://www.sqlcourse.com/</a><br />
&nbsp; * <a href="http://www.w3schools.com/sql/" rel="nofollow" target="_blank">http://www.w3schools.com/sql/</a><br />
&nbsp; * <a href="http://www.oreillynet.com/pub/ct/19" rel="nofollow" target="_blank">http://www.oreillynet.com/pub/ct/19</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13569""></a>
  <div class="note">
   <strong class="user">mw-php at ender dot com</strong>
   <a href="#13569" class="date">21-Jun-2001 09:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The mysql_fetch_[row|object|array] functions return data as type string. Owing to the very flexible nature of php variables, this is normally not relevent, but if you happen to retrieve two integers from a database, then try to compare with bitwise operators, you'll run into trouble, because (19 &amp; 2) == 2, but ("19" &amp; "2") == 0. To remedy this, if you use variables from a database with bitwise operators, use the settype() function to explicitly cast your variables as integers before comparing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mysql.examples-basic.html">MySQL extension overview example</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.mysql-affected-rows.html">mysql_affected_rows</a></div>
 <div class="up"><a href="book.mysql.html">Mysql</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
