<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>SNMP Functions</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="snmp.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.snmp-get-quick-print.html">snmp_get_quick_print</a></div>
 <div class="up"><a href="book.snmp.html">SNMP</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.snmp" class="reference">
 <h1 class="title">SNMP Functions</h1>
  
 








































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.snmp-get-quick-print.html">snmp_get_quick_print</a> â€” Fetches the current value of the UCD library's quick_print setting</li><li><a href="function.snmp-get-valueretrieval.html">snmp_get_valueretrieval</a> â€” Return the method how the SNMP values will be returned</li><li><a href="function.snmp-read-mib.html">snmp_read_mib</a> â€” Reads and parses a MIB file into the active MIB tree</li><li><a href="function.snmp-set-enum-print.html">snmp_set_enum_print</a> â€” Return all values that are enums with their enum value instead of the raw integer</li><li><a href="function.snmp-set-oid-numeric-print.html">snmp_set_oid_numeric_print</a> â€” Return all objects including their respective object id within the specified one</li><li><a href="function.snmp-set-oid-output-format.html">snmp_set_oid_output_format</a> â€” Set the OID output format</li><li><a href="function.snmp-set-quick-print.html">snmp_set_quick_print</a> â€” Set the value of quick_print within the UCD SNMP library</li><li><a href="function.snmp-set-valueretrieval.html">snmp_set_valueretrieval</a> â€” Specify the method how the SNMP values will be returned</li><li><a href="function.snmp2-get.html">snmp2_get</a> â€” Fetch an SNMP object</li><li><a href="function.snmp2-getnext.html">snmp2_getnext</a> â€” Fetch the SNMP object which follows the given object id</li><li><a href="function.snmp2-real-walk.html">snmp2_real_walk</a> â€” Return all objects including their respective object ID within the specified one</li><li><a href="function.snmp2-set.html">snmp2_set</a> â€” Set the value of an SNMP object</li><li><a href="function.snmp2-walk.html">snmp2_walk</a> â€” Fetch all the SNMP objects from an agent</li><li><a href="function.snmp3-get.html">snmp3_get</a> â€” Fetch an SNMP object</li><li><a href="function.snmp3-getnext.html">snmp3_getnext</a> â€” Fetch the SNMP object which follows the given object id</li><li><a href="function.snmp3-real-walk.html">snmp3_real_walk</a> â€” Return all objects including their respective object ID within the specified one</li><li><a href="function.snmp3-set.html">snmp3_set</a> â€” Set the value of an SNMP object</li><li><a href="function.snmp3-walk.html">snmp3_walk</a> â€” Fetch all the SNMP objects from an agent</li><li><a href="function.snmpget.html">snmpget</a> â€” Fetch an SNMP object</li><li><a href="function.snmpgetnext.html">snmpgetnext</a> â€” Fetch the SNMP object which follows the given object id</li><li><a href="function.snmprealwalk.html">snmprealwalk</a> â€” Return all objects including their respective object ID within the specified one</li><li><a href="function.snmpset.html">snmpset</a> â€” Set the value of an SNMP object</li><li><a href="function.snmpwalk.html">snmpwalk</a> â€” Fetch all the SNMP objects from an agent</li><li><a href="function.snmpwalkoid.html">snmpwalkoid</a> â€” Query for a tree of information about a network entity</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="83293""></a>
  <div class="note">
   <strong class="user">Andrew Erickson</strong>
   <a href="#83293" class="date">19-May-2008 11:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A good resource if you need a basic SNMP tutorial:<br />
<a href="http://www.dpstele.com/layers/l2/snmp_l2_tut_part1.php" rel="nofollow" target="_blank">http://www.dpstele.com/layers/l2/snmp_l2_tut_part1.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82746""></a>
  <div class="note">
   <strong class="user">m_ilhami at yahoo dot com</strong>
   <a href="#82746" class="date">23-Apr-2008 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you modify snmp.conf, for example, add your own MIB, you must restart apache server for changes take effect.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80763""></a>
  <div class="note">
   <strong class="user">maviael dot silva at gmail dot com</strong>
   <a href="#80763" class="date">30-Jan-2008 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple snmp test.<br />
<br />
Code:<br />
<br />
&lt;h1&gt;SNMP Walk <span class="default">&lt;?php </span><span class="keyword">echo @</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'addr'</span><span class="keyword">]; </span><span class="default">?&gt;</span>&lt;/h1&gt;<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(isset(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'addr'</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">snmprealwalk</span><span class="keyword">(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'addr'</span><span class="keyword">],</span><span class="string">'public'</span><span class="keyword">,</span><span class="default">null</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$open_table </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dt </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'::'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$dt</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] != </span><span class="default">$last</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$open_table</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;/table&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$open_table </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">$dt</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;hr&gt;&lt;h2&gt;</span><span class="default">$last</span><span class="string">&lt;/h2&gt;"&nbsp; &nbsp; </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;table&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$open_table </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;&lt;td&gt;</span><span class="keyword">${</span><span class="default">dt</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;&lt;td&gt;</span><span class="default">$data</span><span class="string">&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }else{<br />
</span><span class="default">?&gt;<br />
</span>&nbsp; &nbsp; &lt;form action="snmp.php" method="get"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;input type="text" name="addr" /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;input type="submit" value="Ok"/&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/form&gt;<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78909""></a>
  <div class="note">
   <strong class="user">Chris</strong>
   <a href="#78909" class="date">01-Nov-2007 01:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a fresh list of API for SNMPv1, SNMPv2c, and SNMPv3 as of PHP 5.2.4:<br />
<br />
SNMPv1<br />
------<br />
string snmpget(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
string snmpgetnext(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
array snmpwalk(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
array snmprealwalk(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
bool snmp_get_quick_print(void);<br />
<br />
void snmp_set_quick_print(int quick_print);<br />
<br />
void snmp_set_enum_print(int enum_print);<br />
<br />
void snmp_set_oid_output_format(int oid_format);<br />
<br />
int snmpset(string host, string community, string object_id, string type, mixed value [, int timeout [, int retries]]);<br />
<br />
SNMPv2c<br />
-------<br />
string snmp2_get(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
string snmp2_getnext(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
array snmp2_walk(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
array snmp2_real_walk(string host, string community, string object_id [, int timeout [, int retries]]);<br />
<br />
int snmp2_set(string host, string community, string object_id, string type, mixed value [, int timeout [, int retries]]);<br />
<br />
SNMPv3<br />
------<br />
int snmp3_get(string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_protocol, string priv_passphrase, string object_id [, int timeout [, int retries]]);<br />
<br />
int snmp3_getnext(string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_protocol, string priv_passphrase, string object_id [, int timeout [, int retries]]);<br />
<br />
int snmp3_walk(string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_protocol, string priv_passphrase, string object_id [, int timeout [, int retries]]);<br />
<br />
int snmp3_real_walk(string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_protocol, string priv_passphrase, string object_id [, int timeout [, int retries]]);<br />
<br />
int snmp3_set(string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_protocol, string priv_passphrase, string object_id, string type, mixed value [, int timeout [, int retries]]);<br />
<br />
General<br />
-------<br />
int snmp_set_valueretrieval(int method);<br />
<br />
int snmp_get_valueretrieval();<br />
<br />
int snmp_read_mib(string filename);<br />
<br />
SNMPv3 options<br />
--------------<br />
SNMPv3 offers a different authentication/authorization scheme than previous versions of SNMP.&nbsp; To aid in using the API listed above, here is a brief explanation of each of the unique parameters used in the snmp3_* functions.<br />
<br />
$sec_name - the "username" used for authentication to the system<br />
<br />
$sec_level - the authentication scheme ('noAuthNoPriv', 'authNoPriv', or 'authPriv')<br />
<br />
$auth_protocol - the encryption protocol used for authentication ('MD5' [default] or 'SHA')<br />
<br />
$auth_passphrase - the encrypted key to use as the authentication challenge<br />
<br />
$priv_protocol - the encryption protocol used for protecting the protocol data unit ('DES' [default], 'AES128', 'AES192', or 'AES256')<br />
<br />
$priv_passphrase - the key to use for encrypting the protocol data unit<br />
<br />
There are good code snippets available on <a href="http://forums.cacti.net/about5403.html for more information." rel="nofollow" target="_blank">http://forums.cacti.net/about5403.html for more information.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71850""></a>
  <div class="note">
   <strong class="user">cesarmata2000 at cantv dot net</strong>
   <a href="#71850" class="date">19-Dec-2006 07:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With that, i can show the mac of my machine, sorry de english...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//Bug #36196&nbsp; &nbsp; &nbsp; SNMP_VALUE_PLAIN<br />
</span><span class="default">snmp_set_valueretrieval</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$mac </span><span class="keyword">= </span><span class="default">snmpget</span><span class="keyword">(</span><span class="string">"192.168.0.1"</span><span class="keyword">,</span><span class="string">'public'</span><span class="keyword">,</span><span class="string">".1.3.6.1.2.1.2.2.1.6.x"</span><span class="keyword">);<br />
</span><span class="default">snmp_set_valueretrieval</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="default">$mac </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'""'</span><span class="keyword">,</span><span class="string">"&amp;nbsp;"</span><span class="keyword">,</span><span class="default">$mac</span><span class="keyword">);<br />
</span><span class="default">$mac </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'Hex: '</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$mac</span><span class="keyword">);<br />
</span><span class="default">$mac </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">,</span><span class="string">":"</span><span class="keyword">,</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$mac</span><span class="keyword">));<br />
<br />
print </span><span class="default">$mac</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
P.D.: the .x of the OID, is de index of de Interfaz...<br />
<br />
Viva Venezuela y el Software Libre.... =CMM=</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58657""></a>
  <div class="note">
   <strong class="user">1413 at blargh dot com</strong>
   <a href="#58657" class="date">10-Nov-2005 01:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For my purposes in PHP coding, I have the following SNMP options set, always.&nbsp; These aren't documented very well in PHP's docs, but they make dealing with the SNMP results a LOT easier:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Return back the numeric OIDs, instead of text strings.<br />
</span><span class="default">snmp_set_oid_numeric_print</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Get just the values.<br />
</span><span class="default">snmp_set_quick_print</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
<br />
</span><span class="comment">// For sequence types, return just the numbers, not the string and numbers.<br />
</span><span class="default">snmp_set_enum_print</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">); <br />
<br />
</span><span class="comment">// Don't let the SNMP library get cute with value interpretation.&nbsp; This makes <br />
// MAC addresses return the 6 binary bytes, timeticks to return just the integer<br />
// value, and some other things.<br />
</span><span class="default">snmp_set_valueretrieval</span><span class="keyword">(</span><span class="default">SNMP_VALUE_PLAIN</span><span class="keyword">);&nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58396""></a>
  <div class="note">
   <strong class="user">Tim</strong>
   <a href="#58396" class="date">02-Nov-2005 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a problem getting mib errors on my php5 and IIS install.&nbsp; Ended up adding an environmental variable to the Win2k box and that fixed it.&nbsp; Had to add MIBDIRS=C:\PHP\extras\mibs<br />
<br />
After I added this and booted the server I was no longer getting the errors.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57968""></a>
  <div class="note">
   <strong class="user">ch at westend dot com</strong>
   <a href="#57968" class="date">20-Oct-2005 12:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For some devices one needs a string index, i.e.<br />
&nbsp; activeSessions.activeSession-inputOctets."ABC"<br />
<br />
On commandline this is possible with the "-Ir" flag. PHP does not<br />
seem to like it regardless of the quoting. Converting the string index to a numeric OID is quite simple though, it becomes:<br />
&nbsp; activeSessions.activeSession-inputOctets.3.41.42.43<br />
<br />
function getNumericStringIndex($string_idx) {<br />
&nbsp;&nbsp; &nbsp; $string_idx = substr($string_idx, 1, strlen($string_idx)-2);<br />
&nbsp;&nbsp; &nbsp; $ret = strlen($string_idx);<br />
&nbsp;&nbsp; &nbsp; for ($i=0; $i&lt;strlen($string_idx); $i++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ret .= '.'.ord($string_idx[$i]);<br />
<br />
&nbsp;&nbsp; &nbsp; return $ret;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53781""></a>
  <div class="note">
   <strong class="user">Jeroen Simonetti</strong>
   <a href="#53781" class="date">13-Jun-2005 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The listed functions here use snmp version 1. If you wish to use version 2c or 3, use the following functions:<br />
<br />
snmp v2c functions:<br />
<br />
snmp2_get (string host, string community, string object_id [, int timeout [, int retries]])<br />
snmp2_getnext (string host, string community, string object_id [, int timeout [, int retries]])<br />
snmp2_walk (string host, string community, string object_id [, int timeout [, int retries]])<br />
snmp2_real_walk (string host, string community, string object_id [, int timeout [, int retries]])<br />
snmp2_set (string host, string community, string object_id, string type, mixed value [, int timeout [, int retries]])<br />
<br />
snmp v3 functions:<br />
<br />
snmp3_get (string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_pr)<br />
snmp3_getnext (string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string pri)<br />
snmp3_walk (string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_p)<br />
snmp3_real_walk (string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string p)<br />
snmp3_set (string host, string sec_name, string sec_level, string auth_protocol, string auth_passphrase, string priv_pr)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51401""></a>
  <div class="note">
   <strong class="user">http://mike.eire.ca</strong>
   <a href="#51401" class="date">29-Mar-2005 12:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems obvious enough in retrospect, but it doesn't say it anywhere in the (rather poor) SNMP functions documentation.<br />
<br />
You can use a non-standard port number in the hostname string.<br />
<br />
<span class="default">&lt;?php<br />
$data</span><span class="keyword">=</span><span class="default">snmprealwalk</span><span class="keyword">(</span><span class="string">'localhost:261'</span><span class="keyword">,</span><span class="string">'public'</span><span class="keyword">,</span><span class="default">null</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45329""></a>
  <div class="note">
   <strong class="user">tom at tom420 dot cjb dot net</strong>
   <a href="#45329" class="date">02-Sep-2004 12:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of Net-SNMP 5.1.2 the file config.h is now called acconfig.h. This is where you will find and uncomment the line<br />
#define NO_ZEROLENGTH_COMMUNITY 1<br />
as described in the manual above.<br />
<br />
I've been looking for the file for about 20 minutes before I located it by the new name.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44159""></a>
  <div class="note">
   <strong class="user">amit_gupta at users dot sourceforge dot net</strong>
   <a href="#44159" class="date">16-Jul-2004 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was struggling to compile PHP 4.3.8/PHP-5 with net-snmp-5.1 RPMS .&nbsp; It was continously showing errors during make. Later I first complied and installed net-snmp-5.1&nbsp; on fedora system. With this compiled Net-snmp , I could install PHP 4.3.8/php5 successfully. So if you are also getting error during make command during installation of PHP, first compile net-snmp instaead of using its RPM.<br />
<br />
Amit Gupta</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43253""></a>
  <div class="note">
   <strong class="user">peterd at nospam telephonetics co uk</strong>
   <a href="#43253" class="date">15-Jun-2004 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found that when using SNMP on Windows (2000 Pro) the drive the mib files have to be located on actually depends on where you subsequently call PHP from.<br />
<br />
For example:<br />
(Assume PHP is installed in c:\\php and the mibs are installed in c:\\usr\\mibs and you have a script c:\\test.php)<br />
Open a command prompt at c:\\<br />
Calling c:\\php\\cli\\php.exe c:\\test.php will work fine.<br />
Change directory to d:\\<br />
Execute c:\\php\\cli\\php.exe c:\\test.php will now cause an error about not finding mib files.<br />
<br />
If you now copy the mibs to d:\\usr\\mibs and run the above command again, it will now work fine.<br />
<br />
Effectively the drive the mibs has to be on is the same as the drive of the current working directory when you call PHP.<br />
<br />
This isn't very useful at all, so after some digging around there seems to be an environment variable (MIBDIRS) you can set specifying where the MIBs are to be found.<br />
<br />
After setting MIBDIRS=c:\\php\\mibs in the environment and placing the mibs there, everything seemed to work fine.<br />
<br />
Note: If you need SNMP whilst using apache you may have to use the PassEnv command with MIBDIRS in your apache config, I haven't tried this yet.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43070""></a>
  <div class="note">
   <strong class="user">Sean Boulter</strong>
   <a href="#43070" class="date">08-Jun-2004 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In addition to working on NT as the documentation says, SNMP works on XP if you have the snmp extensions enabled in the ph.ini file, point the ini file to the correct extensions folder, and copy the mibs from the full install package to c:\usr\mibs.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40199""></a>
  <div class="note">
   <strong class="user">mcotner at mcotner dot com</strong>
   <a href="#40199" class="date">24-Feb-2004 10:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi all,<br />
I had a need for mass polling of many devices and bulkgets were very desirable.&nbsp; It turns out the change was simpler than I thought.<br />
<br />
One word of warning, however.&nbsp; The version is set in such a way that if I were to keep the changes to a minimum all operations that weren't v3 needed to be set to v2c.&nbsp; This isn't a problem for us because we have no v1 specific devices.&nbsp; If you're polling any v1 ONLY agents then you will have issues with this patch.&nbsp; <br />
<br />
Here's the patch.&nbsp; I hope this helps.<br />
<br />
Just save it to /tmp/patch<br />
cd ext/snmp/<br />
patch snmp.c /tmp/patch<br />
<br />
'njoy,<br />
Mark<br />
<br />
--- snmp.c&nbsp; &nbsp; 2003-08-07 12:44:11.000000000 -0400<br />
+++ /tmp/snmp.c&nbsp; &nbsp; 2004-02-24 22:03:22.000000000 -0500<br />
@@ -405,7 +405,11 @@<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN_FALSE;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; } else if (st &gt;= 2) {<br />
-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pdu = snmp_pdu_create(SNMP_MSG_GETNEXT);<br />
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int reps = 20, non_reps = 0;<br />
+<br />
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pdu = snmp_pdu_create(SNMP_MSG_GETBULK);<br />
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pdu-&gt;non_repeaters = non_reps;<br />
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pdu-&gt;max_repetitions = reps;&nbsp; &nbsp; /* fill the packet */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; snmp_add_null_var(pdu, name, name_length);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;<br />
@@ -471,7 +475,7 @@<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; goto retry;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if (st &gt;= 2) {<br />
-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((pdu = snmp_fix_pdu(response, SNMP_MSG_GETNEXT)) != NULL) {<br />
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((pdu = snmp_fix_pdu(response, SNMP_MSG_GETBULK)) != NULL) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; goto retry;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
@@ -579,7 +583,7 @@<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; session.peername = hostname;<br />
&nbsp;&nbsp; &nbsp; session.remote_port = remote_port;<br />
-&nbsp; &nbsp; session.version = SNMP_VERSION_1;<br />
+&nbsp; &nbsp; session.version = SNMP_VERSION_2c;<br />
&nbsp;&nbsp; &nbsp; /*<br />
&nbsp;&nbsp; &nbsp; * FIXME: potential memory leak<br />
&nbsp;&nbsp; &nbsp; * This is a workaround for an "artifact" (Mike Slifcak)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20934""></a>
  <div class="note">
   <strong class="user">thug at wolf359 dot cjb dot net</strong>
   <a href="#20934" class="date">22-Apr-2002 12:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note on PHP SNMP instalation on Windows machines (IIS 5.x / Win2k SP2 etc...) <br />
I had installed PHP into C:\PHP.. (standard stuff eh?)<br />
<br />
Whilst I had followed the instructions for the installation of SNMP (put php_snmp.dll in extension_dir, uncomment entry in php.ini and all mib files located on the same drive where php was installed&nbsp; (in this case c:\usr\mibs right?) I still ran into trouble like "Cannot find module (IP-MIB): At line 0 in (none)..." appearing on the bottom of every php that page I was viewing which existed on a drive other than C:\ drive...<br />
<br />
It seams that the mibs dir (and content thereof) have to be located on every volume where a php file will be executed from.<br />
<br />
For example :-<br />
If you have a php file as "C:\INETPUB\WWWROOT\snmp1.php" then the coresponding "C:\USR\MIBS\*.*" has to be present (as mentioned in the install.txt).<br />
<br />
Now here comes the catch...<br />
<br />
If you have a "D:\INETPUB\PHPROOT\snmp1.php" file, then a copy of the mib files have to be in "D:\USR\MIBS\*.*" as well (the same mib files that are on the C:\ drive and same basic location &lt;drive&gt;:\USR\MIBS).<br />
<br />
(Or in short : Copy the C:\USR dir (inc mibs dir) to *every* drive you intend to have .php files accessed from.&nbsp; Done!)<br />
<br />
Hope this helps other PHParians.<br />
<br />
Keep up the *Great* work!!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="snmp.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.snmp-get-quick-print.html">snmp_get_quick_print</a></div>
 <div class="up"><a href="book.snmp.html">SNMP</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
