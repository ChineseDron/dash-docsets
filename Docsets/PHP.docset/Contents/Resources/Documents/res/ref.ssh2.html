<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>SSH2 Functions</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ssh2.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.ssh2-auth-hostbased-file.html">ssh2_auth_hostbased_file</a></div>
 <div class="up"><a href="book.ssh2.html">SSH2</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.ssh2" class="reference">
 <h1 class="title">SSH2 Functions</h1>

 



































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.ssh2-auth-hostbased-file.html">ssh2_auth_hostbased_file</a> â€” Authenticate using a public hostkey</li><li><a href="function.ssh2-auth-none.html">ssh2_auth_none</a> â€” Authenticate as &quot;none&quot;</li><li><a href="function.ssh2-auth-password.html">ssh2_auth_password</a> â€” Authenticate over SSH using a plain password</li><li><a href="function.ssh2-auth-pubkey-file.html">ssh2_auth_pubkey_file</a> â€” Authenticate using a public key</li><li><a href="function.ssh2-connect.html">ssh2_connect</a> â€” Connect to an SSH server</li><li><a href="function.ssh2-exec.html">ssh2_exec</a> â€” Execute a command on a remote server</li><li><a href="function.ssh2-fetch-stream.html">ssh2_fetch_stream</a> â€” Fetch an extended data stream</li><li><a href="function.ssh2-fingerprint.html">ssh2_fingerprint</a> â€” Retrieve fingerprint of remote server</li><li><a href="function.ssh2-methods-negotiated.html">ssh2_methods_negotiated</a> â€” Return list of negotiated methods</li><li><a href="function.ssh2-publickey-add.html">ssh2_publickey_add</a> â€” Add an authorized publickey</li><li><a href="function.ssh2-publickey-init.html">ssh2_publickey_init</a> â€” Initialize Publickey subsystem</li><li><a href="function.ssh2-publickey-list.html">ssh2_publickey_list</a> â€” List currently authorized publickeys</li><li><a href="function.ssh2-publickey-remove.html">ssh2_publickey_remove</a> â€” Remove an authorized publickey</li><li><a href="function.ssh2-scp-recv.html">ssh2_scp_recv</a> â€” Request a file via SCP</li><li><a href="function.ssh2-scp-send.html">ssh2_scp_send</a> â€” Send a file via SCP</li><li><a href="function.ssh2-sftp-lstat.html">ssh2_sftp_lstat</a> â€” Stat a symbolic link</li><li><a href="function.ssh2-sftp-mkdir.html">ssh2_sftp_mkdir</a> â€” Create a directory</li><li><a href="function.ssh2-sftp-readlink.html">ssh2_sftp_readlink</a> â€” Return the target of a symbolic link</li><li><a href="function.ssh2-sftp-realpath.html">ssh2_sftp_realpath</a> â€” Resolve the realpath of a provided path string</li><li><a href="function.ssh2-sftp-rename.html">ssh2_sftp_rename</a> â€” Rename a remote file</li><li><a href="function.ssh2-sftp-rmdir.html">ssh2_sftp_rmdir</a> â€” Remove a directory</li><li><a href="function.ssh2-sftp-stat.html">ssh2_sftp_stat</a> â€” Stat a file on a remote filesystem</li><li><a href="function.ssh2-sftp-symlink.html">ssh2_sftp_symlink</a> â€” Create a symlink</li><li><a href="function.ssh2-sftp-unlink.html">ssh2_sftp_unlink</a> â€” Delete a file</li><li><a href="function.ssh2-sftp.html">ssh2_sftp</a> â€” Initialize SFTP subsystem</li><li><a href="function.ssh2-shell.html">ssh2_shell</a> â€” Request an interactive shell</li><li><a href="function.ssh2-tunnel.html">ssh2_tunnel</a> â€” Open a tunnel through a remote server</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="93131""></a>
  <div class="note">
   <strong class="user">kirvy at plunify dot com</strong>
   <a href="#93131" class="date">25-Aug-2009 01:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Initially I had the same problem as BlackJowy, but it should be working in windows.<br />
<br />
The problem is that during ssh-keygen, you need to generate SSH2 version. <br />
<br />
Meaning, run "ssh-keygen -t dsa" instead of just "ssh-keygen". <br />
<br />
The rest of the setup is the same. <br />
1) Copy your public key to your remote host<br />
2) Create the authorized_keys files on your remote host</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82960""></a>
  <div class="note">
   <strong class="user">volkirik at yahoo dot com dot tr</strong>
   <a href="#82960" class="date">03-May-2008 09:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems like current versions of ssh2 extension (0.10 and olders) are not compatible with LibSSH2 versions newer than 0.14<br />
<br />
Patch ssh2.c file or use LibSSH2 v0.14 until new LibSSH2 versions are supported.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81093""></a>
  <div class="note">
   <strong class="user">aby at thomasoft dot com</strong>
   <a href="#81093" class="date">13-Feb-2008 02:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an update for those who are having difficulty compiling <br />
on newer systems when following the manual procedure above.<br />
<br />
The following finally worked on OpenSuSE 10.3.&nbsp; <br />
I assume this will probably work on most newer distributions.<br />
<br />
Download the latest source for php-ssh2 from <br />
<a href="http://svn.mandriva.com/cgi-bin/viewvc.cgi/packages/cooker/php-ssh2/" rel="nofollow" target="_blank">http://svn.mandriva.com/cgi-bin/viewvc.cgi/packages/cooker/php-ssh2/</a><br />
<br />
Save it in a temp folder <br />
<br />
Extract the file&nbsp; (eg: tar -xzvf ssh2-0.11-20071019.tar.gz)<br />
<br />
Change to the newly extracted folder and execute following<br />
<br />
phpize &amp;&amp; ./configure --with-ssh2 --with-php-config=/usr/bin/php-config5 &amp;&amp; make<br />
<br />
(make sure to change the path to the correct php-config5 on your system.) <br />
<br />
Once the complie is completed successfully, copy the .libs/ssh2.so<br />
to the php extension folder specified in php.ini<br />
<br />
add "extension=ssh2.so" in php.ini<br />
<br />
restart apache<br />
<br />
This worked.&nbsp; Good luck.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80859""></a>
  <div class="note">
   <strong class="user">me at chrisstockton dot org</strong>
   <a href="#80859" class="date">04-Feb-2008 08:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Anyone trying to compile ssh2 in php6 will run into a lot of errors. I made a simple patch that is suitable for a test environment, you may want to go over it before using it in a production environment as I remove a checkuid function.<br />
<br />
The patch is a little big so here is a link (had to add a line break):<br />
<a href="http://chrisstockton.org/2008/02/04/" rel="nofollow" target="_blank">http://chrisstockton.org/2008/02/04/</a><br />
programming/php6-ssh2-doesnt-compile/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80837""></a>
  <div class="note">
   <strong class="user">andreas dot winkelbauer at gmx dot at</strong>
   <a href="#80837" class="date">02-Feb-2008 08:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As fedora does not provide an official package for the ssh2 functions, I have built a php-pecl-ssh2 package for fedora users out there.<br />
<br />
you can find the packages at: <a href="http://www.wina.at/uni/html/linux-php-pecl-ssh2.html" rel="nofollow" target="_blank">http://www.wina.at/uni/html/linux-php-pecl-ssh2.html</a><br />
<br />
bye,<br />
Andi</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80617""></a>
  <div class="note">
   <strong class="user">XmisterIS</strong>
   <a href="#80617" class="date">25-Jan-2008 03:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When installing SSH2 on Debian Etch using gcc 4.1.2, compilation of ssh2.c failed with a whole load of errors (too many to show here).<br />
<br />
A lot of people seem to have had this problem with a variety of flavours of Linux and gcc.&nbsp; The solution that worked for me is as follows:<br />
<br />
Presuming you've downloaded, and extracted the pecl lib you can patch it manually by opening up ssh2.c and reading down the script untill you get to the line that reads:<br />
<br />
&nbsp; #if LIBSSH2_APINO &lt; 200412301450<br />
<br />
Change it to read<br />
<br />
&nbsp; #if LIBSSH2_VERSION_NUM &lt; 0x001000<br />
<br />
Save the file and run<br />
<br />
&nbsp; phpize &amp;&amp; ./configure --with-ssh2 &amp;&amp; make<br />
<br />
Then carry on from there.<br />
<br />
Incidentally, if you run "make install" rather than just "make" as the root user then the make process *should* automatically copy ssh2.so into your php.ini extension_dir, provided your environment is correct.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79754""></a>
  <div class="note">
   <strong class="user">areddan at silverarm dot com</strong>
   <a href="#79754" class="date">11-Dec-2007 05:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Setup PHP SSH2 Connection from php&nbsp; running locally win32<br />
&nbsp;to a remote box&nbsp; (i used pair networks)<br />
1. Download module<br />
<a href="http://www.php.net/downloads.php" rel="nofollow" target="_blank">http://www.php.net/downloads.php</a><br />
Download Win32 binaries and extract<br />
php_ssh2.dll to the extensions directory<br />
<br />
Edit the php.ini file that is being used to include this extension<br />
<br />
extension=php_ssh2.dll<br />
<br />
Generate a pub / private key pair on the server you wish to connect to<br />
<br />
ssh-keygen -t rsa -C "username@boxname.pair.com"<br />
Generating public/private rsa key pair.<br />
Enter file in which to save the key (/usr/home/username/.ssh/id_rsa):<br />
Enter passphrase (empty for no passphrase):<br />
Enter same passphrase again:<br />
Your identification has been saved in /usr/home/username/.ssh/id_rsa.<br />
Your public key has been saved in /usr/home/username/.ssh/id_rsa.pub.<br />
<br />
Copy both the public and private key files to your local box.<br />
Cut and paste the id_rsa.pub contents into authorized_keys2<br />
&nbsp; file in /usr/home/username/.ssh - creating it if it does not exist.<br />
<br />
Create a php program containing the following<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/* Notify the user if the server terminates the connection */<br />
</span><span class="keyword">function </span><span class="default">my_ssh_disconnect</span><span class="keyword">(</span><span class="default">$reason</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">, </span><span class="default">$language</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"Server disconnected with reason code [%d] and message: %s\n"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$reason</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$methods </span><span class="keyword">= array(<br />
&nbsp; </span><span class="string">'kex' </span><span class="keyword">=&gt; </span><span class="string">'diffie-hellman-group1-sha1,diffie-hellman-group14-sha1,'<br />
&nbsp; </span><span class="keyword">.</span><span class="string">'diffie-hellman-group-exchange-sha1'</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'client_to_server' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'crypt' </span><span class="keyword">=&gt; </span><span class="string">'3des-cbc'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'comp' </span><span class="keyword">=&gt; </span><span class="string">'none'</span><span class="keyword">),<br />
&nbsp; </span><span class="string">'hostkey'</span><span class="keyword">=&gt;</span><span class="string">'ssh-rsa'</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'server_to_client' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'crypt' </span><span class="keyword">=&gt; </span><span class="string">'aes256-cbc,aes192-cbc,aes128-cbc'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'comp' </span><span class="keyword">=&gt; </span><span class="string">'none'</span><span class="keyword">));<br />
<br />
</span><span class="default">$callbacks </span><span class="keyword">= array(</span><span class="string">'disconnect' </span><span class="keyword">=&gt; </span><span class="string">'my_ssh_disconnect'</span><span class="keyword">);<br />
<br />
</span><span class="default">$connection </span><span class="keyword">= </span><span class="default">ssh2_connect</span><span class="keyword">(</span><span class="string">'vepar.pair.com'</span><span class="keyword">, </span><span class="default">22</span><span class="keyword">, </span><span class="default">$methods</span><span class="keyword">, </span><span class="default">$callbacks</span><span class="keyword">);<br />
if (!</span><span class="default">$connection</span><span class="keyword">) die(</span><span class="string">'Connection failed'</span><span class="keyword">);<br />
<br />
</span><span class="comment">/* Uncomment to secure even further, <br />
you want to get the known host key by getting $fingerprint <br />
the first time and then hard coding<br />
$known_host = '';<br />
$fingerprint = ssh2_fingerprint($connection,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SSH2_FINGERPRINT_MD5 | SSH2_FINGERPRINT_HEX);<br />
<br />
if ($fingerprint != $known_host) {<br />
&nbsp; die("HOSTKEY MISMATCH!\n" .<br />
&nbsp;&nbsp; &nbsp;&nbsp; "Possible Man-In-The-Middle Attack? $fingerprint");<br />
}<br />
*/<br />
<br />
</span><span class="keyword">if (</span><span class="default">ssh2_auth_pubkey_file</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">, </span><span class="string">'username'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'S:/sshphp/id_rsa.pub'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'S:/sshphp/id_rsa'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">)) {<br />
&nbsp; echo </span><span class="string">"Public Key Authentication Successful\n"</span><span class="keyword">;<br />
} else {<br />
&nbsp; die(</span><span class="string">'Public Key Authentication Failed'</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Alan Reddan Silverarm</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79380""></a>
  <div class="note">
   <strong class="user">zsbe17fr at yahoo dot fr</strong>
   <a href="#79380" class="date">23-Nov-2007 03:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you want to be able to compile the ssh2 extension with the newest version of libss2, you should modify the source code of ssh2.c and replace<br />
<br />
#if LIBSSH2_APINO &lt; 200412301450<br />
<br />
with<br />
<br />
#if false<br />
<br />
and it is working</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79027""></a>
  <div class="note">
   <strong class="user">mjames at voipsupply dot com</strong>
   <a href="#79027" class="date">07-Nov-2007 08:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a note, if you're download the libssh2 source tar, you'll need to download libssh2-0.12.tar.gz.&nbsp; The newer versions won't compile properly.&nbsp; I've tried either the pecl or manual way, and kept getting a compile time error&nbsp; when using the pecl package ssh2-0.10. <br />
<br />
Michael James<br />
mjames@voipsupply.com</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78756""></a>
  <div class="note">
   <strong class="user">dan at novapulsar dot com</strong>
   <a href="#78756" class="date">25-Oct-2007 11:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you will have an issue transferring any file using ssh2_scp_send unless you send a dummy file after your real file, or preferably issue an <br />
<br />
ssh2_exec ($connection, 'exit'); <br />
<br />
I was transferring hundreds of thousands of files in my prototype across multiple servers, and noticed that each file had a mismatched md5 hash and bytelength.<br />
<br />
after a bit of research i learnt that this was a bug, and added the code above as suggested at pecl.php.net in the bugs section.<br />
<br />
hopefully this helps someone who is getting partial file transfer that could ruin your whole app.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78692""></a>
  <div class="note">
   <strong class="user">dan at novapulsar dot com</strong>
   <a href="#78692" class="date">23-Oct-2007 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
when connecting with ssh2_auth_password (connection, username, password), if you don't use a constant for the password you will get an authentication failure. i tried casting as a string, putting in single and double quotes, etc.<br />
<br />
i tried passing the password straight from mysql and couldn't. you'll spend hours trying to figure this simple thing out, so you're stuck with using hard coded password strings for now.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77170""></a>
  <div class="note">
   <strong class="user">aeolianmeson at blitzeclipse dot com</strong>
   <a href="#77170" class="date">17-Aug-2007 12:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some installations of PHP 5 may have a problem starting the SSH2 extension as a Windows' service. It just started happening to me today, spontaneously. I have PHP 5.2.2 (and have tried 5.2.3), on Apache 2.0.59 .<br />
<br />
It turns out that it's an Apache problem. Even though I was given an error message when starting it, it still worked perfectly from the CLI. So, I commented it out in the<br />
INI file again, and am just loading it using extension_loaded('ssh2') and dl('php_ssh2.dll') from within the script.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72183""></a>
  <div class="note">
   <strong class="user">Tim Wood</strong>
   <a href="#72183" class="date">05-Jan-2007 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those trying to use this under an x86_64 version of an rpm-based distribution (e.g. CentOS, RHEL or Fedora Core) who don't have an rpm for libssh2, here's a work around.<br />
<br />
Locate the source rpm for an i386 version (for instance from dag or dries) and rebuild it:<br />
<br />
rpmbuild --rebuild --target x86_64 libssh2-*.src.rpm<br />
<br />
If the rebuild complains about not being able to find something and references a path beginning /var/tmp or /tmp, it may very well have built the files but failed due to a minor error in the spec file.&nbsp; I was too lazy to fix the spec file, so I just manually copied the files into place.&nbsp; In my case, the path in the error included /var/tmp/libssh2-0.12-root/usr/lib/...&nbsp; Note that libssh2 part?&nbsp; That's the area where all the files are dumped during the rpmbuild process.&nbsp; if you move everything in there to the comparable place on your drive, you're golden.&nbsp; In this case libssh2.so was in /var/tmp/libssh2-0.12-root/usr/lib/&nbsp; Strip off the /var/tmp/libssh2* part and you find out the libssh2.so file goes in /usr/lib/<br />
<br />
Enjoy.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71883""></a>
  <div class="note">
   <strong class="user">Josh Kritner</strong>
   <a href="#71883" class="date">20-Dec-2006 07:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Update for the Mac OS X install when using the Entropy.ch PHP5 package: You can use the PECL installer for ssh2 now instead of manually downloading it.<br />
<br />
1) Download and install libssh2 per the instructions below(Steps 1-5)<br />
2) run "sudo /usr/local/php5/bin/pecl install ssh2-beta"<br />
3) add extension=ssh2.so to /usr/local/php5/lib/php.ini<br />
4) Restart Apache (sudo apachectl restart)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70515""></a>
  <div class="note">
   <strong class="user">S Haycroft</strong>
   <a href="#70515" class="date">19-Oct-2006 03:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I also struggled with the <br />
configure: error: libssh2 version &gt;= 0.4 not found<br />
error using verions 0.10 of ssh2 and 0.14 of libssh.<br />
<br />
When looking in the config.log file I found that it was unable to find my SSL libraries, and as I installed my openssl in /usr/local/ssl it could not find it.&nbsp; It was only looking in /usr/local/lib.<br />
<br />
To get round this problem, I set <br />
&nbsp;LDFLAGS="-L /usr/local/ssl/lib"<br />
and this works a treat.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69324""></a>
  <div class="note">
   <strong class="user">astribuncio at gmail dot com</strong>
   <a href="#69324" class="date">31-Aug-2006 10:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Installing on HPUX 11.11 cookbook<br />
<br />
Just follow the install instructions on the man page and solved the problems as they appear<br />
<br />
- when making libssh2<br />
Problem related with /lib/pa20_64 and 64 bits library in 32 bits link<br />
Edited the configure file&nbsp; and changed<br />
SHLIB_LDFLAGS="-b +vnocompatwarnings -L/lib/pa20_64"<br />
to<br />
SHLIB_LDFLAGS="-b +vnocompatwarnings -L/lib"<br />
<br />
-when executing phpize<br />
Problems with aclocal, autom4ke and m4<br />
Installed automake, autoconf and m4<br />
<br />
-when ./configuring the ssh2 <br />
Configure: error: libssh2 version &gt;= 0.4 not found<br />
Edited the configure.m4 and removed the -ldl switch from line (as posted before)<br />
39&nbsp; &nbsp; &nbsp; -L$SSH2_DIR/lib -lm -ldl<br />
runned phpize again and ./configure --with-ssh2</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68806""></a>
  <div class="note">
   <strong class="user">chris dot britton at cingular dot com</strong>
   <a href="#68806" class="date">11-Aug-2006 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was building out the ssh2 extension (0.10) under OpenBSD 3.9 on sparc64 and I got this error when running configure:<br />
<br />
checking for libssh2_banner_set in -lssh2... no<br />
configure: error: libssh2 version &gt;= 0.4 not found<br />
<br />
I did some poking around in the configure file and traced the problem down.&nbsp; The reason for the failure is that configure is trying to compile a test program with -ldl.&nbsp; libdl is not installed on OpenBSD 3.9. The OpenBSD folks purged libdl years ago and I could not find a package that contains it. <br />
<br />
(The error message above is misleading because the problem is not with libssh2.)<br />
<br />
I looked at the ssh2 extension code and could not see a reason for using libdl, so I removed the -ldl from the config.m4 file.&nbsp; Re-ran phpize and configure. No errors.&nbsp; Did make and installed ssh2.so.&nbsp; Works fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68360""></a>
  <div class="note">
   <strong class="user">kickthedonkey at gmail dot com</strong>
   <a href="#68360" class="date">24-Jul-2006 09:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note about the manual installation instructions above.&nbsp; If your PHP is in a non-standard location, or you're running multiple installs of different PHP version, you have to complie the module with an explicit path to phpize and php-config:<br />
<br />
/path/to/correct/php/bin/phpize &amp;&amp; ./configure --with-ssh2 --with-php-config=/path/to/correct/php/bin/php-config &amp;&amp; make<br />
<br />
Took me an hour to figure out why I was getting a "Unable to initialize module Module compiled with module API" error when I loaded the module.&nbsp; Turns out, it was compiling against my php4 libs, and not the php5 ones.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="67197""></a>
  <div class="note">
   <strong class="user">stevec at carbondesignsystems dot com</strong>
   <a href="#67197" class="date">05-Jun-2006 09:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I couldn't get `pear install ssh2-beta` to work, so I tried the manual installation.&nbsp; I followed the instructions:<br />
<br />
phpize &amp;&amp; ./configure --with-ssh2 &amp;&amp; make<br />
Copy ssh2.so from the directory indicated by the build process to the location specified in your php.ini file under extension_dir.<br />
<br />
When I restarted Apache, I got:<br />
PHP Warning:&nbsp; Unknown(): Invalid library (maybe not a PHP library) 'ssh2.so'&nbsp; in Unknown on line 0<br />
<br />
To fix the problem, I ran `make install`, instead of copying ssh2.so into the extension directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63641""></a>
  <div class="note">
   <strong class="user">Mike &lt;esnik8202 at sneakemail dot com&gt;</strong>
   <a href="#63641" class="date">26-Mar-2006 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To slightly correct the directory listing code below....<br />
<br />
<span class="default">&lt;?php<br />
$connection </span><span class="keyword">= </span><span class="default">ssh2_connect</span><span class="keyword">(</span><span class="string">"hostname"</span><span class="keyword">, </span><span class="default">22</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// use any of the ssh2_auth_* methods<br />
</span><span class="default">ssh2_auth_password</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">,</span><span class="string">"username"</span><span class="keyword">, </span><span class="string">"password"</span><span class="keyword">);<br />
</span><span class="default">$sftp </span><span class="keyword">= </span><span class="default">ssh2_sftp</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">);<br />
</span><span class="default">$dir </span><span class="keyword">= </span><span class="string">"ssh2.s<a href="ftp://" rel="nofollow" target="_blank">ftp://</a></span><span class="default">$sftp</span><span class="string">/path/to/dir/"</span><span class="keyword">;<br />
</span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp; echo </span><span class="string">"</span><span class="default">$file</span><span class="string"> is in hostname:/path/to/dir\ n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
(thanks to Sara for assisting)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57462""></a>
  <div class="note">
   <strong class="user">dotwho at NSPM dot mac dot com</strong>
   <a href="#57462" class="date">04-Oct-2005 03:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Trying to compile this ssh PECL extension for Mac OS X (10.4.2) <br />
with entropy.ch's php5 distribution? Read on: PART 2:<br />
<br />
11) Check your shell's path variable by SHELL$ "echo $PATH". <br />
If your php5 binary directory is not listed before the standard OS X binary directory, <br />
update your $PATH variable to list it first. Mine reads: <br />
/usr/local/mysql/bin/: /usr/local/php5/bin/: /bin:/sbin: /usr/bin:/usr/sbin <br />
11a) if you do not do this step, the PECL extension will link against the old <br />
php4 version that ships with Mac OS X. You will know this by the fact that the <br />
next step lists a server API that is different than the output of phpinfo(): <br />
My version was 20041030, Apples version was 20020429.<br />
12) Run: phpize &amp;&amp; ./configure --with-ssh2 &amp;&amp; make<br />
This will produce a lot of output and probably some warnings. If you get a note <br />
at the end that says "Build Complete", then the process has completed <br />
(probably successfully). The command has produced the output file ssh2.so within <br />
the ssh2-0.9 (or whatever version) directory.<br />
13) Check where the extension directory is located at by running the following command:<br />
SHELL$/usr/local/php5/bin/php-config --extension-dir<br />
If it lists some directory that actually exists, copy the ssh2.so file to this directory.<br />
If it doesn't list a location that exists, you can either create the location, or <br />
choose a different location and update the line in your php.ini file:<br />
extension_dir = "./"<br />
to point to the directory you would like to use. I chose:<br />
extension_dir = "/usr/local/php5/extensions/"?&gt;<br />
14) Add the line<br />
extension=ssh2.so<br />
to the Dynamic Extensions area of your php.ini file.<br />
15) Restart your web server for the extensioin to be loaded. If there are any problems, they will be written to the webserver log.<br />
16) Check if your new ssh based streams are available by running:<br />
SHELL$ /usr/local/php5/bin/php -r "print_r(stream_get_wrappers());"<br />
You should get something similar to this output:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; php<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; file<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; http<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; ftp<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; compress.bzip2<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; compress.zlib<br />
&nbsp;&nbsp;&nbsp; [6] =&gt; https<br />
&nbsp;&nbsp;&nbsp; [7] =&gt; ftps<br />
&nbsp;&nbsp;&nbsp; [8] =&gt; ssh2.shell<br />
&nbsp;&nbsp;&nbsp; [9] =&gt; ssh2.exec<br />
&nbsp;&nbsp;&nbsp; [10] =&gt; ssh2.tunnel<br />
&nbsp;&nbsp;&nbsp; [11] =&gt; ssh2.scp<br />
&nbsp;&nbsp;&nbsp; [12] =&gt; ssh2.sftp<br />
)<br />
You should now be able to do all the cool things you need to do with ssh <br />
(like sftp scp ssh execution)! Take a look at some of the comment here for some <br />
example scripts to test things out:<br />
<a href="http://us2.php.net/manual/en/ref.ssh2.php" rel="nofollow" target="_blank">http://us2.php.net/manual/en/ref.ssh2.php</a><br />
<br />
Good luck... hope that saves you my headache! :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57461""></a>
  <div class="note">
   <strong class="user">dotwho at NSPM dot mac dot com</strong>
   <a href="#57461" class="date">04-Oct-2005 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Trying to compile this ssh PECL extension for Mac OS X (10.4.2) <br />
with entropy.ch's php5 distribution? Read on: PART 1:<br />
1) Download libssh (I used version 0.11)<br />
<a href="http://sourceforge.net/project/showfiles.php?group_id=125852" rel="nofollow" target="_blank">http://sourceforge.net/project/showfiles.php?group_id=125852</a><br />
2) Unzip the directory and cd to the upacked directory in the terminal.<br />
3) run: ./configure; make all install;<br />
libssh should compile and place the output file in src/*.o<br />
4) copy all headers from the include folder within the libssh2 directory to<br />
/usr/local/include/<br />
5) copy all compiled files (*.o) from the src folder within the libssh2 <br />
directory to /usr/local/lib/<br />
6) Download ssh2 <br />
(I used version 0.9 with additional changes from cvs - explained below)<br />
<a href="http://pecl.php.net/package/ssh2" rel="nofollow" target="_blank">http://pecl.php.net/package/ssh2</a><br />
7) unzip the downloaded archive.<br />
8) version 0.9 has a conflict with an existing symbol used in some of the ZEND headers... <br />
a change is available in cvs which renames the symbol in ssh2 to avoid the conflict<br />
<a href="http://cvs.php.net/diff.php/pecl/ssh2/ssh2.c?r1=1.9&amp;r2=1.10&amp;ty=h" rel="nofollow" target="_blank">http://cvs.php.net/diff.php/pecl/ssh2/ssh2.c?r1=1.9&amp;r2=1.10&amp;ty=h</a><br />
down load at least the 1.10 version of ssh2.c<br />
if you decide to download a newer version, download any of the corresponding related files, <br />
such as the php_ssh2.h header file.<br />
9) replace the old version of ssh2.c with the new version of ssh2.c <br />
(and any other files you downloaded).<br />
10) From the terminal: <br />
cd to the source directory (for me ssh2-0.9/ssh2-0.9/).<br />
<br />
(Continued in a PART 2 comment)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53279""></a>
  <div class="note">
   <strong class="user">jr at cnb dot uam dot es</strong>
   <a href="#53279" class="date">27-May-2005 07:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
OK, the SSH class I wrote is now available for free on the Net.<br />
<br />
The class uses an underlying SSH implementation, and hence does not require any library to be compiled against.<br />
<br />
It is available at savannah.cer.ch as a byproduct of project GridGramm (look in the downloads section). There are two releases available, the first one establishes a connection for each command, having a serious authentication overhead. The second release shares a master connection, highly reducing auth payload, but requires openssh &gt;= 3.8.<br />
<br />
They are also available from the development site at<br />
<br />
<a href="http://savannah.cern.ch/projects/gridgramm" rel="nofollow" target="_blank">http://savannah.cern.ch/projects/gridgramm</a><br />
<br />
and come with extensive documentation and examples.<br />
<br />
These are work in progress, and I hope to add more enhancements in the close future. But you are welcome to use them now.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ssh2.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.ssh2-auth-hostbased-file.html">ssh2_auth_hostbased_file</a></div>
 <div class="up"><a href="book.ssh2.html">SSH2</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
